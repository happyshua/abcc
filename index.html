
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<!-- ÂèØ‰øÆÊîπ Editable - ÈªòËÆ§‰∏çÂ±èËîΩÊêúÁ¥¢ÂºïÊìéÊú∫Âô®‰∫∫ÔºåÊÉ≥Â±èËîΩÁöÑËØ∑ÂéªÈô§Ê≥®Èáä„ÄÇ Default allow search engine robots. -->
<meta name="ROBOTS" content="noindex,nofllow">
<!-- ÂèØ‰øÆÊîπ Editable - ÁΩëÈ°µÊ†áÈ¢ò -->
<title>ABCÊµ∑Ëû∫Bot BY MC</title>
<meta name="description" content="MCGPT - A ChatGPT (GPT-3.5 / GPT-4) Webpage with Just a Single HTML File." />
<!-- ÁΩëÈ°µÂú®ÊâãÊú∫/Âπ≥Êùø‰∏äÁöÑÊòæÁ§∫ÊØî‰æã  ÈªòËÆ§Áº©Êîæ80%Ôºà initial-scale=0.8 Ôºâ -->
<meta name="viewport" content="width=device-width,initial-scale=0.8,minimum-scale=0.5,maximum-scale=2,user-scalable=yes,viewport-fit=cover">
<link rel="shortcut icon" href="https://kimi.xinu.ink/gpt.jpgjpgipg">
<!-- ÂèØ‰øÆÊîπ Editable - iPhone/iPadÂ∞ÜÁΩëÈ°µÊ∑ªÂä†Âà∞‰∏ªÂ±èÂπïÂêéÊòæÁ§∫ÁöÑLogo  ÈªòËÆ§‰∏∫ChatGPTÁöÑLogo  *Â∞èÁôΩ‰∏çÈúÄË¶ÅÊîπ„ÄÇÈúÄË¶Å‰º†ÁΩëÈ°µÂà∞Github/Gitee/ÈùôÊÄÅÁΩëÈ°µÊâòÁÆ°Âπ≥Âè∞/‰∏ªÊú∫/ÊúçÂä°Âô®ÁöÑÂêåÂ≠¶ÔºåÊâçÈúÄË¶ÅËÆæÁΩÆ„ÄÇ  ÁÆÄÂçïÁÇπÂø´ÈÄüËÆæÁΩÆÔºö‰ªªÊÑèÊ†ºÂºèÁöÑÊ≠£ÊñπÂΩ¢ÂõæÁâá„ÄÇ  Êé®ËçêÂèÇËÄÉËÆæÁΩÆÔºöpngÊ†ºÂºè 180x180  -->
<link rel="apple-touch-icon" https://abcc.xinu.ink/1.jpg">
<link rel="icon" href="https://abcc.xinu.ink/1.jpg" sizes="128x128"> 
    <meta name="application-name" content="ÈóÆÈóÆÁ•ûÂ•áüêö">
    <!-- Ëá™ÂÆö‰πâÂ∫îÁî®ÂõæÊ†áÂèØÁî® -->
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://abcc.xinu.ink/1.jpg">
    <!-- ÂÖ®Â±èËÆæÁΩÆ -->
    <meta name="viewport" content = "width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" />
    <!-- ÁΩëÁ´ôÂºÄÂêØÂØπ web app Á®ãÂ∫èÁöÑÊîØÊåÅ ÂÖ∑‰ΩìË°®Áé∞‰∏∫ÂéªÈô§ÊµèËßàÂô®Âú∞ÂùÄÊ†èÂíåÂ∫ïÈÉ®ÂØºËà™Ê†è ÔºöÂÖà‰øùÂ≠ò‰∏∫Ê°åÈù¢‰π¶Á≠æÔºåÁÑ∂ÂêéÈÄöËøá‰π¶Á≠æÊâìÂºÄÂç≥ÂèØÁîüÊïà-->
    <meta name="apple-mobile-web-app-capable" content="yes">
<!-- VueÈ¶ñÈÄâCDN(Á∫øË∑Ø1) VueÊòØ‰∏ÄÊ¨æÁî®‰∫éÊûÑÂª∫Áî®Êà∑ÁïåÈù¢ÁöÑJavaScriptÊ°ÜÊû∂ÔºåÁΩëÈ°µÂ∏∏Áî®ÊäÄÊúØ  -->
<!-- 20230520 tips: ‰∏çË¶Å‰ΩøÁî®3.2.47ÁöÑprodÁâàÊú¨Ôºå‰ºöÂÅ∂Â∞î‰∫ßÁîüÈîôËØØÔºåÂΩ±Âìç‰ΩøÁî®„ÄÇ Do not use the prod version of 3.2.47, as I have found it to occasionally produce errors with unknown causes. -->
<!-- 20230603 tips: ‰ΩøÁî®3.3.4ÁöÑprodÁâàÊú¨‰∏§Âë®‰∫ÜÔºåÈùûÂ∏∏Á®≥ÂÆöÔºåÊ≤°ÊúâÂÜçÊä•ÈîôÔºåÂæàÊ£íÁöÑÁâàÊú¨„ÄÇ  I've been using the prod version of 3.3.4 for two weeks now and it has been very stable, without any errors. It's a great version.  -->
<script src="https://unpkg.com/vue@3.3.4/dist/vue.global.prod.js"></script>
<!-- VueÂ§áÈÄâCDN(Á∫øË∑Ø2) È¶ñÈÄâCDNÂ§±ÊïàÂêéÔºåËá™Âä®Âä†ËΩΩÂ§áÈÄâCDNÔºåÁ°Æ‰øùvueÁöÑÊ≠£Á°ÆÂä†ËΩΩ„ÄÇ unescape()Êã¨Âè∑ÈáåÁöÑÊòØ‰∏ÄÁßçÁºñÁ†ÅÔºåËΩ¨‰πâÂ∞ñÊã¨Âè∑(<>)ÔºåÈùû‰π±Á†Å„ÄÇÂú®Á∫øËß£Á†ÅÂ∑•ÂÖ∑ https://tool.ip138.com/escape/   -->
<script> !window.Vue && document.write(unescape('%3Cscript src="https://cdn.jsdelivr.net/npm/vue@3.3.4/dist/vue.global.prod.js"%3E%3C/script%3E') ) </script>



<!-- ‰ª•‰∏ã‰∏∫cssÊ†∑Âºè Â∑≤ÂéãÁº©ÔºåÂèØ‰ΩøÁî®Â∑•ÂÖ∑Ê†ºÂºèÂåñ -->
<!-- CSSÊ†ºÂºèÂåñÂ∑•ÂÖ∑1: https://tool.ip138.com/css/ -->
<!-- CSSÊ†ºÂºèÂåñÂ∑•ÂÖ∑2: http://www.ab173.com/gongju/format/css.php  -->
<style> 

#loading-mask{background-color:#ededed;z-index:900999}
#loading-mask div{text-align:center;font-size:12px;color:#b4b4b4}
::-webkit-scrollbar{width:7px;height:7px}
::-webkit-scrollbar-thumb{background-color:#e1e1e1;border-radius:10px}
::-webkit-scrollbar-thumb:hover{background-color:#cdcdcd}
body::-webkit-scrollbar-thumb{background-color:#e1e1e1;border-radius:10px}
body::-webkit-scrollbar-thumb:hover{background-color:#cdcdcd}
body::-webkit-scrollbar-track{background-color:#ededed}
body::-webkit-scrollbar-track:hover{background-color:#ededed}
body::-webkit-scrollbar-corner{background-color:#ededed}
.dialog-wrapper .dialog-scroll::-webkit-scrollbar-thumb{background-color:#d2d2d2;border-radius:10px}
.dialog-wrapper .dialog-scroll::-webkit-scrollbar-thumb:hover{background-color:#c3c3c3}
.dialog-wrapper .dialog-scroll::-webkit-scrollbar-track{background-color:#ededed;border-radius:10px}
.dialog-wrapper .dialog-scroll::-webkit-scrollbar-track:hover{background-color:#ededed}
.dialog-wrapper .dialog-scroll::-webkit-scrollbar-corner{background-color:#ededed}
.notification-wrapper .dialog-scroll::-webkit-scrollbar-thumb{background-color:#e8eb95;border-radius:10px}
.notification-wrapper .dialog-scroll::-webkit-scrollbar-thumb:hover{background-color:#dadd8b}
.notification-wrapper .dialog-scroll::-webkit-scrollbar-track{background-color:#fdffb4}
.notification-wrapper .dialog-scroll::-webkit-scrollbar-track:hover{background-color:#fdffb4}
.notification-wrapper .dialog-scroll::-webkit-scrollbar-corner{background-color:#fdffb4}
body{margin-bottom:0px;margin-top:8px;overflow-y:scroll;background-color:#ededed;font-family:Helvetica Neue,Helvetica,Hiragino Sans GB,"SF Pro SC",Microsoft YaHei,"PingFang SC",Arial,sans-serif}
.bottom-position{height:95px}
.newcontext-hr{height:1px;background-color:#cfcfcf;border:none;width:92%;margin-top:16px;margin-bottom:20px}
.wechatstyle-datetime{display:block;font-size:13px;text-align:center;color:#bbbbbb;margin-top:20px;margin-bottom:17px;-webkit-text-size-adjust:100%;}
.msgdatetimediv{position:relative;-webkit-text-size-adjust:100%;}
.usermsg-datetime{font-size:12px;color:#bbbbbb;bottom:auto;left:auto;right:54px;top:-14px;position:absolute}
.aimsg-datetime{font-size:12px;color:#bbbbbb;bottom:auto;left:57px;right:auto;top:-14px;position:absolute}
.userinfo{display:flex;flex-direction:row-reverse;align-items:flex-start;padding-right:2px;margin-top:17px;animation:oneshow 0.8s ease 1}
.usermsg{color:#191919;display:flex;flex-direction:column;justify-content:center;padding:9px 13px;border-radius:6px;overflow-x:auto;overflow-y:hidden;scrollbar-width:thin;margin-right:11px;background-color:#95eb6c}
.aiinfo{display:flex;flex-direction:row;align-items:flex-start;margin-left:7px;margin-top:17px;animation:oneshow 0.8s ease 1}
.aimsg{color:#191919;display:flex;flex-direction:column;justify-content:center;padding:9px 13px;border-radius:6px;overflow-x:auto;overflow-y:hidden;scrollbar-width:thin;margin-left:11px;background-color:#ffffff}
.aiinfo .msgdiv::before{content:"";display:block;position:absolute;border:12px solid transparent;border-right-color:rgba(255,255,255,1);left:-7px;top:8px}
.userinfo .msgdiv::before{content:"";display:block;position:absolute;border:12px solid transparent;border-left-color:#95eb6c;right:-7px;top:8px}
.msgcopydiv{width:auto;max-width:76%}
.chat-img{border-radius:6px;height:2.3rem;width:2.3rem;color:rgba(255,255,255);background-color:#f5f5f5;display:flex;flex-direction:row;justify-content:center;align-items:center}
.chat-img img{height:100%;width:100%;object-fit:cover;border-radius:6px}
.chat-green-svg{background: linear-gradient(to bottom, #17c882, #14b482);}
.chat-img-border{box-shadow:0 0 2px 1px rgba(56,82,56,0.3);-webkit-box-shadow:0 0 2px 1px rgba(56,82,56,0.3);-moz-box-shadow:0 0 2px 1px rgba(56,82,56,0.3)}
.chat-img-bg{background-image:radial-gradient(#fff,rgb(245,245,245) 40%,#e6e6e6);background-image:-webkit-radial-gradient(#fff,rgb(245,245,245) 40%,#e6e6e6);background-image:-moz-radial-gradient(#fff,rgb(245,245,245) 40%,#e6e6e6)}
.update-img-size{margin-right:4px !important;height:33px;width:33px}
.flex-column-center{display:flex;flex-direction:column;justify-content:center;align-items:flex-start;position:fixed;bottom:0px;width:100%;left:0px;background-color:#f6f6f6;border-top:0.8px solid #dddddd}
.justify-end{display:flex;flex-direction:row;justify-content:flex-start;align-items:right;bottom:0px}
.panelrow{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-end;width:100%;height:30px}
.dh-input{font-size:14px;color:#191919;width:100%;height:25px;border-radius:6px;padding-left:10px;padding-right:10px;margin-left:10px;margin-right:4px;border:1px solid #DDD;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;scrollbar-width: thin;}
.dh-input:disabled{border:1px solid #DDD;color:#cccccc !important}
.dh-input:read-only{border:1px solid #DDD;color:#cccccc !important}
.textareaSPReadOnly:read-only{color:#555555 !important;background-color:#ededed !important;overflow:scroll}
input[type=text],input[type=password],textarea{outline:none}
input[type=text]:focus,input[type=password]:focus,textarea:focus{border:1px solid #17a316 !important;box-shadow:inset 0 1px 2px rgba(0,0,0,.075),0 0 5px rgba(81,167,232,.5)}
input:focus{z-index:2}
.dropdown{-webkit-appearance:none;-moz-appearance:none;appearance:none;flex-shrink:0;width:auto;height:25px;align-items:center;justify-content:center;margin:0;padding:0 10px;border-radius:6px;border:none;font-weight:400;font-size:12px;overflow:hidden;outline:none;cursor:pointer;color:#FFF;background:#1aad19;background: linear-gradient(to bottom, #1ac83c, #1aa819);-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}
.btn{display:flex;flex-shrink:0;width:auto;height:25px;align-items:center;justify-content:center;padding:0 10px;margin-right:7px;background-color:#1aad19;border-color:#1aad19;background: linear-gradient(to bottom, #1ac83c, #1aa819);color:#FFF;border-radius:6px;border:none;outline:none;font-weight:400;font-size:12px;text-decoration:none;text-align:center;line-height:25px;cursor:pointer;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-transition-property:all;transition-property:all;-webkit-transition-duration:.3s;transition-duration:.3s}
.btn *,.copybtn *{align-items:center;justify-content:center;display:flex}
.btn:visited,.dropdown:visited{color:#FFF}
.btn:hover,.btn:focus,.dropdown:hover{background-color:#25c524;border-color:#25c524;background: linear-gradient(to bottom, #24dc46, #24b423);color:#FFF}
.dropdown:active, .dropdown:focus{background:#0fb9af;background-color:#0fb9af;border-color:#0fb9af;color:#f5feff}
.dropdown option:disabled {color: #0c8b6e;}
.bluedropdown option:disabled {color: #008398;}
.orangereddropdown option:disabled {color: #a23300;}
.btn:active{background-color:#17a316;border-color:#17a316;background: linear-gradient(to bottom, #17be39, #179616);color:#f9fff5;}
.btn:disabled,.dropdown:disabled,.bluebtn:disabled{border:1px solid #DDD !important;background-color:#F5F5F5 !important;background: linear-gradient(to bottom, #fcfcfc, #f0f0f0) !important;color:#1aad19 !important}
.minibtn{width:14px;height:14px;line-height:12px;padding:1px;font-size:12px;flex-shrink:0;display:inline-block;vertical-align:middle;border-radius:50%;margin-bottom:1px !important;transform:scale(0.85);-ms-transform:scale(0.85);-webkit-transform:scale(0.85);-moz-transform:scale(0.85);-o-transform:scale(0.85)}
.minibtn-default{width:auto;height:16px;padding:2px 7px;border-radius:4px}
.bluebtn,.bluedropdown{background-color:#1ca5c2;border-color:#1ca5c2;background: linear-gradient(to bottom, #1cbec8, #1c9bc3);}
.bluebtn:hover,.bluebtn:focus{background-color:#22b9d9;border-color:#22b9d9;background: linear-gradient(to bottom, #26d2d2, #26afcd);color:#FFF}
.bluebtn:active{background-color:#1ca5c2;border-color:#1ca5c2;background: linear-gradient(to bottom, #19b4c5, #1991c0);color:#effcff}
.bluedropdown:hover,.bluedropdown:focus{background-color:#22b9d9;border-color:#22b9d9;background:#22b9d9;color:#FFF}
.redbtn{background-color:#dd3838;border-color:#dd3838;background: linear-gradient(to bottom, #f34d2d, #eb0505);box-shadow:0 0 3px 0 rgba(221,56,56,0.55)}
.redbtn:hover,.redbtn:focus{background-color:#ff4040;border-color:#ff4040;background: linear-gradient(to bottom, #fd5f4b, #eb1919);color:#FFF}
.redbtn:active{background-color:#c73737;border-color:#c73737;background: linear-gradient(to bottom, #ea4607, #ea0002);color:#fff5f0}
.orangeredbtn,.orangereddropdown{background-color:#f44400;border-color:#f44400;background: linear-gradient(to bottom, #ff7800, #f74900);box-shadow:0 0 2px 0 rgba(241,64,14,0.55)}
.orangeredbtn:hover,.orangeredbtn:focus{background-color:#ff4f00;border-color:#ff4f00;background: linear-gradient(to bottom, #ff8c0a, #fe580a);color:#FFF}
.orangeredbtn:active{background-color:#da3600;border-color:#da3600;background: linear-gradient(to bottom, #fc6e00, #f13a00);color:#fff9f6}
.orangereddropdown:hover,.orangereddropdown:focus{background-color:#ff4f00;border-color:#ff4f00;background:#ff4f00;color:#FFF}
.btnzoom-a{transition:all 0.5s;cursor:pointer}
.btnzoom-a:hover{transform: scale(1.18)}
.btnzoom-b{transition:all 0.2s}
.btnzoom-b:hover{transform: scale(1)}
.btnzoom-c{transition:all 0.2s}
.btnzoom-c:hover{transform: scale(1.1)}
.btnzoom-d{transition:all 0.2s}
.btnzoom-d:hover{transform: scale(0.95)}
.usermsg *,.aimsg *{margin:0;word-wrap:break-word}
/* white-space:normalÂéªÈô§‰∏ä‰∏ãÁ©∫Ë°åÔºàÈ´òÂ∫¶ÔºâÔºà blockquote ÂçïÁã¨ÂÜôÔºâ+ ÂàóË°®ÂêéÊéíÈô§Êç¢Ë°åÁöÑÂèØËÉΩ  */
.usermsg ul,.usermsg ol,.aimsg ul,.aimsg ol{white-space:normal;margin:5px 0;padding-left:28px}
.usermsg p,.usermsg span,.aimsg p,.aimsg span{line-height:1.6;margin-top:3px}
/* li: break-all Êà™Êñ≠ */
.usermsg li,.aimsg li{word-break:break-all}
/* code Â≠ó‰Ωì */
.usermsg code,.aimsg code{font-size:12px;font-family:Consolas,Monaco,monospace}
/* Ë°åÂÜÖ‰ª£Á†Å Èô§‰∫Üpre>code‰πãÂ§ñÁöÑ‰ª£Á†ÅÂùó */
.aimsg code:not(pre code){color:#27282c;white-space:pre-wrap;word-break:break-word;margin:0;border-radius:6px;padding:1px 5px;background-color:#efefef}
.usermsg code:not(pre code){color:#27282c;white-space:pre-wrap;word-break:break-word;margin:0;border-radius:6px;padding:1px 5px;background-color:#a9f289}
/* Ë°®Ê†º table code */
.usermsg table code:not(pre code),.aimsg table code:not(pre code){color:#27282c;white-space:pre-wrap;word-break:break-word;margin:0;border-radius:6px;padding:1px 5px;background-color:#e3e3d4}
/* ‰ª£Á†ÅÂùó */
/* tokyo-night-dark color:#9aa5ce ; */
/* tokyo-night-dark background: #1a1b26; */
/* panda-syntax-dark color:#e6e6e6 ; */
/* panda-syntax-dark background: #2a2c2d; */
.usermsg pre,.aimsg pre{margin:5px 0;width:100%;min-width:100px;white-space:pre;border-radius:6px;box-sizing:border-box;color:#e6e6e6;background:#2a2c2d}
.usermsg pre > code,.aimsg pre > code{display:block;padding:1em;-moz-tab-size:4;tab-size:4;overflow-x:auto;white-space:pre;word-break:normal;scrollbar-width:thin}
.usermsg img:not(.clippy),.aimsg img:not(.clippy){margin:5px 0;max-width:100%}
.usermsg table img,.aimsg table img{max-width:300px}
/* white-space:normal ÂéªÈô§‰∏ä‰∏ãÁ©∫Ë°åÔºàÈ´òÂ∫¶Ôºâ*/
.usermsg blockquote{white-space:normal;margin:8px 14px;max-width:100%;color:#373737;border-left:1px solid #6eac4e;padding:0 0 0 8px}
.aimsg blockquote{white-space:normal;margin:8px 14px;max-width:100%;color:#57606a;border-left:1px solid #c8c8c8;padding:0 0 0 8px}
.usermsg blockquote *,.aimsg blockquote *{margin-top:0px;margin-bottom:0px}
.usermsg h1,.usermsg h2,.usermsg h3,.usermsg h4,.usermsg h5,.usermsg h6,.usermsg ul,.usermsg ol,.usermsg blockquote,.usermsg ul p,.usermsg ol p,.usermsg blockquote p,.aimsg h1,.aimsg h2,.aimsg h3,.aimsg h4,.aimsg h5,.aimsg h6,.aimsg ul,.aimsg ol,.aimsg blockquote,.aimsg ul p,.aimsg ol p,.aimsg blockquote p{line-height:1.5}
.usermsg h1,.usermsg h2,.usermsg h3,.usermsg h4,.usermsg h5,.usermsg h6,.aimsg h1,.aimsg h2,.aimsg h3,.aimsg h4,.aimsg h5,.aimsg h6{margin-top:5px}
.usermsg h1,.aimsg h1{font-size:1.4em;margin:0 0 0.5em 0;padding:1em 0 0.5em;border-bottom:1px solid #7dc35a}
.usermsg h2,.aimsg h2{font-size:1.25em;margin:0.5em 0;padding:0.2em 0 0.3em;border-bottom:1px solid #7dc35a}
.aimsg h1{border-bottom:1px solid #b4b4b4}
.aimsg h2{border-bottom:1px solid #b4b4b4}
.usermsg h3,.aimsg h3{font-size:1.125em}
.usermsg h4,.aimsg h4{font-size:1em}
.usermsg h5,.aimsg h5{font-size:.875em}
.usermsg h6{font-size:.85em;color:#373737}
.aimsg h6{font-size:.85em;color:#57606a}
.usermsg hr{height:1px;border:none;background-color:#7dc35a;margin:0.6em 0 0.7em 0}
.aimsg hr{height:1px;border:none;background-color:#b4b4b4;margin:0.6em 0 0.7em 0}
.usermsg table,.aimsg table{margin:5px 0;border-spacing:0;border-collapse:collapse;display:table;max-width:100%;overflow:auto;color:rgb(40,40,40);word-break:break-all}
.usermsg td,.usermsg th,.aimsg td,.aimsg th{padding:0}
.usermsg table th,.aimsg table th{font-weight:600}
.usermsg table th,.usermsg table td,.aimsg table th,.aimsg table td{padding:5px 8px;border:1px solid #e4e6d0}
.usermsg table tr,.aimsg table tr{background-color:#f6f9f1;border-top:1px solid}
.usermsg table tr:nth-child(2n),.aimsg table tr:nth-child(2n){background-color:#edf1e5}
.usermsg table img,.aimsg table img{background-color:transparent}
/* ‰ª•‰∏ã ‰∏ÄÈîÆÂ§çÂà∂Áõ∏ÂÖ≥ pre=snippet, button=copybtn ,svg/img(svg)=clippy */
.clippy{margin:4px;position:relative}
.copybtn[disabled] .clippy{opacity:.3}
.snippet,.msgcopydiv{position:relative;overflow:visible}
.snippet .copybtn,.msgcopydiv .copybtn,.msgcopydiv .copybtn,.panelrow .copybtn,.notification-content .copybtn{-webkit-transition:opacity .3s ease-in-out;-o-transition:opacity .3s ease-in-out;transition:opacity .3s ease-in-out;opacity:0;padding:0;position:absolute;right:4px;top:4px;display:inline-block;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-appearance:none}
.snippet:hover > .copybtn,.snippet > .copybtn:focus,.msgcopydiv:hover > .copybtn,.msgcopydiv > .copybtn:focus{opacity:1}
@media screen and (max-width:768px){
.snippet > .copybtn{opacity:0.4}
.msgcopydiv > .copybtn{}
}
.userinfo > .msgcopydiv{margin-left:30px}
.aiinfo > .msgcopydiv{margin-right:30px}
.userinfo > .msgcopydiv > .copybtn{top:auto;bottom:4px;left:-30px;right:auto}
.aiinfo > .msgcopydiv > .copybtn{top:auto;bottom:4px;left:auto;right:-30px}
/* ‰ª•‰∏ãcopybtn (btn) by https://primer.style/css/components/tooltips https://clipboardjs.com/bower_components/primer-css/css/primer.css */
.copybtn:focus{text-decoration:none;border-color:#51a7e8;outline:none;box-shadow:0 0 5px rgba(81,167,232,.5)}
.copybtn:focus:hover,.copybtn.selected:focus{border-color:#51a7e8}
.copybtn:hover,.copybtn:active{text-decoration:none;background-color:#ddd;background-image:linear-gradient(#eee,#ddd);border-color:#ccc}
.copybtn:active,.copybtn.selected{background-color:#dcdcdc;background-image:none;border-color:#b5b5b5;box-shadow:inset 0 2px 4px rgba(0,0,0,.15)}
.copybtn.selected:hover{background-color:#cfcfcf}
.copybtn:disabled,.copybtn:disabled:hover,.copybtn.disabled,.copybtn.disabled:hover{color:rgba(102,102,102,.5);cursor:default;background-color:rgba(229,229,229,.5);background-image:none;border-color:rgba(197,197,197,.5);box-shadow:none}
/* ‰ª•‰∏ä copybtn (btn)  */
.snippet .tooltipped-w:after{background:#6e7681}
.snippet .tooltipped-w:before{border-left-color:#6e7681}
/* ‰ª•‰∏ã Tooltips by https://primer.style/css/components/tooltips https://clipboardjs.com/bower_components/primer-css/css/primer.css */
.tooltipped{position:relative}
.tooltipped:after{position:absolute;z-index:1000000;display:none;padding:5px 8px;font:normal normal 11px/1.5 Helvetica,arial,nimbussansl,liberationsans,freesans,clean,sans-serif,"Segoe UI Emoji","Segoe UI Symbol";color:#fff;text-align:center;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-wrap:break-word;white-space:pre;pointer-events:none;content:attr(aria-label);background:rgba(0,0,0,.8);border-radius:3px;-webkit-font-smoothing:subpixel-antialiased}
.tooltipped:before{position:absolute;z-index:1000001;display:none;width:0;height:0;color:rgba(0,0,0,.8);pointer-events:none;content:"";border:5px solid transparent}
.tooltipped:hover:before,.tooltipped:hover:after,.tooltipped:active:before,.tooltipped:active:after,.tooltipped:focus:before,.tooltipped:focus:after{display:inline-block;text-decoration:none}
.tooltipped-n:after,.tooltipped-ne:after,.tooltipped-nw:after{right:50%;bottom:100%;margin-bottom:5px}
.tooltipped-n:before,.tooltipped-ne:before,.tooltipped-nw:before{top:-5px;right:50%;bottom:auto;margin-right:-5px;border-top-color:rgba(0,0,0,.8)}
.tooltipped-ne:after{right:auto;left:50%;margin-left:-15px}
.tooltipped-nw:after{margin-right:-15px}
.tooltipped-n:after{-webkit-transform:translateX(50%);-ms-transform:translateX(50%);transform:translateX(50%)}
.tooltipped-w:after{right:100%;bottom:50%;margin-right:5px;-webkit-transform:translateY(50%);-ms-transform:translateY(50%);transform:translateY(50%)}
.tooltipped-w:before{top:50%;bottom:50%;left:-5px;margin-top:-5px;border-left-color:rgba(0,0,0,.8)}
.tooltipped-e:after{bottom:50%;left:100%;margin-left:5px;-webkit-transform:translateY(50%);-ms-transform:translateY(50%);transform:translateY(50%)}
.tooltipped-e:before{top:50%;right:-5px;bottom:50%;margin-top:-5px;border-right-color:rgba(0,0,0,.8)}
/* ‰ª•‰∏ä Tooltips */
/* ‰ª•‰∏ä ‰∏ÄÈîÆÂ§çÂà∂Áõ∏ÂÖ≥ */
#app{display:flex;flex-flow:column;margin:1;white-space:pre-wrap}
/* ‰ª•‰∏ã ÂºπÁ™ó */
.dialog-wrapper{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:900100}
.dialog-wrapper-hide{display:none}
/* .dialog{width:95%;max-width:800px;height:auto;max-height:82%;overflow:scroll;border-radius:10px;z-index:900101;position:fixed;top:calc(50% - 14.5px);left:calc(50% - 0.5px);transform: translate(calc(-50% + 0.5px), calc(-50% + 0.5px));background-color:#ededed;box-shadow:0px 0px 10px rgba(0,0,0,0.3)} */
.dialog{width:95%;max-width:800px;height:78%;max-height:1000px;overflow:hidden;border-radius:10px;z-index:900101;position:fixed;background-color:#ededed;box-shadow:0px 0px 10px rgba(0,0,0,0.3)}
.dialog-header{position:relative;height:40px;line-height:40px;padding:0 20px;background-color:#f5f5f5;border-top-left-radius:10px;border-top-right-radius:10px}
.dialog-bottom{position:relative;height:15px;line-height:15px;border-bottom-left-radius:10px;border-bottom-right-radius:10px}
.dialog-close{line-height:20px;color:#333333;position:absolute;top:10px;right:10px;width:20px;height:20px;cursor:pointer}
.dialog-title{font-size:14px;line-height:20px;color:#333333;position:absolute;top:10px;align-items:center;justify-content:center;display:flex;-webkit-text-size-adjust:100%;}
.dialog-scroll{position: relative; width: 100%; height: calc(100% - 54.5px); overflow: auto;scrollbar-width:thin;}
.dialog-content{padding:20px;display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center}
.dialog-content .btn,.dialog-content .dh-input{margin:0 2px}
.dialog-content .panelrow{height:26px;margin-bottom:4px}
.dialog-content .panelrow >:last-child{margin-right:2px}
/*.panelgroup- box-shadow> 1px 2px 9px 2.5px rgba(201, 201, 201, 0.6);  .panelgroup-shadow> box-shadow: 1px 1.5px 7.5px 2.5px rgba(201, 201, 201, 0.66); */
.dialog-content .panelgroup{width:100%;box-shadow: 0 3px 8px 0 rgba(20,20,20,0.16),0 0 1px 1px rgba(20,20,20,0.07) ;padding:5px 6px 4px 8px;border-radius:5px;margin-bottom:12px}
.dialog-content .panelgroup-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;padding-bottom:1px;border-bottom:1px solid rgb(220,220,220,0.5)}
.dialog-content .panelgroup-head > span{color:#666666;font-size:12px}
.dialog-content .panelgroup-shadow{box-shadow: 0 3px 8px 2px rgba(20,20,20,0.14),0 0 1px 1px rgba(20,20,20,0.065);}
.dialog-content span{font-size:12px;color:#333333;margin-left:4px;line-height:18px;-webkit-text-size-adjust:100%;}
.dialog-mask{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);z-index:-1}
.panelgroup-chatdata-selected{box-shadow: 0 0 0.5px 1px rgba(26, 168, 50, 0.8 ) !important;background: linear-gradient(rgba(26, 168, 50, 0.015), rgba(26, 168, 50, 0.15));}
.panelgroup-chatdata-selected-transparent{box-shadow: 0 0 0.5px 2px rgba(26, 168, 50, 1 ) !important;background: linear-gradient(rgba(26, 168, 50, 0.005), rgba(26, 168, 50, 0.05));}
.control-container{width:auto;margin-right:6px}
.control-bg{padding:2px 5px;width:auto;height:auto;background:#fcfcfc;border-radius:5px;display:flex}
.slider{-webkit-appearance:none !important;-moz-appearance:none;appearance:none;width:100%;height:2px;margin:9px 4px;padding:0px 2px;background: linear-gradient(to bottom, #17d51e, #179e16);border:none;border-radius:2px;outline:none;-webkit-transition:.2s;transition:opacity .2s}
.slider::-webkit-slider-thumb{-webkit-appearance:none !important;appearance:none;width:12px;height:17px;border:none;background: linear-gradient(to bottom, #17d51e, #179e16);border-radius:4px;cursor:pointer}
.slider::-moz-range-thumb{-webkit-appearance:none !important;-moz-appearance:none !important;appearance:none;width:12px;height:17px;border:none;background: linear-gradient(to bottom, #17d51e, #179e16);border-radius:4px;cursor:pointer}
.slider::-ms-thumb{-webkit-appearance:none !important;appearance:none;width:12px;height:17px;border:none;background: linear-gradient(to bottom, #17d51e, #179e16);border-radius:4px;cursor:pointer}
.slider::-webkit-slider-thumb:hover,.slider::-webkit-slider-thumb:focus{background: linear-gradient(to bottom, #1ac83c, #179b16);outline:none}
.slider::-moz-range-thumb:hover,.slider::-moz-range-thumb:focus{background: linear-gradient(to bottom, #1ac83c, #179b16);outline:none}
.slider::-ms-thumb:hover,.slider::-ms-thumb:focus{background: linear-gradient(to bottom, #1ac83c, #179b16);outline:none}
.slider::-webkit-slider-thumb:active{background: linear-gradient(to bottom, #1ac83c, #179b16);}
.slider::-moz-range-thumb:active{background: linear-gradient(to bottom, #1ac83c, #179b16);}
.slider::-ms-thumb:active{background: linear-gradient(to bottom, #1ac83c, #179b16);}
@media only screen and (max-width:768px){.slider::-webkit-slider-thumb{width:25px;height:18px}
.slider::-moz-range-thumb{width:25px;height:18px}
.slider::-ms-thumb{width:25px;height:18px}
}
.slider:disabled::-webkit-slider-thumb{background: linear-gradient(to bottom, #d7ebd7, #c3d6c2);cursor:not-allowed}
.slider:disabled::-moz-range-thumb{background: linear-gradient(to bottom, #d7ebd7, #c3d6c2);cursor:not-allowed}
.slider:disabled::-ms-thumb{background: linear-gradient(to bottom, #d7ebd7, #c3d6c2);cursor:not-allowed}
.slider:disabled{background: linear-gradient(to bottom, #d7ebd7, #c3d6c2);cursor:not-allowed}
#dialog-settings .dh-input,#dialog-promptgenerator .dh-input{font-size:12px;color:#333333;background-color:#fcfcfc}
#dialog-promptgenerator .dh-input{font-size:13px}
#loading-mask button{margin:30px;display:inline-block;padding:8px 16px;font-size:14px;text-align:center;color:#333;background-color:#fdffb4;border:3px solid #555;border-radius:10px;cursor:pointer}
/* ‰ª•‰∏ä ÂºπÁ™ó */
/* ‰ª•‰∏ã Ê∂àÊÅØÈÄöÁü• tooltips */
.notification{position:relative;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:900900}
.notification-wrapper{max-width:600px;overflow:hidden;position:fixed;transform:translate(-50%, -50%);background-color:#fdffb4;box-shadow:0 0 8px rgba(191,169,16,0.3);border:1px solid rgba(166,152,27,0.45);z-index:900902}
.notification-content{color:#664909;font-size:13px;line-height:1.6;-webkit-text-size-adjust:100%;}
.notification-content-center{display:block;text-align:start;padding-left:6px;margin:5px 10px 0px 10px;word-break:break-word}
.notification-content-bottom{display:flex;text-align:center;padding-left:0;margin:5px 11px 5px 11px;word-break:break-word}
.notification-center{width:82%;min-width:160px;bottom:auto;left:50%;top:50%;right:auto;border-radius:10px}
.notification-bottom{width:auto;min-width:45px;bottom:calc(0% + 4.5px);left:50%;top:auto;right:auto;border-radius:6px;animation:slideIn 0.4s ease-out forwards}
.notification-mask{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.65);z-index:900901}
@keyframes slideIn{from{transform:translate(-50%,-3px);opacity:0}
to{transform:translate(-50%,-18px);opacity:1}
}
/* ‰ª•‰∏ä Ê∂àÊÅØÈÄöÁü• tooltips */
</style>
<!-- ‰ª•‰∏ä‰∏∫cssÊ†∑Âºè  -->
</head>


<body>
<!-- #app -->  
<div id="app">

	<!-- Âä†ËΩΩÁΩëÈ°µÊó∂ÁöÑÈÅÆÁΩ© Page Loading - Mask -->  
	<div id="loading-mask" class="dialog-wrapper" style="z-index: 999999;">
		<div>Âä†ËΩΩ‰∏≠<br>Loading</div>
	</div>
	
	<!-- ‰∏ªÁïåÈù¢-ËÅäÂ§©ÂØπËØù Main interface - Chat  -->  
	<div style="width:100%;">
		<div>
			<div v-for="(x,i) in msgList" :key="i">
				<!-- Me / User WechatStyleDatetime -->
				<span v-if="x.my" class="wechatstyle-datetime" :style="{ display: (settingsTime_WechatStyle && x.wechatstyledatetime != null) ? 'block' : 'none', marginBottom: settingsTime_Message == 3 ? '27px' : '17px', fontSize: settingsFontSize * 0.9 + 'px' }">{{x.wechatstyledatetime}}</span>
				
				<!-- Me / User Message Datetime -->
				<div v-if="x.my" :data-hr="x.hr" class="msgdatetimediv" :style="{ display: settingsTime_Message == 1 ? 'none' : 'block' }" ><span class="usermsg-datetime">{{x.datetime}}</span></div>
				
				<!-- AI Message Datetime -->
				<div v-if="!x.my" :data-hr="x.hr" class="msgdatetimediv" :style="{ display: settingsTime_Message == 1 ? 'none' : 'block' }" ><span class="aimsg-datetime">{{x.datetime}}</span></div>
				
				<!-- Me / User Message -->
				<div v-if="x.my" class="userinfo" :style="{ marginTop : settingsTime_Message == 3 ? '27px' : '17px' }" >
					<div class="chat-img btnzoom-a" @click="isShowDialog_ChatList = true" :title="settingsLanguage == 'cn' ? 'ÊâìÂºÄÂØπËØùÂàóË°®' : 'Open Chat List'">
						<img :src="userAvatarURL">
					</div>	
					<div class="justify-end msgcopydiv msgdiv">
						<div v-html="x.msg" class="usermsg" :style="{ fontSize: settingsFontSize + 'px' }">
						</div>
					</div>
				</div>
				
				<!-- AI Message -->
				<div v-if="!x.my" class="aiinfo" :style="{ marginTop : settingsTime_Message == 3 ? '27px' : '17px' }" >
					<div class="chat-img btnzoom-a" :style="{ display: isgptGreenSvgShow ? 'none' : 'flex' }" @click="isShowDialog_ChatList = true" :title="settingsLanguage == 'cn' ? 'ÊâìÂºÄÂØπËØùÂàóË°®' : 'Open Chat List'">
						<img :src="gptAvatarURL">
					</div>
					<div class="chat-img chat-green-svg btnzoom-a" :style="{ display: isgptGreenSvgShow ? 'flex' : 'none'}" @click="isShowDialog_ChatList = true" :title="settingsLanguage == 'cn' ? 'ÊâìÂºÄÂØπËØùÂàóË°®' : 'Open Chat List'">
						<svg width="27" height="27" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg" stroke-width="1.5"  role="img">
							<path d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z" fill="currentColor">
							</path>
						</svg>
					</div>
					<div class="msgcopydiv msgdiv">
						<div  v-html="x.msg" class="aimsg" :style="{ fontSize: settingsFontSize + 'px' }">
						</div>
					</div>
				</div>
			</div>
			
			<!-- Á©∫ÁôΩÂùó Â∏ÉÂ±Ä/ÂÆö‰ΩçÁî® For position -->
			<div class="bottom-position"></div>
		</div>
	</div>
	<!-- End: ‰∏ªÁïåÈù¢-ËÅäÂ§©ÂØπËØù Main interface - Chat -->


	<!-- ‰∏ªÁïåÈù¢-Â∫ïÈÉ®  Main interface - Bottom  -->
	<div  class="flex-column-center">
		<!-- First row -->
		<div class="panelrow" style="margin-top: 6px;height: 40px;">
			<button @click="isShowDialog_PromptGenerator = true" class="btn" :class="{ 'orangeredbtn': !(gptSystemPromptReadOnly.trim() == '') }" :disabled="(gptSystemPrompt_hidden.trim() != '')" :title="gptSystemPrompt_hidden.trim() == '' ? (settingsLanguage == 'cn' ? 'ÊâìÂºÄÊèêÁ§∫ËØçÁ™óÂè£' : 'Open Prompt Generator') : (settingsLanguage == 'cn' ? 'ÂäüËÉΩÂ∑≤Ë¢´Á¶ÅÁî®' : 'The feature has been disabled') " style="margin-left:12px;margin-right:-1px;border-radius: 6px 0px 0px 6px;line-height: 38px; width: 27px;height: 38px;padding: 0 8px;z-index: 900001;">
				<div>
					<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
						<path clip-rule="evenodd" d="M14.526 6.10576C15.0265 6.33917 15.2667 6.88343 15.0625 7.3214L9.88541 18.4237C9.68118 18.8616 9.10985 19.0275 8.60931 18.7941C8.10877 18.5607 7.86857 18.0164 8.0728 17.5784L13.2499 6.47616C13.4541 6.03819 14.0254 5.87235 14.526 6.10576Z" fill="currentColor" fill-rule="evenodd" /></svg>
					</svg>
				</div>
			</button>
			<textarea @click="scrollToBottomViewClick"  @blur="textareaChatInputBox_blur" @focus="textareaChatInputBox_focus"  @keydown="textareaMobileInputCompatibility" @keydown.enter.exact="textareaEnter"  @keydown.ctrl.enter.exact="newLine" @keydown.meta.enter.exact="newLine"  v-model="msg"  type="text"  class="dh-input textareachatinputbox" style="margin-left:0px;height: 38px;min-height: 38px;max-height: 38px;border-radius: 0px 6px 6px 0px; z-index:900000" placeholder="" enterkeyhint="send" ></textarea>
			<button @click="sendMsg();" :disabled="btnDisabledState_Sending" class="btn" :title="settingsLanguage == 'cn' ? 'ÂèëÈÄÅ' : 'Send'" style="line-height: 38px; height: 38px;font-size: 14px;padding: 0 15px;" >{{sentext}}</button> 
		</div>
	
		<!-- Second row - Left -->
		<div class="panelrow" style="margin-bottom: 7px;">
			<!-- new - orangered : -3 ~ -2  -->
			<!-- new - red : -1 ~ 0 ~ ËææÂà∞...   -1 ~ 0 ~ have reached...  -->
		  	<button  @click="clearContext" :disabled="btnDisabledState_Clear"  class="btn" style="margin-left:12px;margin-right: 4px;" 
			:class="{'orangeredbtn': !Number.isInteger(settingsContextualMode) ? false : (  !btnDisabledState_Clear && ( (settingsContextualMode > 100 && succQA_Count >= settingsContextualMode - 103 && succQA_Count < settingsContextualMode - 101) || (settingsContextualMode > 0 && settingsContextualMode < 100 && succQA_Count >= settingsContextualMode - 3 && succQA_Count < settingsContextualMode - 1) )  ) ? true : false ,
					'redbtn': !Number.isInteger(settingsContextualMode) ? false : (  !btnDisabledState_Clear && ( (settingsContextualMode > 100 && succQA_Count >= settingsContextualMode - 101) || (settingsContextualMode > 0 && settingsContextualMode < 100 && succQA_Count >= settingsContextualMode - 1) )  ) ? true : false   }" 
			:title="settingsLanguage == 'cn' ? 'Ê∏ÖÈô§ËÆ∞ÂøÜ' : 'Clear Context'">
				<div>
					<svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round">
						<polyline points="3 6 5 6 21 6"></polyline>
						<path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
						<line x1="10" y1="11" x2="10" y2="17"></line>
						<line x1="14" y1="11" x2="14" y2="17"></line>
					</svg>	
				</div>
				<span v-if="settingsLanguage == 'cn' " :style="{ display: isShowQACountLabel ? 'flex' : 'none' }" >&nbsp;ËÆ∞ÂøÜ</span>
				<span v-else :style="{ display: isShowQACountLabel ? 'flex' : 'none' }" >&nbsp;Context</span>
				<span>:&nbsp;{{succQA_Count}}</span>
			</button>
			<!-- orangered : >= 2000 && < model.maxtokens * 0.9  -->
			<!-- red : >= model.maxtokens * 0.9  -->
			<button  disabled class="btn" style="margin-left: 0px;margin-right: 4px;cursor: auto;" 
				:style="{ color: totaltokens < 2000 ? '#1aad19 !important' : (  totaltokens < ( gptModelList.find(model => model.modelname === apiGPTModel) ? gptModelList.find(model => model.modelname === apiGPTModel).maxtokens : 4096 ) * 0.9 ? '#f94000 !important' : '#fa1e0a !important'  ),
				fontWeight: totaltokens < ( gptModelList.find(model => model.modelname === apiGPTModel) ? gptModelList.find(model => model.modelname === apiGPTModel).maxtokens : 4096 ) * 0.9 ? 'normal' : 'bold'  }"
				:title="settingsLanguage == 'cn' ? 'TokenÁî®Èáè' : 'Tokens Usage'">
				<div :style="{ display: isShowTotaltokensSVG ? 'flex' : 'none' }" >
					<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="25" height="18"  viewBox="0 0 25 19"  fill="currentColor" stroke-width="0.02"  stroke="currentColor"  stroke-linecap="round" stroke-linejoin="round">
							<path d="m10.62109,1.66441c-1.05095,-0.60518 -2.43437,-0.9385 -3.89526,-0.9385c-1.46093,0 -2.84426,0.33332 -3.89526,0.9385c-1.12359,0.64701 -1.74652,1.53053 -1.75767,2.49024l-0.00051,0l0,10.75701c0,1.91873 2.48327,3.42172 5.65344,3.42172c3.17018,0 5.65349,-1.50299 5.65349,-3.42172l0,-10.74381l-0.00023,0c-0.00557,-0.96482 -0.62926,-1.85344 -1.758,-2.50345zm0.77473,6.82194c0,1.32648 -2.13857,2.44712 -4.66998,2.44712c-2.53136,0 -4.66994,-1.12064 -4.66994,-2.44712l0,-0.18096c1.01002,0.8957 2.70835,1.47278 4.66994,1.47278c1.96163,0 3.65992,-0.57714 4.66998,-1.47278l0,0.18096zm0,2.13876c0,1.32652 -2.13857,2.44716 -4.66998,2.44716c-2.53136,0 -4.66994,-1.12068 -4.66994,-2.44716l0,-0.18092c1.01002,0.89565 2.70835,1.47278 4.66994,1.47278c1.96163,0 3.65992,-0.57713 4.66998,-1.47278l0,0.18092zm-9.33992,1.95788c1.01002,0.8957 2.70835,1.47278 4.66993,1.47278c1.96164,0 3.65992,-0.57713 4.66998,-1.47283l0,0.18102c0,1.32647 -2.13857,2.44711 -4.66998,2.44711c-2.53136,0 -4.66993,-1.12064 -4.66993,-2.44711l0,-0.18097zm9.33992,-6.23549c0,1.32647 -2.13857,2.44711 -4.66998,2.44711c-2.53137,0.00005 -4.66994,-1.12063 -4.66994,-2.44711l0,-0.22269c1.01002,0.88937 2.70835,1.46238 4.66993,1.46238c1.96164,0 3.65992,-0.57306 4.66998,-1.46238l0,0.22269l0,0zm-8.07442,-3.83077c0.90403,-0.52061 2.11309,-0.80727 3.40444,-0.80727c1.29139,0 2.50046,0.28671 3.40449,0.80727c0.80423,0.46309 1.2655,1.06963 1.2655,1.66405c0,1.31336 -2.13857,2.4229 -4.66998,2.4229c-2.53136,0 -4.66994,-1.10954 -4.66994,-2.4229c0,-0.59441 0.46127,-1.20095 1.26549,-1.66405zm3.40444,14.83319c-2.53136,0 -4.66993,-1.11656 -4.66993,-2.43826l0,-0.18982c1.01002,0.89566 2.70835,1.47279 4.66993,1.47279c1.96164,0 3.65992,-0.57713 4.66998,-1.47279l0,0.18987c0,1.32166 -2.13862,2.43822 -4.66998,2.43822z"/>
							<path d="m24.01826,10.37334c-0.00347,-0.9667 -0.62739,-1.85725 -1.75804,-2.50833c-1.05095,-0.60519 -2.43437,-0.9385 -3.89531,-0.9385c-1.46088,0 -2.84426,0.33332 -3.89526,0.9385c-1.1338,0.65286 -1.75818,1.54655 -1.75818,2.51633c0,0.00023 0,0.00047 0,0.00075l0,0l0,4.32772c0,1.91086 2.48326,3.40772 5.65344,3.40772c3.17018,0 5.65349,-1.49686 5.65349,-3.40772l0,-4.33653l-0.00014,0l0,0.00005zm-0.98337,2.17477c0,1.32648 -2.13857,2.44717 -4.66999,2.44717c-2.53137,0 -4.66993,-1.12065 -4.66993,-2.44717l0,-0.22269c1.01002,0.88937 2.7083,1.46238 4.66993,1.46238s3.65992,-0.57301 4.66999,-1.46238l0,0.22269zm-8.07442,-3.83077c0.90403,-0.52061 2.11309,-0.80727 3.40444,-0.80727c1.29135,0 2.50046,0.28672 3.40449,0.80727c0.80423,0.46309 1.2655,1.06964 1.2655,1.66405c0,1.31336 -2.13857,2.4229 -4.66999,2.4229c-2.53137,0 -4.66993,-1.10954 -4.66993,-2.4229c0.00005,-0.59441 0.46127,-1.20096 1.2655,-1.66405zm3.40444,8.41673c-2.53137,0 -4.66993,-1.11014 -4.66993,-2.42421l0,-0.20386c1.01002,0.89565 2.7083,1.47277 4.66993,1.47277s3.65992,-0.57708 4.66998,-1.47277l0,0.20386c0,1.31407 -2.13857,2.42421 -4.66998,2.42421z" />
					</svg>
				</div>
				<span v-if="settingsLanguage == 'cn' " :style="{ display: isShowTotaltokensLabel ? 'flex' : 'none' }" >&nbsp;TokenÁî®Èáè</span>
				<span v-else :style="{ display: isShowTotaltokensLabel ? 'flex' : 'none' }" >&nbsp;Tokens</span>
				<span>:&nbsp;{{totaltokens}}</span>
			</button>
			<!-- green : gpt-3.5  -->
			<!-- blue : gpt-3.5 >=16k -->
			<!-- orangered : gpt-4   -->
			<!-- red : gpt-4  && ( 32k | SmartMaxTokens | AutoRetry | max_tokens >= 4000 | Used tokens >= 4000  )   -->
			<button @click="showStatus" class="btn" style="width:30px;padding: 0 5px;" 
				:class="{'bluebtn': (apiGPTModel.includes('gpt-3.5') && (apiGPTModel.includes('16k') || totaltokens > 9999 )),
					'orangeredbtn': (!apiGPTModel.includes('gpt-3.5') && !(apiGPTModel.includes('32k') || openSmartMaxTokens || apiMaxTokens > 3999 || totaltokens > 3999)),
					'redbtn': (!apiGPTModel.includes('gpt-3.5') && (apiGPTModel.includes('32k') || openSmartMaxTokens || apiMaxTokens > 3999 || totaltokens > 3999)) }" 
			:title="settingsLanguage == 'cn' ? 'Áä∂ÊÄÅ' : 'Status'">
				<div>
					<svg fill="currentColor" stroke="none" width="18" height="18" viewBox="0 -0.028 0.4 0.4" xmlns="http://www.w3.org/2000/svg"><path d="M.246.171.334.083A.012.012 0 0 0 .317.066L.229.154a.013.013 0 0 0-.004.004A.05.05 0 0 0 .2.15.05.05 0 1 0 .25.2.05.05 0 0 0 .243.175.013.013 0 0 0 .247.171ZM.2.225A.025.025 0 1 1 .225.2.025.025 0 0 1 .2.225ZM.4.192a.2.2 0 0 1-.057.15.013.013 0 0 1-.018 0L.292.309A.012.012 0 0 1 .309.292l.024.023A.175.175 0 0 0 .375.2H.337a.013.013 0 0 1 0-.025h.035a.181.181 0 0 0-.014-.05.013.013 0 1 1 .023-.011.196.196 0 0 1 .017.067.011.011 0 0 1 0 .01Zm-.29.1a.012.012 0 0 1 0 .017L.077.342a.013.013 0 0 1-.018 0A.2.2 0 0 1 0 .2V.19a.011.011 0 0 1 0-.003.01.01 0 0 1 0-.004A.199.199 0 0 1 .198 0H.2a.01.01 0 0 1 .004 0 .196.196 0 0 1 .081.018.012.012 0 0 1 .006.017.012.012 0 0 1-.017.006.178.178 0 0 0-.061-.014v.036a.013.013 0 0 1-.025 0V.025a.175.175 0 0 0-.111.05.173.173 0 0 0-.05.1h.036a.013.013 0 0 1 0 .025H.025a.173.173 0 0 0 .043.115L.092.292a.012.012 0 0 1 .017 0Z"/>
					</svg>
				</div>
			</button>
			
			<!-- Second row - Right -->
		 	<button @click="undo" :disabled="btnDisabledState_Undo" class="btn" style="margin-left:auto;margin-right:4px;width:45px;" :title="settingsLanguage == 'cn' ? 'Êí§ÈîÄ' : 'Undo'" >
				<div>
					<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="23px" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round" >
						<path d="M5 9.5C8.5 9.5 11.5 9.5 15 9.5C15.1615 9.5 19 9.5 19 13.5C19 18 15.2976 18 15 18C12 18 10 18 7 18"/>
						<path d="M8.5 13C7.13317 11.6332 6.36683 10.8668 5 9.5C6.36683 8.13317 7.13317 7.36683 8.5 6" />
					</svg>
				</div>
			</button>
			<button @click="retry" :disabled="btnDisabledState_Undo"  class="btn"  style="margin-right:4px;width:45px;" :title="settingsLanguage == 'cn' ? 'ÈáçÈóÆ' : 'Retry'">
				<div>
					<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round">
						<path d="M17 2.1l4 4-4 4"/>
						<path d="M3 12.2v-2a4 4 0 0 1 4-4h12.8M7 21.9l-4-4 4-4"/>
						<path d="M21 11.8v2a4 4 0 0 1-4 4H4.2"/>
					</svg>
				</div>
			</button>
			<button @click="openDialogTodo_Settings" class="btn" :class="{ 'redbtn': !btnDisabledState_CheckAPI }" style="margin-right:4px;width:45px;" :title="settingsLanguage == 'cn' ? 'ËÆæÁΩÆ' : 'Settings'">
				<div>
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<circle cx="12" cy="12" r="3"></circle>
						<path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
					</svg>
				</div>
			</button>
			<button @click="openDialog_Help" class="btn bluebtn" style="width:45px;" :title="settingsLanguage == 'cn' ? 'Â∏ÆÂä©' : 'Help'">
				<div>
					<svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<circle cx="12" cy="12" r="10"></circle>
						<path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
						<line x1="12" y1="17" x2="12.01" y2="17"></line>
					</svg>
				</div>
			</button>
		</div>
	</div>
	<!-- End: ‰∏ªÁïåÈù¢-Â∫ïÈÉ®  Main interface - Bottom  -->



	<!-- dialog-wrapper A: ËÆæÁΩÆ Settings -->  
	<div id="dialog-settings" class="dialog-wrapper" v-show="isShowDialog_Settings">
		<!-- A: dialog -->  
		<div class="dialog" style="max-height: 800px;">
	
			<!-- A: Ê†áÈ¢ò header -->  
			<div class="dialog-header">
				<div class="dialog-title" style="justify-content: space-between;width: calc(95% - 27px);" >
					<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle>
					<path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
					</svg>
					{{ settingsLanguage == 'cn' ? '&nbsp;ËÆæÁΩÆ' : '&nbsp;Settings' }}
					<select @change="changeSimpleMode(true)" class="dropdown minibtn minibtn-default bluedropdown btnzoom-b" v-model="isSimpleMode" :style="{ marginLeft: settingsLanguage == 'cn' ? '5px' : '5px',marginTop: settingsLanguage == 'cn' ? '0.5px' : '1.5px', width: settingsLanguage == 'cn' ? ( isSimpleMode ? '64px' : '77px' ) : ( isSimpleMode ? '91px' : '111px' )}" :title="settingsLanguage == 'cn' ? 'ÂΩìÂâçMCGPTÊ®°Âºè' : 'Current MCGPT Mode'">
						<option v-if="settingsLanguage == 'cn'" v-for="option in simpleModeOptions_cn" :value="option.state">{{ option.label }}</option>
						<option v-else v-for="option in simpleModeOptions_en" :value="option.state">{{ option.label }}</option>
					</select>
					<span style="margin-left:auto" :title="settingsLanguage == 'cn' ? 'ÂΩìÂâçÁâàÊú¨' : 'Current Version'">v8.28&nbsp;&nbsp;</span>
					<button  class="btn btnzoom-a" style="margin: 0px; padding: 0 3px;background: linear-gradient(to bottom, #fff, #fff);background-color: #fff;height: 20px;width: 20px; box-shadow: 0 0 0px 0.5px rgba(80, 80, 80, 0.08);" :title="settingsLanguage == 'cn' ? 'Êü•ÁúãÁ≥ªÁªüÁä∂ÊÄÅ' : 'View the uptime'">
						<a href="https://s.xinu.ink" target="_blank">
							<svg xmlns="http://www.w3.org/2000/svg" width="14" viewBox="0 0 16 16"  fill="#1f2328"> 
								<path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path>
							</svg>
						</a>
					</button>
					<button onclick="copyText('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTg0MTY2NTAsInVzZXIiOnsiaWQiOiIyNDMwNjkyMjcwMTkyMDI1NjIiLCJuYW1lIjoi5bCP6J665bi9MjU2MiIsImF2YXRhciI6Imh0dHBzOi8vY2RuLnlpbmdzaGktYWkuY29tL3Byb2QvdXNlcl9hdmF0YXIvMTcwNjI2NzcxMTI4Mjc3MDg3Mi0xNzMxOTQ1NzA2Njg5NjU4OTZvdmVyc2l6ZS5wbmciLCJkZXZpY2VJRCI6IjI0MzA2OTIyNDI5NzEwMzM2NSIsImlzQW5vbnltb3VzIjpmYWxzZX19.iYnKMi4zQ38F9TxPJvVkjCCgWaRnYNNQlpUhKnMfOQk')">Â§çÂà∂key</button>

					<script>
					function copyText(text) {
					const el = document.createElement('textarea');
					el.value = text;
					document.body.appendChild(el);
					el.select();
					document.execCommand('copy');
					document.body.removeChild(el);
    alert('ÊñáÊú¨Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
}
</script>
					
				</div>
			
				<div class="dialog-close" @click="isShowDialog_Settings = false" :title="settingsLanguage == 'cn' ? 'ÂÖ≥Èó≠' : 'Close'">
					<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="fill: none; stroke: #333; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;">
						<path d="M6 18L18 6M6 6l12 12"></path>
					</svg>
				</div>
			</div>
		
			<!-- A: ÊªöÂä®Ê°ÜÊû∂ scroll -->
			<div class="dialog-scroll">
			<!-- A: ‰∏ª‰ΩìÂÜÖÂÆπ content -->  
			<div class="dialog-content">
 
				<!-- panelgroup: Êé•Âè£ÂØÜÈí• API Key --> 
				<div class="panelgroup panelgroup-shadow">
					<div class="panelgroup-head">
						<span>{{ settingsLanguage == 'cn' ? 'API Key (OpenAI / Á¨¨‰∏âÊñπ) ' : 'API Key (OpenAI / Third-party) ' }}</span>
						<button  @click="showMiniHelp('A-CheckAPIKey')"  class="btn minibtn bluebtn btnzoom-b" :style="{ marginRight: btnDisabledState_CheckAPI ? 'auto' : '2px' }" :title="settingsLanguage == 'cn' ? 'ÂäüËÉΩËØ¥Êòé' : 'Help'" >?</button>
						<span :style="{ display: btnDisabledState_CheckAPI ? 'none' : 'block' }"  style="margin-right: auto;color: #fa1e0a;font-size: 11px;">{{ settingsLanguage == 'cn' ? '*ÂøÖÂ°´' : '*Required' }}</span>
						<!-- ËΩÆËØ¢ / Ëá™Âä®ËΩÆÊç¢API Key / Auto Key Rotation --> 
						<button @click="clickOpenAutoKeyRotation" class="btn minibtn minibtn-default btnzoom-b" :class="{ 'orangereddropdown': btnDisabledState_CheckAPI && ( (!isThirdPartyAPIKeyEnabled && apiCheckedData.filter(data => data.vpn !== 'third-party').length > 0) || (isThirdPartyAPIKeyEnabled && apiCheckedData.filter(data => data.vpn === 'third-party').length > 0) ) }" :style="{ marginRight: settingsLanguage == 'cn' ? '-11px' : '-11px'}" style="display: flex;" :title="settingsLanguage == 'cn' ? 'ÁÆ°ÁêÜËá™Âä®ËΩÆÊç¢API Key' : 'Auto Key Rotation Management'">
							<div>
								<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
								</svg>
							</div>
							&nbsp;{{ !isThirdPartyAPIKeyEnabled ? (settingsLanguage == 'cn' ? 'KeyÊ®°Âºè: Ëá™Âä®ËΩÆÊç¢API Key' : 'Key Mode: Auto Key Rotation') : (settingsLanguage == 'cn' ? 'KeyÊ®°Âºè: Á¨¨‰∏âÊñπÂçïKeyÊ®°Âºè' : 'Key Mode: 3rd party Key Mode') }}
						</button>
						<!-- ËØ•ÂäüËÉΩÂ∑≤Ë¢´ÈöêËóè The feature has been hidden:   Session Key‰∏çÊòØÂõ∫ÂÆöÁöÑÔºåÊØèÊ¨°ÁôªÂΩïÈÄÄÂá∫ÈÉΩ‰ºöÂèòÂåñ„ÄÇ The Session Key is not static and changes with each login and logout. --> 
						<button style="display: none;" @click="sendRequest_usingSessionKey"  class="btn minibtn minibtn-default btnzoom-b" :style="{ marginRight: settingsLanguage == 'cn' ? '-4px' : '-5px'}" :title="settingsLanguage == 'cn' ? 'Êü•ËØ¢OpenAI API‰ΩôÈ¢ù (via Session Key)' : 'Check OpenAI API balances (via Session Key)'">
							<div>
								<svg xmlns="http://www.w3.org/2000/svg" width="13px" height="13px" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="1.75" stroke-miterlimit="10">  
									<circle cx="9.5106" cy="9.42613" r="7.64"/>
									<path d="m6.6506,12.28613l3.34,0a1.43,1.43 0 0 0 1.43,-1.43l0,0a1.43,1.43 0 0 0 -1.43,-1.43l-0.95,0a1.44,1.44 0 0 1 -1.39,-1.44l0,0a1.44,1.44 0 0 1 1.44,-1.43l3.34,0"/>
									<line x1="9.5106" x2="9.5106" y1="4.64613" y2="6.55613"/><line x1="9.5106" x2="9.5106" y1="12.28613" y2="14.19613"/><line transform="rotate(90 18.2202 18.6877)" x1="14.70164" x2="21.73886" y1="22.20633" y2="15.16912"/>  
								</svg>
							</div>
							{{ settingsLanguage == 'cn' ? 'Session Key' : 'Session Key' }}
						</button>
					</div>
				
					<div class="panelrow"> 
						<!-- ‰∏ÄÈîÆÂ§çÂà∂API Key  Cpoy API Key -->
						<button class="copybtn btncopyapikey" data-clipboard-nextelementsibling="" style="opacity:1;position:relative;flex-shrink: 0;height: 25px;top:0;right:0;margin-right:-4px;border-radius: 6px 0px 0px 6px;border: 1px solid #DDD;width: 25px" :title="settingsLanguage == 'cn' ? '‰∏ÄÈîÆÂ§çÂà∂' : 'One-Click Copy'">
							<div>
								<svg width="14" height="17" class="clippy" fill="currentColor">
									<path d="m2.36373,12.61912l4.12233,0l0,1.03058l-4.12233,0l0,-1.03058zm5.15291,-6.18349l-5.15291,0l0,1.03058l5.15291,0l0,-1.03058zm2.06116,3.09174l0,-2.06116l-3.09174,3.09174l3.09174,3.09174l0,-2.06116l5.15291,0l0,-2.06116l-5.15291,0zm-4.63761,-1.03058l-2.57645,0l0,1.03058l2.57645,0l0,-1.03058zm-2.57645,3.09174l2.57645,0l0,-1.03058l-2.57645,0l0,1.03058zm9.27523,1.03058l1.03058,0l0,2.06116c-0.0161,0.28985 -0.11272,0.53139 -0.30595,0.72463s-0.43478,0.28985 -0.72463,0.30595l-10.30581,0c-0.5636,0 -1.03058,-0.46698 -1.03058,-1.03058l0,-11.33639c0,-0.5636 0.46698,-1.03058 1.03058,-1.03058l3.09175,0c0,-1.1433 0.91786,-2.06116 2.06116,-2.06116s2.06116,0.91786 2.06116,2.06116l3.09174,0c0.5636,0 1.03058,0.46698 1.03058,1.03058l0,5.15291l-1.03058,0l0,-3.09174l-10.30581,0l0,9.27523l10.30581,0l0,-2.06116zm-9.27523,-8.24465l8.24465,0c0,-0.5636 -0.46698,-1.03058 -1.03058,-1.03058l-1.03058,0c-0.5636,0 -1.03058,-0.46698 -1.03058,-1.03058s-0.46698,-1.03058 -1.03058,-1.03058s-1.03058,0.46698 -1.03058,1.03058s-0.46698,1.03058 -1.03058,1.03058l-1.03058,0c-0.5636,0 -1.03058,0.46698 -1.03058,1.03058z">
									</path>
								</svg>
							</div>
						</button>
						<!-- ÈöêËóèÁöÑAPI KeyÔºåËøô‰∏™ÂèØË¢´Â§çÂà∂ÂÜÖÂÆπ  hide : Function: Data can be read by "Copy Btn" --> 
						<input class="inputghostforcopyapikey" type="text" v-model="api" style="opacity:0;height:1px;width:1px;overflow:hidden;margin:0;padding:0;border:none;" />
						<!-- API KeyËæìÂÖ•Ê°Ü„ÄÇ Âõ†‰∏∫type="password" Ôºå‰∏çÂèØË¢´Â§çÂà∂„ÄÇ Because type="password", it cannot be copied by "Copy Btn". --> 	
						<input @blur="inputapiblur" @focus="inputapifocus"  @input="inputapichange(false)" :style="{ color: btnDisabledState_CheckAPI ? '#cccccc' : '#191919' }" v-model="api" type="password"  class="dh-input inputapikey"  style="border-radius: 0px;"  :placeholder="settingsLanguage == 'cn' ? 'API Key Á≤òË¥¥Âà∞ËøôÈáåÔºåÊîØÊåÅÁ¨¨‰∏âÊñπKey' : 'Paste API Key here, support Third-party Key.' " />
						<!-- È™åËØÅAPI Key Check API Key --> 	
						<button @click="checkAPIbtn" :disabled="btnDisabledState_CheckAPI" class="btn" :class="{ 'redbtn': !btnDisabledState_CheckAPI }" style="border-radius: 0px 6px 6px 0px;margin-left:-3px;"  >{{apibtntext}}</button>
						<!-- 1.Êü•ËØ¢OpenAI API‰ΩôÈ¢ù 2.ÊÅ¢Â§çAPI Key  1.Check OpenAI API balances 2.Restore Api Key--> 	
						<button  @click="sendRequest_or_restoreApiKeyInput" class="btn" :class="{ 'redbtn': !btnDisabledState_CheckAPI }" :style="{ padding: !btnDisabledState_CheckAPI ? '0 4px' : '0 8px' }" :title="settingsLanguage == 'cn' ? (btnDisabledState_CheckAPI ? 'Êü•ËØ¢OpenAI API‰ΩôÈ¢ù' : 'ÂèñÊ∂à‰øÆÊîπ Âπ∂ÊÅ¢Â§çAPI Key') : (btnDisabledState_CheckAPI ? 'Check OpenAI API balances' : 'Cancel and Restore API Key')">
							<div :style="{ display: btnDisabledState_CheckAPI ? 'flex' : 'none' }">
								<svg xmlns="http://www.w3.org/2000/svg" width="21px" height="20px" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="1.75" stroke-miterlimit="10">  
									<circle cx="9.5106" cy="9.42613" r="7.64"/>
									<path d="m6.6506,12.28613l3.34,0a1.43,1.43 0 0 0 1.43,-1.43l0,0a1.43,1.43 0 0 0 -1.43,-1.43l-0.95,0a1.44,1.44 0 0 1 -1.39,-1.44l0,0a1.44,1.44 0 0 1 1.44,-1.43l3.34,0"/>
									<line x1="9.5106" x2="9.5106" y1="4.64613" y2="6.55613"/><line x1="9.5106" x2="9.5106" y1="12.28613" y2="14.19613"/><line transform="rotate(90 18.2202 18.6877)" x1="14.70164" x2="21.73886" y1="22.20633" y2="15.16912"/>  
								</svg>
							</div>
							<div :style="{ display: btnDisabledState_CheckAPI ? 'none' : 'flex' }">
								<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<circle cx="12" cy="12" r="10"></circle>
									<line x1="15" y1="9" x2="9" y2="15"></line>
									<line x1="9" y1="9" x2="15" y2="15"></line>
								</svg>
							</div>
						</button>
					</div>
				</div>


				<!-- panelgroup: APIËÆæÁΩÆ  API Settings --> 
				<div class="panelgroup panelgroup-shadow">
					<div class="panelgroup-head">
						<span>{{ settingsLanguage == 'cn' ? 'APIËÆæÁΩÆ' : 'API Settings' }}</span>
						<button  @click="showMiniHelp('A-APISettings')"  class="btn minibtn bluebtn btnzoom-b"  style="margin-right: auto;" :title="settingsLanguage == 'cn' ? 'ÂäüËÉΩËØ¥Êòé' : 'Help'">?</button>
						<button  @click="showMiniHelp('A-SmartMaxTokens')"  class="btn minibtn orangeredbtn btnzoom-c" style="width: 12px; height: 12px;" :style="{ display: openSmartMaxTokens  ? 'block' : 'none', marginRight: settingsLanguage == 'cn' ? '-7px' : '-9px'}" :title="settingsLanguage == 'cn' ? 'ÂäüËÉΩËØ¥Êòé' : 'Help'">?</button>
						<select @change="changeSmartMaxTokens" class="dropdown minibtn minibtn-default btnzoom-d" :class="{ 'orangereddropdown': openSmartMaxTokens }" v-model="openSmartMaxTokens" :style="{ marginRight: settingsLanguage == 'cn' ? '-9px' : '-13px'}" :title="settingsLanguage == 'cn' ? 'ÂΩìÂâç[Smart max_tokens]Áä∂ÊÄÅ' : 'Current [Smart max_tokens] Status'">
								<option v-if="settingsLanguage == 'cn'" v-for="option in smartMaxTokensOptions_cn" :value="option.state">{{ option.label }}</option>
								<option v-else v-for="option in smartMaxTokensOptions_en" :value="option.state">{{ option.label }}</option>
						</select>
						<button  @click="restoreDefault_APISettings"  class="btn minibtn minibtn-default bluebtn btnzoom-b" :style="{ marginRight: settingsLanguage == 'cn' ? '-2px' : '-4px'}" :title="settingsLanguage == 'cn' ? 'ÊÅ¢Â§çÈªòËÆ§' : 'Restore Default'">{{ settingsLanguage == 'cn' ? 'ÊÅ¢Â§çÈªòËÆ§' : 'Restore Default' }}</button>
					</div>

					<div class="panelrow" style="align-items: start; height:auto;">
						<!--Ê∏©Â∫¶/ÈöèÊú∫ÊÄß/ÂàõÈÄ†Âäõ temperature --> 
						<div class="control-container" style="width:108px;flex-shrink: 0;">
							<div>
								<span>temperature: {{apitemperature}}</span>
							</div>
							<div class="control-bg" >
								<input @change="changeTemperature" type="range" class="slider" v-model.number="apitemperature"  min="0.0" max="2.0" step="0.1" value="0.7" >
							</div>
						</div>
						<!-- ÂçïÊ¨° ÊúÄÂ§ß‰ª§ÁâåÊï∞Èáè max_tokens (4095 4096 4097 16384 16385  gpt-3.5 gpt-4 gpt3.5 gpt4) --> 
						<div class="control-container" style="flex: 1 1 0%;">
							<div>
								<span>max_tokens(</span><span style="margin-left: 0px;font-weight:500;">1~{{ gptModelList.find(model => model.modelname === apiGPTModel) ? gptModelList.find(model => model.modelname === apiGPTModel).maxtokens : 4096 }}</span><span style="margin-left: 0px;">): {{apiMaxTokens}}</span>
							</div>
							<div class="control-bg">
								<input @change="changeMaxTokens" type="range" :disabled="openSmartMaxTokens" class="slider" v-model.number="apiMaxTokens"  min="1" :max=" gptModelList.find(model => model.modelname === apiGPTModel) ? gptModelList.find(model => model.modelname === apiGPTModel).maxtokens : 4096 " step="1" value="2048" >
							</div>
						</div>
					</div>	
	
					<div class="panelrow" style="align-items: start; height:auto;">
						<!-- GPTÊ®°Âûã GPT Model --> 
						<div class="control-container" style="flex-shrink: 0;" :style="{ width: apiGPTModel === 'gpt-3.5-turbo-16k-0613' ? '178px' : '156px'}">
							<div>
								<span>model: {{apiGPTModel}}</span>
							</div>
							<select @change="changeGPTModel" class="dropdown" v-model="apiGPTModel" style="width: 100%;height: 24px;">
								<option v-for="model in gptModelList" :value="model.modelname">{{ model.alias ? model.alias : model.modelname }}</option>
							</select>
						</div>
	
						<!-- ÂçïÊ¨°ÊúÄÂ§ß‰ª§ÁâåÊï∞ÈáèÔºàÁ≤æÁªÜË∞ÉËäÇ 1ÔΩû300Ôºâ max_tokensÔºàFine 1ÔΩû300Ôºâ  --> 
						<div class="control-container" style="flex: 1 1 0%;">
							<div>
								<span :title="settingsLanguage == 'cn' ? 'max_tokens (1~300)' : 'max_tokens (1~300)'">{{ settingsLanguage == 'cn' ? 'max_tokens(ÂæÆË∞É)' : 'max_tokens(Fine)' }}</span>
							</div>
							<div class="control-bg">
								<input @change="changeMaxTokens" type="range" :disabled="openSmartMaxTokens" class="slider" v-model.number="apiMaxTokens"  min="1" max="600" step="1" value="2048" >
							</div>
						</div>
	
						<!-- ÊòæÁ§∫‰∏ì‰∏öËÆæÁΩÆ Show more settings (Professional API Settings) --> 
						<div class="control-container">
							<div>
								<span>{{ settingsLanguage == 'cn' ? ' Êõ¥Â§ö' : ' More' }}</span>
							</div>
							<button  @click="showProConfig"  class="btn bluebtn btnzoom-c" :class="{ 'orangereddropdown': ( inputApiURL.toLowerCase().trim() !== OpenAI_API_URL ) }" style="margin: 0;padding: 0 4px;" :title="settingsLanguage == 'cn' ? 'ÊòæÁ§∫Êõ¥Â§ö‰∏ì‰∏öËÆæÁΩÆ' : 'Show more Pro settings'">
								<div>
									PRO
								</div>
							</button>
						</div>
					</div>
				</div>

				<!-- panelgroup: API‰∏ì‰∏öËÆæÁΩÆ  Professional API Settings --> 
				<div class="panelgroup panelgroup-shadow" :style="{ display: isShowProConfig ? 'block' : 'none'}">
					<div class="panelgroup-head">
						<span>{{ settingsLanguage == 'cn' ? 'API‰∏ì‰∏öËÆæÁΩÆ' : 'Professional API Settings' }}</span>
						<button  @click="showMiniHelp('A-ProfessionalAPISettings')"  class="btn minibtn bluebtn btnzoom-b" style="margin-right: auto;" :title="settingsLanguage == 'cn' ? 'ÂäüËÉΩËØ¥Êòé' : 'Help'">?</button>
						<!-- ÊòæÁ§∫Á¨¨‰∏âÊñπ‰ª£ÁêÜÂπ≥Âè∞ Show 3rd-party APIs * display: settingsLanguage == 'cn' ? 'block' : 'none'  --> 
						<button  @click="loadThirdPartyPaidAPIs"  class="btn minibtn minibtn-default btnzoom-b" :style="{ marginRight: settingsLanguage == 'cn' ? '-7.5px' : '-10px', display: settingsLanguage == 'cn' ? 'block' : 'none' }" :title="isLoadThirdPartyPaidAPIs ? (settingsLanguage == 'cn' ? 'ÈöêËóèÁ¨¨‰∏âÊñπ‰ª£ÁêÜÂπ≥Âè∞' : 'Hide 3rd-party APIs') : (settingsLanguage == 'cn' ? 'ÊòæÁ§∫Á¨¨‰∏âÊñπ‰ª£ÁêÜÂπ≥Âè∞' : 'Show 3rd-party APIs')">
							{{ isLoadThirdPartyPaidAPIs ? (settingsLanguage == 'cn' ? 'ÈöêËóèÁ¨¨‰∏âÊñπ‰ª£ÁêÜÂπ≥Âè∞' : 'Hide 3rd-party APIs') : (settingsLanguage == 'cn' ? 'ÊòæÁ§∫Á¨¨‰∏âÊñπ‰ª£ÁêÜÂπ≥Âè∞' : 'Show 3rd-party APIs') }}
						</button>
						<button  @click="restoreDefault_ProfessionalAPISettings"  class="btn minibtn minibtn-default bluebtn btnzoom-b" :style="{ marginRight: settingsLanguage == 'cn' ? '-2px' : '-4px'}" :title="settingsLanguage == 'cn' ? 'ÊÅ¢Â§çÈªòËÆ§' : 'Restore Default'">{{ settingsLanguage == 'cn' ? 'ÊÅ¢Â§çÈªòËÆ§' : 'Restore Default' }}</button>
					</div>
				
					<!-- Êé•Âè£ÁΩëÂùÄ API URL / API Endpoint  --> 
					<div class="panelrow" style="align-items: start; height:auto;">
						<span style="line-height: 25px;font-size: 12px;flex-shrink: 0;" :title="settingsLanguage == 'cn' ? 'API URL (API Endpoint)' : 'API Endpoint'">
							{{ settingsLanguage == 'cn' ? 'Êé•Âè£ÁΩëÂùÄ :' : 'API URL :' }} 
						</span>
						<input type="text" @input="inputApiURLChange" v-model="inputApiURL" class="dh-input" style="border-radius:6px 0px 0px 6px;"  :placeholder="settingsLanguage == 'cn' ? 'Ê∏ÖÁ©∫Âêé‰øùÂ≠ò ÂèØÈáçÁΩÆ‰∏∫OpenAIÂÆòÊñπÊé•Âè£' : 'Clear and save, can be reset to OpenAI API endpoint.' "  />
						<button @click="saveApiURL" :disabled="btnDisabledState_SaveApiURL" class="btn" style="border-radius: 0px 6px 6px 0px;margin-left:-3px;"  >
							{{ settingsLanguage == 'cn' ? '‰øùÂ≠ò' : 'Save' }} 
						</button>	
						<select @change="updateInputApiURL" :disabled="btnDisabledState_ApiURL" class="dropdown" v-model="selectedApiURL" :class="{ 'orangereddropdown': ( !btnDisabledState_ApiURL && inputApiURL.toLowerCase().trim() !== OpenAI_API_URL ) }" :style="{ width: selectedApiURL === '' ? '31px' : (  settingsLanguage == 'cn' ? (selectedApiURL === apiURLOptions_en[0]['url'] ? '46px' : '57px') : (selectedApiURL === apiURLOptions_en[0]['url'] ? '63px' : '71px')  )  }" :title="settingsLanguage == 'cn' ? 'Êé•Âè£URLÈÄâÈ°π (ÂèØÈÄâ)' : 'Endpoint Options (Optional)'">
							<option disabled value="">‚ñº&nbsp;{{ settingsLanguage == 'cn' ? 'È¢ÑËÆæÈÄâÈ°πÔºöGPTÂÆòÊñπÊé•Âè£ Âíå Á¨¨‰∏âÊñπÊé•Âè£(Êù•Ê∫ê‰∫éÁΩëÁªú)' : 'Pre-set options: OpenAI API and Third-party APIs (Internet resources)' }}</option>
							<option v-if="settingsLanguage == 'cn'" v-for="option in apiURLOptions_cn" :value="option.url">{{ option.label }}</option>
							<option v-else v-for="option in apiURLOptions_en" :value="option.url">{{ option.label }}</option>
							<option v-if=" !isLoadThirdPartyPaidAPIs" disabled value="help1">{{ settingsLanguage == 'cn' ? ' - Á¨¨‰∏âÊñπÊé•Âè£Êù•Ê∫êÁΩëÁªúÔºåÊó†Ê≥ï‰øùËØÅÈöêÁßÅÂÆâÂÖ®ÂíåÂÆûÊïàÊÄß' : ' - Third-party APIs can be unsafe or unreliable' }}</option>
							<option v-if="!isSimpleMode" disabled value="help2">{{ settingsLanguage == 'cn' ? ' - ‰ΩøÁî®Á¨¨‰∏âÊñπÊé•Âè£Êó∂ÔºåÈ¢úËâ≤‰ºöÂá∫Áé∞ÂèòÂåñ' : ' - The colors will change when using third-party APIs' }}</option>
							<option v-if="isLoadThirdPartyPaidAPIs" disabled value="help4">{{ settingsLanguage == 'cn' ? '***‰ª•‰∏ã‰∏∫Êî∂ÈõÜËá™ÁΩëÁªúÁöÑ‰ªòË¥π‰ª£ÁêÜAPIËµÑÊ∫êÔºåÈúÄÂú®ÂêÑÂπ≥Âè∞Ê≥®ÂÜåÔºåÊ∂âÂèäÊîØ‰ªò' : '***‰ª•‰∏ã‰∏∫Êî∂ÈõÜËá™ÁΩëÁªúÁöÑ‰ªòË¥π‰ª£ÁêÜAPIËµÑÊ∫êÔºåÈúÄÂú®ÂêÑÂπ≥Âè∞Ê≥®ÂÜåÔºåÊ∂âÂèäÊîØ‰ªò' }}</option>
							<option v-if="isLoadThirdPartyPaidAPIs" disabled value="help5">{{ settingsLanguage == 'cn' ? '***ËØ∑Ê≥®ÊÑè‰øùÊä§ÈöêÁßÅÂíåÂ¢ûÂº∫ÂèçËØàÊÑèËØÜÔºåÈ¢ÑÈò≤‰ø°ÊÅØÊ≥ÑÈú≤ÂíåÂπ≥Âè∞ÂÄíÈó≠Á≠âÊÉÖÂÜµ' : '***ËØ∑Ê≥®ÊÑè‰øùÊä§ÈöêÁßÅÂíåÂ¢ûÂº∫ÂèçËØàÊÑèËØÜÔºåÈ¢ÑÈò≤‰ø°ÊÅØÊ≥ÑÈú≤ÂíåÂπ≥Âè∞ÂÄíÈó≠Á≠âÊÉÖÂÜµ' }}</option>
							<option v-if="isLoadThirdPartyPaidAPIs" v-for="option in apiURLOptions_LoadThirdPartyPaidAPIs" :value="option.url">{{ option.label }}</option>
						</select>		
					</div>
	
					<div class="panelrow" style="align-items: start; height:auto;">
						<!-- top_p --> 
						<div class="control-container" style="flex: 1 1 0%;">
							<div>
								<span style="font-size: 11px;">top_p: {{apiTopP}}</span>
							</div>
							<div class="control-bg" >
								<input @change="changeTopP" type="range" class="slider" v-model.number="apiTopP"  min="0.0" max="1" step="0.1" value="1" >
							</div>
						</div>
	
						<!-- presence_penalty --> 
						<div class="control-container" style="width: 48%;flex: 1 1 15%;">
							<div>
								<span style="font-size: 11px;">presence_penalty: {{apiPresencePenalty}}</span>
							</div>
							<div class="control-bg" >
								<input @change="changePresencePenalty" type="range" class="slider" v-model.number="apiPresencePenalty"  min="-2.0" max="2.0" step="0.1" value="0" >
							</div>
						</div>
	
						<!-- frequency_penalty --> 
						<div class="control-container" style="width: 48%;flex: 1 1 15%;">
							<div>
								<span style="font-size: 11px;">frequency_penalty: {{apiFrequencyPenalty}}</span>
							</div>
							<div class="control-bg" >
								<input @change="changeFrequencyPenalty" type="range" class="slider" v-model.number="apiFrequencyPenalty"  min="-2.0" max="2.0" step="0.1" value="0" >
							</div>
						</div>
					</div>
				</div>

				<!-- panelgroup: Â∏∏ËßÑËÆæÁΩÆ General Settings --> 
				<div class="panelgroup panelgroup-shadow">
					<div class="panelgroup-head">
						<span>{{ settingsLanguage == 'cn' ? 'Â∏∏ËßÑËÆæÁΩÆ' : 'General Settings' }}</span>
						<button  @click="showMiniHelp('A-GeneralSettings')"  class="btn minibtn bluebtn btnzoom-b" style="margin-right: auto;" :title="settingsLanguage == 'cn' ? 'ÂäüËÉΩËØ¥Êòé' : 'Help'">?</button>
						<div style="margin-right: -7px;">
							<svg width="22" height="22"  :fill="(pageScaling === '0.8' || pageScaling === '0.80') ? '#25ad24' : '#f44400'" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:se="http://svg-edit.googlecode.com">
								<path d="m22,29l-12,0a3,3 0 0 1 -3,-3l0,-20a3,3 0 0 1 3,-3l12,0a3,3 0 0 1 3,3l0,20a3,3 0 0 1 -3,3zm-12,-24a1,1 0 0 0 -1,1l0,20a1,1 0 0 0 1,1l12,0a1,1 0 0 0 1,-1l0,-20a1,1 0 0 0 -1,-1l-12,0z" id="svg_1"/>
								<path d="m18,7l-4,0a2,2 0 0 1 -2,-2l0,-1a1,1 0 0 1 1,-1l6,0a1,1 0 0 1 1,1l0,1a2,2 0 0 1 -2,2zm-4,-2l0,0z" />
							</svg>
						</div>
						<select @change="changePageScaling(true)" class="dropdown minibtn minibtn-default btnzoom-b" v-model="selectedPageScaling" :class="{ 'orangereddropdown': !(pageScaling === '0.8' || pageScaling === '0.80') }" :style="{ marginRight: settingsLanguage == 'cn' ? '-4px' : '-7px', width: settingsLanguage == 'cn' ? '64px' : '90px' }" :title="settingsLanguage == 'cn' ? 'Êõ¥ÊîπÈ°µÈù¢Áº©ÊîæÊØî‰æã (ÁßªÂä®Á´Ø)' : 'Change Page Scaling (Mobile)'">
							<option disabled value="">{{ settingsLanguage == 'cn' ? 'È°µÈù¢Áº©Êîæ' : 'Page Scaling' }}</option>
							<option disabled value="help1">{{ settingsLanguage == 'cn' ? ' - ÂΩìÂâçÁº©Êîæ‰∏∫ ' + (parseFloat(this.pageScaling) * 100).toFixed(0) + '%ÔºåÈªòËÆ§ÁöÑÁº©ÊîæËÆæÁΩÆÊòØ 80%' : ' - Current scaling is ' + (parseFloat(this.pageScaling) * 100).toFixed(0) + '%, and default scaling is 80%'  }}</option>
							<option disabled value="help2">{{ settingsLanguage == 'cn' ? ' - ‰ªÖÊîØÊåÅÁßªÂä®ËÆæÂ§áÔºåÁîµËÑëÁ´Ø‰∏ç‰ºöËøõË°åÁº©Êîæ' : ' - Only mobile devices are supported, and there will be no scaling on desktop' }}</option>
							<option v-for="option in selectedPageScalingOptions" :value="option">{{ option }}</option>
						</select>
						<button  @click="restoreDefault_GeneralSettings"  class="btn minibtn minibtn-default bluebtn btnzoom-b" :style="{ marginRight: settingsLanguage == 'cn' ? '-2px' : '-4px'}" :title="settingsLanguage == 'cn' ? 'ÊÅ¢Â§çÈªòËÆ§' : 'Restore Default'">{{ settingsLanguage == 'cn' ? 'ÊÅ¢Â§çÈªòËÆ§' : 'Restore Default' }}</button>
					</div>
				
					<div class="panelrow" style="align-items: start; height:auto;flex-wrap: wrap;justify-content: stretch;">
						<!-- ËÆ∞ÂøÜÊ®°Âºè / ‰∏ä‰∏ãÊñáÊ®°Âºè  Contextual Mode  *ÈÉ®ÂàÜÂäüËÉΩ[‰øùÁïôÊúÄÂêéxxÊù°ËÆ∞ÂøÜ]/[Keep Last] ÂæÖÂºÄÂèë To be developed--> 
						<div class="control-container" style="min-width: 110px;max-width: 210px;flex: 1 1 0%;margin: 0px 3px;">
							<div>
								<span>{{ settingsLanguage == 'cn' ? 'ËÆ∞ÂøÜÊ®°Âºè' : 'Contextual Mode' }}</span>
							</div>
							<select @change="changeContextualMode" :disabled="btnDisabledState_ContextualMode" class="dropdown" v-model="settingsContextualMode" style="width: 100%;height: 24px;" 
								:class="{ 'orangereddropdown': !Number.isInteger(settingsContextualMode) ? false : settingsContextualMode === 0 ? false : btnDisabledState_ContextualMode ? false : true }">
								<option v-if="!isSimpleMode" disabled value="help1">{{ settingsLanguage == 'cn' ? ' - ËÆ∞ÂøÜ: Âç≥"‰∏ä‰∏ãÊñá"„ÄÇÊØèÊ¨°‰∏ÄÈóÆ‰∏ÄÁ≠î‰ºö‰∫ßÁîü 2 Êù°ËÆ∞ÂøÜ' : " - Every 2 context messages correspond to each Q&A session." }}</option>
								<option disabled value="help2">{{ settingsLanguage == 'cn' ? ' - ËÆæÁΩÆ[ËÆ∞ÂøÜ‰∏äÈôê]ÔºåËææÂà∞ÂêéÔºå‰ºöÂú®ÂèëÈÄÅÊñ∞Ê∂àÊÅØÊó∂Ëá™Âä®Ê∏ÖÈô§‰πãÂâçÂÖ®ÈÉ®ËÆ∞ÂøÜ' : " - [Limit]: The context will be automatically cleared after reaching the limit." }}</option>
								<option disabled value="help3">{{ settingsLanguage == 'cn' ? ' - ËÆæÁΩÆ[‰øùÁïôÊúÄÂêéxxÊù°ËÆ∞ÂøÜ]Ôºå‰ºöÂßãÁªà‰øùÊåÅËÆ∞ÂøÜ‰∏∫ÊúÄÊñ∞ÁöÑxxÊù°ÂéÜÂè≤Ê∂àÊÅØ *ÂæÖÂºÄÂèë' : " - [Keep Last]: Always keep the last ** number of messages as the context. *To be developed" }}</option>
								<option v-if="settingsLanguage == 'cn'" v-for="option in settingsContextualModeOptions_cn" :value="option.mode">{{ option.label }}</option>
								<option v-else v-for="option in settingsContextualModeOptions_en" :value="option.mode">{{ option.label }}</option>
							</select>
						</div>
						<!-- ËØ≠Ë®ÄÂàáÊç¢ ‰∏≠/Ëã± Language --> 
						<div class="control-container" style="min-width: 80px;max-width: 180px;flex: 1 1 0%;margin: 0px 3px;">
							<div>
								<span>{{ settingsLanguage == 'cn' ? 'Language &#127464;&#127475;' : 'ËØ≠Ë®Ä &#x1F1EC;&#x1F1E7;' }}</span>
							</div>
							<select @change="changeLanguage" :disabled="btnDisabledState_Language" class="dropdown" v-model="settingsLanguage" style="width: 100%;height: 24px;">
								<option v-for="option in settingsLanguageOptions" :value="option.lang">{{ option.label }}</option>
							</select>
						</div>
						<!-- Â≠ó‰ΩìÂ§ßÂ∞è Font Size --> 
						<div class="control-container" style="min-width: 65px;max-width: 165px;flex: 1 1 0%;margin: 0px 3px;">
							<div>
								<span>{{ settingsLanguage == 'cn' ? 'Â≠ó‰ΩìÂ§ßÂ∞è' : 'Font Size' }}</span>
							</div>
							<select @change="changeStyle_FontSize" class="dropdown" v-model="settingsFontSize" style="width: 100%;height: 24px;">
								<option disabled value="">{{ settingsLanguage == 'cn' ? ' - ÈÅøÂÖçÂú®ÊñáÊú¨ËøáÂ§öÁöÑÂØπËØù‰∏≠ËøõË°åÊõ¥ÊîπÔºå‰ª•ÂÖçÂØºËá¥ÁΩëÈ°µÂ¥©Ê∫É' : " - To avoid crashes, don't make changes in chats with excessive content" }}</option>
								<option v-for="option in settingsFontSizeOptions" :value="option.fontsize">{{ option.label }}</option>
							</select>
						</div>
						<!-- ÊòæÁ§∫Êó∂Èó¥(ÂæÆ‰ø°Ê†∑Âºè)  Display time (WeChat style) --> 
						<div class="control-container" style="min-width: 125px;max-width: 225px;flex: 1 1 0%;margin: 0px 3px;">
							<div>
								<span>{{ settingsLanguage == 'cn' ? '‰ªøÂæÆ‰ø°Êó∂Èó¥' : 'Time (WeChat style)' }}</span>
							</div>
							<select @change="changeStyle_Time_WechatStyle" class="dropdown" v-model="settingsTime_WechatStyle" style="width: 100%;height: 24px;">
								<option v-if="settingsLanguage == 'cn'" v-for="option in settingsTimeWechatStyleOptions_cn" :value="option.displaytime">{{ option.label }}</option>
								<option v-else v-for="option in settingsTimeWechatStyleOptions_en" :value="option.displaytime">{{ option.label }}</option> 
							</select>
						</div>
						<!-- ÊòæÁ§∫Ê∂àÊÅØÊó∂Èó¥  Display message time.  --> 
						<div class="control-container" style="min-width: 105px;max-width: 205px;flex: 1 1 0%;margin: 0px 3px;">
							<div>
								<span>{{ settingsLanguage == 'cn' ? 'Ê∂àÊÅØÊó∂Èó¥' : 'Time (Message)' }}</span>
							</div>
							<select @change="changeStyle_Time" class="dropdown" v-model="settingsTime_Message" style="width: 100%;height: 24px;">
								<option v-if="settingsLanguage == 'cn'" v-for="option in settingsTimeMessageOptions_cn" :value="option.displaytime">{{ option.label }}</option>
								<option v-else v-for="option in settingsTimeMessageOptions_en" :value="option.displaytime">{{ option.label }}</option>
							</select>
						</div>
						<!-- ÊòæÁ§∫ÂàÜÂâ≤Á∫ø ËÆ∞ÂøÜÂàÜÂâ≤Á∫ø/‰∏ä‰∏ãÊñáÂàÜÂâ≤Á∫ø Display divider line --> 
						<div class="control-container" style="min-width: 125px;max-width: 225px;flex: 1 1 0%;margin: 0px 3px;">
							<div>
								<span>{{ settingsLanguage == 'cn' ? 'ËÆ∞ÂøÜÂàÜÂâ≤Á∫ø' : 'Context Divider Line' }}</span>
							</div>
							<select @change="changeStyle_DividerLine" class="dropdown" v-model="settingsDividerLine" style="width: 100%;height: 24px;">
								<option v-if="settingsLanguage == 'cn'" v-for="option in settingsDividerLineOptions_cn" :value="option.displaydividerline">{{ option.label }}</option>
								<option v-else v-for="option in settingsDividerLineOptions_en" :value="option.displaydividerline">{{ option.label }}</option>
							</select>
						</div>
			

	
						<!-- È™åËØÅAPI Key Âø´Êç∑ÈîÆ Check API Key Shortcut ¬†***v8.27 ÊîπÁî®ÈÄî ÊîπÊàê"ÊâìÂºÄKeyÊ®°ÂºèÁ™óÂè£"ÁöÑÂø´Êç∑ÈîÆ Change the original purpose to "Open Key Mode window". --> 
						<div class="control-container" style="min-width: 150px;max-width: 260px;flex: 1 1 0%;margin: 0px 3px;">
							<div>
								<span>{{ settingsLanguage == 'cn' ? '[Key Ê®°Âºè] Âø´Êç∑ÈîÆ' : '[Key Mode] Shortcut' }}</span>
							</div>
							<select class="dropdown" v-model="settingsShortcut_CheckApiKey" style="width: 100%;height: 24px;">
								<option v-if="settingsLanguage == 'cn'" v-for="option in settingsShortcutCheckApiKeyOptions_cn" :value="option.shortcut">{{ option.label }}</option>
								<option v-else v-for="option in settingsShortcutCheckApiKeyOptions_en" :value="option.shortcut">{{ option.label }}</option>
							</select>
						</div>
		
						<!-- Ê∏ÖÈô§ËÆ∞ÂøÜÂø´Êç∑ÈîÆ Clear Context Shortcut--> 
						<div class="control-container" style="min-width: 140px;max-width: 250px;flex: 1 1 0%;margin: 0px 3px;">
							<div>
								<span>{{ settingsLanguage == 'cn' ? '[Ê∏ÖÈô§ËÆ∞ÂøÜ] Âø´Êç∑ÈîÆ' : '[Clear Context] Shortcut' }}</span>
							</div>
							<select class="dropdown" v-model="settingsShortcut_Clear" style="width: 100%;height: 24px;">
								<option v-if="settingsLanguage == 'cn'" v-for="option in settingsShortcutClearOptions_cn" :value="option.shortcut">{{ option.label }}</option>
								<option v-else v-for="option in settingsShortcutClearOptions_en" :value="option.shortcut">{{ option.label }}</option>
							</select>
						</div>
	
						<!-- Êí§ÈîÄÂø´Êç∑ÈîÆ Undo Shortcut --> 
						<div class="control-container" style="min-width: 95px;max-width: 195px;flex: 1 1 0%;margin: 0px 3px;">
							<div>
								<span>{{ settingsLanguage == 'cn' ? '[Êí§ÈîÄ] Âø´Êç∑ÈîÆ' : '[Undo] Shortcut' }}</span>
							</div>
							<select class="dropdown" v-model="settingsShortcut_Undo" style="width: 100%;height: 24px;">
								<option v-if="settingsLanguage == 'cn'" v-for="option in settingsShortcutUndoOptions_cn" :value="option.shortcut">{{ option.label }}</option>
								<option v-else v-for="option in settingsShortcutUndoOptions_en" :value="option.shortcut">{{ option.label }}</option>
							</select>
						</div>
	
						<!-- ÈáçÈóÆÂø´Êç∑ÈîÆ Retry Shortcut --> 
						<div class="control-container" style="min-width: 95px;max-width: 195px;flex: 1 1 0%;margin: 0px 3px;">
							<div>
								<span>{{ settingsLanguage == 'cn' ? '[ÈáçÈóÆ] Âø´Êç∑ÈîÆ' : '[Retry] Shortcut' }}</span>
							</div>
							<select class="dropdown" v-model="settingsShortcut_Retry" style="width: 100%;height: 24px;">
								<option v-if="settingsLanguage == 'cn'" v-for="option in settingsShortcutRetryOptions_cn" :value="option.shortcut">{{ option.label }}</option>
								<option v-else v-for="option in settingsShortcutRetryOptions_en" :value="option.shortcut">{{ option.label }}</option>
							</select>
						</div>
					</div>

					<!-- Áî®Êà∑Â§¥ÂÉè user Avatar  -->
					<div class="panelrow" style="height:36px;">
						<select class="dropdown" v-model="selectedImageUrl" @change="updateSelectedImage('user')" :style="{ width: settingsLanguage == 'cn' ? '72px' : '87px' }" style="flex-shrink: 0;height: 24px;margin-right: 4px;margin-left: 3px;" :title="settingsLanguage == 'cn' ? 'Áî®Êà∑Â§¥ÂÉèÈÄâÈ°π (ÂèØÈÄâ)' : 'User Avatar Options (Optional)'">
							<option value="">{{ settingsLanguage == 'cn' ? 'Áî®Êà∑Â§¥ÂÉè' : 'User Avatar' }}</option>
							<option v-if="!isSimpleMode" disabled value="help1">{{ settingsLanguage == 'cn' ? ' - ÊîØÊåÅÂ§öÁßçÊñπÂºèÊõ¥ÊîπÂ§¥ÂÉèÔºåÁÇπÂáªÈù¢Êùø[?]‰∫ÜËß£Êõ¥Â§ö' : ' - Offering multiple options to change avatars. Click the panel [?] to learn more' }}</option>
							<option value="uploadimage">{{ settingsLanguage == 'cn' ? ' - ÁÇπÂáªÂè≥‰æßÂ§¥ÂÉè ÂèØ‰∏ä‰º†ÂõæÁâá' : ' - Click the Avatar on the right to upload an image' }}</option>
							<option :value="userAvatarUp_blobUrl">{{ settingsLanguage == 'cn' ? (userAvatarUp_blobUrl == '' ? '1) ÊúÄËøë‰∏ä‰º†ÁöÑÁî®Êà∑Â§¥ÂÉè (ÊÇ®ËøòÊ≤°‰∏ä‰º†Â∞è‰∫é350KBÁöÑÂ§¥ÂÉè)' : '1) ÊúÄËøë‰∏ä‰º†ÁöÑÁî®Êà∑Â§¥ÂÉè (ÂèØÁî®)') : (userAvatarUp_blobUrl == '' ? '1) Uploaded User Avatar (No uploaded avatar within 350KB)' : '1) Uploaded User Avatar (Available)') }}</option>
							<option v-if="settingsLanguage == 'cn'" v-for="image in userpresetImages_cn" :value="image.url">{{ image.name }}</option>
							<option v-else v-for="image in userpresetImages_en" :value="image.url">{{ image.name }}</option>
						</select>
						<span style="line-height: 25px; font-size: 12px; flex-shrink: 0;" :title="settingsLanguage == 'cn' ? 'ÊàñÊâãÂä®ËæìÂÖ•ÁΩëÁªúÂõæÁâáÁΩëÂùÄ/Êú¨Âú∞ÂõæÁâáË∑ØÂæÑ' : 'or Manually Enter Image URL / Local Image Path'">{{ settingsLanguage == 'cn' ? 'Êàñ URL:' : 'or URL' }}</span>
						<input type="text" v-model="inputUserImageUrl" @input="inputImageUrlChange('user')" class="dh-input" style="flex: 1 1 0%;border-radius:6px 0px 0px 6px;" :placeholder="settingsLanguage == 'cn' ? 'ËæìÂÖ•ÂõæÁâáÁöÑÁΩëÂùÄÔºàÊú¨Âú∞ËøêË°å.htmlÁΩëÈ°µÊó∂ÊîØÊåÅÁîµËÑë‰∏≠ÂõæÁâáÁöÑÊú¨Âú∞Ë∑ØÂæÑÔºâ' : 'Image URL. (Local image paths are supported when running *.html from PC/Mac.)' " >
						<button @click="updateAvatar('user')" :disabled="btnDisabledState_updateUserImageUrl" class="btn" :style="{ width: settingsLanguage == 'cn' ? '68px' : '85px' }" style="flex-shrink: 0;border-radius: 0px 6px 6px 0px;margin-left:-3px;margin-right: 4px;" :title="settingsLanguage == 'cn' ? 'ÂèØÈÄâ: Âú®‰øÆÊîπÂõæÁâáÁΩëÂùÄÂêé ÁÇπÂáªÊõ¥Êç¢' : 'Optional: Click Update after modifying the image URL'">{{ settingsLanguage == 'cn' ? 'Êõ¥Êç¢ >>' : 'Update >>' }}</button>
						<div id="div-upload-userAvataror" class="chat-img chat-img-bg chat-img-border update-img-size btnzoom-a" :title="settingsLanguage == 'cn' ? 'ÂèØÈÄâ: ÁÇπÂáª‰∏ä‰º†ÊàëÁöÑÂ§¥ÂÉè' : 'Optional: Click to upload my avatar'">
							<img :src="userAvatarURL">
						</div>
					</div> 
					<!-- GPTÂ§¥ÂÉè gpt Avatar  -->
					<div class="panelrow" style="height:35px;">
						<select class="dropdown" v-model="selectedImageUrl" @change="updateSelectedImage('gpt')" :style="{ width: settingsLanguage == 'cn' ? '72px' : '87px' }" style="flex-shrink: 0;height: 24px;margin-right: 4px;margin-left: 3px;" :title="settingsLanguage == 'cn' ? 'GPTÂ§¥ÂÉèÈÄâÈ°π (ÂèØÈÄâ)' : 'GPT Avatar Options (Optional)'">
							<option value="">{{ settingsLanguage == 'cn' ? 'GPTÂ§¥ÂÉè' : 'GPT Avatar' }}</option>
							<option v-if="!isSimpleMode" disabled value="help1">{{ settingsLanguage == 'cn' ? ' - ÊîØÊåÅÂ§öÁßçÊñπÂºèÊõ¥ÊîπÂ§¥ÂÉèÔºåÁÇπÂáªÈù¢Êùø[?]‰∫ÜËß£Êõ¥Â§ö' : ' - Offering multiple options to change avatars. Click the panel [?] to learn more' }}</option>
							<option value="uploadimage">{{ settingsLanguage == 'cn' ? ' - ÁÇπÂáªÂè≥‰æßÂ§¥ÂÉè ÂèØ‰∏ä‰º†ÂõæÁâá' : ' - Click the Avatar on the right to upload an image' }}</option>
							<option v-if="settingsLanguage == 'cn'" v-for="image in gptpresetImages_cn" :value="image.url">{{ image.name }}</option>
							<option v-else v-for="image in gptpresetImages_en" :value="image.url">{{ image.name }}</option>
						</select>
						<span style="line-height: 25px; font-size: 12px; flex-shrink: 0;" :title="settingsLanguage == 'cn' ? 'ÊàñÊâãÂä®ËæìÂÖ•ÁΩëÁªúÂõæÁâáÁΩëÂùÄ/Êú¨Âú∞ÂõæÁâáË∑ØÂæÑ' : 'or Manually Enter Image URL / Local Image Path'">{{ settingsLanguage == 'cn' ? 'Êàñ URL:' : 'or URL' }}</span>
						<input type="text" v-model="inputGPTImageUrl" @input="inputImageUrlChange('gpt')" class="dh-input" style="flex: 1 1 0%;border-radius:6px 0px 0px 6px;" :placeholder="settingsLanguage == 'cn' ? 'ËæìÂÖ•ÂõæÁâáÁöÑÁΩëÂùÄÔºàÊú¨Âú∞ËøêË°å.htmlÁΩëÈ°µÊó∂ÊîØÊåÅÁîµËÑë‰∏≠ÂõæÁâáÁöÑÊú¨Âú∞Ë∑ØÂæÑÔºâ' : 'Image URL. (Local image paths are supported when running *.html from PC/Mac.)' ">
						<button @click="updateAvatar('gpt')" :disabled="btnDisabledState_updateGPTImageUrl" class="btn" :style="{ width: settingsLanguage == 'cn' ? '68px' : '85px' }" style="flex-shrink: 0;border-radius: 0px 6px 6px 0px;margin-left:-3px;margin-right: 4px;" :title="settingsLanguage == 'cn' ? 'ÂèØÈÄâ: Âú®‰øÆÊîπÂõæÁâáÁΩëÂùÄÂêé ÁÇπÂáªÊõ¥Êç¢' : 'Optional: Click Update after modifying the image URL'">{{ settingsLanguage == 'cn' ? 'Êõ¥Êç¢ >>' : 'Update >>' }}</button>
						<div id="div-upload-gptAvataror" class="chat-img chat-img-bg chat-img-border update-img-size btnzoom-a" :style="{ display: isgptGreenSvgShow ? 'none' : 'flex' }" :title="settingsLanguage == 'cn' ? 'ÂèØÈÄâ: ÁÇπÂáª‰∏ä‰º†GPTÂ§¥ÂÉè' : 'Optional: Click to upload GPT avatar'">
							<img :src="gptAvatarURL">
						</div>
						<div id="div-upload-gptAvataror-SVG" class="chat-img chat-img-border chat-green-svg update-img-size btnzoom-a" :style="{ display: isgptGreenSvgShow  ? 'flex' : 'none' }" :title="settingsLanguage == 'cn' ? 'ÂèØÈÄâ: ÁÇπÂáª‰∏ä‰º†GPTÂ§¥ÂÉè' : 'Optional: Click to upload GPT avatar'">
							<svg width="27" height="27" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg" stroke-width="1.5"  role="img">
								<path d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z" fill="currentColor">
							</svg>
						</div>
					</div>
				</div>

				<!-- panelgroup: ÊâìÂºÄÂØπËØùÂàóË°® open Chat List   ÊâìÂºÄÊèêÁ§∫ËØçÁ™óÂè£ open Prompt Generator   ‰∏ãËΩΩËÅäÂ§©ËÆ∞ÂΩï Export chat history. --> 
				<div class="panelgroup panelgroup-shadow">
					<div class="panelrow" style="align-items: center; height:auto;flex-wrap: wrap;justify-content: stretch;">
						<div class="control-container" style=" flex: 1 1 0%;" :style="{ minWidth: settingsLanguage == 'cn' ? '119px' : '129px',maxWidth: settingsLanguage == 'cn' ? '179px' : '199px' }">
							<div>
								<span>{{ settingsLanguage == 'cn' ? 'ÂØπËØùÂàóË°®' : 'Chat List' }}</span>
								<button @click="showMiniHelp('C-ChatList')"  class="btn minibtn bluebtn btnzoom-b" :title="settingsLanguage == 'cn' ? 'ÂäüËÉΩËØ¥Êòé' : 'Help'">?</button>
							</div>
							<button  @click="clickOpenChatList" class="btn bluebtn" style="width:100%;margin: 2px 0px 4px 0px;justify-content: start;">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
								</svg>&nbsp;{{ settingsLanguage == 'cn' ? 'ÊâìÂºÄÂØπËØùÂàóË°®' : 'Open Chat List' }}
							</button>
						</div>
						<div class="control-container" style=" flex: 1 1 0%;" :style="{ minWidth: settingsLanguage == 'cn' ? '130px' : '179px',maxWidth: settingsLanguage == 'cn' ? '190px' : '239px' }">
							<div>
								<span>{{ settingsLanguage == 'cn' ? 'ÊèêÁ§∫ËØçÁ™óÂè£' : 'Prompt Generator' }}</span>
							</div>
							<button  @click="clickOpenPromptGenerator" class="btn bluebtn" style="width:100%;margin: 2px 0px 4px 0px;justify-content: start;">
								<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0.6" stroke-linecap="round" stroke-linejoin="round">
									<path d="M19.7,23.5H4.3c-2.1,0-3.8-1.7-3.8-3.8V4.3c0-2.1,1.7-3.8,3.8-3.8h15.3c2.1,0,3.8,1.7,3.8,3.8v15.3    C23.5,21.8,21.8,23.5,19.7,23.5z M4.3,1.5c-1.6,0-2.8,1.3-2.8,2.8v15.3c0,1.6,1.3,2.8,2.8,2.8h15.3c1.6,0,2.8-1.3,2.8-2.8V4.3    c0-1.6-1.3-2.8-2.8-2.8H4.3z"/>
									<path d="M10.4,19.2H7.3c-0.3,0-0.5-0.2-0.5-0.5V5.3c0-0.3,0.2-0.5,0.5-0.5h9.3c0.3,0,0.5,0.2,0.5,0.5v8.5c0,0.3-0.2,0.5-0.5,0.5    h-5.7v4.4C10.9,19,10.7,19.2,10.4,19.2z M7.8,18.2h2.1v-4.4c0-0.3,0.2-0.5,0.5-0.5h5.7V5.8H7.8V18.2z M13.6,11.2h-3.2    c-0.3,0-0.5-0.2-0.5-0.5V8.4c0-0.3,0.2-0.5,0.5-0.5h3.2c0.3,0,0.5,0.2,0.5,0.5v2.3C14.1,11,13.9,11.2,13.6,11.2z M10.9,10.2h2.2    V8.9h-2.2V10.2z"/>
								</svg>&nbsp;{{ settingsLanguage == 'cn' ? 'ÊâìÂºÄÊèêÁ§∫ËØçÁ™óÂè£' : 'Open Prompt Generator' }}
							</button>
						</div>
						<div class="control-container" style=" flex: 1 1 0%;" :style="{ minWidth: settingsLanguage == 'cn' ? '130px' : '179px' }">
							<div>
								<span>{{ settingsLanguage == 'cn' ? 'ÂØºÂá∫ËÅäÂ§©ËÆ∞ÂΩï/Êó•Âøó' : 'Export Chat History / Logs' }}</span>
								<button  @click="showMiniHelp('A-ExportChatHistory')"  class="btn minibtn bluebtn btnzoom-b" style="margin-right: auto;" :title="settingsLanguage == 'cn' ? 'ÂäüËÉΩËØ¥Êòé' : 'Help'">?</button>
							</div>
							<select @change="changeSelectedExportChatHistory" :disabled="btnDisabledState_Export" class="dropdown" v-model="selectedExportChatHistory" style="width: 100%; height: 25px; margin: 2px 0px 4px;">
								<option value="">{{ settingsLanguage == 'cn' ? 'ÂΩìÂâçÂØπËØùID: #' + ( this.chatid == null ? '' : (this.chatid.toString().length > 18 ? (this.chatid.toString().slice(0, 18) + " ...") : this.chatid.toString().slice(0, 18))  ) : 'Current Chat ID: #' + ( this.chatid == null ? '' : (this.chatid.toString().length > 18 ? (this.chatid.toString().slice(0, 18) + " ...") : this.chatid.toString().slice(0, 18))  ) }}</option>
								<option disabled value="help1">{{ settingsLanguage == 'cn' ? ' - ÂØºÂá∫ÂΩìÂâçÂØπËØùÁöÑÊñáÊú¨ÂÜÖÂÆπ' : ' - Export the text content of the current chat' }}</option>
								<option v-if="settingsLanguage == 'cn'" v-for="option in selectedExportChatHistoryOptions_cn" :value="option.type">{{ option.label }}</option>
								<option v-else v-for="option in selectedExportChatHistoryOptions_en" :value="option.type">{{ option.label }}</option>
								<option v-if="!isSimpleMode" disabled value="help2">{{ settingsLanguage == 'cn' ? ' - ÂØºÂá∫‰∏∫Á∫ØÊñáÊú¨Ôºå‰∏çÂèØÁî®‰∫éÂØºÂÖ•' : ' - Export to Plain Text, Not available for import' }}</option>
								<option v-if="!isSimpleMode" disabled value="help3">{{ settingsLanguage == 'cn' ? ' - ÊñáÊú¨ÂÜÖÂÆπ‰ΩøÁî®MarkdownÊ†ºÂºè' : ' - Plain text is formatted using Markdown syntax' }}</option>
							</select>
						</div>
					</div>
				</div>

				<!-- panelgroup: Êï∞ÊçÆÁÆ°ÁêÜ‰∏éÈöêÁßÅ Data Privacy and Management. --> 
				<div class="panelgroup panelgroup-shadow">
					<div class="panelgroup-head">
						<span>{{ settingsLanguage == 'cn' ? 'Êï∞ÊçÆÁÆ°ÁêÜ‰∏éÈöêÁßÅ ' : 'Data Privacy and Management ' }}</span>
						<button  @click="showMiniHelp('A-DataPrivacyAndManagement')"  class="btn minibtn bluebtn btnzoom-b" :class="{ 'orangeredbtn': (isLocalStorageSupported && !isSimpleMode) ,'redbtn': !isLocalStorageSupported }" :style="{ marginRight: isLocalStorageSupported ? '2px' : '2px' }" :title="settingsLanguage == 'cn' ? 'ÂäüËÉΩËØ¥Êòé' : 'Help'">?</button>
						<span :style="{ color: isLocalStorageSupported ? '#f94000' : '#fa1e0a'}" style="display:block; margin-right: auto;font-size: 12px;">{{ isLocalStorageSupported ? ( isSimpleMode ? '' : (settingsLanguage == 'cn' ? 'Â∑≤ÂêØÁî®Ëá™Âä®‰øùÂ≠òÔºåÁî®Êà∑Êï∞ÊçÆ‰ªÖÂ≠òÂÇ®Âú®ÊµèËßàÂô®ÁöÑÁºìÂ≠ò‰∏≠' : "Autosave has been enabled. User data is stored solely in the browser's local storage.") ) : (settingsLanguage == 'cn' ? 'Ëá™Âä®‰øùÂ≠ò‰∏çÂèØÁî®ÔºåÂΩìÂâçÊµèËßàÂô®ÊàñÊµèËßàÂô®Ê®°Âºè‰∏çÊîØÊåÅ"ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®"' : 'Autosave is not available. LocalStorage is not supported in this browser or browser mode.') }}</span>
					</div>
					
					<div class="panelrow" style="align-items: start; height:auto;flex-wrap: wrap;justify-content: stretch;">
						<select @change="changeSelectedDeleteLocalStorageData" class="dropdown" v-model="selectedDeleteLocalStorageData" style="width: auto;height: 24px; flex: 1 1 0%; margin: 4px 3px 1px 0px;" :style="{ minWidth: settingsLanguage == 'cn' ? '71px' : '85px' }">
							<option value="">{{ settingsLanguage == 'cn' ? 'Âà†Èô§Êï∞ÊçÆ' : 'Delete Data' }}</option>
							<option v-if="!isSimpleMode" disabled value="help">{{ settingsLanguage == 'cn' ? ' - Ë∞®ÊÖéÊìç‰ΩúÔºåÊï∞ÊçÆÂà†Èô§‰∏çÂèØÈÄÜ' : ' - The deletion of data is irreversible' }}</option>
							<option v-if="settingsLanguage == 'cn'" v-for="option in selectedDeleteLocalStorageDataOptions_cn" :value="option.type">{{ option.label }}</option>
							<option v-else v-for="option in selectedDeleteLocalStorageDataOptions_en" :value="option.type">{{ option.label }}</option>
						</select>
						<select @change="changeSelectedExportLocalStorageData" :disabled="!isLocalStorageSupported" class="dropdown" v-model="selectedExportLocalStorageData" style="width: auto;height: 24px; flex: 1 1 0%; margin: 4px 3px 1px 3px;" :style="{ minWidth: settingsLanguage == 'cn' ? '86px' : '95px' }">
							<option value="">{{ settingsLanguage == 'cn' ? 'ÂØºÂá∫ (.json)' : 'Export (.json)' }}</option>
							<option v-if="!isSimpleMode" disabled value="help1">{{ settingsLanguage == 'cn' ? ' - ÂØºÂá∫ÁöÑJSONÊñá‰ª∂ÔºåÂèØÂÜçÊ¨°ÂØºÂÖ•Âà∞MCGPT' : ' - Export as JSON File for Re-import into MCGPT' }}</option>
							<option v-if="!isSimpleMode" disabled value="help2">{{ settingsLanguage == 'cn' ? ' - Áî®ÈÄîÔºöËøÅÁßªÊï∞ÊçÆ„ÄÅÂàÜ‰∫´Áªô‰ªñ‰∫∫„ÄÅÂ§á‰ªΩÊï∞ÊçÆ' : ' - Use: Data Transfer, Share with Others, Backup' }}</option>
							<option v-if="settingsLanguage == 'cn'" v-for="option in selectedExportLocalStorageDataOptions_cn" :value="option.type">{{ option.label }}</option>
							<option v-else v-for="option in selectedExportLocalStorageDataOptions_en" :value="option.type">{{ option.label }}</option>
							<option v-if="!isSimpleMode" disabled value="help3">{{ settingsLanguage == 'cn' ? ' - Âè™ÊÉ≥ÂØºÂá∫Âçï‰∏™ÂØπËØùÔºåËØ∑Âú®[ÂØπËØùÂàóË°®]‰∏≠ÁÇπÂáª[‚Ä¢‚Ä¢‚Ä¢]' : ' - To export a single chat, click [‚Ä¢‚Ä¢‚Ä¢] in [Chat List]' }}</option>
							<option v-if="!isSimpleMode" disabled value="help4">{{ settingsLanguage == 'cn' ? ' - ÊµèËßàÂô®ÂÖºÂÆπÊÄßÈóÆÈ¢ò‰ºöÂØºËá¥Â§±Ë¥•' : ' - Browser compatibility issues may cause failure' }}</option>
						</select>
						<button @click="importLocalStorageData" :disabled="!isLocalStorageSupported" class="btn" style="justify-content: start;width: auto;height: 24px; flex: 1 1 0%; margin: 4px 3px 1px 3px;" :style="{ minWidth: settingsLanguage == 'cn' ? '87px' : '98px' }">
							{{ settingsLanguage == 'cn' ? 'ÂØºÂÖ• (.json)' : 'Import (.json)' }}
						</button>
						<button  @click="getLocalStorageSize" :disabled="!isLocalStorageSupported" class="btn" style="padding: 0px 4px; height: 24px; line-height: 24px; margin: 4px 2px 1px 3px;min-width: 23px;" :title="settingsLanguage == 'cn' ? 'Áî®ÈáèÁªüËÆ°' : 'Usage statistics'">
							<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.2 7.8l-7.7 7.7-4-4-5.7 5.7"/><path d="M15 7h6v6"/>
							</svg>
						</button>
					</div>
				</div>
			
  
			<!-- End:  A: ‰∏ª‰ΩìÂÜÖÂÆπ content -->  
			</div>
			<!-- End:  A: ÊªöÂä®Ê°ÜÊû∂ scroll --> 
			</div>

			<!-- dialog-bottom -->
			<div class="dialog-bottom">
			</div>
		
	  	<!-- End:  A: dialog -->  
		</div>
	
		<!-- dialog-mask -->
		<div class="dialog-mask" @click="isShowDialog_Settings = false">
		</div>
	
	<!-- End:  dialog-wrapper A: ËÆæÁΩÆ Settings -->  
	</div>
 
 
 
	<!-- dialog-wrapper B: ÊèêÁ§∫ËØç Prompt Generator -->  
	<div id="dialog-promptgenerator" class="dialog-wrapper" v-show="isShowDialog_PromptGenerator">
		<!-- B: dialog -->  
		<div class="dialog" style="width: 95%;max-width: 800px; max-height: 680px;">
			<!-- B: Ê†áÈ¢ò header -->  
			<div class="dialog-header">
				<div class="dialog-title" >
					<svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0.6" stroke-linecap="round" stroke-linejoin="round">
						<path d="M19.7,23.5H4.3c-2.1,0-3.8-1.7-3.8-3.8V4.3c0-2.1,1.7-3.8,3.8-3.8h15.3c2.1,0,3.8,1.7,3.8,3.8v15.3    C23.5,21.8,21.8,23.5,19.7,23.5z M4.3,1.5c-1.6,0-2.8,1.3-2.8,2.8v15.3c0,1.6,1.3,2.8,2.8,2.8h15.3c1.6,0,2.8-1.3,2.8-2.8V4.3    c0-1.6-1.3-2.8-2.8-2.8H4.3z"/>
						<path d="M10.4,19.2H7.3c-0.3,0-0.5-0.2-0.5-0.5V5.3c0-0.3,0.2-0.5,0.5-0.5h9.3c0.3,0,0.5,0.2,0.5,0.5v8.5c0,0.3-0.2,0.5-0.5,0.5    h-5.7v4.4C10.9,19,10.7,19.2,10.4,19.2z M7.8,18.2h2.1v-4.4c0-0.3,0.2-0.5,0.5-0.5h5.7V5.8H7.8V18.2z M13.6,11.2h-3.2    c-0.3,0-0.5-0.2-0.5-0.5V8.4c0-0.3,0.2-0.5,0.5-0.5h3.2c0.3,0,0.5,0.2,0.5,0.5v2.3C14.1,11,13.9,11.2,13.6,11.2z M10.9,10.2h2.2    V8.9h-2.2V10.2z"/>
					</svg>
					{{ settingsLanguage == 'cn' ? '&nbsp;ÊèêÁ§∫ËØç&nbsp;' : '&nbsp;Prompt Generator&nbsp;' }}
					<button @click="changePromptGeneratorMaxWidth"  class="btn bluebtn" style="margin-right: 7px;width: 22px; padding: 0px 1px; height: 20px;" :title="settingsLanguage == 'cn' ? 'Êõ¥ÊîπÊúÄÂ§ßÂÆΩÂ∫¶' : 'Change Maximum Width'">
						<div>
							<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M9 21V9"/></svg>
						</div>
					</button>	
					<button @click="changePromptGeneratorLayout"  class="btn bluebtn" style="margin-right: auto;margin-left: 1px;width: 22px; padding: 0px 1px; height: 20px;" :title="settingsLanguage == 'cn' ? 'Êõ¥ÊîπÂ∏ÉÂ±Ä (ÈÄÇÁî®‰∫éÁßªÂä®ËÆæÂ§á)' : 'Change Layout (For Mobile)'">
						<div>
							<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M9 3v18"/></svg>
						</div>
					</button>		
				</div>
				<div class="dialog-close" @click="isShowDialog_PromptGenerator = false" :title="settingsLanguage == 'cn' ? 'ÂÖ≥Èó≠' : 'Close'">
					<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="fill: none; stroke: #333; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;">
						<path d="M6 18L18 6M6 6l12 12"></path>
					</svg>
				</div>
			</div>
			
	  		<!-- B: ÊªöÂä®Ê°ÜÊû∂ scroll -->
			<div class="dialog-scroll">
			<!-- B: ‰∏ª‰ΩìÂÜÖÂÆπ content -->  
			<div class="dialog-content" :style="styleDialogLayout">
		
				<!-- panelgroup: ÂΩìÂâçÁ≥ªÁªüÊèêÁ§∫ËØç  Current System Prompt --> 
				<div class="panelgroup">
					<div class="panelgroup-head">
						<span>{{ settingsLanguage == 'cn' ? 'ÂΩìÂâçÁ≥ªÁªüÊèêÁ§∫ËØç ( system prompt )' : 'Current System Prompt' }} </span>
						<button  @click="showMiniHelp('B-CurrentSystemPrompt')"  class="btn minibtn bluebtn btnzoom-b" style="margin-right: 4px;" :title="settingsLanguage == 'cn' ? 'ÂäüËÉΩËØ¥Êòé' : 'Help'">?</button>
						<span style="color:#f94000; display:block; margin-right: auto;font-size: 12px;">{{ settingsLanguage == 'cn' ? 'ÂØπËØùID: #' + ( this.chatid == null ? '' : (this.chatid.toString().length > 20 ? (this.chatid.toString().slice(0, 20) + " ...") : this.chatid.toString().slice(0, 20))  ) : 'Chat ID: #' + ( this.chatid == null ? '' : (this.chatid.toString().length > 20 ? (this.chatid.toString().slice(0, 20) + " ...") : this.chatid.toString().slice(0, 20))  ) }}</span>
					</div>
				
					<div class="panelrow" style="align-items: end; height:auto;flex-wrap: wrap;">
						<!-- Â§çÂà∂Âà∞ÁºñËæëÂå∫ --> 
						<button @click="copySystemPromptToEditor" class="btn" style="margin-left: 5px;">
							{{ settingsLanguage == 'cn' ? 'Â§çÂà∂Âà∞ÁºñËæëÊ°Ü' : 'Copy To Editor' }}
						</button>	
						<!-- Â±ïÂºÄ -->
						<button @click="changeElementHeight('textareaSPReadOnly')" class="btn bluebtn" style="width: 25px;padding: 0px 2px;margin: 0 5px;" :title="settingsLanguage == 'cn' ? 'Âø´ÈÄüÂàáÊç¢È´òÂ∫¶' : 'Quick Height Toggle'">
							<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 32 32" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
								<path d="m28,30l-24,0c-1.1,0 -2,-0.9 -2,-2l0,-24c0,-1.1 0.9,-2 2,-2l24,0c1.1,0 2,0.9 2,2l0,24c0,1.1 -0.9,2 -2,2z" id="svg_1"></path>
								<line id="svg_2" x1="20" x2="20" y1="2" y2="30"></line><polyline points="27,24 25,26 23,24 "></polyline><polyline points="23,8 25,6 27,8 "></polyline><line x1="6" x2="16" y1="9" y2="9"></line><line x1="6" x2="12" y1="13" y2="13"></line><line x1="6" x2="12" y1="17" y2="17"></line>
							</svg>
						</button>
						<!-- Êç¢Ë°åËßÜÂõæ -->
						<button @click="changeElementLineBreak('textareaSPReadOnly')" class="btn bluebtn" style="margin-right: auto;width: 25px;padding: 0px 2px;" :title="settingsLanguage == 'cn' ? 'Êõ¥ÊîπÊç¢Ë°åÊ®°Âºè' : 'Change Wrap Mode'">
							<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 32 32" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
								<path d="m2,28l0,-24c0,-1.1 0.9,-2 2,-2l24,0c1.1,0 2,0.9 2,2l0,24c0,1.1 -0.9,2 -2,2l-24,0c-1.1,0 -2,-0.9 -2,-2z" id="svg_1"/></path>
								<line x1="30" x2="2" y1="20" y2="20"/></line><polyline points="8,27 6,25 8,23 "/></polyline><polyline points="24,23 26,25 24,27 "/></polyline><line x1="6" x2="16" y1="9" y2="9"/></line><line x1="6" x2="12" y1="13" y2="13"/></line>
							</svg>
						</button>	
						<!-- ‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ   Cpoy Button --> 
						<button class="copybtn" data-clipboard-nextelementsibling="" style="opacity: 1;position: relative;flex-shrink: 0;top: auto;right: auto;margin:0 5px 0 0 ;" :title="settingsLanguage == 'cn' ? '‰∏ÄÈîÆÂ§çÂà∂' : 'One-Click Copy'">
							<div>
								<svg width="14" height="17" class="clippy" fill="currentColor">
									<path d="m2.36373,12.61912l4.12233,0l0,1.03058l-4.12233,0l0,-1.03058zm5.15291,-6.18349l-5.15291,0l0,1.03058l5.15291,0l0,-1.03058zm2.06116,3.09174l0,-2.06116l-3.09174,3.09174l3.09174,3.09174l0,-2.06116l5.15291,0l0,-2.06116l-5.15291,0zm-4.63761,-1.03058l-2.57645,0l0,1.03058l2.57645,0l0,-1.03058zm-2.57645,3.09174l2.57645,0l0,-1.03058l-2.57645,0l0,1.03058zm9.27523,1.03058l1.03058,0l0,2.06116c-0.0161,0.28985 -0.11272,0.53139 -0.30595,0.72463s-0.43478,0.28985 -0.72463,0.30595l-10.30581,0c-0.5636,0 -1.03058,-0.46698 -1.03058,-1.03058l0,-11.33639c0,-0.5636 0.46698,-1.03058 1.03058,-1.03058l3.09175,0c0,-1.1433 0.91786,-2.06116 2.06116,-2.06116s2.06116,0.91786 2.06116,2.06116l3.09174,0c0.5636,0 1.03058,0.46698 1.03058,1.03058l0,5.15291l-1.03058,0l0,-3.09174l-10.30581,0l0,9.27523l10.30581,0l0,-2.06116zm-9.27523,-8.24465l8.24465,0c0,-0.5636 -0.46698,-1.03058 -1.03058,-1.03058l-1.03058,0c-0.5636,0 -1.03058,-0.46698 -1.03058,-1.03058s-0.46698,-1.03058 -1.03058,-1.03058s-1.03058,0.46698 -1.03058,1.03058s-0.46698,1.03058 -1.03058,1.03058l-1.03058,0c-0.5636,0 -1.03058,0.46698 -1.03058,1.03058z">
									</path>
								</svg>
							</div>
						</button> 
				 
						<!-- ËæìÂÖ•Ê°Ü(Âè™ËØª) - ÂΩìÂâçÁ≥ªÁªüÊèêÁ§∫ËØç --> 
						<textarea readonly v-model="gptSystemPromptReadOnly"  type="text"  class="dh-input textareaSPReadOnly" style="flex: 0 0 100%;margin: 4px 0 0 0;height:100px;min-height:80px;max-height: 1000px;" placeholder=""></textarea>		
					</div>
				</div>			
			
				<!-- panelgroup: ÊèêÁ§∫ËØçÁºñËæëÂå∫  Edit Prompts -->
				<div class="panelgroup">
					<div class="panelgroup-head">
						<span>{{ settingsLanguage == 'cn' ? 'ÊèêÁ§∫ËØçÁºñËæëÂå∫' : 'Prompt Editor' }}</span>
						<button  @click="showMiniHelp('B-PromptEditor')"  class="btn minibtn bluebtn btnzoom-b" style="margin-right: auto;" :title="settingsLanguage == 'cn' ? 'ÂäüËÉΩËØ¥Êòé' : 'Help'">?</button>
					</div>
				
					<div class="panelrow" style="align-items: end; height:auto;flex-wrap: wrap;">
						<!-- ‰øùÂ≠ò‰∏∫Á≥ªÁªüÊèêÁ§∫ËØç Êõ¥Êñ∞Á≥ªÁªüÊèêÁ§∫ËØç --> 
						<button @click="setSystemPrompt" :disabled="btnDisabledState_SetSystemPrompt" class="btn" style="margin-left: 5px;"  >
							{{ settingsLanguage == 'cn' ? '‰øùÂ≠ò‰∏∫Á≥ªÁªüÊèêÁ§∫ËØç' : 'Save as System Prompt' }}
						</button>
					
						<!-- Â±ïÂºÄ --> 
						<button @click="changeElementHeight('textareasystemprompt')" class="btn bluebtn" style="width: 25px;padding: 0px 2px;margin: 0 5px;" :title="settingsLanguage == 'cn' ? 'Âø´ÈÄüÂàáÊç¢È´òÂ∫¶' : 'Quick Height Toggle'">
							<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 32 32" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
								<path d="m28,30l-24,0c-1.1,0 -2,-0.9 -2,-2l0,-24c0,-1.1 0.9,-2 2,-2l24,0c1.1,0 2,0.9 2,2l0,24c0,1.1 -0.9,2 -2,2z" id="svg_1"></path>
								<line id="svg_2" x1="20" x2="20" y1="2" y2="30"></line><polyline points="27,24 25,26 23,24 "></polyline><polyline points="23,8 25,6 27,8 "></polyline><line x1="6" x2="16" y1="9" y2="9"></line><line x1="6" x2="12" y1="13" y2="13"></line><line x1="6" x2="12" y1="17" y2="17"></line>
							</svg>
						</button>
						<!-- Êç¢Ë°åËßÜÂõæ --> 
						<button @click="changeElementLineBreak('textareasystemprompt')" class="btn bluebtn" style="margin-right: auto;width: 25px;padding: 0px 2px;" :title="settingsLanguage == 'cn' ? 'Êõ¥ÊîπÊç¢Ë°åÊ®°Âºè' : 'Change Wrap Mode'">
							<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 32 32" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
								<path d="m2,28l0,-24c0,-1.1 0.9,-2 2,-2l24,0c1.1,0 2,0.9 2,2l0,24c0,1.1 -0.9,2 -2,2l-24,0c-1.1,0 -2,-0.9 -2,-2z" id="svg_1"/></path>
								<line x1="30" x2="2" y1="20" y2="20"/></line><polyline points="8,27 6,25 8,23 "/></polyline><polyline points="24,23 26,25 24,27 "/></polyline><line x1="6" x2="16" y1="9" y2="9"/></line><line x1="6" x2="12" y1="13" y2="13"/></line>
							</svg>
						</button>	
						<!-- ‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ   Cpoy Button --> 
						<button class="copybtn" data-clipboard-nextelementsibling="" style="opacity: 1;position: relative;flex-shrink: 0;top: auto;right: auto;margin:0 5px 0 0 ;" :title="settingsLanguage == 'cn' ? '‰∏ÄÈîÆÂ§çÂà∂' : 'One-Click Copy'">
							<div>
								<svg width="14" height="17" class="clippy" fill="currentColor">
									<path d="m2.36373,12.61912l4.12233,0l0,1.03058l-4.12233,0l0,-1.03058zm5.15291,-6.18349l-5.15291,0l0,1.03058l5.15291,0l0,-1.03058zm2.06116,3.09174l0,-2.06116l-3.09174,3.09174l3.09174,3.09174l0,-2.06116l5.15291,0l0,-2.06116l-5.15291,0zm-4.63761,-1.03058l-2.57645,0l0,1.03058l2.57645,0l0,-1.03058zm-2.57645,3.09174l2.57645,0l0,-1.03058l-2.57645,0l0,1.03058zm9.27523,1.03058l1.03058,0l0,2.06116c-0.0161,0.28985 -0.11272,0.53139 -0.30595,0.72463s-0.43478,0.28985 -0.72463,0.30595l-10.30581,0c-0.5636,0 -1.03058,-0.46698 -1.03058,-1.03058l0,-11.33639c0,-0.5636 0.46698,-1.03058 1.03058,-1.03058l3.09175,0c0,-1.1433 0.91786,-2.06116 2.06116,-2.06116s2.06116,0.91786 2.06116,2.06116l3.09174,0c0.5636,0 1.03058,0.46698 1.03058,1.03058l0,5.15291l-1.03058,0l0,-3.09174l-10.30581,0l0,9.27523l10.30581,0l0,-2.06116zm-9.27523,-8.24465l8.24465,0c0,-0.5636 -0.46698,-1.03058 -1.03058,-1.03058l-1.03058,0c-0.5636,0 -1.03058,-0.46698 -1.03058,-1.03058s-0.46698,-1.03058 -1.03058,-1.03058s-1.03058,0.46698 -1.03058,1.03058s-0.46698,1.03058 -1.03058,1.03058l-1.03058,0c-0.5636,0 -1.03058,0.46698 -1.03058,1.03058z">
									</path>
								</svg>
							</div>
						</button>
					
						<!-- ËæìÂÖ•Ê°Ü - ÁºñËæëÊèêÁ§∫ËØç --> 
						<textarea @input="btnDisabledState_SetSystemPrompt=false;" v-model="gptSystemPrompt"  type="text"  class="dh-input textareasystemprompt" style="flex: 0 0 100%;margin: 4px 0 0 0;height:100px;min-height:80px;max-height: 1000px;" :placeholder=" settingsLanguage == 'cn' ? 'ËæìÂÖ•ÊèêÁ§∫ËØçÔºå‰øùÂ≠òÂêéÁîüÊïà„ÄÇÂ¶ÇÈúÄÂèñÊ∂àÁ≥ªÁªüÊèêÁ§∫ËØçÔºåËØ∑Ê∏ÖÁ©∫ËæìÂÖ•Ê°ÜÂêéÁÇπ‰øùÂ≠ò„ÄÇ' : 'Input prompt: Changes will take effect after saving. To cancel system prompt, clear the input field and save.' " ></textarea>		
					</div>
				</div>
 
 
	
			<!-- End:  B: ‰∏ª‰ΩìÂÜÖÂÆπ content -->  
			</div>
			<!-- End:  B: ÊªöÂä®Ê°ÜÊû∂ scroll --> 
			</div>
			
			<!-- dialog-bottom -->
			<div class="dialog-bottom">
			</div>
			
	  	<!-- End:  B: dialog -->  
		</div>
	
		<!-- dialog-mask -->
		<div class="dialog-mask" @click="isShowDialog_PromptGenerator = false">
		</div>
	
	<!-- End:  dialog-wrapper B: ËÆæÁΩÆ Settings -->  
	</div>



	<!-- dialog-wrapper C: ÂØπËØùÂàóË°® Chat List -->  
	<div id="dialog-ChatList" class="dialog-wrapper" v-show="isShowDialog_ChatList">
		<!-- C: dialog -->  
		<div class="dialog" style="max-width: 430px;width: 95%;max-height: 720px;background-color: rgb(237, 237, 237);">
			<!-- C: Ê†áÈ¢ò header -->  
			<div class="dialog-header">
				<div class="dialog-title" style="width: calc(95% - 35px);">
					<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
					</svg>
					{{ settingsLanguage == 'cn' ? '&nbsp;ÂØπËØùÂàóË°®&nbsp;' : '&nbsp;Chat List&nbsp;' }}
					<button @click="showMiniHelp('C-ChatList')"  class="btn minibtn bluebtn btnzoom-b" style="margin-right: 8px;" :title="settingsLanguage == 'cn' ? 'ÂäüËÉΩËØ¥Êòé' : 'Help'">?</button>	
					<button @click="changeChatListMaxWidth"  class="btn bluebtn" style="margin-right: 8px;width: 22px; padding: 0px 1px; height: 20px;" :title="settingsLanguage == 'cn' ? 'Êõ¥ÊîπÊúÄÂ§ßÂÆΩÂ∫¶' : 'Change Maximum Width'">
						<div>
							<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M9 21V9"/></svg>
						</div>
					</button>
					<button @click="changeChatListTransparent"  class="btn bluebtn" style="margin-right: auto;width: 22px; padding: 0px 1px; height: 20px;" :title="settingsLanguage == 'cn' ? 'Êõ¥ÊîπÈÄèÊòéÂ∫¶' : 'Change Transparency'">
						<div>
							<svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
						</div>
					</button>
					<button @click="chatList_addNewChatData(false)" class="btn" style="width: auto; padding: 0px 8px; height: 20px; line-height: 20px; border-radius: 5px; font-size: 13px; margin-left: 8px; margin-right: 10px;">
						<div>
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3h18v18H3zM12 8v8m-4-4h8"/>
							</svg>
						</div>
						{{ settingsLanguage == 'cn' ? '&nbsp;Êñ∞ÂØπËØù&nbsp;' : '&nbsp;New Chat' }}	
					</button>
				</div>
				<div class="dialog-close" @click="isShowDialog_ChatList = false" :title="settingsLanguage == 'cn' ? 'ÂÖ≥Èó≠' : 'Close'">
					<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="fill: none; stroke: #333; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;">
						<path d="M6 18L18 6M6 6l12 12"></path>
					</svg>
				</div>
			</div>

			<!-- C: ÊªöÂä®Ê°ÜÊû∂ scroll -->
			<div class="dialog-scroll">
			<!-- C: ‰∏ª‰ΩìÂÜÖÂÆπ content -->  
			<div class="dialog-content">
		
				<!-- panelgroup: Âçï‰∏™ÂØπËØù Chat Data --> 
				<div class="panelgroup" v-for="chatdata in chatDataList" :key="chatdata.chatcreatedtime" @click="chatList_ClickChatData(chatdata)" :class="{'panelgroup-chatdata-selected': (chatdata.chatcreatedtime === selectedChatData.chatcreatedtime && !isChatListTransparent) ,'panelgroup-chatdata-selected-transparent':  (chatdata.chatcreatedtime === selectedChatData.chatcreatedtime && isChatListTransparent) }">
					<div class="panelgroup-head">
						<!--  ÂØπËØùÂàõÂª∫Êó∂Èó¥ Chat Creation Time -->
						<span style="margin-right: auto;" :style="{ color: isChatListTransparent ? 'rgba(204, 204, 204, 0.3)' : '#444444' }" >{{ (settingsLanguage == 'cn' ? 'ÂàõÂª∫Êó∂Èó¥: ' : 'Creation Date: ') +  (chatdata.chatcreatedtime === null ? (settingsLanguage == 'cn' ? 'Êñ∞ÂØπËØù' : 'New Chat') : (chatdata.chatcreatedtime.startsWith(current_Year) ? chatdata.chatcreatedtime.slice(5) : chatdata.chatcreatedtime) ) }}</span>
						<!--  Âç†Áî®Â≠òÂÇ®Á©∫Èó¥Â§ßÂ∞è Storage Usage  *ÂèØËÄÉËôëÂ¢ûÂä†ÊòæÁ§∫Êù°‰ª∂Ôºö display none - this.isLocalStorageAllowed && this.isLocalStorageSupported -->
						<button class="btn minibtn" style="display: flex;width: auto; height: 16px; padding: 0px;margin-right: 0px; border-radius: 4px;cursor:auto;border: none !important; background: none !important;" :style="{ color: isChatListTransparent ? 'rgba(204, 204, 204, 0.3)' : '#444444' , display: chatdata.chatcreatedtime === null ? 'none' : 'flex' }" :title="settingsLanguage == 'cn' ? 'Âç†Áî®Â≠òÂÇ®Á©∫Èó¥Â§ßÂ∞è' : 'Storage Usage'">
							<svg xmlns="http://www.w3.org/2000/svg" width="12" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>
							</svg>
							<span :style="{ color: isChatListTransparent ? 'rgba(204, 204, 204, 0.3)' : '#444444' }" >{{ (JSON.stringify(chatdata).length * 2 / 1024 / 1024).toFixed(2)}} MB</span>
						</button>
						<!--  goto Top -->
						<button @click="gotoTop" class="btn minibtn btnzoom-c" :style="{ display:  (chatdata.chatcreatedtime === null || chatdata.chatcreatedtime !== selectedChatData.chatcreatedtime)  ? 'none' : 'flex'}"  style="width: 18px; height: 16px; padding: 0px; border-radius: 4px;" :title="settingsLanguage == 'cn' ? 'ÊªöÂä®Âà∞È°∂ÈÉ®' : 'Scroll to Top'">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 11l-5-5-5 5M17 18l-5-5-5 5"/>
							</svg>
						</button>
						<!--  goto Bottom  -->
						<button @click="gotoBottom" class="btn minibtn btnzoom-c" :style="{ display:  (chatdata.chatcreatedtime === null || chatdata.chatcreatedtime !== selectedChatData.chatcreatedtime)  ? 'none' : 'flex'}" style="width: 18px; height: 16px; padding: 0px; border-radius: 4px;margin-left: 1px;" :title="settingsLanguage == 'cn' ? 'ÊªöÂä®Âà∞Â∫ïÈÉ®' : 'Scroll to Bottom'">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 13l5 5 5-5M7 6l5 5 5-5"/>
							</svg>
						</button>
						<!--  Êõ¥Â§öÈÄâÈ°π More Options -->
						<select @change="changeSelectedChatListMoreOptions(chatdata)" class="dropdown minibtn minibtn-default btnzoom-c" v-model="selectedChatListMoreOptions" :style="{ display: chatdata.chatcreatedtime === null  ? 'none' : 'block' }" style="width:31px;" :title="settingsLanguage == 'cn' ? 'Êõ¥Â§öÈÄâÈ°π' : 'More Options'">
								<option value="">‚Ä¢‚Ä¢‚Ä¢</option>
								<option v-if="settingsLanguage == 'cn'" v-for="option in selectedChatListMoreOptions_Options_cn" :value="option.op">{{ option.label }}</option>
								<option v-else v-for="option in selectedChatListMoreOptions_Options_en" :value="option.op">{{ option.label }}</option>
								<option value="EraseLogs">5) {{ ( settingsLanguage == 'cn' ? 'ÊäπÊéâÊó•Âøó(MarkdownÊ†ºÂºè, ‚âà' : 'Erase logs (Markdown, ‚âà' ) + (chatdata.chatVariables.chathistory.length * 2 / 1024 / 1024).toFixed(2) + 'MB)' }}</option>
						</select>
						<!--  Âà†Èô§ delete -->
						<button @click="deleteChatData(chatdata)" class="btn minibtn redbtn btnzoom-c" style="display: flex; width: 16px; height: 16px; padding: 0px; border-radius: 4px;" :title="settingsLanguage == 'cn' ? 'Âà†Èô§ÂØπËØù' : 'Delete Chat'">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line>
							</svg>
						</button>
					</div>
				
					<div class="panelrow" style="align-items: end; height:auto;flex-wrap: wrap;">
						<!-- ID   *old::: background: linear-gradient(to bottom, #fcfcfc, #f0f0f0) !important;  -->
						<button @click="chatList_EditChatID(chatdata)" class="btn btnzoom-c" style="width: auto;padding: 0px 8px; background: none !important; color: #1aad19 !important;" :style="{ border: isChatListTransparent ? '1px solid rgba(221, 221, 221, 0.3) !important' : '1px solid #DDD !important' }" :title="settingsLanguage == 'cn' ? 'ÂØπËØùID' : 'Chat ID'">
							<div>
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>
								</svg>
							</div>
							<span style="color: #1aad19;font-size: 13px;">&nbsp;{{ chatdata.chatid }}</span>
						</button>
						<!-- ‰∏äÊ¨°Ê¥ªÂä®Êó∂Èó¥ Last Activity Time -->
						<button disabled class="btn" style="margin-right: auto;width: auto;padding: 0px 8px;cursor:auto;border: none !important; background: none !important;" :style="{ display: chatdata.chatcreatedtime === null  ? 'none' : 'flex'}">
							<div>
								<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
								</svg>
							</div>
							<span :style="{ color: isChatListTransparent ? 'rgba(204, 204, 204, 0.3)' : '#444444' }" >&nbsp;{{ (settingsLanguage == 'cn' ? '‰∏äÊ¨°Ê¥ªÂä®Êó∂Èó¥: ' : 'Last Activity Time: ') + (chatdata.chatlasttime === null ? (settingsLanguage == 'cn' ? 'Êñ∞ÂØπËØù' : 'New Chat') :  (chatdata.chatlasttime.startsWith(current_Year) ? chatdata.chatlasttime.slice(5) : chatdata.chatlasttime) ) }}</span>
						</button>
					</div>		
							
					<div class="panelrow" style="align-items: end; height:auto;flex-wrap: wrap;">
						<!-- Ê†áÈ¢ò Â§áÊ≥® ÊèèËø∞ Title -->
						<button @click="chatList_EditChatTitle(chatdata)" class="btn btnzoom-c" style="width: auto;padding: 0px 8px; background: none !important; color: #1aad19 !important;" :style="{ border: isChatListTransparent ? '1px solid rgba(221, 221, 221, 0.3) !important' : '1px solid #DDD !important' }" :title="settingsLanguage == 'cn' ? 'ÂØπËØùÊ†áÈ¢ò / ÊèèËø∞' : 'Chat Title / Description'">
							<div>
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"></path><polygon points="18 2 22 6 12 16 8 16 8 12 18 2"></polygon>
								</svg>
							</div>
							<span :style="{ color: isChatListTransparent ? 'rgba(204, 204, 204, 0.3)' : (chatdata.chattitle == '' ? '#cccccc' : '#444444') }">&nbsp;{{ chatdata.chattitle == '' ? (settingsLanguage == 'cn' ? 'Â∞öÊú™ÂÜôÊèèËø∞' : 'No description yet.') : chatdata.chattitle }}</span>
						</button>
					</div>
				</div>
				
				
			<!-- End:  C: ‰∏ª‰ΩìÂÜÖÂÆπ content -->  
			</div>
			<!-- End:  C: ÊªöÂä®Ê°ÜÊû∂ scroll --> 
			</div>

			<!-- dialog-bottom -->
			<div class="dialog-bottom">
			</div>
			
	  	<!-- End:  C: dialog -->  
		</div>
	
		<!-- dialog-mask -->
		<div class="dialog-mask" @click="isShowDialog_ChatList = false">
		</div>
	
	<!-- End:  dialog-wrapper C: ÂØπËØùÂàóË°® Chat List -->  
	</div>



	<!-- dialog-wrapper D: ËΩÆËØ¢ / Ëá™Âä®ËΩÆÊç¢API Key / Auto Key Rotation / Auto Key Rotation Management-->  
	<div id="dialog-AutoKeyRotation" class="dialog-wrapper" v-show="isShowDialog_AutoKeyRotation">
		<!-- D: dialog -->  
		<div class="dialog" style="max-width: 520px;width: 90%;max-height: 720px;background-color: rgb(237, 237, 237);">
			<!-- D: Ê†áÈ¢ò header -->  
			<div class="dialog-header">
				<div class="dialog-title" style="width: calc(95% - 35px);">
					<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
					</svg>
					{{ !isThirdPartyAPIKeyEnabled ? (settingsLanguage == 'cn' ? '&nbsp;Ëá™Âä®ËΩÆÊç¢API Key&nbsp;' : '&nbsp;Auto Key Rotation&nbsp;') : (settingsLanguage == 'cn' ? '&nbsp;Á¨¨‰∏âÊñπÂçïKeyÊ®°Âºè&nbsp;' : '&nbsp;3rd party Key Mode&nbsp;') }}
					<button @click="showMiniHelp('D-AutoKeyRotation')"  class="btn minibtn bluebtn btnzoom-b" style="margin-right: 8px;" :title="settingsLanguage == 'cn' ? 'ÂäüËÉΩËØ¥Êòé' : 'Help'">?</button>	
					<button @click="changeAutoKeyRotationSorted"  class="btn bluebtn" style="margin-right: auto;width: 22px; padding: 0px 1px; height: 20px;" :title="settingsLanguage == 'cn' ? '‰∏âÁßçÊéíÂ∫èÊñπÂºè‰ª•‰æõÊü•Áúã' : 'Three ways to sort for viewing'">
						<div>
							<svg xmlns="http://www.w3.org/2000/svg" width="19" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M7 20h2V8h3L8 4 4 8h3zm13-4h-3V4h-2v12h-3l4 4z"/>
							</svg>
						</div>
					</button>
					<button @click="autoKeyRotation_BulkAdd" class="btn" :style="{ display: isThirdPartyAPIKeyEnabled ? 'none' : 'flex' }"  style="width: auto; padding: 0px 8px; height: 20px; line-height: 20px; border-radius: px; font-size: 13px; margin-left: 8px; margin-right: 10px;">
						<div>
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line>
							</svg>
						</div>
						{{ settingsLanguage == 'cn' ? '&nbsp;ÊâπÈáèÊ∑ªÂä†&nbsp;' : '&nbsp;Bulk Add' }}	
					</button>
				</div>
				<div class="dialog-close" @click="isShowDialog_AutoKeyRotation = false" :title="settingsLanguage == 'cn' ? 'ÂÖ≥Èó≠' : 'Close'">
					<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="fill: none; stroke: #333; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;">
						<path d="M6 18L18 6M6 6l12 12"></path>
					</svg>
				</div>
			</div>

			<!-- D: ÊªöÂä®Ê°ÜÊû∂ scroll -->
			<div class="dialog-scroll">
			<!-- D: ‰∏ª‰ΩìÂÜÖÂÆπ content -->  
			<div class="dialog-content">
    
				<!-- panelgroup:  -->
				<div class="panelgroup" style="margin-bottom: 4px;margin-top: -10px;box-shadow: none;" >
					<div class="panelgroup-head" style="display: none;">
						<span>{{ settingsLanguage == 'cn' ? 'API KeyÁ±ªÂûã' : 'API Key Types' }}</span>
					</div>
					<div class="panelrow" style="color: #444444;font-size: 13px;align-items: end; height:auto;flex-wrap: wrap;justify-content: start;">
						<label style="margin-right: 24px;">
							<input type="radio" @change="changeIsThirdPartyAPIKeyEnabled" :disabled="btnDisabledState_KeyMode" v-model="isThirdPartyAPIKeyEnabled" :value="false">
							{{ (settingsLanguage == 'cn' ? '‰ΩøÁî® OpenAI ÂÆòÊñπKey' : 'Use OpenAI API Keys') + ' (' + apiCheckedData.filter(data => data.vpn !== 'third-party').length + ')' }}
						</label>
						<label>
							<input type="radio" @change="changeIsThirdPartyAPIKeyEnabled" :disabled="btnDisabledState_KeyMode" v-model="isThirdPartyAPIKeyEnabled" :value="true">
							{{ (settingsLanguage == 'cn' ? '‰ΩøÁî®Á¨¨‰∏âÊñπ‰ª£ÁêÜ‰∏ìÁî®Key' : 'Use Third-party Key')  + ' (' + apiCheckedData.filter(data => data.vpn === 'third-party').length + ')' }}
						</label>
					</div>
					<div class="panelrow" :style="{ display: isThirdPartyAPIKeyEnabled ? 'block' : 'none' }"  style="line-height: 14px;align-items: end; height:auto;flex-wrap: wrap;">
						<span style="color: #f94000;font-size: 11px;">
							{{ settingsLanguage == 'cn' ? ' TipsÔºö1) ÂΩìÂâç‰∏∫ÂçïKeyÊ®°ÂºèÔºåËØ∑Âú®‰∏ãÊñπÈÄâÊã©Á¨¨‰∏âÊñπÊé•Âè£ÁöÑ‰∏ìÁî®KeyÔºõ2) Â¶Ç‰ΩïÊ∑ªÂä†Á¨¨‰∏âÊñπKeyÔºü‰ªÖÊîØÊåÅÂú® [ËÆæÁΩÆ] ‰∏≠ÈÄê‰∏™Ê∑ªÂä†ÔºåËØ∑ÂÖàÂú® [Êõ¥Â§ö] > [API‰∏ì‰∏öËÆæÁΩÆ] > [Êé•Âè£ÁΩëÂùÄ] ‰∏≠ËÆæÁΩÆÁ¨¨‰∏âÊñπÊé•Âè£ÁöÑURLÔºåÁÑ∂ÂêéÂÜçÈ™åËØÅKeyÔºåÈÄöËøáÂêéÔºåÊ∑ªÂä†ÊàêÂäü„ÄÇ  ' : ' Tips: 1) Currently in single-key mode, please select the key for the third-party API below.  2) How to add a third-party key? Only one key can be added at a time. First, modify [Settings] > [API URL] to the third-party API Endpoint. Then, fill in and check the third-party key.  ' }}
						</span>
						<a :href="settingsLanguage == 'cn' ? 'https://lin2025.github.io/img/MCGPT-sample01-cn.png' : 'https://lin2025.github.io/img/MCGPT-sample01-en.png' " 
							:style="{ display: apiCheckedData.filter(data => data.vpn === 'third-party').length < 2 ? 'inline' : 'none' }" target="_blank" style="font-size: 11px;">
						{{ settingsLanguage == 'cn' ? 'Êü•ÁúãÁ§∫‰æã (Âõæ)' : 'View Sample (pic)' }}
						</a>
					</div>
					<div class="panelrow" :style="{ display: !isThirdPartyAPIKeyEnabled && !apiGPTModel.includes('gpt-4') ? 'block' : 'none' }"  style="line-height: 14px;align-items: end; height:auto;flex-wrap: wrap;">
						<span style="color: #f94000;font-size: 11px;">
							{{ settingsLanguage == 'cn' ? ' TipsÔºö1) Ê≠§Ê®°Âºè‰ªÖÊîØÊåÅOpenAIÂÆòÊñπKeyÔºåËØ∑‰ΩøÁî®ÂÆòÊñπÊé•Âè£ÊàñÊîØÊåÅÂÆòÊñπKeyÁöÑÁ¨¨‰∏âÊñπÊé•Âè£(Âèç‰ª£); 2) ÊîØÊåÅGPT-4ÁöÑÊ†áÁ≠æÊòØËá™Âä®Ê†áËÆ∞ÁöÑ; 3) API Key‰ºöËá™Âä®ÂàÜÁ±ªÔºåÂØπ‰∫éÊó†Ê≥ïÊ≠£Á°ÆËØÜÂà´ÁöÑÁ¨¨‰∏âÊñπKeyÔºåÂèØ‰ª•ÁÇπÂáª[Á∫ßÂà´]ËæìÂÖ•"333"ËøõË°å‰øÆÊ≠£„ÄÇ' : ' Tips: 1) This mode only supports OpenAI API Keys, please use OpenAI API or Third-party APIs that support OpenAI keys.  2) Automatic tagging of GPT-4.  3) API Keys are automatically categorized. If a Third-party key is not recognized correctly, click [Level] to modify it.' }}
						</span>
					</div>
					<div class="panelrow" :style="{ display: !isThirdPartyAPIKeyEnabled && apiGPTModel.includes('gpt-4') ? 'block' : 'none' }"  style="line-height: 14px;align-items: end; height:auto;flex-wrap: wrap;">
						<span style="color: #f94000;font-size: 11px;">
							{{ settingsLanguage == 'cn' ? ' TipsÔºö1) GPT-4Ê†áÁ≠æ‰∏∫Ëá™Âä®Ê†áËÆ∞ÔºåÊó†Ê≥ïÊâãÂä®Ê∑ªÂä†Êàñ‰øÆÊîπ„ÄÇ2) Â¶Ç‰ΩïÈáçÊñ∞Ê£ÄÊµãGPT-4ÊùÉÈôêÔºü‚ë†ÊâãÂä®‰øÆÊîπ[Á∫ßÂà´]‰∏∫0 (‰ªòË¥πË¥¶Âè∑)ÔºåÂÖÅËÆ∏KeyËøõÂÖ•GPT-4Ê±†Âπ∂È™åËØÅÊùÉÈôê„ÄÇ‚ë°Âú®[ËÆæÁΩÆ]‰∏≠ÈÄâÊã©Êã•ÊúâÊùÉÈôêÁöÑGPT-4Ê®°Âûã„ÄÇ‚ë¢ËøõË°åÂá†Ê¨°ÂØπËØù„ÄÇ‚ë£ÂΩìÁÑ∂Ôºå‰πüÂèØ‰ª•Áõ¥Êé•Âà†Èô§KeyÂêéÈáçÊñ∞Ê∑ªÂä†Âπ∂‰ΩøÁî®GPT-4Ê®°ÂûãÈ™åËØÅ„ÄÇ' : ' Tips: 1) GPT-4 tags are automatically assigned and cannot be manually added or modified.  2) How to retest GPT-4 permissions for a regular Key: ‚ë† Set the [Level] to 0 (Paid Account) to allow calling and verified. ‚ë° Choose the authorized GPT-4 model in [Settings]. ‚ë¢ Start chatting. (*Alternatively, you can delete and re-add the Key to validate using the GPT-4 model.)' }}
						</span>
					</div>
				</div>
				
				<!-- panelgroup: ÊâπÈáèÊ∑ªÂä† Bulk Add -->
				<div class="panelgroup" :style="{ display: isShowBulkAddPanel_AutoKeyRotation && !isThirdPartyAPIKeyEnabled ? 'block' : 'none' }" style="margin-bottom: 18px;" >
					<div class="panelgroup-head">
						<span>{{ settingsLanguage == 'cn' ? 'ÊâπÈáèÊ∑ªÂä† OpenAI API Key' : 'Bulk Add OpenAI API Keys' }}</span>
					</div>
				
					<div class="panelrow" style="align-items: end; height:auto;flex-wrap: wrap;">
						<!-- Êèê‰∫§ --> 
						<button @click="submitBulkApiKeys(true,true,null)" class="btn" style="margin-left: 5px;"  >
							{{ settingsLanguage == 'cn' ? 'Êèê‰∫§' : 'Submit' }}
						</button>
						<!-- ÂèñÊ∂à --> 
						<button @click="isShowBulkAddPanel_AutoKeyRotation = false" class="btn redbtn" style="margin-left: 5px;margin-right: auto;"  >
							{{ settingsLanguage == 'cn' ? 'ÂèñÊ∂à' : 'Cancel' }}
						</button>
					
						<!-- ËæìÂÖ•Ê°Ü --> 
						<textarea type="text" class="dh-input textareabulkaddapikey" style="font-size: 13px;flex: 0 0 100%;margin: 4px 0 0 0;height:108px;min-height:55px;max-height: 500px;white-space: pre;" :placeholder=" settingsLanguage == 'cn' ? 'ËæìÂÖ•‰ª• &quot;sk-&quot; ÂºÄÂ§¥ÁöÑ API KeyÔºåÊØèË°å‰∏Ä‰∏™„ÄÇ' : 'Enter API Keys starting with &quot;sk-&quot; , one per line.' " ></textarea>		
					</div>
				</div>
		
				<!-- panelgroup: apidata --> 
				<div class="panelgroup" v-for="apidata in apiCheckedData" :key="apidata.apikey"  :style="{ display: (isThirdPartyAPIKeyEnabled && apidata.vpn === 'third-party') || (!isThirdPartyAPIKeyEnabled && apidata.vpn !== 'third-party') ? 'block' : 'none' }" >
					<div class="panelgroup-head">
						<!--  ÊúÄËøëÊõ¥Êñ∞Êó∂Èó¥ updatetime -->
						<span style="color: '#444444';">{{ settingsLanguage == 'cn' ? 'Êõ¥Êñ∞Êó∂Èó¥: ' : 'Update Time: '}}</span>
						<span style="margin-right: auto;" :style="{color: apidata.updatetime === 0 ? '#0096b6' : '#444444' }">{{ apidata.updatetime === 0 ? (settingsLanguage == 'cn' ? 'Êñ∞ÂØÜÈí•' : 'New API Key') :  ( formatDateYYYYMMDDHHmmss(new Date(apidata.updatetime),':').startsWith(current_Year) ? formatDateYYYYMMDDHHmmss(new Date(apidata.updatetime),':').slice(5) : formatDateYYYYMMDDHHmmss(new Date(apidata.updatetime),':') )  }}</span>
						<!--    -->
						<button @click="useThirdPartyApiKey(apidata)" class="btn minibtn btnzoom-c" :class="{'orangeredbtn': apidata.apikey === api.trim()  }" :style="{ display: isThirdPartyAPIKeyEnabled  ? 'flex' : 'none'}" style="width: auto; height: 16px; padding: 0px 6px; border-radius: 4px;margin-left: 1px;" :title="settingsLanguage == 'cn' ? '‰ΩøÁî®Ëøô‰∏™Key' : 'Use this Key'">
							{{ apidata.apikey === api.trim() ? (settingsLanguage == 'cn' ? 'Ê≠£Âú®‰ΩøÁî®' : 'In use') : (settingsLanguage == 'cn' ? '‰ΩøÁî®Ëøô‰∏™Key' : 'Use this Key') }}
						</button>
						<!--  Âà†Èô§ delete -->
						<button @click="deleteApiData(apidata)" class="btn minibtn redbtn btnzoom-c" style="display: flex; width: 16px; height: 16px; padding: 0px; border-radius: 4px;" :title="settingsLanguage == 'cn' ? 'Âà†Èô§API Key' : 'Delete Key'">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line>
							</svg>
						</button>
					</div>
				
					<div class="panelrow" style="align-items: end; height:auto;flex-wrap: wrap;">
						<!-- Á∫ßÂà´ -->
						<button @click="autoKeyRotation_EditLevel(apidata)" class="btn btnzoom-c" style="width: auto;padding: 0 8px;border: 1px solid #DDD !important; background: none; color: #1aad19 !important;" :style="{ display: apidata.vpn === 'third-party' ? 'none' : 'flex' }" :title="settingsLanguage == 'cn' ? 'Á∫ßÂà´' : 'Level'">
							<div>
								<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line>
								</svg>
							</div>
							<span style="font-size: 13px;" :style="{ color: apidata.level === null ? '#0096b6' : apidata.level === 8 ? '#f42828' : apidata.level === 9 ? '#ff7d0b' : '#1aad19' }" >&nbsp;{{ apidata.level === null ? (settingsLanguage == 'cn' ? 'Á≠âÂæÖÈ™åËØÅ' : 'Pending Check') : apidata.level === 0 ? (settingsLanguage == 'cn' ? '‰ªòË¥πË¥¶Âè∑' : 'Paid Account') : apidata.level === 8 ? (settingsLanguage == 'cn' ? 'Êó†ÊïàÂØÜÈí•' : 'Invalid key') : apidata.level === 9 ?  (settingsLanguage == 'cn' ? 'Ë∂ÖÂá∫ÈÖçÈ¢ù' : 'Quota exceeded') :  (settingsLanguage == 'cn' ? apidata.level + ' Á∫ß' : 'Level ' + apidata.level)   }}</span>
						</button>
						<!-- ÊàêÂäüÁéá   ‚Äúapidata.vpn‚ÄùÊîπÁî®ÈÄîÔºåÊîπ‰∏∫Â≠òÂÇ®‚Äútag‚Äù „ÄÇ"apidata.vpn" has been repurposed to store "tag" -->
						<button class="btn" style="width: auto;padding: 0px 14px;border: none; background: none; color: #1aad19 !important;cursor:auto;" :style="{ marginRight: apidata.vpn !== 'GPT-4' && apidata.vpn !== 'third-party' ? 'auto' : '1px', display: apidata.vpn === 'third-party' ? 'none' : 'flex' }" :title="settingsLanguage == 'cn' ? 'ÊàêÂäüÁéá' : 'Success rate'">
							<div>
								<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
								</svg>
							</div>
							<span style="color: #1aad19;font-size: 13px;">&nbsp;{{ Math.round(apidata.succrate * 100) + ' %' }}</span>
						</button>
						<!-- TagÔºö Third-party„ÄÅGPT-4 ...  ‚Äúapidata.vpn‚ÄùÊîπÁî®ÈÄîÔºåÊîπ‰∏∫Â≠òÂÇ®‚Äútag‚Äù „ÄÇ"apidata.vpn" has been repurposed to store "tag"  -->
						<button class="btn" style="width: auto;border: none; background: none; color: #1aad19 !important;cursor:auto;" :style="{ display: apidata.vpn !== 'GPT-4' && apidata.vpn !== 'third-party' ? 'none' : 'flex' ,padding: apidata.vpn === 'third-party' ? '0px 8px' : '0px 1px', marginRight: apidata.vpn === 'third-party' ? '2px' : 'auto'   }" :title="apidata.vpn === 'third-party' ? (settingsLanguage == 'cn' ? 'Á¨¨‰∏âÊñπ‰∏ìÁî®Key' : 'Third-party API Key') : apidata.vpn === 'GPT-4' ? (settingsLanguage == 'cn' ? 'ÊîØÊåÅGPT-4' : 'Support GPT-4') : apidata.vpn">
							<div>
								<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
								</svg>
							</div>
							<span style="color: #1aad19;font-size: 13px;">&nbsp;{{ apidata.vpn === 'third-party' ? (settingsLanguage == 'cn' ? 'Á¨¨‰∏âÊñπ‰∏ìÁî®' : 'Third-party') : apidata.vpn }}</span>
						</button>
						<!-- api url -->
						<span style="margin-right: auto;line-height: 23px; color: #1aad19;font-size: 13px;" :style="{ display: apidata.vpn === 'third-party' ? 'flex' : 'none'}" :title="settingsLanguage == 'cn' ? 'Êé•Âè£ÁΩëÂùÄ(‰∏äÊ¨°‰ΩøÁî®ÁöÑ)' : 'API URL (last used)'">&nbsp;{{ apidata.apiurl }}</span>
					</div>		
							
					<div class="panelrow" style="align-items: start; height:auto;flex-wrap: nowrap;justify-content: start;">
						<!-- API Key-->
						<div style="width: auto;padding: 0 1px 0 12px;color: #1aad19 !important;" :title="settingsLanguage == 'cn' ? 'API Key' : 'API Key'">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
							</svg>
						</div>
						<span style="color: #444444;word-break: break-all;" :title="settingsLanguage == 'cn' ? 'API Key' : 'API Key'">&nbsp;{{ apidata.apikey }}</span>
					</div>
				</div>
				
				
			<!-- End:  D: ‰∏ª‰ΩìÂÜÖÂÆπ content -->  
			</div>
			<!-- End:  D: ÊªöÂä®Ê°ÜÊû∂ scroll --> 
			</div>

			<!-- dialog-bottom -->
			<div class="dialog-bottom">
			</div>
			
	  	<!-- End:  D: dialog -->  
		</div>
	
		<!-- dialog-mask -->
		<div class="dialog-mask" @click="isShowDialog_AutoKeyRotation = false">
		</div>
	
	<!-- End:  dialog-wrapper D: ËΩÆËØ¢ / Ëá™Âä®ËΩÆÊç¢API Key / Auto Key Rotation -->  
	</div>
 


	<!-- Notification Z: Ê∂àÊÅØÈÄöÁü• Notification -->
	<div v-show="isShowNotification" class="notification">
		<div class="notification-wrapper" :class="{'notification-center': isNotificationHasMask, 'notification-bottom': !isNotificationHasMask }">
			<!-- Z: Ê†áÈ¢ò header :Only center -->  
			<div :style="{ display: isNotificationHasMask ? 'block' : 'none' }" style="position: relative;height: 30px;padding: 2px 16px;border-top-left-radius:10px;border-top-right-radius:10px;">
				<div class="dialog-title" style="color: #664909;font-weight:600;">
					{{setNotificationTitle}}
				</div>
				<div class="dialog-close" @click="hideNotification" style="color: #664909;width: 18px;height: 18px;" :title="settingsLanguage == 'cn' ? 'ÂÖ≥Èó≠' : 'Close'">
					<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="fill: none; stroke: #333; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;">
						<path d="M6 18L18 6M6 6l12 12"></path>
					</svg>
				</div>
			</div>
		
			<!-- Z: ÊªöÂä®Ê°ÜÊû∂ scroll -->
			<div class="dialog-scroll" :style="{ height: isNotificationHasMask ? 'calc(100% - 49.5px)' : 'auto', overflowX: isNotificationHasMask ? 'auto' : 'hidden', overflowY: isNotificationHasMask ? 'scroll' : 'hidden' }" >
			<!-- Z: ÂÜÖÂÆπ content-->
			<div class="notification-content" :class="{'notification-content-center': isNotificationHasMask, 'notification-content-bottom': !isNotificationHasMask }">
				<!-- Z: Â§çÂà∂ÊåâÈíÆ Copy btn -->  
				<button class="copybtn btncopynotification" :style="{ display: isNotificationHasMask ? 'block' : 'none' }" data-clipboard-nextelementsibling="" style="opacity: 1; position: fixed; flex-shrink: 0; top: 7px; right: 40px; width: 25px; height: 25px;color: #664909; border: 1px solid #cfd450; background-color: #e5e881; background-image: linear-gradient(#fdffb4, #e5e881);" :title="settingsLanguage == 'cn' ? '‰∏ÄÈîÆÂ§çÂà∂' : 'One-Click Copy'">
					<div>
						<svg width="14" height="17" class="clippy" fill="currentColor">
							<path d="m2.36373,12.61912l4.12233,0l0,1.03058l-4.12233,0l0,-1.03058zm5.15291,-6.18349l-5.15291,0l0,1.03058l5.15291,0l0,-1.03058zm2.06116,3.09174l0,-2.06116l-3.09174,3.09174l3.09174,3.09174l0,-2.06116l5.15291,0l0,-2.06116l-5.15291,0zm-4.63761,-1.03058l-2.57645,0l0,1.03058l2.57645,0l0,-1.03058zm-2.57645,3.09174l2.57645,0l0,-1.03058l-2.57645,0l0,1.03058zm9.27523,1.03058l1.03058,0l0,2.06116c-0.0161,0.28985 -0.11272,0.53139 -0.30595,0.72463s-0.43478,0.28985 -0.72463,0.30595l-10.30581,0c-0.5636,0 -1.03058,-0.46698 -1.03058,-1.03058l0,-11.33639c0,-0.5636 0.46698,-1.03058 1.03058,-1.03058l3.09175,0c0,-1.1433 0.91786,-2.06116 2.06116,-2.06116s2.06116,0.91786 2.06116,2.06116l3.09174,0c0.5636,0 1.03058,0.46698 1.03058,1.03058l0,5.15291l-1.03058,0l0,-3.09174l-10.30581,0l0,9.27523l10.30581,0l0,-2.06116zm-9.27523,-8.24465l8.24465,0c0,-0.5636 -0.46698,-1.03058 -1.03058,-1.03058l-1.03058,0c-0.5636,0 -1.03058,-0.46698 -1.03058,-1.03058s-0.46698,-1.03058 -1.03058,-1.03058s-1.03058,0.46698 -1.03058,1.03058s-0.46698,1.03058 -1.03058,1.03058l-1.03058,0c-0.5636,0 -1.03058,0.46698 -1.03058,1.03058z">
							</path>
						</svg>
					</div>
				</button> 
		
				<!-- Z: Ê∂àÊÅØÂÜÖÂÆπ ÊèêÁ§∫Ê°ÜÂÜÖÂÆπ Message -->  
				<span>{{setNotificationContent}}</span>
			
				<!-- Z: Â∞èÊåâÈíÆ ÂÖ≥Èó≠  :Only bottom -->
				<div @click="hideNotification" :style="{ display: !isNotificationHasMask && isNotificationBottomShowCloseBtn ? 'block' : 'none' } " style="cursor: pointer; margin-left: 5px;margin-right: -3px; font-size: 12px;">√ó</div>
			</div>
			<!-- End:  Z: ÊªöÂä®Ê°ÜÊû∂ scroll --> 
			</div>

			<!-- dialog-bottom -->
			<div class="dialog-bottom" :style="{ display: isNotificationHasMask ? 'block' : 'none' }">
			</div>
			
		</div>
  	
		<!-- Z: ÈÅÆÁΩ© Mash :Only center -->  
		<div class="notification-mask" v-show="isNotificationHasMask" @click="hideNotification" ></div>
	<!-- End:  Notification Z: Ê∂àÊÅØÈÄöÁü• Notification --> 
	</div>


<!-- End:  #app -->  
</div>


<script>
	//VueÂ§áÈÄâCDN(Á∫øË∑Ø3) ÂÜçÊ¨°Ê£ÄÊµãÔºåÁ°Æ‰øùvueÁöÑÊ≠£Á°ÆÂä†ËΩΩ„ÄÇ
	!window.Vue && document.write(unescape('%3Cscript src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.prod.min.js"%3E%3C/script%3E') );
  
  	//*ÂΩìÁî®Êà∑‰ΩøÁî®ËøáÊó∂ÁöÑÊóßÁâàÊú¨ÊµèËßàÂô®ËÆøÈóÆÊó∂Ôºå‰ºöÂá∫Áé∞‰∏çÊîØÊåÅÁöÑÊÉÖÂÜµÔºà‰∏çÊîØÊåÅÊñ∞ÁöÑjs‰ª£Á†Å/‰∏çÊîØÊåÅÊñ∞Áâàvue.jsÔºâ When accessing with an old version of browser, it may not be supported (not supporting ES6 |  not supporting new version of Vue.js).
	//ÂÆöÊó∂Âô®Ôºö12ÁßíÂêéÊ∑ªÂä†ÊåâÈíÆ  Add button after 12 seconds.
	var timermask = setTimeout(function() {
		var loadingMask = document.getElementById("loading-mask");
		if (loadingMask) {
			var maskfirstChild = loadingMask.firstChild;
			if (maskfirstChild) {
				loadingMask.removeChild(maskfirstChild);
			}
			var maskbutton = document.createElement("button");
			maskbutton.innerHTML = "È°µÈù¢Âä†ËΩΩÊó∂Èó¥ËæÉÈïøÔºåÊÇ®ÂèØ‰ª•Â∞ùËØïÂà∑Êñ∞È°µÈù¢ÊàñÊ£ÄÊü•ÁΩëÁªúËøûÊé•ÊòØÂê¶ÁïÖÈÄö„ÄÇ<br>[ÁÇπÂáªÊàë]ÁÇπÂáªÊñáÊú¨ÂèØ‰ª•ÈöêËóèÈÅÆÁΩ©ÔºåÊü•ÁúãÁΩëÈ°µ„ÄÇÂú®ÊéíÈô§ÁΩëÁªú‰∏çÁïÖ/ÊúçÂä°Âô®Êã•Â†µÁ≠âÁΩëÁªúÈóÆÈ¢òÂêéÔºåËã•ËøòÂá∫Áé∞Â∏ÉÂ±ÄÈîôËØØÊàñ‰π±Á†ÅÔºåÂèØËÉΩÊòØÂõ†‰∏∫ÊµèËßàÂô®ÁâàÊú¨ËøáÊóßÊàñËÆæÂ§áËøáÊóßÔºåËØ∑Â∞ùËØï‰ΩøÁî®Êõ¥Êñ∞ÁöÑÊµèËßàÂô®ÁâàÊú¨„ÄÇ<br><br>The page is loading too slowly. Please refresh the page or check your internet connection.<br>Click [here] to hide the mask and view the webpage. After ruling out network issues such as poor connection or server congestion, if the layout is still incorrect or displaying gibberish, please try using a newer version of the browser or device.";
			maskbutton.onclick = displaymaskbtn; 
			loadingMask.appendChild(maskbutton); 
		}
		clearTimeout(timermask);
	}, 12000);
	// ÈöêËóèÈÅÆÁΩ©
	function displaymaskbtn() {
		var loadingMask = document.getElementById("loading-mask");
		if (loadingMask) {
			loadingMask.classList.add('dialog-wrapper-hide');
		}
	}
</script>

<script>
//‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆÁöÑÊèêÁ§∫Ê°Ü Tooltips for Copy Button. by clipboardjs  https://clipboardjs.com/assets/scripts/tooltips.js
//ËøôÊÆµjsÊîæÂâçÈù¢ÔºöÁΩëÈ°µÂä†ËΩΩËøáÂø´‰ºöÂØºËá¥Ê∑ªÂä†ÁõëÂê¨‰∫ã‰ª∂Â§±Ë¥•„ÄÇThis JS code should be placed at the beginning: If the webpage loads too quickly, listener events may fail to be added.

	//ÂΩìÂâçËØ≠Ë®Ä Current Language„ÄÇ ÂÖ®Â±ÄÂèòÈáè„ÄÇ Global variable.
	window.currentlang = 'cn';
	
	function addEventListenerCopyBtnTooltip(btn) {
		btn.addEventListener('mouseleave', clearCopyBtnTooltip);
		btn.addEventListener('blur', clearCopyBtnTooltip);
	}
	function clearCopyBtnTooltip(e) {
		e.currentTarget.setAttribute('class', 'copybtn');
		e.currentTarget.removeAttribute('aria-label'); 
	}
	//ÊèêÁ§∫Ê°ÜÊñπÂêëÁöÑÊ†∑Âºè directionClass: https://primer.style/css/components/tooltips
	function showCopyBtnTooltip(elem, msg, directionClass) {
		elem.setAttribute('class', 'copybtn tooltipped ' + directionClass); 
		elem.setAttribute('aria-label', msg); 
	}
	function fallbackCopyBtnMessage(action) {
		let actionMsg = '';
		actionMsg = window.currentlang == 'cn' ? 'Êó†Êï∞ÊçÆ ' : 'No data' ; //ÂéªÈô§‚Äú‰∏çÊîØÊåÅ‚Äù Delete ‚ÄúNo support‚Äù
		//actionMsg = window.currentlang == 'cn' ? 'Êó†Êï∞ÊçÆ / ‰∏çÊîØÊåÅ' : 'No data / No support' ; 
		return actionMsg;
	}
</script>

<script>
	if(!window.Vue){ alert("ÈîôËØØÔºö\r\nVue.jsÂä†ËΩΩÂ§±Ë¥•ÔºåÂ∞ÜÊó†Ê≥ï‰ΩøÁî®GPTÔºÅËØ∑Ê£ÄÊü•ÁΩëÁªúÂêéÂà∑Êñ∞È°µÈù¢„ÄÇ\r\n\r\nError:\r\nFailed to load plugin Vue.js. The GPT will be unavailable. Please check your network and refresh the page to try again.") };
	
	const { createApp } = Vue;
	createApp({
		data() {
			return {
			
				api: '', //Ê≠§ÂèòÈáèÊîØÊåÅOpenAIÂíåÁ¨¨‰∏âÊñπÁöÑKey„ÄÇ This variable supports both OpenAI and third-party keys.
				//CN: 1‰∏™ÊàñÂ§ö‰∏™KeyÔºåÂª∫ËÆÆÂ°´ÂÜôÂú®‰∏ãÊñπÁöÑdefault_apiKeyArray_WrittenInTheCode‰∏≠„ÄÇ
				// v7.05 ÂºÄÂßãÔºåÊîØÊåÅÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®ÔºåÊîØÊåÅÂØºÂá∫ÂØºÂÖ•API KeyÊñá‰ª∂ÔºåÊâÄ‰ª•api keyÊ≤°ÂøÖË¶ÅÂÜôÂú®‰ª£Á†Å‰∏≠„ÄÇ
				// api‰øÆÊîπÊèêÈÜíÔºöhtmlÊñá‰ª∂Ëã•Ë¶Å‰∏ä‰º†Âà∞GitHubÔºå‰ª£Á†ÅÈáå‰∏çËÉΩÂ°´API KeyÁöÑÊòéÊñáÔºÅGitHub‰∏ÄÊó¶Ê£ÄÊµãÂà∞‰ª£Á†ÅÈáåÊúâGPTÁöÑAPI KeyÔºå‰ºöËÅîÂä®OpenAIÁöÑÂêéÂè∞ÂèñÊ∂àËøô‰∏™keyÔºåÂπ∂ÁîüÊàêÊñ∞key „ÄÇ
				
				//EN: 1 or more keys, recommended to be filled in the default_apiKeyArray_WrittenInTheCode below.
				// Starting from v7.05, browser local storage is supported, allowing for the export and import of API key files. Therefore, It is not recommended to write the API key in the code. 
				//!!Reminder: If your project is hosted on GitHub, do not enter the plaintext OpenAI API key here! GitHub will trigger OpenAI to automatically invalidate the API key and generate a new one.
				
				//v7.22 ÂºÄÂßãÔºåÂ¶ÇÊûúÊÉ≥Â∞Üapi keyÂÜôÂú®‰ª£Á†Å‰∏≠ÔºåÂèØÂÜôÂú®‰∏ãÊñπÁöÑÊï∞ÁªÑ‰∏≠Ôºå1‰∏™ÊàñÂ§ö‰∏™ÔºåÊï∞Èáè‰∏çÈôê(Ëá™Ë°åËøΩÂä†)„ÄÇÁ©∫ÁöÑkey‰ºöË¢´Ëá™Âä®ËøáÊª§„ÄÇ
				//Starting from v7.22, If you want to include the API key in the code, you can write it in the array below. You can add 1 or more, with no limit to the quantity (append as needed). Empty keys will be automatically filtered.
				//ÂèØ‰øÆÊîπ Editable - ÂçïÂºïÂè∑ÂÜÖÂèØ‰ª•ÁïôÁ©∫ÔºåÊàñÂ°´ÂÖ•ÈªòËÆ§ÁöÑAPI Key„ÄÇ You can leave it blank or enter the default API key.
				//Ë∞ÉÁî®"ÊâπÈáèÊ∑ªÂä†"ÁöÑÂáΩÊï∞Ôºå‰ªÖÊîØÊåÅsk-ÂºÄÂ§¥ÁöÑOpenAIÁöÑKey„ÄÇ  Call the function of "Bulk Add" and only support the OpenAI Key starting with "sk-". 
				//Ê≠§ÂèòÈáè‰ªÖÊîØÊåÅOpenAIÁöÑAPI KEy„ÄÇ  This variable only supports OpenAI's API Key.
				default_apiKeyArray_WrittenInTheCode: [
					'',
					'',
					'',
					'',	
					'',
					'',
					'',	
					'',
					''
				],
				////‰ª•‰∏ãÊòØÁ§∫ËåÉÔºåÂ¶Ç‰ΩïÂ°´ÂÜôÂ§ö‰∏™API KeyÔºö Here is an example of how to fill in multiple API keys:
				////default_apiKeyArray_WrittenInTheCode: [
				////	'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',
				////	'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',
				////	'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',
				////	'',	
				////	''
				////],
				

				//ÂèØ‰øÆÊîπ Editable  - v7.31 Encrypted Base64ÁºñÁ†Å Âä†ÂØÜ ÁÆÄÂçïÁöÑÈÅøÂÖçÊòéÊñáÂØÜÈí•Êö¥Èú≤Âú®github‰∏≠„ÄÇ  Simple method to prevent plaintext keys from being exposed on GitHub.
				//CNÔºöÊ≠§Êï∞ÁªÑ‰∏≠ÈÄöËøáBase64ÁºñÁ†ÅÁöÑKeyÔºå‰ºöËá™Âä®Ëß£Á†ÅÔºåÁÑ∂ÂêéËøΩÂä†Âà∞default_apiKeyArray_WrittenInTheCode‰∏≠„ÄÇ
				//ENÔºöThe Key encoded through Base64 in this array will be automatically decoded and then appended to default_apiKeyArray_WrittenInTheCode.
				//Ë∞ÉÁî®"ÊâπÈáèÊ∑ªÂä†"ÁöÑÂáΩÊï∞Ôºå‰ªÖÊîØÊåÅsk-ÂºÄÂ§¥ÁöÑOpenAIÁöÑKey„ÄÇ Call the function of "Bulk Add" and only support the OpenAI Key starting with "sk-". 
				//Ê≠§ÂèòÈáè‰ªÖÊîØÊåÅOpenAIÁöÑAPI KEy„ÄÇ  This variable only supports OpenAI's API Key.
				default_apiKeyArray_WrittenInTheCode_Encrypted_Base64: [
					'',
					'',
					''
				],
				////‰ª•‰∏ãÊòØÁ§∫ËåÉ Example
				////default_apiKeyArray_WrittenInTheCode_Encrypted_Base64: [
				////	'c2stRHhGMHBuQmtWS3VpMHNqMWEzZ1dUM0JsYmtGSnFUa3hjVWxyd1VCeUJoclpKaW00', // OpenAI Key
				////	'',
				////	''
				////],
				
				////Â∑•ÂÖ∑ Tool: Base64ÁºñÁ†Å/Ëß£Á†Å:https://tool.ip138.com/base64/   Base64 Encode/Decode: https://www.base64encode.org  https://www.base64encode.net
				////ÁºñÁ†ÅÁ§∫‰æã Example of encodingÔºö'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' => 'c2stTzJxTEREUHRjZTRnaDBmQ25wZHpUM0JsYmtGSmpoaDVZMTZwUWdZTHpMaFBDNDAx'
				
				btnDisabledState_Sending: true,
				btnDisabledState_CheckAPI: false,				
				btnDisabledState_Clear: true,
				btnDisabledState_Undo: true,
				sentext: 'ÂÖàÈ™åËØÅAPI', // Check API first
				apibtntext:  '<< È™åËØÅ', // Check API key
				timerId: null, // *ÊòØÂê¶ÊõæÈ™åËØÅËøáapikeyÊúâÂÄüÁî®Ê≠§ÂèòÈáèËøõË°åÂà§Êñ≠
				
				btnDisabledState_Export: true,
				//settingsContextualMode  ‰∏échat dataÁõ∏ÂÖ≥ÔºåÂÜôÂú®ÂêéÈù¢
				hasSystemPromptBeenSaved: false,
				userMsgTokensForRetry: 0, //int ‰∏¥Êó∂ËÆ∞ÂΩïÈáçÈóÆÊó∂ÁöÑtokensÊï∞ÊçÆ
				succQA_Count: 0, //int ÂΩìÂâçÊúâÊïàÁöÑ‰∏ä‰∏ãÊñáÊï∞ÈáèÔºå‰∏ÄÈóÆ‰∏ÄÁ≠îsuccQA_Count = 2 „ÄÇ Êï∞ÈáèÂèòÂåñÂØπÂ∫îthis.msgContent
				totaltokens: 0, //int
				chathistory: '# GPTËÅäÂ§©ËÆ∞ÂΩï / Chat History  \r\n\r\n',
				//gptSystemPromptReadOnly ‰πü‰∏échat dataÁõ∏ÂÖ≥ÔºåÂÜôÂú®ÂêéÈù¢
								
				btnDisabledState_KeyMode: false,
				btnDisabledState_SaveApiURL: true,
				btnDisabledState_ApiURL: false,
				btnDisabledState_Language: false,
				btnDisabledState_ContextualMode: false,
				btnDisabledState_updateUserImageUrl: true,
				btnDisabledState_updateGPTImageUrl: true,
				isRetry_RetryMessage: '', //ÈáçÈóÆÊó∂‰º†ÈÄíÈáçÈóÆÁöÑÂÜÖÂÆπÔºåÈÅøÂÖç‰ΩøÁî®this.msg
				isfirstclickonchatinputbox: true, //ÊòØÂê¶È¶ñÊ¨°ÁÇπÂáªËÅäÂ§©ËæìÂÖ•Ê°ÜÔºåÈò≤Ê≠¢ÈáçÂ§çÊøÄÊ¥ªÁÇπÂáª‰∫ã‰ª∂
				isShowTotaltokensSVG : true, //Total Tokens ÂõæÊ†á
				isShowTotaltokensLabel : true, //Total Tokens ÊñáÂ≠ó
				isShowQACountLabel: true, //Q&A Count  ÊñáÂ≠ó
				isSendingNow: false, //ÊòØÂê¶Ê≠£Âú®ÂèëÈÄÅÊ∂àÊÅØ
				isCheckingApiKeyNow:false, //ÊòØÂê¶Ê≠£Âú®È™åËØÅAPI Key
				is_Alert_Confirm_Prompt_Open:false, //ÊòØÂê¶ÊúâÂéüÁîüÂºπÁ™óÂºπÂá∫
				autoRetry_FirstTime: 0, //È¶ñÊ¨°Ëá™Âä®ÈáçÂèëÊ∂àÊÅØÁöÑÊó∂Èó¥Êà≥ÔºåÁî®‰∫éËá™Âä®ÈáçÈóÆ
				autoRetry_log: '',//Ëá™Âä®ÈáçÂèëËøáÁ®ãÁöÑÁÆÄÂçïËÆ∞ÂΩïÔºåÁî®‰∫éËá™Âä®ÈáçÈóÆ
				autoRetry_apiKeyExcludeList: [], //‰∏¥Êó∂ËÆ∞ÂΩïÈúÄË¶ÅÊöÇÊó∂ÊéíÈô§ÁöÑapikeyÔºå[{'apikey':'****', 'time':0 }]
				current_Year: '2023', //StringÁ±ªÂûãÔºåÁî®‰∫éÊØîÂØπÊó•ÊúüÔºåÂ¶ÇÊûúÊó•ÊúüÊòØ‰ªäÂπ¥ÁöÑÔºåÈÇ£‰πàÂπ¥‰ªΩ‰∏çÊòæÁ§∫„ÄÇ ÊîπÂèòÈáèËá™Âä®Êõ¥Êñ∞Ôºå‰∏çÁî®Êîπ
				bugfixing_BaiduInput_NewLine_timestamp: 0, //Êüê‰∫õÊú∫Âûã‰∏ãÔºåÁôæÂ∫¶ËæìÂÖ•Ê≥ïÔºåËÅäÂ§©Ê°Ü‰∏≠Êó†Ê≥ïÊç¢Ë°å
				
				
				//ÊèêÁ§∫ËØçÁ™óÂè£ Prompt Generator
				isShowDialog_PromptGenerator: false, //ÊòØÂê¶ÊòæÁ§∫ÊèêÁ§∫ËØçÁ™óÂè£
				styleDialogLayout: { padding: '20px 20px 20px 20px' },
				
				gptSystemPromptReadOnly: '', //Â±ïÁ§∫ÂΩìÂâçÁ≥ªÁªüÊèêÁ§∫ËØç(Âè™ËØª)
				btnDisabledState_SetSystemPrompt: false,
				gptPrompts: [{ 
					prompt: '',
					sort: -1,
					id: -1,	
					tag: '',	
					note: '',
					owner: 'me',
					other1: '',
					other2: ''
				}],
				
				
				//ÂØπËØùÂàóË°®Á™óÂè£ Chat List
				isShowDialog_ChatList: false,//ÊòØÂê¶ÊòæÁ§∫ÂØπËØùÂàóË°®Á™óÂè£
				selectedChatListMoreOptions: '',
				selectedChatListMoreOptions_Options_cn: [
				  { label: '1) ÂØºÂá∫/ÂàÜ‰∫´ÂØπËØù (.json)', op: 'ExportChatData' },
				  { label: '2) ÂàõÂª∫ÂâØÊú¨', op: 'CreateCopy' },
				  { label: '3) Ê∏ÖÁ©∫ËÆ∞ÂΩï (‰øùÁïôÊúÄËøëÂçïËΩÆËÆ∞ÂΩï)', op: 'ClearPrevious' },
				  { label: '4) Ê∏ÖÁ©∫ËÆ∞ÂΩï', op: 'ClearAll' }
				],
				selectedChatListMoreOptions_Options_en: [
				  { label: '1) Export & Share (.json)', op: 'ExportChatData' },
				  { label: '2) Creat a copy', op: 'CreateCopy' },
				  { label: '3) Clear the history (Keep the latest round)', op: 'ClearPrevious' },
				  { label: '4) Clear the history', op: 'ClearAll' }
				],
				isChatListTransparent: false, //Á™óÂè£ÊòØÂê¶ÈÄèÊòé
				
				
				//Ëá™Âä®ËΩÆÊç¢API KeyÁ™óÂè£ Auto Key Rotation
				isShowDialog_AutoKeyRotation: false,//ÊòØÂê¶ÊòæÁ§∫ÂØπËØùÂàóË°®Á™óÂè£
				changeAutoKeyRotationSorted_Mode:0, //ËßÜÂõæÁöÑÊéíÂ∫èÔºåÁÆÄÊòìÁöÑÊéíÂ∫èÔºåÂàáÊç¢‰∏çÂêåÁöÑÊéíÂ∫è„ÄÇ *‰∏ç‰ºöÂΩ±ÂìçËΩÆËØ¢/ËΩÆÊç¢ÁöÑÊéíÂ∫è
				isShowBulkAddPanel_AutoKeyRotation: false,//ÊòØÂê¶ÊòæÁ§∫ÊâπÈáèÊ∑ªÂä†ÁöÑÈù¢Êùø
				isThirdPartyAPIKeyEnabled: false, //ÊòØÂê¶‰∏∫Á¨¨‰∏âÊñπAPI KeyÊ®°Âºè(ÂçïKeyÊ®°ÂºèÔºåÈùûOpenAIÁöÑKey)  [Key Mode]



				//ËÆæÁΩÆÁ™óÂè£ Settings
				isShowDialog_Settings: false, //ÊòØÂê¶ÊòæÁ§∫ËÆæÁΩÆÁ™óÂè£
				isShowProConfig:true, // ÊòæÁ§∫/ÈöêËóè API‰∏ì‰∏öËÆæÁΩÆ Show/Hide Professional API Settings			
				isSimpleMode: false,  //true=ÁÆÄÁ∫¶Ê®°ÂºèÔºàÈªòËÆ§Ê®°ÂºèÔºâÔºåfalse=Êñ∞Áî®Êà∑Ê®°Âºè„ÄÇÂå∫Âà´Âú®‰∫éÁÆÄÁ∫¶Ê®°ÂºèÊòæÁ§∫ÁöÑ"ÊèêÁ§∫‰ø°ÊÅØ"‰ºöÂ∞ë‰∫õ„ÄÇ true=Simple Mode (Normal Mode), false=User Onboarding. The difference is that there will be more "help information" in User Onboarding.
				simpleModeOptions_cn: [
				  { label: 'ÈªòËÆ§Ê®°Âºè', state: true },
				  { label: 'Êñ∞Áî®Êà∑Ê®°Âºè', state: false }
				],
				simpleModeOptions_en: [
				  { label: 'Normal Mode', state: true },
				  { label: 'User Onboarding', state: false }
				],
				
				
				// Â∑≤È™åËØÅÁöÑAPI KeyÊï∞ÊçÆ   *Ëá™Âä®‰øÆÊîπ/ËÆ∞ÂΩï Auto modification/record  *Èùû‰∫∫Â∑• Not manually
				// v7.18 Â¶ÇÊûúÊÇ®ÈúÄË¶ÅÊâãÂä®‰øÆÊîπapikeyDataÁöÑJSONÊñá‰ª∂ËøõË°åÊâπÈáèÊ∑ªÂä†API KeyÔºåÂè™ÈúÄË¶ÅËÆ∞ÂΩïapikey‰∏Ä‰∏™Â±ûÊÄßÂç≥ÂèØÔºåÂØºÂÖ•JSONÊñá‰ª∂Ôºå‰ª£Á†Å‰ºöËá™Âä®Ê∑ªÂä†ÂÖ∂‰ªñÂ±ûÊÄßÔºåÂπ∂Â°´ÂÖ•ÈªòËÆ§ÂÄº„ÄÇ
				// v7.18 If you need to manually modify the JSON file of apikeyData for bulk addition of API Keys, you only need to record the apikey attribute. Import the JSON file and the code will automatically add other attributes and fill in the default values.
				apiCheckedData: [{ 
					apikey: '',	 //Not nullÔºåDefault:''  
					apiurl: '',	 //Not nullÔºåDefault:''
					date1: 0, //ËØ∑Ê±ÇÁöÑÊó∂Èó¥1  Êó∂Èó¥Êà≥ Recording request time. Not nullÔºåIntÔºåDefault:0
					date2: 0, //ËØ∑Ê±ÇÁöÑÊó∂Èó¥2  Êó∂Èó¥Êà≥ Recording request time. Not nullÔºåIntÔºåDefault:0
					date3: 0, //ËØ∑Ê±ÇÁöÑÊó∂Èó¥3  Êó∂Èó¥Êà≥ Recording request time. Not nullÔºåIntÔºåDefault:0
					nexttime: 0, //*Êñ∞Â¢ûÂèòÈáèÊó•ÊúüÔºö7.10  È¢Ñ‰º∞‰∏ãÊ¨°ÂèØÁî®ÁöÑÊó∂Èó¥ Êó∂Èó¥Êà≥ Estimated next available time. Not nullÔºåIntÔºåDefault:0
					level: null, //ÁõÆÂâçÂΩìÁ±ªÂà´Áî®ÔºåËá™Âä®ÂàÜÁ±ªÔºåËá™Âä®Ê†áÊ≥®Á±ªÂà´„ÄÇÁõÆÂâçÊúâ 0„ÄÅ1„ÄÅÂíå 2„ÄÅ3„ÄÅ4„ÄÅ5 Âíå 8„ÄÅ9 ËøôÂá†‰∏™„ÄÇ0‰ª£Ë°®‰ªòË¥πkeyÔºå1‰ª£Ë°®ÊØèÂàÜÈíü‰øùËØÅÊúâ3ÔΩû5Ê¨°ÁöÑÁã¨‰∫´ÁöÑÂÖçË¥πkeyÔºå2„ÄÅ3„ÄÅ4„ÄÅ5‰ª£Ë°®‰∏çÁ®≥ÂÆöÁöÑÂ§ö‰∫∫ÂÖ±Áî®ÁöÑÂÖçË¥πkeyÔºå8‰ª£Ë°®Êó†ÊïàÔºå9‰ª£Ë°®ÈÖçÈ¢ù‰∏çË∂≥/ËøáÊúüÁöÑkey„ÄÇ  Allowing nullÔºånull or IntÔºåInt:01234589ÔºåDefault:null
					freq: 0, //Not nullÔºåNumberÔºåDefault:0  *v7.18 not used
					vpn: '', //Not nullÔºåDefault:''      *v8.05  ‚Äúvpn‚ÄùÊîπÁî®ÈÄîÔºåÊîπ‰∏∫Â≠òÂÇ®‚Äútag‚Äù „ÄÇ"vpn" has been repurposed to store "tag"
					owner: 'me', //Not nullÔºåDefault:''  *v7.18 not used
					succcount: 0, //*Êñ∞Â¢ûÂèòÈáèÊó•ÊúüÔºö7.13  ÁªüËÆ°ÊàêÂäüÊ¨°Êï∞  Not nullÔºåIntÔºåDefault:0
					failcount: 0, //*Êñ∞Â¢ûÂèòÈáèÊó•ÊúüÔºö7.13  ÁªüËÆ°Â§±Ë¥•Ê¨°Êï∞  Not nullÔºåIntÔºåDefault:0
					succrate: 0,  //*Êñ∞Â¢ûÂèòÈáèÊó•ÊúüÔºö7.13  ÊàêÂäüÁéá  Not nullÔºåNumberÔºåDefault:0
					updatetime: 0 //*Êñ∞Â¢ûÂèòÈáèÊó•ÊúüÔºö7.13  ÊúÄÂêé‰øÆÊîπÁöÑÊó∂Èó¥  Not nullÔºåIntÔºåDefault:0
				}],
				lastCheckApiTime: 0, // ËÆ∞ÂΩï‰∏ä‰∏ÄÊ¨°È™åËØÅAPI KeyÁöÑÊó∂Èó¥Ôºå4ÁßíÂÜÖÂè™ËÉΩÂèëÈÄÅ‰∏ÄÊ¨°È™åËØÅËØ∑Ê±Ç
				lastAPIKeyInputText: '',//ËÆ∞ÂΩïÊúÄÂêé‰∏ÄÊ¨°‰ΩøÁî®ÁöÑkey
				lastAPIKeyInputText_Available: '',//ËÆ∞ÂΩïÊúÄÂêé‰∏ÄÊ¨°ÂèØÁî®ÁöÑÁöÑkey(‰ªÖËÆ∞ÂΩï OpenAI API Key)
				defaultAPIKey: '',//ËÆ∞ÂΩïÂÜôÂú®‰ª£Á†Å‰∏≠ÁöÑÂõ∫ÂÆöÁöÑAPIKeyÔºàthis.apiÔºâÔºåÂ¶ÇÊûúÂ≠òÂú®ÁöÑËØù
				
				apitemperature: 0.7, //Ôºà0.0ÔΩû2.0ÔºâÊé•Âè£ÂèÇÊï∞ temperature ÈªòËÆ§0.7 (ÂÆòÊñπÈªòËÆ§1.0) v-model.number
				apiMaxTokens:2048, //Ôºà1ÔΩû4096ÔΩû16384ÔºâÊé•Âè£ÂèÇÊï∞ max_tokens ÈªòËÆ§2048 v-model.number (4095 4096 4097 16384 16385 gpt-3.5 gpt-4 gpt3.5 gpt4)
				apiTopP:1, // Ôºà0.0ÔΩû1.0ÔºâÊé•Âè£ÂèÇÊï∞ top_p ÂÆòÊñπÈªòËÆ§1 v-model.number
				apiPresencePenalty:0, //Ôºà-2.0ÔΩû2.0ÔºâÊé•Âè£ÂèÇÊï∞ presence_penalty ÂÆòÊñπÈªòËÆ§0 v-model.number
				apiFrequencyPenalty:0, //Ôºà-2.0ÔΩû2.0ÔºâÊé•Âè£ÂèÇÊï∞ frequency_penalty ÂÆòÊñπÈªòËÆ§0 v-model.number
				
				openSmartMaxTokens:true, // Êô∫ËÉΩmax_tokensÁä∂ÊÄÅ„ÄÇÈÄöËøá‰º∞ÁÆóËá™Âä®Ë∞ÉËäÇ„ÄÇ Smart max_tokens
				smartMaxTokensOptions_cn: [
				  { label: 'Â∑≤ÂêØÁî® Êô∫ËÉΩmax_tokens', state: true },
				  { label: 'Â∑≤ÂÖ≥Èó≠ Êô∫ËÉΩmax_tokens', state: false }
				],
				smartMaxTokensOptions_en: [
				  { label: 'Smart max_tokens Enabled', state: true },
				  { label: 'Smart max_tokens Disabled', state: false }
				],
				isSendingNow_ForSmartMaxTokens: false, //ÊòØÂê¶Ê≠£Âú®ÂèëÈÄÅÊ∂àÊÅØ ÂêåisSendingNow„ÄÇ‰∏∫‰∫Ü‰∏çÊîπÂä®isSendingNowÁöÑ‰ΩçÁΩÆ
				isFixingMaxTokens_SmartMaxTokens:false, //Ê†áËÆ∞‰∏∫‚ÄúÊ≠£Âú®‰øÆÂ§çMaxTokens‚ÄùÊó∂ÔºåÊú¨Ê¨°‰∏ç‰ºöÊâßË°å‰øÆÊîπmax_tokensÁöÑÂä®‰Ωú
				isFirstRetry_SmartMaxTokens:true, //ÊòØÂê¶‰∏∫È¶ñÊ¨°Ëá™Âä®ÈáçÈóÆ
				isReminded_SmartMaxTokens:-1, //ÊòØÂê¶ÊèêÈÜíËøáÔºåÊèêÈÜíÂΩìÂâçÁä∂ÊÄÅÊòØÂÖ≥Èó≠ÁöÑ„ÄÇ-1 ‰∏çÊèêÈÜí 0 ÊèêÈÜí  >0 ‰∏çÊèêÈÜí
				
				
				apiGPTModel: 'gpt-3.5-turbo-16k', // Êé•Âè£ÂèÇÊï∞ model ÈªòËÆ§'gpt-3.5-turbo-16k' * ÂèØ‰øÆÊîπ Editable. Default Model  * ÂÖ±Êúâ‰∏§Â§ÑÔºå‰∏ªË¶ÅÊòØÂú®userVariables_default‰∏≠‰øÆÊîπ„ÄÇTwo areas need modification, Make modifications primarily in userVariables_default.
				
				// ‰ª•‰∏ãÂ°´ÂÜôÁöÑÊ®°ÂûãËµÑÊñô‰∏≠ modelname „ÄÅ maxtokens ÂøÖÈ°ªÂ°´ÂÜôÂáÜÁ°ÆÔºå‰∏éÂÆòÊñπ‰∏ÄËá¥„ÄÇÂ¶ÇÊûúË¶ÅÂ°´ÂÜôËøáÊúüÊó∂Èó¥expiredtimeÔºå‰πüÂøÖÈ°ª‰∏éÂÆòÊñπ‰∏ÄËá¥ÔºåÊ†ºÂºè‰∏∫‚Äú2023-09-13T00:00:00‚Äù
				// The model information, "modelname" and "maxtokens", must be accurately filled and consistent with the official information.  The expiration date of the model, "expiredtime", is optional and should be filled in the format of "2023-09-13T00:00:00".
				// ÂèØ‰øÆÊîπ Editable - GPTÊ®°Âûã GPT Model List   modelname:ÂøÖÂ°´(Required)  maxtokens:ÂøÖÂ°´(Required),Int  *Ê≥®ÊÑèÊï∞ÊçÆÁ±ªÂûã„ÄÅÊ†ºÂºè„ÄÅÂèä‰∏çË¶ÅÂá∫Áé∞Â§ö‰ΩôÁöÑÁ©∫Ê†º„ÄÇ *Please take note of the data type, format, and avoid any unnecessary spaces.
				// "modelname" Âíå "maxtokens" ÂøÖÈ°ªÂ°´ÂÜôÔºåÂê¶Âàô‰ºöÊä•ÈîôÔºåÊó†Ê≥ï‰ΩøÁî®„ÄÇ The "modelname" and "maxtokens" must be filled in, otherwise an error will occur and it cannot be used.
				gptModelList: [ //modelname(ÂÆòÊñπ-Ê®°ÂûãÂêçÁß∞) alias(Âà´Âêç) maxtokens(ÂÆòÊñπ-ÊîØÊåÅÁöÑÊúÄÂ§ßtokens) expiredtime(ÂÆòÊñπ-ÂºÉÁî®Êó•Êúü/Ê®°ÂûãËøáÊúüÊó∂Èó¥)
					{ modelname: 'gpt-3.5-turbo', alias: 'gpt-3.5-turbo', maxtokens: 4096,  expiredtime: '' },	//ÈÄöÁî®ÔºåÈªòËÆ§‰∏∫ÊúÄÊñ∞ÂûãÂè∑ÔºåËøôÈáåÂÆåÂÖ®Á≠â‰∫é'gpt-3.5-turbo-0613'
					{ modelname: 'gpt-3.5-turbo-16k', alias: '', maxtokens: 16384,  expiredtime: '' },	//ÈÄöÁî®ÔºåÈªòËÆ§‰∏∫ÊúÄÊñ∞ÂûãÂè∑ÔºåËøôÈáåÂÆåÂÖ®Á≠â‰∫é'gpt-3.5-turbo-16k-0613'
					{ modelname: 'gpt-4', alias: '', maxtokens: 8192,  expiredtime: '' },	//ÈÄöÁî®ÔºåÈªòËÆ§‰∏∫ÊúÄÊñ∞ÂûãÂè∑ÔºåËøôÈáåÂÆåÂÖ®Á≠â‰∫é'gpt-4-0613' Âç≥ GPT-4 8K
					{ modelname: 'gpt-4-32k', alias: '', maxtokens: 32768,  expiredtime: '' },	//ÈÄöÁî®ÔºåÈªòËÆ§‰∏∫ÊúÄÊñ∞ÂûãÂè∑ÔºåËøôÈáåÂÆåÂÖ®Á≠â‰∫é'gpt-4-32k-0613'
					{ modelname: 'gpt-3.5-turbo-0613', alias: '- gpt-3.5-turbo-0613', maxtokens: 4096,  expiredtime: '2023-09-13T00:00:00' },	// 0613
					{ modelname: 'gpt-3.5-turbo-16k-0613', alias: '- gpt-3.5-turbo-16k-0613', maxtokens: 16384,  expiredtime: '2023-09-13T00:00:00' },	// 0613
					{ modelname: 'gpt-4-0613', alias: '- gpt-4-0613', maxtokens: 8192,  expiredtime: '2023-09-13T00:00:00' },	// 0613 Âç≥ GPT-4 8K
					{ modelname: 'gpt-4-32k-0613', alias: '- gpt-4-32k-0613', maxtokens: 32768,  expiredtime: '2023-09-13T00:00:00' },	// 0613
					{ modelname: 'gpt-3.5-turbo-0301', alias: '* gpt-3.5-turbo-0301', maxtokens: 4096,  expiredtime: '2024-06-13T00:00:00' },	// Extending support => until at least June 13, 2024
					{ modelname: 'gpt-4-0314', alias: '* gpt-4-0314', maxtokens: 8192,  expiredtime: '2024-06-13T00:00:00' },	// Extending support => until at least June 13, 2024
					{ modelname: 'gpt-4-32k-0314', alias: '* gpt-4-32k-0314', maxtokens: 32768,  expiredtime: '2024-06-13T00:00:00' },	// Extending support => until at least June 13, 2024
				],
				//// gpt-3.5: https://platform.openai.com/docs/models/gpt-3-5
				//// gpt-4: https://platform.openai.com/docs/models/gpt-4
				//// ÂºÉÁî® Deprecations: https://platform.openai.com/docs/deprecations
				//// Ê®°ÂûãÂçáÁ∫ß Model upgrades: https://platform.openai.com/docs/models/continuous-model-upgrades
				//// 3‰∏™Ê®°ÂûãÂª∂Êúü Extending support => 'gpt-3.5-turbo-0301' 'gpt-4-0314' 'gpt-4-32k-0314' : https://openai.com/blog/function-calling-and-other-api-updates
				
				
				//‰ªÖÊîØÊåÅ/v1/chat/completionsÁ±ªÂûãÊé•Âè£url„ÄÇ Êé•Âè£‰∏éÊ®°ÂûãÁöÑÂÖ≥Á≥ª https://platform.openai.com/docs/models/model-endpoint-compatibility
				apiURL: '',  // Êé•Âè£ÂèÇÊï∞ Êé•Âè£ÁΩëÂùÄ
				inputApiURL: '',  //InputÂÄº
				selectedApiURL: '',  //selectedÂÄº
				// ÂèØ‰øÆÊîπ Editable - Á¨¨‰∏âÊñπÂπ≥Âè∞„ÄÅÂèç‰ª£ ÁöÑAPIÁΩëÂùÄÂèØÂä†ÂÖ•Âà∞‰∏ãÈù¢ÁöÑapiURLOptions_cn „ÄÅapiURLOptions_en ‰∏≠
				apiURLOptions_cn: [
				  { label: 'ÂÆòÊñπ  ‚Ä¢ OpenAIÂÆòÊñπAPI (GPT-3.5 / GPT-4) ÈúÄÈ≠îÊ≥ï', url: 'https://api.openai.com/v1/chat/completions' },
				  { label: 'Á¨¨‰∏âÊñπ  ‚Ä¢ ÂÖçÈ≠îÊ≥ï ‰ΩøÁî®ÂÆòÊñπKey openai-proxy.com', url: 'https://api.openai-proxy.com/v1/chat/completions' }
				],
				apiURLOptions_en: [ //ÂèØ‰øÆÊîπ Editable
				  { label: "OpenAI  ‚Ä¢ OpenAI's official API. GPT-3.5 / GPT-4 API endpoint.", url: 'https://api.openai.com/v1/chat/completions' },
				  { label: '3rd party  ‚Ä¢ Unofficial. No VPN required, use OpenAI API Key', url: 'https://api.openai-proxy.com/v1/chat/completions' }
				],
				OpenAI_API_URL: 'https://api.openai.com/v1/chat/completions', //‰∏çË¶ÅÊîπ Âõ∫ÂÆöÂ∏∏Èáè 
				OpenaiProxyCom_API_URL: 'https://api.openai-proxy.com/v1/chat/completions', //‰∏çË¶ÅÊîπ Âõ∫ÂÆöÂ∏∏Èáè
				
				// 8.11 Êî∂ÈõÜËá™ÁΩëÁªúÁöÑËøòÁÆóÈù†Ë∞±Á¨¨‰∏âÊñπ‰ªòË¥πAPIÔºå‰ªÖÂú®ËØ≠Ë®Ä‰∏∫‰∏≠ÊñáÊó∂ÊòæÁ§∫„ÄÇ Part of the third-party paid APIs collected from the Internet will only be displayed when the language is set to Chinese.
				// search for >> display: settingsLanguage == 'cn' ? 'block' : 'none'
				isLoadThirdPartyPaidAPIs: false, //ÊòØÂê¶Âä†ËΩΩÁ¨¨‰∏âÊñπÊî∂Ë¥πAPIÁöÑURLÔºàÂä†ËΩΩÂà∞‰∏ãÊãâÊ°Ü‰∏≠ÔºâLoad the URL of the third-party paid API (displayed in the preset dropdown menu)?
 				apiURLOptions_LoadThirdPartyPaidAPIs: [
				  { label: 'Á¨¨‰∏âÊñπ  ‚Ä¢ ‰∏ìÁî®Key ÂÖçÈ≠îÊ≥ï API2DÂπ≥Âè∞', url: 'https://oa.api2d.net/v1/chat/completions' },
				  { label: 'Á¨¨‰∏âÊñπ  ‚Ä¢ ‰∏ìÁî®Key ÂÖçÈ≠îÊ≥ï API2DÂπ≥Âè∞¬∑Â§áÁî®', url: 'https://openai.api2d.net/v1/chat/completions' },
				  { label: 'Á¨¨‰∏âÊñπ  ‚Ä¢ ‰∏ìÁî®Key ÂÖçÈ≠îÊ≥ï Next-WebÂπ≥Âè∞', url: 'https://api.nextweb.fun/openai/v1/chat/completions' },
				  { label: 'Á¨¨‰∏âÊñπ  ‚Ä¢ (ÂÆòÊñπKey) ÂÖçÈ≠îÊ≥ï Next-WebÂπ≥Âè∞', url: 'https://chatgpt1.nextweb.fun/api/proxy/v1/chat/completions' },
				  { label: 'Á¨¨‰∏âÊñπ  ‚Ä¢ ‰∏ìÁî®Key ÂÖçÈ≠îÊ≥ï OpenAI-SBÂπ≥Âè∞', url: 'https://api.openai-sb.com/v1/chat/completions' },
				  { label: 'Á¨¨‰∏âÊñπ  ‚Ä¢ ‰∏ìÁî®Key ÂÖçÈ≠îÊ≥ï AI ProxyÂπ≥Âè∞', url: 'https://api.aiproxy.io/v1/chat/completions' }
				],
				
				
				//ÂèØ‰øÆÊîπ Editable„ÄÇ ÂäüËÉΩÔºöÂ¶ÇÊûúÁ¨¨‰∏âÊñπÂπ≥Âè∞‰∏ìÁî®Key‰πüÊòØ‰ª•sk-ÂºÄÂ§¥Ôºå‰ºö‰∏éÂÆòÁΩëKeyÊ∑∑Ê∑ÜÔºåÈúÄË¶ÅÊéíÈô§Ôºå‰ª•‰∏ãÂÖ≥ÈîÆËØçÁî®Êù•ËØÜÂà´Ê≠§Á±ªURL„ÄÇ
				//ÂèØ‰øÆÊîπ Editable„ÄÇ FunctionsÔºö Third-party API Keys Start With 'sk-', But it's not OpenAI's key. It needs to be excluded. Keywords are used to compare domain names/URLs.
				//ÂèØ‰øÆÊîπ Editable (Professional)
				excludeList_ThirdPartyKeyStartWithSK_DomainKeyword: [
					'ohmygpt', 'textai.bu', 'aigptx', 'opapi.wi', //Ê≠§Ë°å4‰∏™ÈÉΩÂ±û‰∫éohmygpt
					'closeai-asia', 'closeai-proxy', 'openai-proxy.or', 'openai-proxy.liv', //Ê≠§Ë°å4‰∏™ÈÉΩÂ±û‰∫écloseai-asia
					'aiayw','i.aikey.on','czl.n','i.apiai.c','rcouyi', //Ê≠§Ë°åÂùá‰ΩøÁî®ÂºÄÊ∫êOne-apiÊê≠Âª∫
					'aiproxy.io', 'openaimax', 'chatai.beauty/v1/chat'
				],
	//*The third-party API platforms (reverse proxies) that have been added are mostly developed by Chinese developers (or primarily targeting Chinese users). You can continue to add more.	
				//ÂèØ‰øÆÊîπ Editable„ÄÇ ÂäüËÉΩÔºöÂè™ËÉΩ‰ΩøÁî®Á¨¨‰∏âÊñπKeyÁöÑÁ¨¨‰∏âÊñπÊé•Âè£ÁöÑURLÂÖ≥ÈîÆËØç„ÄÇ   ÈÄâÊã©/‰øùÂ≠ò"Êé•Âè£URL"ÂêéÔºåÂåπÈÖçÂà∞‰ª•‰∏ãÂÖ≥ÈîÆËØçÔºåÂ∞ÜËá™Âä®ÂàáÊç¢‰∏∫Á¨¨‰∏âÊñπKeyÊ®°Âºè„ÄÇ 
				//ÂèØ‰øÆÊîπ Editable„ÄÇ FunctionsÔºöKeywords for third-party API URLs that only support third-party keys. "API URL" includes the following keywords, and the Key Mode will be automatically switched to third-party key mode.
				//Q&A - ÊòØÂê¶ËÉΩ‰ΩøÁî®OpenAI KeyËΩÆËØ¢Ê®°ÂºèÔºü ‰∏çÂÖÅËÆ∏„ÄÇ  Is it possible to use the OpenAI Key automatic rotation mode when the URL contains the following keywords?  No, it is not allowed.
				//Q&A - Âêå‰∏™ÂüüÂêçÊèê‰æõÊúâ‰∏§‰∏™Êé•Âè£URLÔºå‰∏Ä‰∏™‰ªÖÊîØÊåÅOpenAI KeyÔºå‰∏Ä‰∏™‰ªÖÊîØÊåÅÁ¨¨‰∏âÊñπKeyÔºåÂ¶Ç‰ΩïÊîπ‰ª£Á†ÅÔºü Â∞Ü"‰ªÖÊîØÊåÅÁ¨¨‰∏âÊñπKey"ÁöÑurl(ÈÉ®ÂàÜÊàñÂÆåÊï¥ÁöÑurl)ÂÅö‰∏∫ÂÖ≥ÈîÆËØçÂ°´ÂÖ•‰ª•‰∏ã„ÄÇ There are two API URLs under the same domain name, one only supports OpenAI Key, and the other only supports third-party Key. How to modify the code? Refer to the example of 'next-web' below.
				//Q&A - ‰∏æ‰æãÔºö nextweb.fun Êúâ‰∏§‰∏™api urlÔºå1Ôºâ"https://chatgpt1.nextweb.fun/api/proxy/v1/chat/completions"‰ªÖÊîØÊåÅOpenAI KeyÔºõ2Ôºâ"https://api.nextweb.fun/openai/v1/chat/completions"‰ªÖÊîØÊåÅnextwebÁöÑKey„ÄÇÊâÄ‰ª•ÂÖ≥ÈîÆËØçÂèØËÄÉËôëÈÄâÂèñ"nextweb.fun/openai"Áî®‰∫éÂå∫ÂàÜ‰∫åËÄÖÔºåÊåáÂÆöÂåÖÂê´"nextweb.fun/openai"ÁöÑAPI URL‰ªÖÊîØÊåÅÁ¨¨‰∏âÊñπKey„ÄÇ
				//Q&A - Example: nextweb.fun provides two API URLs: 1) "https://chatgpt1.nextweb.fun/api/proxy/v1/chat/completions" only supports OpenAI Key, and 2) "https://api.nextweb.fun/openai/v1/chat/completions" only supports third-party Key. Therefore, the keyword "nextweb.fun/openai" can be used to distinguish between the two. Specify that the API URL containing "nextweb.fun/openai" only supports third-party Key.
				//ÂèØ‰øÆÊîπ Editable (Professional)
				list_OnlyUseThirdPartyKey_DomainKeyword: [  
					'api2d', 'nextweb.fun/openai/v1/chat', 'openai-sb', 'aiproxy.io', 'openaimax', 'aigc2d', //"aiproxy.io"ÈúÄË¶ÅÈÅøÂÖç‰∏é"aiproxy.xyz"ÂÜ≤Á™Å
					'chatai.beauty/v1/chat', 'api2gpt',
					'closeai-asia', 'closeai-proxy', 'openai-proxy.or', 'openai-proxy.liv', //Ê≠§Ë°å4‰∏™ÈÉΩÂ±û‰∫écloseai-asia
					'ohmygpt','textai.bu','aigptx','opapi.wi', //Ê≠§Ë°å4‰∏™ÈÉΩÂ±û‰∫éohmygpt
					'aiayw','i.aikey.on','czl.n','i.apiai.c','rcouyi' //Ê≠§Ë°åÂùá‰ΩøÁî®ÂºÄÊ∫êOne-apiÊê≠Âª∫
				],
				
				
				
				//**Â∏∏ËßÑËÆæÁΩÆÁ¨¨‰∏ÄÊéí
				//ÁßªÂä®ËÆæÂ§áÈ°µÈù¢ÊØî‰æã  For mobile devices
				pageScaling: '0.8', //Â≠óÁ¨¶ÂûãÔºåÁî®‰∫éÂ≠òÂÇ®ËÆæÁΩÆ
				selectedPageScaling: '', //‰∏ãÊãâÊ°ÜÈÄâÈ°πÔºåÈÄâÂêéÂêéÊ∏ÖÁ©∫
				selectedPageScalingOptions: [], //0.5ÔΩû1  Ë∂ÖËøá100%ÔºåÂä®ÊÄÅËÆæÁΩÆ‰ºº‰πéÊ≤°ÊúâÊïàÊûú

				//ËØ≠Ë®ÄËÆæÁΩÆ 
				// * Modifying the default language in the code (change to English): Please search for "Default language" in the code for quick location. 
				settingsLanguage: 'cn', //ÁÆÄ‰Ωì‰∏≠Êñácn Ëã±Êñáen„ÄÇ Chinese-Simplified = cn  English = en   * ÂèØ‰øÆÊîπ Editable. Default language  * ÂÖ±Êúâ‰∏§Â§ÑÔºå‰∏ªË¶ÅÊòØÂú®userVariables_default‰∏≠‰øÆÊîπ„ÄÇ  Two areas need modification, Make modifications primarily in userVariables_default.
				settingsLanguageOptions: [
					{ label: '‰∏≠Êñá', lang: 'cn' },
					{ label: 'English', lang: 'en' }
				],
				//Â≠ó‰ΩìÂ§ßÂ∞èËÆæÁΩÆ ÈªòËÆ§14px
				settingsFontSize: 14, //Êï∞Â≠ó Êï∞ÂÄºÂûã
				settingsFontSizeOptions: [
					{ label: '9', fontsize: 9 },
					{ label: '10', fontsize: 10 },
					{ label: '11', fontsize: 11 },
					{ label: '12', fontsize: 12 },
					{ label: '13', fontsize: 13 },
					{ label: '14', fontsize: 14 },
					{ label: '15', fontsize: 15 },
					{ label: '16', fontsize: 16 },
					{ label: '17', fontsize: 17 },
					{ label: '18', fontsize: 18 },
					{ label: '19', fontsize: 19 },
					{ label: '20', fontsize: 20 },
					{ label: '21', fontsize: 21 },
					{ label: '22', fontsize: 22 },
					{ label: '23', fontsize: 23 },
					{ label: '24', fontsize: 24 },
					{ label: '25', fontsize: 25 },
					{ label: '26', fontsize: 26 },
					{ label: '27', fontsize: 27 },
					{ label: '28', fontsize: 28 },
					{ label: '29', fontsize: 29 }
				],
				//ÊòØÂê¶ÊòæÁ§∫Êó∂Èó¥(ÂæÆ‰ø°Ê†∑Âºè) ÈªòËÆ§ÊòæÁ§∫
				settingsTime_WechatStyle: true,
				settingsTimeWechatStyleOptions_cn: [
					{ label: 'ÊòæÁ§∫', displaytime: true },
					{ label: '‰∏çÊòæÁ§∫', displaytime: false }
				],
				settingsTimeWechatStyleOptions_en: [
					{ label: 'Show', displaytime: true },
					{ label: 'Hide', displaytime: false }
				],
				//ÊòØÂê¶ÊòæÁ§∫Êó∂Èó¥(Ê∂àÊÅØ) ÈªòËÆ§‰∏çÊòæÁ§∫
				settingsTime_Message: 1, // Êï∞Â≠óÔºåÊï∞ÂÄºÂûã ‰ª£Ë°®‰∏âÁßçÁä∂ÊÄÅ state.  1:hide ; 2:show height:0 ; 3:show height:+10
				settingsTimeMessageOptions_cn: [
					{ label: '‰∏çÊòæÁ§∫', displaytime: 1 },
					{ label: 'ÊòæÁ§∫', displaytime: 2 },
					{ label: 'ÊòæÁ§∫(Â¢ûÂ§ßÈó¥Ë∑ù)', displaytime: 3 }
				],
				settingsTimeMessageOptions_en: [
					{ label: 'Hide', displaytime: 1 },
					{ label: 'Show', displaytime: 2 },
					{ label: 'Show(Increase Spacing)', displaytime: 3 }
				],
				//ÊòØÂê¶ÊòæÁ§∫ÂàÜÂâ≤Á∫ø ÈªòËÆ§ÊòæÁ§∫
				settingsDividerLine: true, 
				settingsDividerLineOptions_cn: [
					{ label: 'ÊòæÁ§∫', displaydividerline: true },
					{ label: '‰∏çÊòæÁ§∫', displaydividerline: false }
				],
				settingsDividerLineOptions_en: [
					{ label: 'Show', displaydividerline: true },
					{ label: 'Hide', displaydividerline: false }
				],
				
				//**Â∏∏ËßÑËÆæÁΩÆÁ¨¨‰∫åÊéí 
				//‰∏ä‰∏ãÊñáÊ®°Âºè ÈªòËÆ§ËøûÁª≠ÂØπËØù  ÂæÖÂºÄÂèë  ÁõÆÂâçÂè™ÊúâÔºö‰∏çÈôêÂà∂  1. 0-‰∏çÈôêÂà∂ Ôºõ2. Âõ∫ÂÆöÊ¨°Êï∞ÂêéËá™Âä®Ê∏ÖÈô§ Ôºõ 3. Ê∞∏Ëøú‰øùÁïôÊúÄÂêéÂá†Êù°ÁöÑËÆ∞ÂΩï
				settingsContextualMode: 0, // Int Êï∞Â≠óÔºåÊï∞ÂÄºÂûã 0‰ª£Ë°®ËøûÁª≠ÂØπËØù„ÄÇ   2 = 2 messages = 1*Q&A ; 4 = 4 messages =  2*Q&A 
				settingsContextualModeOptions_cn: [
					{ label: '‰∏çÈôêÂà∂', mode: 0 },
					{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 2 Êù°', mode: 2 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 4 Êù°', mode: 4 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 6 Êù°', mode: 6 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 8 Êù°', mode: 8 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 10 Êù°', mode: 10 },
					{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 12 Êù°', mode: 12 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 14 Êù°', mode: 14 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 16 Êù°', mode: 16 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 18 Êù°', mode: 18 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 20 Êù°', mode: 20 },
					{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 22 Êù°', mode: 22 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 24 Êù°', mode: 24 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 26 Êù°', mode: 26 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 28 Êù°', mode: 28 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 30 Êù°', mode: 30 },
					
					{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 32 Êù°', mode: 32 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 34 Êù°', mode: 34 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 36 Êù°', mode: 36 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 38 Êù°', mode: 38 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 40 Êù°', mode: 40 },
					{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 42 Êù°', mode: 42 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 44 Êù°', mode: 44 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 46 Êù°', mode: 46 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 48 Êù°', mode: 48 },{ label: 'ËÆ∞ÂøÜ‰∏äÈôê 50 Êù°', mode: 50 },
	//ÂæÖÂºÄÂèë To be developed			 	{ label: '‰øùÁïôÊúÄÂêé 4 Êù°', mode: 104 }, // > 100 Ôºå 104 - 100 = 4
	//ÂæÖÂºÄÂèë To be developed				{ label: '‰øùÁïôÊúÄÂêé 6 Êù°', mode: 106 },
	//ÂæÖÂºÄÂèë To be developed				{ label: '‰øùÁïôÊúÄÂêé 8 Êù°', mode: 108 },
	//ÂæÖÂºÄÂèë To be developed				{ label: '‰øùÁïôÊúÄÂêé 10 Êù°', mode: 110 },{ label: '‰øùÁïôÊúÄÂêé 12 Êù°', mode: 112 },{ label: '‰øùÁïôÊúÄÂêé 14 Êù°', mode: 114 },{ label: '‰øùÁïôÊúÄÂêé 16 Êù°', mode: 116 },{ label: '‰øùÁïôÊúÄÂêé 18 Êù°', mode: 118 },
	//ÂæÖÂºÄÂèë To be developed				{ label: '‰øùÁïôÊúÄÂêé 20 Êù°', mode: 120 },{ label: '‰øùÁïôÊúÄÂêé 22 Êù°', mode: 122 },{ label: '‰øùÁïôÊúÄÂêé 24 Êù°', mode: 124 },{ label: '‰øùÁïôÊúÄÂêé 26 Êù°', mode: 126 },{ label: '‰øùÁïôÊúÄÂêé 28 Êù°', mode: 128 },
	//ÂæÖÂºÄÂèë To be developed				{ label: '‰øùÁïôÊúÄÂêé 30 Êù°', mode: 130 },{ label: '‰øùÁïôÊúÄÂêé 32 Êù°', mode: 132 },{ label: '‰øùÁïôÊúÄÂêé 34 Êù°', mode: 134 },{ label: '‰øùÁïôÊúÄÂêé 36 Êù°', mode: 136 },{ label: '‰øùÁïôÊúÄÂêé 38 Êù°', mode: 138 },
	//ÂæÖÂºÄÂèë To be developed				{ label: '‰øùÁïôÊúÄÂêé 40 Êù°', mode: 140 },{ label: '‰øùÁïôÊúÄÂêé 42 Êù°', mode: 142 },{ label: '‰øùÁïôÊúÄÂêé 44 Êù°', mode: 144 },{ label: '‰øùÁïôÊúÄÂêé 46 Êù°', mode: 146 },{ label: '‰øùÁïôÊúÄÂêé 48 Êù°', mode: 148 },
	//ÂæÖÂºÄÂèë To be developed				{ label: '‰øùÁïôÊúÄÂêé 50 Êù°', mode: 150 },{ label: '‰øùÁïôÊúÄÂêé 52 Êù°', mode: 152 },{ label: '‰øùÁïôÊúÄÂêé 54 Êù°', mode: 154 },{ label: '‰øùÁïôÊúÄÂêé 56 Êù°', mode: 156 },{ label: '‰øùÁïôÊúÄÂêé 58 Êù°', mode: 158 },
	//ÂæÖÂºÄÂèë To be developed				{ label: '‰øùÁïôÊúÄÂêé 60 Êù°', mode: 160 }
				],
				settingsContextualModeOptions_en: [
					{ label: 'No Limit', mode: 0 },
					{ label: 'Limit: 2', mode: 2 },{ label: 'Limit: 4', mode: 4 },{ label: 'Limit: 6', mode: 6 },{ label: 'Limit: 8', mode: 8 },{ label: 'Limit: 10', mode: 10 },
					{ label: 'Limit: 12', mode: 12 },{ label: 'Limit: 14', mode: 14 },{ label: 'Limit: 16', mode: 16 },{ label: 'Limit: 18', mode: 18 },{ label: 'Limit: 20', mode: 20 },
					{ label: 'Limit: 22', mode: 22 },{ label: 'Limit: 24', mode: 24 },{ label: 'Limit: 26', mode: 26 },{ label: 'Limit: 28', mode: 28 },{ label: 'Limit: 30', mode: 30 },
					
					{ label: 'Limit: 32', mode: 32 },{ label: 'Limit: 34', mode: 34 },{ label: 'Limit: 36', mode: 36 },{ label: 'Limit: 38', mode: 38 },{ label: 'Limit: 40', mode: 40 },
					{ label: 'Limit: 42', mode: 42 },{ label: 'Limit: 44', mode: 44 },{ label: 'Limit: 46', mode: 46 },{ label: 'Limit: 48', mode: 48 },{ label: 'Limit: 50', mode: 50 },
	//ÂæÖÂºÄÂèë To be developed				{ label: 'Keep Last: 4', mode: 104 }, // > 100 Ôºå 104 - 100 = 4
	//ÂæÖÂºÄÂèë To be developed				{ label: 'Keep Last: 6', mode: 106 },
	//ÂæÖÂºÄÂèë To be developed				{ label: 'Keep Last: 8', mode: 108 },
	//ÂæÖÂºÄÂèë To be developed				{ label: 'Keep Last: 10', mode: 110 },{ label: 'Keep Last: 12', mode: 112 },{ label: 'Keep Last: 14', mode: 114 },{ label: 'Keep Last: 16', mode: 116 },{ label: 'Keep Last: 18', mode: 118 },
	//ÂæÖÂºÄÂèë To be developed				{ label: 'Keep Last: 20', mode: 120 },{ label: 'Keep Last: 22', mode: 122 },{ label: 'Keep Last: 24', mode: 124 },{ label: 'Keep Last: 26', mode: 126 },{ label: 'Keep Last: 28', mode: 128 },
	//ÂæÖÂºÄÂèë To be developed				{ label: 'Keep Last: 30', mode: 130 },{ label: 'Keep Last: 32', mode: 132 },{ label: 'Keep Last: 34', mode: 134 },{ label: 'Keep Last: 36', mode: 136 },{ label: 'Keep Last: 38', mode: 138 },
	//ÂæÖÂºÄÂèë To be developed				{ label: 'Keep Last: 40', mode: 140 },{ label: 'Keep Last: 42', mode: 142 },{ label: 'Keep Last: 44', mode: 144 },{ label: 'Keep Last: 46', mode: 146 },{ label: 'Keep Last: 48', mode: 148 },
	//ÂæÖÂºÄÂèë To be developed				{ label: 'Keep Last: 50', mode: 150 },{ label: 'Keep Last: 52', mode: 152 },{ label: 'Keep Last: 54', mode: 154 },{ label: 'Keep Last: 56', mode: 156 },{ label: 'Keep Last: 58', mode: 158 },
	//ÂæÖÂºÄÂèë To be developed				{ label: 'Keep Last: 60', mode: 160 }
				],
				
				//ÊòØÂê¶ÂºÄÂêØÈ™åËØÅAPI KeyÁöÑÂø´Êç∑ÈîÆ ÔºàÁîµËÑëÁ´Ø‰ΩøÁî®Ôºâ ÈªòËÆ§ÂºÄÂêØ ***v8.27 ÊîπÁî®ÈÄî ÊîπÊàê"ÊâìÂºÄKeyÊ®°ÂºèÁ™óÂè£"ÁöÑÂø´Êç∑ÈîÆ Change the original purpose to "Open Key Mode window".
				settingsShortcut_CheckApiKey: true, 
				settingsShortcutCheckApiKeyOptions_cn: [
					{ label: 'F2', shortcut: true },
					{ label: 'Êó†', shortcut: false }
				],
				settingsShortcutCheckApiKeyOptions_en: [
					{ label: 'F2', shortcut: true },
					{ label: 'None', shortcut: false }
				],
				
				//ÊòØÂê¶ÂºÄÂêØ Ê∏ÖÈô§ËÆ∞ÂøÜ (Clear Context) ÁöÑÂø´Êç∑ÈîÆ ÔºàÁîµËÑëÁ´Ø‰ΩøÁî®Ôºâ ÈªòËÆ§ÂÖ≥Èó≠
				settingsShortcut_Clear: false, 
				settingsShortcutClearOptions_cn: [
					{ label: 'F1', shortcut: true },
					{ label: 'Êó†', shortcut: false }
				],
				settingsShortcutClearOptions_en: [
					{ label: 'F1', shortcut: true },
					{ label: 'None', shortcut: false }
				],
				
				//ÊòØÂê¶ÂºÄÂêØ Êí§ÈîÄ ÁöÑÂø´Êç∑ÈîÆ ÔºàÁîµËÑëÁ´Ø‰ΩøÁî®Ôºâ ÈªòËÆ§ÂÖ≥Èó≠
				settingsShortcut_Undo: false, 
				settingsShortcutUndoOptions_cn: [
					{ label: 'F3', shortcut: true },
					{ label: 'Êó†', shortcut: false }
				],
				settingsShortcutUndoOptions_en: [
					{ label: 'F3', shortcut: true },
					{ label: 'None', shortcut: false }
				],
				
				//ÊòØÂê¶ÂºÄÂêØ ÈáçÈóÆ ÁöÑÂø´Êç∑ÈîÆ ÔºàÁîµËÑëÁ´Ø‰ΩøÁî®Ôºâ ÈªòËÆ§ÂºÄÂêØ
				settingsShortcut_Retry: true, 
				settingsShortcutRetryOptions_cn: [
					{ label: 'F4', shortcut: true },
					{ label: 'Êó†', shortcut: false }
				],
				settingsShortcutRetryOptions_en: [
					{ label: 'F4', shortcut: true },
					{ label: 'None', shortcut: false }
				],
				
				//**Â∏∏ËßÑËÆæÁΩÆ Â§¥ÂÉè  ‚Äúhttps://kimi.xinu.ink/gpt.jpg‚ÄùÊòØÂõ∫ÂÆöÁöÑÔºåË∞ÉÁî®SVGÁöÑÊ†áËØÜÁ¨¶„ÄÇ
				userAvatarURL: 'https://kimi.xinu.ink/top.JPG',  // *ÂèØ‰øÆÊîπ Editable. ÈªòËÆ§ÁöÑÁî®Êà∑Â§¥ÂÉè Default User Avatar. 
				inputUserImageUrl: 'https://kimi.xinu.ink/top.JPG', // *ÂèØ‰øÆÊîπ Editable. ÈªòËÆ§Áî®Êà∑Â§¥ÂÉèÁöÑurlÂú∞ÂùÄÔºåÂíå‰∏äÈù¢ÁöÑ"userAvatarURL"‰øùÊåÅ‰∏ÄËá¥„ÄÇËøô‰∏™ÊòØÂá∫Áé∞Âú®ÁºñËæëÊ°ÜÁöÑÊñáÊú¨ÂÜÖÂÆπ„ÄÇ Will display in the input. ("inputUserImageUrl" & "userAvatarURL") Two URLs are consistent.
				gptAvatarURL: '',   // ÂΩìÂâçGPTÂ§¥ÂÉèÁΩëÂùÄ
				inputGPTImageUrl: '',  // GPT inputÊñáÊú¨
				selectedImageUrl: '',  // È¢ÑËÆæÂ§¥ÂÉèÂ∫ì‰∏ãÊãâÊ°ÜÂÄº
				userpresetImages_cn: [
					{ name: '2) È¢ÑËÆæ: ÂìîÂì©ÂìîÂì©Â§¥ÂÉè', url: 'https://kimi.xinu.ink/top.JPG' },
					{ name: '3) È¢ÑËÆæ: ÈªëËâ≤GPTÂ§¥ÂÉè', url: 'https://kimi.xinu.ink/gpt.jpg' } 
				],
				userpresetImages_en: [
					{ name: '2) Pre-set: Bilibili Logo', url: 'https://kimi.xinu.ink/top.JPG' },
					{ name: '3) Pre-set: Black GPT Logo', url: 'https://kimi.xinu.ink/gpt.jpg' } 
				],
				gptpresetImages_cn: [
					{ name: '1) È¢ÑËÆæ: ÁªøËâ≤GPTÂ§¥ÂÉè', url: 'https://kimi.xinu.ink/gpt.jpg' },
					{ name: '2) È¢ÑËÆæ: ÈªëËâ≤GPTÂ§¥ÂÉè', url: 'https://kimi.xinu.ink/gpt.jpg' } //ÈªëËâ≤Â§¥ÂÉèÊ≤°ÊúâÂ∞ÜÁªøËâ≤SVGÊîπËâ≤ÔºåËÄåÊòØÈÄâÁî®ÂÆòÁΩëÁöÑicoÂõæÊ†á
				],
				gptpresetImages_en: [
					{ name: '1) Pre-set: Green GPT Logo', url: 'https://kimi.xinu.ink/gpt.jpg' },
					{ name: '2) Pre-set: Black GPT Logo', url: 'https://kimi.xinu.ink/gpt.jpg' }
				],
				isgptGreenSvgShow: true, //ÔºàÊòæÁ§∫<svg>ÁöÑÂêåÊó∂ÔºåÈöêËóè<img>ÔºâÊàñÔºàÈöêËóè<svg>Êó∂ÔºåÊòæÁ§∫<img>Ôºâ„ÄÇ  (display<img> & hide<svg>) or (hide<img> & display<svg>)
				GPTGreenSVG_UrlText_cn: 'GPT-Green-SVG *Êó†ÁΩëÂùÄÔºå‰ªÖÈÄöËøá[GPTÂ§¥ÂÉè]Êõ¥Êñ∞', // GPTÁªøËâ≤SVGÂ§¥ÂÉèÂØπÂ∫îÁöÑÊòæÁ§∫ÁöÑÊñáÊú¨ cn
				GPTGreenSVG_UrlText_en: 'GPT-Green-SVG *No URL, only updated through [GPT Avatar].', // GPTÁªøËâ≤SVGÂ§¥ÂÉèÂØπÂ∫îÁöÑÊòæÁ§∫ÁöÑÊñáÊú¨ en
				userAvatarUp_base64: '', //user - Upload avatar (<=350KB) base64
				userAvatarUp_blob: null, //user - Upload avatar (<=350KB) blob
				userAvatarUp_blobUrl: '', //user - Upload avatar (<=350KB) blob url	
				
				//**Â∏∏ËßÑËÆæÁΩÆ Êú¨Âú∞ÁºìÂ≠ò
				selectedDeleteLocalStorageData: '', 
				selectedDeleteLocalStorageDataOptions_cn: [
					{ label: '1) ‰∏ÄÈîÆÂà†Èô§ÊâÄÊúâÊï∞ÊçÆ', type: 'DeleteAllData' },
					{ label: '2) Âà†Èô§ÊâÄÊúâ[ÂØπËØù]Êï∞ÊçÆ', type: 'DeleteChatDataList' },
					{ label: '3) Âà†Èô§ÊâÄÊúâ[ÂØÜÈí• API Key]Êï∞ÊçÆ', type: 'DeleteAPIKeyData' },
					{ label: '4) Âà†Èô§ÊâÄÊúâ[ÊèêÁ§∫ËØç]Êï∞ÊçÆ', type: 'DeletePromptsData' },
					{ label: '5) Âà†Èô§[‰∏ä‰º†ÁöÑÁî®Êà∑Â§¥ÂÉè]', type: 'DeleteUploadedUserAvatar' },
					{ label: '6) Âà†Èô§ÊâÄÊúâ[ËÆæÁΩÆ]Êï∞ÊçÆ', type: 'DeleteSettingsData' }
				],
				selectedDeleteLocalStorageDataOptions_en: [
					{ label: '1) Delete All Data with One Click', type: 'DeleteAllData' },
					{ label: '2) Delete All [Chat] Data', type: 'DeleteChatDataList' },
					{ label: '3) Delete All [API Key] Data', type: 'DeleteAPIKeyData' },
					{ label: '4) Delete All [Prompt Generator] Data', type: 'DeletePromptsData' },
					{ label: '5) Delete [Uploaded User Avatar]', type: 'DeleteUploadedUserAvatar' },
					{ label: '6) Delete All [Settings] Data', type: 'DeleteSettingsData' }
				],
				selectedExportLocalStorageData: '', 
				selectedExportLocalStorageDataOptions_cn: [
					{ label: '1) ‰∏ÄÈîÆÂØºÂá∫ÊâÄÊúâÊï∞ÊçÆ', type: 'ExportAllData' },
					{ label: '2) ÂØºÂá∫ÊâÄÊúâ[ÂØπËØù]Êï∞ÊçÆ', type: 'ExportChatDataList' },
					{ label: '3) ÂØºÂá∫ÊâÄÊúâ[ÂØÜÈí• API Key]Êï∞ÊçÆ', type: 'ExportAPIKeyData' },
					{ label: '4) ÂØºÂá∫ÊâÄÊúâ[ÊèêÁ§∫ËØç]Êï∞ÊçÆ', type: 'ExportPromptsData' },
					{ label: '5) ÂØºÂá∫ÊâÄÊúâ[ËÆæÁΩÆ]Êï∞ÊçÆ', type: 'ExportSettingsData' }
				],
				selectedExportLocalStorageDataOptions_en: [
					{ label: '1) Export All Data with One Click', type: 'ExportAllData' },
					{ label: '2) Export All [Chat] Data', type: 'ExportChatDataList' },
					{ label: '3) Export All [API Key] Data', type: 'ExportAPIKeyData' },
					{ label: '4) Export All [Prompt Generator] Data', type: 'ExportPromptsData' },
					{ label: '5) Export All [Settings] Data', type: 'ExportSettingsData' }
				],
				
				
				isLocalStorageSupported: true, //ÂΩìÂâçÊµèËßàÂô®ÊòØÂê¶ÊîØÊåÅlocalStorage
				isLocalStorageAllowed: true, //ÊòØÂê¶ÂÖÅËÆ∏‰ΩøÁî®Êú¨Âú∞Â≠òÂÇ®„ÄÇ
				islocalStorageFirstLoad: true, //ÊòØÂê¶È¶ñÊ¨°ËØªÂèñ Áî®ÈÄîÔºö1) È¶ñÊ¨°ËØªÂèñÊó∂ÔºåÈúÄË¶ÅÈáçÊñ∞ÁîüÊàêÂ§¥ÂÉèÁöÑblob url
				localStorage_lastSaveTime : null,// ËÆ∞ÂΩïÊúÄËøë‰∏ÄÊ¨°Ëá™Âä®ÊàñÊâãÂä®Â§á‰ªΩÊìç‰ΩúÂèëÁîüÊó∂ÁöÑÊó∂Èó¥Êà≥ÔºàÊØ´ÁßíÔºâ
				localStorage_lastSaveTime_onblur : null,// ËÆ∞ÂΩïÊúÄËøë‰∏ÄÊ¨°Ëá™Âä®ÊàñÊâãÂä®Â§á‰ªΩÊìç‰ΩúÂèëÁîüÊó∂ÁöÑÊó∂Èó¥Êà≥ÔºàÊØ´ÁßíÔºâ*onblur ÂΩìÂâçÈ°µÈù¢Â§±ÂéªÁÑ¶ÁÇπÁöÑ‰∫ã‰ª∂ÔºåËß¶ÂèëÈ¢ëÁéáËæÉÈ´ò
				chatcreatedtime: null, //ÂØπËØùÁöÑÂàõÂª∫Êó∂Èó¥ *ÂîØ‰∏ÄÂÄº
				chatlasttime: null, //ÊúÄÂêé‰∏ÄÊ¨°Êìç‰ΩúÁöÑÊó∂Èó¥
				chatid: null,  //ID *ÂèØÈáçÂ§ç
				chattitle: '', //Ê†áÈ¢ò
				chatDataList: [], //ÂØπËØùÂàóË°®ÔºåÂåÖÂê´ÊâÄÊúâÂØπËØùÂíåÂØπËØùÁöÑÊâÄÊúâËÆ∞ÂΩï„ÄÇ Áî±‚Äúchatdata‚ÄùÁªÑÂêàÊàêÁöÑÊï∞ÁªÑ
				selectedChatData: {}, //ÂΩìÂâçË¢´ÈÄâ‰∏≠ÁöÑchat dataÔºå‰∏ªË¶ÅÁî®‰∫éhtmlÁªëÂÆöÂàóË°®+ÈÄöËøáchatcreatedtimeÊü•ÊâæÂØπÊØîÔºåÂÖ∂‰ªñÊï∞ÊçÆÈùûÂÆûÊó∂Êõ¥Êñ∞
				localStorageEvent_chatDataList_update_start: false,//‰∫ã‰ª∂Áä∂ÊÄÅ
				
				//ÂØºÂá∫
				chatHistoryPromptOnlyUseBackticks: false , //ÂØºÂá∫ÁöÑËÅäÂ§©ËÆ∞ÂΩï‰∏≠ÔºåÁ≥ªÁªüÊèêÁ§∫ËØçÁöÑmarkdownËØ≠Ê≥ïÂ§ÑÁêÜÊñπÂºè„ÄÇ true:‰ªÖÁî®"‰ª£Á†ÅÂùó"ÂåÖË£π  false:Ëá™Âä®Âà§Êñ≠‰ΩøÁî®"ÂºïÁî®"ÊàñËÄÖ"‰ª£Á†ÅÂùó"ÂåÖË£π
				exportTXTFileName:"MCGPT_ChatHistory", //ÂØºÂá∫ÂÖ®ÈÉ®ÂéÜÂè≤ËÆ∞ÂΩïÁöÑÊñá‰ª∂Âêç
				exportTXTFileName_SingleRound:"MCGPT_ChatHistory_SingleRound", //ÂØºÂá∫ÂçïËΩÆÂéÜÂè≤ËÆ∞ÂΩïÁöÑÊñá‰ª∂Âêç
				exportJSONFileName:"MCGPT Data_",
				selectedExportChatHistory: '', 
				selectedExportChatHistoryOptions_cn: [
					{ label: '1) ÂØºÂá∫ËÅäÂ§©ËÆ∞ÂΩï¬∑ÂçïËΩÆËÆ∞ÂøÜ (.md)', type: 'ChatHistory_Single_MD' },
					{ label: '2) ÂØºÂá∫ËÅäÂ§©ËÆ∞ÂΩï¬∑ÂçïËΩÆËÆ∞ÂøÜ (.txt)', type: 'ChatHistory_Single_TXT' },
					{ label: '3) ÂØºÂá∫ËÅäÂ§©ËÆ∞ÂΩï/Êó•Âøó¬∑ÂÖ®ÈÉ® (.md)', type: 'ChatHistory_ALL_MD' },
					{ label: '4) ÂØºÂá∫ËÅäÂ§©ËÆ∞ÂΩï/Êó•Âøó¬∑ÂÖ®ÈÉ® (.txt)', type: 'ChatHistory_ALL_TXT' }
				],
				selectedExportChatHistoryOptions_en: [
					{ label: '1) Export Chat History for a Single Round (.md)', type: 'ChatHistory_Single_MD' },
					{ label: '2) Export Chat History for a Single Round (.txt)', type: 'ChatHistory_Single_TXT' },
					{ label: '3) Export All Chat History / Logs (.md)', type: 'ChatHistory_ALL_MD' },
					{ label: '4) Export All Chat History / Logs (.txt)', type: 'ChatHistory_ALL_TXT' }
				],
				
				
				//Ê∂àÊÅØÈÄöÁü• tooltipsÂºπÁ™ó Notification tooltips
				isShowNotification: false, //ÊòØÂê¶ÊòæÁ§∫ÈÄöÁü• Show
				setNotificationContent: '', //ÈÄöÁü•ÁöÑÂÜÖÂÆπ Message
				isNotificationHasMask: false, //ÊòØÂê¶ÊòæÁ§∫ÈÅÆÁΩ© Mask 
				isNotificationBottomShowCloseBtn: false,//bottomÂ∫ïÈÉ®ÈÄöÁü•Êó∂ÔºåÊòØÂê¶ÊòæÁ§∫ÂÖ≥Èó≠ÊåâÈíÆ
				setNotificationPosition: 'center', //ÈÄöÁü•Ê†∑Âºè center‰∏≠ÂøÉ or bottomÂ∫ïÈÉ®
				setNotificationTitle: '', //Ê†áÈ¢òÊñáÂ≠ó  Title ÈÄöÁü• ‰ø°ÊÅØ Ë≠¶Âëä ÊèêÈÜí ÈîôËØØ ...
				notificationTimeoutId: 0, // ‰∏ä‰∏Ä‰∏™ÈÄöÁü•ÁöÑÂÆöÊó∂Âô®id


							
				//ÂèØ‰øÆÊîπ Editable - ÁΩëÈ°µ‰∏äÁöÑÁ¨¨‰∏ÄÊù°‰ø°ÊÅØ/Ê¨¢ËøéËØ≠Ôºå‰∏çÂ±û‰∫é‰∏ä‰∏ãÊñá„ÄÇ ËøôÊù°‰ø°ÊÅØÂè™‰ºöÂú®ÁΩëÈ°µ‰∏≠ÊòæÁ§∫Ôºå‰∏ç‰ºöÂõû‰º†ÁªôÊúçÂä°Âô®Ôºå‰∏çÂ±û‰∫éËÅäÂ§©ËÆ∞ÂΩï„ÄÇ 
				// Á§∫ËåÉ{ thefirstmessage: "hi~ ", }  ÊèêÈÜíÔºö1„ÄÅ‰∏çËÉΩÊç¢Ë°åÔºå‰ΩÜÂèØ‰ª•‰ΩøÁî®Êç¢Ë°åÁ¨¶{ \r\n }Ôºõ 2„ÄÅÊîØÊåÅMarkdownËØ≠Ê≥ï„ÄÇ
				// The First Message, This message is out of context,
				// Example{ thefirstmessage: "hi~ ", }  TipsÔºö1.No line breaks. You can use the line break characters{ \r\n }.  2.Supports Markdown.
				thefirstmessage: "### **MCÂà∂ÈÄ†ÁöÑ** ***ABCÊµ∑Ëû∫ Bot*** \r\n##### **v1.0** ‰πåËê®Â•áÂ§¥ÂÉèÂú∞ÂùÄ https://kimi.xinu.ink/gpt.jpg\r\n###### v1.0 Added [Contextual mode].\r\n\r\n_with Just a Single HTML File_ \r\n###### _Change Language: [Settings] > [Language]_  " ,
				
				// v7.05 ÂºÄÂßãÊèêÁ§∫ËØç‰∏çÂª∫ËÆÆÂÜôÂú®‰ª£Á†Å‰∏≠„ÄÇStarting from v7.05, it is advised not to write system prompt in the code. 
				// Á≥ªÁªüÊèêÁ§∫ËØç„ÄÇ‰∏çÂ°´ÁöÑËØùÔºågptSystemPromptÂêéÈù¢ÂçïÂºïÂè∑ÂÜÖÁïôÁ©∫{ gptSystemPrompt: '', }ÔºåÂ°´ÂÜôÂêéÔºå‰ºöÂá∫Áé∞Âú®‚ÄúÊèêÁ§∫ËØçÁºñËæëÂô®‰∏≠‚ÄùÔºå‰∏ç‰ºöËá™Âä®ÁîüÊïàÔºåÈúÄË¶ÅÊâãÂä®‰øùÂ≠òÂêéÊâç‰ºöÁîüÊïà„ÄÇ
				// ‰∏ãÊñπËøôË°åËÆæÁΩÆgptSystemPrompt ÊòØËÆæÁΩÆ[ÈªòËÆ§ÁöÑÊåá‰ª§/ÊèêÁ§∫ËØç/‰∫∫ËÆæ]ÁöÑÁ¨¨‰∏ÄÁßçÊñπÊ≥ïÔºåÊåá‰ª§ÂÜôÂú®ÂçïÂºïÂè∑ÂÜÖ„ÄÇ Â¶ÇÊûúÈªòËÆ§Êåá‰ª§ÂÜôÂú®ËøôÈáåÔºåËøô‰∏™Êåá‰ª§‰ºöÊòæÁ§∫Âú®ËÅäÂ§©ÁïåÈù¢ÁöÑÊåá‰ª§ËæìÂÖ•Ê°Ü‰∏≠„ÄÇ Â¶ÇÊûúËøòËÆæÁΩÆÊúâÁ¨¨‰∫åÁßçÈöêÂΩ¢Êåá‰ª§ÁöÑËØùÔºå‰ª•ÈöêÂΩ¢Êåá‰ª§‰∏∫ÂáÜÔºåÁ¨¨‰∏ÄÁßç‰ºöË¢´ÂøΩÁï•„ÄÇ
				// ‰øùÂ≠òÂà∞‰∏ä‰∏ãÊñáÊï∞ÁªÑmsgContent‰∏≠ÊâçËÉΩÁîüÊïàÔºå‰∏ç‰øùÂ≠òÂàô‰∏çÁîüÊïà„ÄÇ
				// System Prompt(optional): Will be displayed in the "Prompt Editor". It needs to be saved before it takes effect.
				gptSystemPrompt: '', //v7.05 ËØ•ÂèòÈáèÊòØ‚ÄúÊèêÁ§∫ËØçÁºñËæëÂô®ÁöÑÂÜÖÂÆπ‚ÄùÔºå‰∏çÂÜçÊòØÁ≥ªÁªüÊèêÁ§∫ËØç„ÄÇThe variable is now "the content of the prompt editor" instead of the system prompt.
				
				//ÂèØ‰øÆÊîπ Editable - (‰∏ÄËà¨‰∏çÊîπÔºåÂæàÂ∞ë‰ºöÁî®Âà∞ÈöêÂΩ¢Êåá‰ª§) ‰∏çÂ°´ÁöÑËØùÔºåÂçïÂºïÂè∑ÂÜÖÁïôÁ©∫ÔºåÂç≥Ôºö gptSystemPrompt_hidden: '',  
				// ‰∏ãÊñπËøôË°åËÆæÁΩÆgptSystemPrompt_hidden ÊòØËÆæÁΩÆ[ÈªòËÆ§ÁöÑÊåá‰ª§/ÊèêÁ§∫ËØç/‰∫∫ËÆæ]ÁöÑÁ¨¨‰∫åÁßçÊñπÊ≥ïÔºåÊåá‰ª§ÂÜôÂú®ÂçïÂºïÂè∑ÂÜÖ„ÄÇ Á¨¨‰∫åÁßçÊñπÊ≥ïÊòØ[ÈöêÂΩ¢Êåá‰ª§/ÈöêËóèÊåá‰ª§/ÈöêÂΩ¢ÊèêÁ§∫ËØç/ÈöêËóèÊèêÁ§∫ËØç]ÁöÑÂÜôÊ≥ï„ÄÇÂ¶ÇÊûúÈªòËÆ§Êåá‰ª§ÂÜôÂú®ËøôÈáåÔºåËøô‰∏™Êåá‰ª§‰∏ç‰ºöÊòæÁ§∫Âú®ËÅäÂ§©ÁïåÈù¢ÁöÑÊåá‰ª§ËæìÂÖ•Ê°Ü‰∏≠ÔºåÊåá‰ª§ÊòØÈöêÂΩ¢ÁöÑ„ÄÇ Âú®Êú¨‰ª£Á†Å‰∏≠ÊêúÁ¥¢‚ÄúÈöêÂΩ¢Êåá‰ª§‚ÄùÂèØÊü•Áúã[Ê∑ªÂä† disabled Êù•Á¶ÅÊ≠¢ËÅäÂ§©ÁïåÈù¢‰∏äËæìÂÖ•Êñ∞Êåá‰ª§]ÁöÑÊñπÊ≥ï„ÄÇ
				// Â¶ÇÊûúÁî®Á¨¨‰∫åÁßçÊñπÊ≥ïËÆæÁΩÆ‰∫Ü[ÈöêÂΩ¢Êåá‰ª§]ÔºåÈÇ£‰πàGPTÊåá‰ª§Â∞Ü‰ª•ËøôÈáåÁöÑ[ÈöêÂΩ¢Êåá‰ª§]‰∏∫ÂáÜÔºå‰ºöËá™Âä®ÂøΩÁï•ËÅäÂ§©ÁïåÈù¢‰∏äÁöÑÂÖ∂‰ªñÊåá‰ª§ÔºàÂåÖÊã¨Á©∫ÁôΩÁöÑÊåá‰ª§ÔºâÔºå‰∏ç‰ºöÂè†Âä†„ÄÇ
				// ËÆæÁΩÆÈöêÂΩ¢ÊèêÁ§∫ËØçÂêéÔºåÊèêÁ§∫ËØçÂºπÁ™óÂ∞ÜË¢´Á¶ÅÁî®Ôºå‰ª£Á†ÅÂÜôÂú®mounted()Èáå
				// Hidden System Prompt, with the highest priority. Once set, the System Prompt will be based on the Hidden System Prompt, and the Prompt in the System Prompt input box will be invalid. 
				// If "gptSystemPrompt_hidden" is set, the Prompt Generator will be disabled. The judgment code is written in the mounted() method.
				gptSystemPrompt_hidden: '',
				
				

				//v-html 
				msgList: [{
					msg: "",   //ÈªòËÆ§Á©∫„ÄÇËøôÈáå‰∏çÂ°´ÂÜÖÂÆπÔºÅ Do not fill in!
					my: false,
					datetime: "2000-01-01 00:00:00", // ÈªòËÆ§"2000-01-01 00:00:00"ÔºåÁî®‰∫éÂà§Êñ≠Ôºå‰∏çË¶ÅÊîπ
					wechatstyledatetime: null,
					hr: false
				}],
				
				//msgContentÔºö‰∏ä‰∏ãÊñá context
				msgContent : [{role: "system", content: "" }] , 
				
				//msgTokensÔºöÂØπÂ∫îmsgContentËÆ∞ÂΩïÊØèÊù°Ê∂àÊÅØÁöÑtokenÊï∞Èáè Synchronize updates with 'msgContent' and record tokens data for each message.  role: AI & user. 
				//completion_tokensÔºöÂçïÊù°Ê∂àÊÅØÁöÑtokensÊï∞Èáè Tokens for a single message.
				//total_tokensÔºöÊà™Ê≠¢ÂΩìÂâçÊ∂àÊÅØÁöÑtokensÊÄªÊï∞ Current total tokens.
				//Ê∞∏Ëøú‰øùÁïôÁ¨¨‰∏ÄÊù°ËÆ∞ÂΩï[0]ÔºåÂØπÂ∫îmsgContent[0]
				//role: AI & user. 
				msgTokens : [{role: "AI", completion_tokens: 0, total_tokens: 0 }] , //tokens:int
				
				msg: "", //ËæìÂÖ•ÁöÑÊ∂àÊÅØ message  ËÅäÂ§©ËæìÂÖ•Ê°Ü chat input box
				msgContentForMsgList_SingleRound : [{role: "system", content: "", datetime: "2000-01-01 00:00:00" }] , //ÔºàÈªòËÆ§Êó∂Èó¥‰∏çË¶ÅÊîπÔºâ ‰∏émsgContentÁöÑ‰∏çÂêåÁÇπÔºö1.‰ºö‰øùÁïôÊú™Êí§ÈîÄÁöÑÂèëÈÄÅÂ§±Ë¥•ÁöÑÊï∞ÊçÆÔºõ2.Êï∞ÊçÆ‰∏émsgListÁöÑÊúÄÂêé‰∏ÄËΩÆÂØπËØùÂØπÂ∫îÔºõ3.ËÆ∞ÂΩïÊó∂Èó¥„ÄÇ Differences from msgContent: 1. Failed messages that have not been undone will be retained; 2. Data corresponds to msgList (New Chat, Only single round); 3.Add datetime„ÄÇ
				

				userSettings_Version: '1.8.16', // '1.8.16'ÁöÑ‰∏ä‰∏ÄÁâàÊú¨‰∏∫'1.7.09'Ôºà‰ΩÜÊòØÔºå8Êúà6Êó•‰πãÂâç1.7.09ÁâàÊú¨Âõ†ÂÜôÈîôÂèòÈáèÂêçÔºåÂØºËá¥Â≠òÂÇ®ÁöÑÊï∞ÊçÆÊ≤°ÊúâÁâàÊú¨Âè∑Ôºâ„ÄÇ  The previous version of '1.8.16' was '1.7.09'. However, the version 1.7.09 (before August 6th) had a mistake in the variable name, resulting in the stored data lacking a version number.
				//  UserÁî®Êà∑ Settings - ÂèòÈáèÂêçÂçï/ÂèòÈáèÂàóË°®/ÂèòÈáèÁôΩÂêçÂçï/ÈªòËÆ§ÂÄº„ÄÇ  Related to User - Variable list, variable whitelist, default value.
				//* ÂèØ‰øÆÊîπ Editable.  ÈªòËÆ§ÁöÑËÆæÁΩÆÔºåÈªòËÆ§ÂèÇÊï∞ÔºåÈªòËÆ§ÂÄº„ÄÇ Default settings, default parameters, default values.
				//* ÂèØ‰øÆÊîπ Editable.  ÈªòËÆ§ÂÄº‰∏ªË¶ÅÂú®ËøôÈáå‰øÆÊîπ Modify default values primarily here.
				//* ÊîØÊåÅÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®(localStorage)ÔºåÁõ¥Êé•Âú®ÁΩëÈ°µ‰∏≠‰øÆÊîπÂç≥ÂèØÔºå‰∏ãÊ¨°ÂÜçÊâìÂºÄÊó∂‰ºöÂä†ËΩΩ‰∏äÊ¨°ÁöÑÂèòÈáèËÆæÁΩÆ„ÄÇ
				//* Supports for browser local storage (localStorage), which can be directly modified in the [Settings] of the webpage.
				userVariables_default: {
					apitemperature: 0.7, //Ôºà0.0ÔΩû2.0ÔºâÊé•Âè£ÂèÇÊï∞ temperature ÈªòËÆ§0.7 (ÂÆòÊñπÈªòËÆ§1.0) v-model.number
					apiMaxTokens:2048, //Ôºà1ÔΩû4096ÔΩû16384ÔºâÊé•Âè£ÂèÇÊï∞ max_tokens ÈªòËÆ§2048 v-model.number (4095 4096 4097 16384 16385 gpt-3.5 gpt-4 gpt3.5 gpt4)
					apiGPTModel: 'gpt-3.5-turbo-16k', //  ÂèØ‰øÆÊîπ Editable. Default Model. Êé•Âè£ÂèÇÊï∞ model ÈªòËÆ§'gpt-3.5-turbo-16k'
					apiTopP:1, // Ôºà0.0ÔΩû1.0ÔºâÊé•Âè£ÂèÇÊï∞ top_p ÂÆòÊñπÈªòËÆ§1 v-model.number
					apiPresencePenalty:0, //Ôºà-2.0ÔΩû2.0ÔºâÊé•Âè£ÂèÇÊï∞ presence_penalty ÂÆòÊñπÈªòËÆ§0 v-model.number
					apiFrequencyPenalty:0, //Ôºà-2.0ÔΩû2.0ÔºâÊé•Âè£ÂèÇÊï∞ frequency_penalty ÂÆòÊñπÈªòËÆ§0 v-model.number
					apiURL: 'https://abcapi.xinu.ink/v1/chat/completions',  // Êé•Âè£ÂèÇÊï∞ Êé•Âè£ÁΩëÂùÄ ÈªòËÆ§ÁöÑÊé•Âè£ ÈªòËÆ§‰∏∫ÂÆòÊñπÊé•Âè£:'https://api.openai.com/v1/chat/completions'
					selectedApiURL: '',  //selectedÂÄº
				
					settingsLanguage: 'cn', //ÂèØ‰øÆÊîπ Editable. ÈªòËÆ§ËØ≠Ë®Ä ÁÆÄ‰Ωì‰∏≠Êñácn Ëã±Êñáen„ÄÇ ÂèØ‰øÆÊîπ Editable. Default language. Chinese-Simplified = cn  English = en
					settingsFontSize: 14, //Â≠ó‰ΩìÂ§ßÂ∞èËÆæÁΩÆ ÈªòËÆ§14px Êï∞Â≠ó Êï∞ÂÄºÂûã
					settingsTime_WechatStyle: true, //ÊòØÂê¶ÊòæÁ§∫Êó∂Èó¥(ÂæÆ‰ø°Ê†∑Âºè) ÈªòËÆ§ÊòæÁ§∫
					settingsTime_Message: 1, //ÊòØÂê¶ÊòæÁ§∫Êó∂Èó¥(Ê∂àÊÅØ) ÈªòËÆ§‰∏çÊòæÁ§∫ Êï∞Â≠óÔºåÊï∞ÂÄºÂûã ‰ª£Ë°®‰∏âÁßçÁä∂ÊÄÅ state.  1:hide ; 2:show height:0 ; 3:show height:+10
					settingsDividerLine: true, //ÊòØÂê¶ÊòæÁ§∫ÂàÜÂâ≤Á∫ø ÈªòËÆ§ÊòæÁ§∫
					
					settingsShortcut_CheckApiKey: true, //ÊòØÂê¶ÂºÄÂêØÈ™åËØÅAPI KeyÁöÑÂø´Êç∑ÈîÆ ÔºàÁîµËÑëÁ´Ø‰ΩøÁî®Ôºâ ÈªòËÆ§ÂºÄÂêØ ***v8.27 ÊîπÁî®ÈÄî ÊîπÊàê"ÊâìÂºÄKeyÊ®°ÂºèÁ™óÂè£"ÁöÑÂø´Êç∑ÈîÆ Change the original purpose to "Open Key Mode window".
					settingsShortcut_Clear: false, //ÊòØÂê¶ÂºÄÂêØ Ê∏ÖÈô§ËÆ∞ÂøÜ ÁöÑÂø´Êç∑ÈîÆ ÔºàÁîµËÑëÁ´Ø‰ΩøÁî®Ôºâ ÈªòËÆ§ÂÖ≥Èó≠
					settingsShortcut_Undo: false, //ÊòØÂê¶ÂºÄÂêØ Êí§ÈîÄ ÁöÑÂø´Êç∑ÈîÆ ÔºàÁîµËÑëÁ´Ø‰ΩøÁî®Ôºâ ÈªòËÆ§ÂÖ≥Èó≠
					settingsShortcut_Retry: true, //ÊòØÂê¶ÂºÄÂêØ ÈáçÈóÆ ÁöÑÂø´Êç∑ÈîÆ ÔºàÁîµËÑëÁ´Ø‰ΩøÁî®Ôºâ ÈªòËÆ§ÂºÄÂêØ
					
					chatHistoryPromptOnlyUseBackticks: false , //ÂØºÂá∫ÁöÑËÅäÂ§©ËÆ∞ÂΩï‰∏≠ÔºåÁ≥ªÁªüÊèêÁ§∫ËØçÁöÑmarkdownËØ≠Ê≥ïÂ§ÑÁêÜÊñπÂºè„ÄÇ true:‰ªÖÁî®"‰ª£Á†ÅÂùó"ÂåÖË£π  false:Ëá™Âä®Âà§Êñ≠‰ΩøÁî®"ÂºïÁî®"ÊàñËÄÖ"‰ª£Á†ÅÂùó"ÂåÖË£π
					isShowProConfig:true, // ÊòæÁ§∫/ÈöêËóè API‰∏ì‰∏öËÆæÁΩÆ Show/Hide Professional API Settings
					isSimpleMode: false,  //true=ÁÆÄÁ∫¶Ê®°ÂºèÔºàÈªòËÆ§Ê®°ÂºèÔºâÔºåfalse=Êñ∞Áî®Êà∑Ê®°Âºè„ÄÇÂå∫Âà´Âú®‰∫éÁÆÄÁ∫¶Ê®°ÂºèÊòæÁ§∫ÁöÑ"ÊèêÁ§∫‰ø°ÊÅØ"‰ºöÂ∞ë‰∫õ„ÄÇ true=Simple Mode (Normal Mode), false=User Onboarding. The difference is that there will be more "help information" in User Onboarding.
					pageScaling: '0.8', //*Êñ∞Â¢ûÂèòÈáèÊó•ÊúüÔºö7.09 „ÄÇ ÁßªÂä®ËÆæÂ§áÈ°µÈù¢ÊØî‰æã
					isThirdPartyAPIKeyEnabled: false, //*Êñ∞Â¢ûÂèòÈáèÊó•ÊúüÔºöv8.16 „ÄÇ ÊòØÂê¶‰∏∫Á¨¨‰∏âÊñπAPI KeyÊ®°Âºè(ÂçïKeyÊ®°ÂºèÔºåÈùûOpenAIÁöÑKey) [Key Mode]
					isLoadThirdPartyPaidAPIs: false, //*Êñ∞Â¢ûÂèòÈáèÊó•ÊúüÔºöv8.16  ÊòØÂê¶Âä†ËΩΩÁ¨¨‰∏âÊñπÊî∂Ë¥πAPIÁöÑURLÔºàÂä†ËΩΩÂà∞‰∏ãÊãâÊ°Ü‰∏≠ÔºâLoad the URL of the third-party paid API (displayed in the preset dropdown menu)?
				},
				
				chatDataList_Version: '1.7.05',
				//  ËÅäÂ§©Áõ∏ÂÖ≥ Chat Variables - ÂèòÈáèÂêçÂçï/ÂèòÈáèÂàóË°®/ÂèòÈáèÁôΩÂêçÂçï/ÈªòËÆ§ÂÄº„ÄÇ  Related to Chat Variables  - Variable list, variable whitelist, default value.
				// ‰∏çÊîπÂä® Non-editable
				chatVariables_default: {
					btnDisabledState_Export: true,
					settingsContextualMode: 0, //‰∏ä‰∏ãÊñáÊ®°Âºè ÈªòËÆ§ËøûÁª≠ÂØπËØù„ÄÇ  Int Êï∞Â≠óÔºåÊï∞ÂÄºÂûã 0‰ª£Ë°®ËøûÁª≠ÂØπËØù
					hasSystemPromptBeenSaved: false,
					userMsgTokensForRetry: 0, //int ‰∏¥Êó∂ËÆ∞ÂΩïÈáçÈóÆÊó∂ÁöÑtokensÊï∞ÊçÆ
					succQA_Count: 0, //int ÂΩìÂâçÊúâÊïàÁöÑ‰∏ä‰∏ãÊñáÊï∞ÈáèÔºå‰∏ÄÈóÆ‰∏ÄÁ≠îsuccQA_Count = 2 „ÄÇ Êï∞ÈáèÂèòÂåñÂØπÂ∫îthis.msgContent
					totaltokens: 0, //int						
					chathistory: '# GPTËÅäÂ§©ËÆ∞ÂΩï / Chat History  \r\n\r\n',
					gptSystemPromptReadOnly: '',//‰ªÖÂ±ïÁ§∫
				},	
							
				//  ËÅäÂ§©Áõ∏ÂÖ≥ Chat Data - ÂèòÈáèÂêçÂçï/ÂèòÈáèÂàóË°®/ÂèòÈáèÁôΩÂêçÂçï/ÈªòËÆ§ÂÄº„ÄÇ  Related to Chat Data - Variable list, variable whitelist, default value.
				// ‰∏çÊîπÂä® Non-editable
				chatData_default: {
					//*ÂçïÁã¨ÊâãÂä®Âä†ÂÖ• version: '******',  *ÈúÄË¶ÅÊéíÈô§
					chatcreatedtime: null,
					chatlasttime: null,
					chatid: null,
					chattitle: '',

					msgList: [{
						msg: "",
						my: false,
						datetime: "2000-01-01 00:00:00",
						wechatstyledatetime: null,
						hr: false
					}],
					msgContent : [{role: "system", content: "" }] , 
					msgTokens : [{role: "AI", completion_tokens: 0, total_tokens: 0 }] ,
					msgContentForMsgList_SingleRound : [{role: "system", content: "", datetime: "2000-01-01 00:00:00" }] ,
					msg: '',
					//*ÊâãÂä®Âä†ÂÖ• chatVariables  *Chat Variables ÈúÄË¶ÅÊéíÈô§
				},
				
				apikeyData_Version: '1.7.13',			
				//  API KeyÊï∞ÊçÆ API Keys Data - ÂèòÈáèÂêçÂçï/ÂèòÈáèÂàóË°®/ÂèòÈáèÁôΩÂêçÂçï/ÈªòËÆ§ÂÄº„ÄÇ  Related to API key - Variable list, variable whitelist, default value.
				// ‰∏çÊîπÂä® Non-editable
				apikeyData_default: {
					api: '', //‰∏çÂ≠òÊï∞ÊçÆÔºå‰ªÖÁî®‰∫éÈáçÁΩÆÁ©∫ÂÄºÔºåÂèä‰Ωú‰∏∫ÁôΩÂêçÂçï‰ΩøÁî®„ÄÇ Do not store data, only use for resetting empty values and as a whitelist.  **ÂéüÂÖàÂàùÂßãÂÄºÁ≠â‰∫éthia.api, ÂÜôÂú®mounted()Ôºå‰ΩÜÔºå‰ªév7.22ÂºÄÂßãÔºåÂàùÂßãÂÄº‰øùÊåÅ‰∏∫Á©∫„ÄÇ
					timerId: null, 
					apiCheckedData: [], //Êï∞ÁªÑ„ÄÇ‰∏çÂ≠òÊï∞ÊçÆÔºå‰ªÖÁî®‰∫éÈáçÁΩÆÁ©∫ÂÄºÔºåÂèä‰Ωú‰∏∫ÁôΩÂêçÂçï‰ΩøÁî®„ÄÇ Do not store data, only use for resetting empty values and as a whitelist.  **ÂéüÂÖàÈªòËÆ§Á≠â‰∫éthia.apiCheckedData, ÂÜôÂú®mounted()Ôºå‰ΩÜÔºå‰ªév7.22ÂºÄÂßãÔºåÂàùÂßãÂÄº‰øùÊåÅ‰∏∫Á©∫„ÄÇ
				},
				
				promptsData_Version: '1.7.05',				
				//  ÊèêÁ§∫ËØçÊï∞ÊçÆ Prompts Data - ÂèòÈáèÂêçÂçï/ÂèòÈáèÂàóË°®/ÂèòÈáèÁôΩÂêçÂçï/ÈªòËÆ§ÂÄº„ÄÇ  Related to Prompts - Variable list, variable whitelist, default value.
				// ‰∏çÊîπÂä® Non-editable
				promptsData_default: {
					gptSystemPrompt: '', //‰∏çË¶ÅÊîπÔºåÂàùÂßãÂÄºÁ≠â‰∫éthia.gptSystemPrompt, ÂÜôÂú®mounted()  *7.22 ÂæÖÂÆö
					gptPrompts: [], //Êï∞ÁªÑ ‰∏çÂ≠òÊï∞ÊçÆÔºå‰ªÖÁî®‰∫éÈáçÁΩÆÁ©∫ÂÄºÔºåÂèä‰Ωú‰∏∫ÁôΩÂêçÂçï‰ΩøÁî®„ÄÇ Do not store data, only use for resetting empty values and as a whitelist.  *ÂéüÂÖàËÆæÁΩÆÂàùÂßãÂÄºÁ≠â‰∫éthia.gptPrompts, ÂÜôÂú®mounted()Ôºå‰ΩÜÔºå‰ªév7.22ÂºÄÂßãÔºåÂàùÂßãÂÄº‰øùÊåÅ‰∏∫Á©∫„ÄÇ
				}
			}
		},
		methods: {
			//ÊåâÈíÆÔºöÂØºÂá∫ÊâÄÊúâÂØπËØù Export chat history  filetype:'markdown'(.md) or 'plain'(.txt)
			ExportData(filecontent, filename, filetype){
				// ÂàõÂª∫BlobÂØπË±°Âπ∂ÁîüÊàê‰∏ãËΩΩÈìæÊé•
				const blob = new Blob([filecontent], { type: 'text/' + filetype });
				const urlObject = window.URL || window.webkitURL || window ;	
				const url = urlObject.createObjectURL(blob);
				// ÂàõÂª∫‰∏ãËΩΩÈìæÊé•Âπ∂Ëá™Âä®‰∏ãËΩΩ
				const downloadLink = document.createElement('a');
				downloadLink.href = url;
				downloadLink.style.display="none";
				const now = new Date();
				filename = filename + ' ' +  this.formatDateYYYYMMDDHHmmss(now,'.').slice(5) ; // like ‚Äú10-14 10.23.45‚Äù
				filename = filetype == 'markdown' ? filename + '.md' : filename + '.txt';
				downloadLink.download = filename;
				document.body.appendChild(downloadLink);
				downloadLink.click(); 
				document.body.removeChild(downloadLink);
  			}, 
			//ÊåâÈíÆÔºöÂØºÂá∫ÊúÄÂêé‰∏ÄËΩÆ  showtimeÊòØÂê¶ÂØºÂá∫Êó∂Èó¥  exportpromptÊòØÂê¶ÂØºÂá∫ÊèêÁ§∫ËØç  onlyusebackticksÊèêÁ§∫ËØçÊòØÂê¶Âè™‰ΩøÁî®ÂèçÂºïÂè∑ÂåÖË£π  filetype:'markdown'(.md) or 'plain'(.txt)
			ExportData_SingleRound(showtime, exportprompt, onlyusebackticks, filetype){

				if (this.checkBusyStatus()) {
					// Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ
					return;
				} 
				//ÂèëÈÄÅ‰∏≠ÁöÑÁä∂ÊÄÅ‰∏çÂÖÅËÆ∏ÂØºÂá∫ÔºåÊâÄ‰ª•ÂΩì‰∏ä‰∏ãÊñáthis.msgContentÁöÑÈïøÂ∫¶>=3Êó∂ÔºåË°®Á§∫Â≠òÂú®ÊúâÊïàÈóÆÁ≠îÔºàÂçïËΩÆÔºâ
				if( this.msgContent.length < 3 ){
					//‰∏çÂ≠òÂú®ÂèëÈÄÅÊàêÂäüÁöÑËÅäÂ§©ËÆ∞ÂΩï
					let notif = this.settingsLanguage == 'cn' ? 'ÂØºÂá∫Êú¨ËΩÆ‰∏ä‰∏ãÊñáËÆ∞ÂøÜÔºöÂΩìÂâç‰∏çÂ≠òÂú®ÊúâÊïàÁöÑËÅäÂ§©ËÆ∞ÂΩï(ÂçïËΩÆ)ÔºåÊó†Êï∞ÊçÆÂèØÂØºÂá∫' : "Export current round's context: No valid context records found, no data available for export." ; //Â≠òÂú®ÂçïÂºïÂè∑
					setTimeout(() => { //‰πãÂâçÊúâ‰∏Ä‰∏™ÂºπÁ™óÈÄöÁü•ÔºåËøôÈáåÈúÄË¶ÅÂª∂Ëøü
						this.showNotification(notif, 'bottom', '', 7000);
					}, 1800);
					return;
				}
				let context = this.msgContentForMsgList_SingleRound ;
				let txt = '';
				let time = '';
				txt =  this.settingsLanguage == 'cn' ? '# GPTËÅäÂ§©ËÆ∞ÂΩï\r\n\r\n' : '# Chat History\r\n\r\n';
	
				//Â¶ÇÊûúÈúÄË¶ÅÂØºÂá∫ÊèêÁ§∫ËØçÔºå ÂØπÊèêÁ§∫ËØçÁî®markdownËØ≠Ê≥ïËøõË°åÂåÖË£πÔºå ËØ≠Ê≥ïËá™Âä®ÈÄâÊã©Áî®"ÂºïÁî®"ÊàñËÄÖ"‰ª£Á†ÅÂùó",
				//ÂèÇÊï∞onlyusebackticksÂèØ‰ª•ÊåáÂÆöÁî®‰ª£Á†ÅÂùóÔºàÂØºÂá∫ÂêéÔºåËã•ÊèêÁ§∫ËØçÂæàÂ§çÊùÇÂØºËá¥‰∫ÜÊéíÁâàÈîô‰π±ÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ËÆæÁΩÆonlyusebackticks‰∏∫trueÔºâ
				if ( exportprompt ) {
					const sys_prompt =  context[0]['content'].trim();  //context[0]‰∏éthis.msgList[0]Áõ∏ÂêåÔºåÂêåÊ≠•Êõ¥Êñ∞„ÄÇ context[0]['role'] = "system"
		
					//‰ª•‰∏ã‰ª£Á†ÅÊ≥®Èáä ËØ¶ËßÅaddSystemPromptToChatHistory 
					let hasMultipleLines = /\r?\n\r?\n/.test(sys_prompt); 
					let backticks = this.findMaxBackticks(sys_prompt); 
					hasMultipleLines = backticks != '' ? true : hasMultipleLines ;
					backticks = backticks == '' ? '````' : backticks ; 
					if ( onlyusebackticks ) {
						hasMultipleLines = true;
					}
	
					let addMarkdownSyntaxStart = hasMultipleLines ? ( '\r\n' + backticks + '\r\n' ) : '\r\n> ' ;  // (> ÂêéÈù¢Êúâ‰∏™Á©∫Ê†º)
					let addMarkdownSyntaxEnd = hasMultipleLines ? ( '\r\n' + backticks + '\r\n\r\n' ) : '\r\n\r\n' ; 
					let nullprompt = '';  //ÊèêÁ§∫ËØç‰∏∫Á©∫ÁöÑÊÉÖÂÜµ
					if( sys_prompt == '' ){
						nullprompt = this.settingsLanguage == 'cn' ? ': Á©∫' : ': None' ; 
						addMarkdownSyntaxStart = '\r\n'; 
						addMarkdownSyntaxEnd = '\r\n' ;
					}
		
					const head = this.settingsLanguage == 'cn' ? '#### Á≥ªÁªüÊèêÁ§∫ËØç system prompt ' : '#### #System Prompt ' ;
					txt += ( head + nullprompt + addMarkdownSyntaxStart + sys_prompt + addMarkdownSyntaxEnd );
				}
	
				//ÂºÄÂßãËØªÂèñÂØπËØùËÆ∞ÂΩï 
				for(let i = 1; i < context.length; i++) {
					if(context[i]['role'] === 'user') {
						if(i === context.length-1) {
							break; //ÊúÄÂêé‰∏ÄÊù°ËÆ∞ÂΩïÔºåÂ¶ÇÊûúÊòØuserÔºåËØ¥ÊòéÊòØÂ§±Ë¥•ÁöÑÔºåÂèäÊ≤°Êúâ[i+1],ÈúÄË¶ÅË∑≥Âá∫Âæ™ÁéØ
						}
						//ÊéíÈô§ÊéâÂèëÈÄÅÂ§±Ë¥•ÁöÑÊ∂àÊÅØ„ÄÇÂà§Êñ≠‰∏ã‰∏ÄÊù°ËÆ∞ÂΩïÁöÑroleÔºöÂèëÈÄÅÂ§±Ë¥•ÁöÑËÆ∞ÂΩïÔºå‰∏ã‰∏ÄÊù°ÁöÑrole‰∏ÄÂÆöËøòÊòØ'user'ÔºõÂèëÈÄÅÊàêÂäüÁöÑËÆ∞ÂΩïÔºå‰∏ã‰∏ÄÊù°ÁöÑrole‰∏ÄÂÆöÊòØ'assistant'„ÄÇ
						let nextRole = context[i+1]['role'];
						while(nextRole === 'user' && i+1 < context.length-1) {
							i++;
							nextRole = context[i+1]['role'];
						}
						if(nextRole === 'assistant') {
							//Ê≠§Êó∂iÊòØÂèëÈÄÅÊàêÂäüÁöÑuserÁöÑÊ∂àÊÅØ 
							time = showtime ? (' _' + context[i]['datetime'] +  '_  \r\n') : ' \r\n';
							txt += this.settingsLanguage == 'cn' ? '**User**' : '**User**' ;
							txt += time;
							txt += context[i]['content'].replace(/\n/g, "\r\n") + '\r\n\r\n';
						}
					}else if(context[i]['role'] === 'assistant') {
						//gptÁöÑÂõûÂ§ç
						time = showtime ? (' _' + context[i]['datetime'] +  '_  \r\n') : ' \r\n';
						txt += this.settingsLanguage == 'cn' ? '**GPT**' : '**GPT**' ;
						txt += time;
						txt += context[i]['content'].replace(/\n/g, "\r\n") + '\r\n\r\n';
					}
				}
		
				//ÂØºÂá∫ .md ÊàñËÄÖ .txt
				this.ExportData(txt, this.exportTXTFileName_SingleRound, filetype);
			},
			
			//ÊåâÈíÆÔºöÂØºÂá∫Êï∞ÊçÆ JSON   
			ExportData_JSON(stringData, filename){
				//ËÆ°ÁÆóÂ§ßÂ∞è
				let filename_dataSize = '';
				try{
					const _dataSize = this.calculateStringSize(stringData, 'utf-16') / 1024 / 1024 ;
					let notif = '';
					if (_dataSize > 4.99 ){
						notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÂØºÂá∫ÁöÑÊï∞ÊçÆÂ∑≤ËææÂà∞ ' + _dataSize.toFixed(2) + ' MBÔºåÂèØËÉΩÊó†Ê≥ïÂú®‰∏Ä‰∫õÊµèËßàÂô®‰∏≠ÂØºÂÖ• (ÈÉ®ÂàÜÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®‰∏äÈôê‰∏∫5MB)„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÈÄÇÈÖçÊõ¥Â§öÁöÑÊµèËßàÂô®ÔºåÂª∫ËÆÆÂàÜÁ±ªÂØºÂá∫ (ÊàñÊãÜÂàÜ‰∏∫Âçï‰∏™ÂØπËØùÂØºÂá∫„ÄÅÊäπÊéâÊó•Âøó)Ôºå‰ª•ÂáèÂ∞èÂçï‰∏™Êñá‰ª∂ÁöÑÂ§ßÂ∞è„ÄÇ' : 'The currently exported data has reached ' + _dataSize.toFixed(2) + ' MB, which may exceed the local storage limit of 5MB for some browsers, causing import failure. If you need to adapt to more browsers, it is recommended to export data by categories to reduce the size of individual files or split them into separate chat exports, or erase logs.' ;
						setTimeout(() => {
							this.showNotification(notif, 'center', '');
						}, 1600);//Âª∂Ëøü Á≠âÈ¶ñ‰∏™ÈÄöÁü•ÂºπÂá∫Âêé ÂÜçÊõøÊç¢
					}else if (_dataSize > 3 ){
						notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÂØºÂá∫ÁöÑÊï∞ÊçÆÂ§ßÂ∞è‰∏∫ ' + _dataSize.toFixed(2) + ' MB„ÄÇÂ∞èË¥¥Â£´ÔºöÂèØ‰ª•ÈÄöËøáÊãÜÂàÜÂØπËØùÊàñÊäπÊéâÊó•ÂøóÊù•Áº©Â∞èÊñá‰ª∂' : 'The current exported data size is ' + _dataSize.toFixed(2) + ' MB. Tip: You can reduce the file size by exporting individual chats or erasing logs.' ;
						setTimeout(() => {
							this.showNotification(notif, 'bottom', '', 8000);
						}, 1600);//Âª∂Ëøü Á≠âÈ¶ñ‰∏™ÈÄöÁü•ÂºπÂá∫Âêé ÂÜçÊõøÊç¢
					}
					filename_dataSize = _dataSize.toFixed(2); //Âçï‰ΩçÔºöMB
					filename_dataSize = '(' + filename_dataSize + 'MB) ';
				}catch (e) {
					filename_dataSize = '';
					console.error('ExportData_JSON() - ËÆ°ÁÆóÂ§ßÂ∞èÂá∫ÈîôÔºå‰∏çÂΩ±ÂìçÂØºÂá∫',e);
				}
								
				// ÂàõÂª∫BlobÂØπË±°Âπ∂ÁîüÊàê‰∏ãËΩΩÈìæÊé•
				const blob = new Blob([stringData], { type: 'application/json' });
				const url = URL.createObjectURL(blob);

				// ÂàõÂª∫‰∏ãËΩΩÈìæÊé•Âπ∂Ëá™Âä®‰∏ãËΩΩ
				const downloadLink = document.createElement('a');
				downloadLink.href = url;
				downloadLink.style.display="none";
				const now = new Date();
				filename = filename + ' ' + filename_dataSize +  this.formatDateYYYYMMDDHHmmss(now,'.').slice(5) + '.json' ; // like ‚Äú10-14 10.23.45‚Äù
				downloadLink.download = filename; 
				document.body.appendChild(downloadLink);
				downloadLink.click(); 
				document.body.removeChild(downloadLink);
			},

  			
			//Ê†ºÂºèÂåñÊó∂Èó¥  dateÊó∂Èó¥ delimiterÂàÜÈöîÁ¨¶  ÂàÜÈöîÁ¨¶‰∏∫":"ËæìÂá∫Ôºö2021-10-14 10:23:45  ÂàÜÈöîÁ¨¶‰∏∫"."ËæìÂá∫Ôºö2021-10-14 10.23.45
			formatDateYYYYMMDDHHmmss(date,delimiter) {
				const year = date.getFullYear();
				let month, day, hour, minute, second;
				if (String.prototype.padStart) {
					month = (date.getMonth() + 1).toString().padStart(2, '0');
					day = date.getDate().toString().padStart(2, '0');
					hour = date.getHours().toString().padStart(2, '0');
					minute = date.getMinutes().toString().padStart(2, '0');
					second = date.getSeconds().toString().padStart(2, '0');
				} else {
					month = (date.getMonth() + 1).toString();
					day = date.getDate().toString();
					hour = date.getHours().toString();
					minute = date.getMinutes().toString();
					second = date.getSeconds().toString();
					// Âú®Êúà‰ªΩ„ÄÅÊó•Êúü„ÄÅÂ∞èÊó∂„ÄÅÂàÜÈíüÂíåÁßíÊï∞ÂâçË°•Èõ∂
					if (month.length === 1) {
						month = '0' + month;
					}
					if (day.length === 1) {
						day = '0' + day;
					}
					if (hour.length === 1) {
						hour = '0' + hour;
					}
					if (minute.length === 1) {
						minute = '0' + minute;
					}
					if (second.length === 1) {
						second = '0' + second;
					}
				}
				//ES6ÁöÑÂÜôÊ≥ïÔºö  return `${year}-${month}-${day} ${hour}${delimiter}${minute}${delimiter}${second}`;
				return year + '-' + month + '-' + day + ' ' + hour + delimiter + minute + delimiter + second; //ÂÖºÂÆπÊÄßÊõ¥Â•Ω„ÄÇ Support more browsers.
			}, 
			//Ôºà6.20:Êîπ‰∏∫DOMÊ∏≤Êüì‰πãÂâçÂà§Êñ≠ÔºâÊòæÁ§∫ÂæÆ‰ø°Ê†∑ÂºèÁöÑÊó∂Èó¥„ÄÇ Âà§Êñ≠Êó∂Èó¥Èó¥ÈöîÔºåË∑®Â∫¶Ë∂ÖËøá5ÂàÜÈíüÔºåËøîÂõûÂΩìÂâçÊó∂Èó¥Êà≥ÔºåÂê¶ÂàôËøîÂõûnull„ÄÇ
			displayDatetime_WeChatStyle() {
					//Áõ¥Êé•Ëé∑ÂèñÂÄíÊï∞Á¨¨1Êù°ËÆ∞ÂΩïÁöÑÊó∂Èó¥ÔºåÊó†ËÆ∫ÊòØuserËøòÊòØai„ÄÇÂõ†‰∏∫ÊòØÂú®DOMÊ∏≤Êüì‰πãÂâçÔºåÊâÄ‰ª•ÊòØÔºàlength - 1Ôºâ„ÄÇÊúÄ‰Ωé‰∏∫[0]
					//BUGÊó•ËÆ∞Ôºöios/macos, safariÊµèËßàÂô®ÂØπnew Date()Â≠òÂú®ÂÖºÂÆπÈóÆÈ¢òÔºåsafari‰∏çËÆ§"yyyy-MM-dd HH:mm:ss"Ê†ºÂºèÁöÑÊó•ÊúüÂ≠óÁ¨¶‰∏≤Ôºå‰∏çËØÜÂà´‚Äú-‚Äù„ÄÇ
					let lastmsgdatetime = this.msgList[this.msgList.length - 1]["datetime"];
					lastmsgdatetime = lastmsgdatetime.replace(/-/g, "/") ;//ËΩ¨Ê†ºÂºè‰∏∫yyyy/MM/dd HH:mm:ss ÔºåÂÖºÂÆπapple‰∫ßÂìÅ
					let lasttimestamp = new Date(lastmsgdatetime).getTime() / 1000 ; //Ëé∑ÂèñÊåáÂÆöÊó∂Èó¥lastmsgdatetimeÁöÑÊó∂Èó¥Êà≥ÔºåÂçï‰ΩçÁßí(s)
					let nowtimestamp = new Date().getTime() / 1000 ; //Ëé∑ÂèñÂΩìÂâçÊó∂Èó¥Êà≥ÔºåÂçï‰ΩçÁßí(s)
				
					let min = (nowtimestamp - lasttimestamp) / 60;
					if( min > 5 ){
						return nowtimestamp;
					}else{
						return null;
					}
			},
			
			// ÊòæÁ§∫Ê∂àÊÅØÈÄöÁü• ÈÄöÁü•ÊèêÁ§∫Ê°Ü tooltips	‰∏§ÁßçÊ†∑ÂºèÔºöposition center or bottom			
			showNotification(content, position, title, bottomshowtime) {
			
				if (this.isShowNotification && this.notificationTimeoutId != -1) {
					clearTimeout(this.notificationTimeoutId);
					this.isShowNotification = false;
					this.notificationTimeoutId = -1;
				}

				//Êï¥‰ΩìÂª∂Êó∂0.05Áßí Ëß£ÂÜ≥ÂæàÂ§öÈóÆÈ¢ò
				setTimeout(() => {
					this.setNotificationContent = content;
					this.setNotificationPosition = position;//ÂÖ∂ÂÆûÂèØ‰ª•Áî®isNotificationHasMaskÁõ¥Êé•‰ª£ÊõøsetNotificationPosition
					this.isNotificationHasMask = position == 'center' ? true : false ; 
					this.notificationTimeoutId = position == 'center' ? -1 : this.notificationTimeoutId;
					if(title != null){
						this.setNotificationTitle = title.trim();
					}
					const notificationWrapper = document.querySelector('.notification-wrapper');
					notificationWrapper.style.height = 'auto';
					this.isShowNotification = true;
	  
					//Only bottom
					if (bottomshowtime == null){
						bottomshowtime = 1450; // ‰∏∫Á©∫ÔºåÈªòËÆ§ÊòæÁ§∫1.45Áßí
					}	  
					this.isNotificationBottomShowCloseBtn = bottomshowtime > 2999 ? true : false ; //3ÁßíÊàñ‰ª•‰∏ä ÊòæÁ§∫ÂÖ≥Èó≠ÊåâÈíÆ
					if (position == 'bottom') {
						// ËÆæÁΩÆÂÆöÊó∂Âô®Âπ∂‰øùÂ≠òËøîÂõûÂÄºÁªôthis.notificationTimeoutId
						this.notificationTimeoutId = setTimeout(() => {
								this.isShowNotification = false;
								this.notificationTimeoutId = -1;
							}, bottomshowtime);
					}
					if (position == 'center') { //Âä®ÊÄÅËÆæÁΩÆÂéüÂõ†ÔºöÊ∑ªÂä†ÊªöÂä®Â±ÇdivÂêéÔºåÂ¶ÇÊûúnotification-wrapperÁöÑheightËÆæ‰∏∫Ëá™Âä®ÔºåÊªöÂä®Êù°‰ºöÂ§±ÊïàÔºåÊâæ‰∏çÂà∞Ëß£ÂÜ≥ÊñπÊ≥ï
						this.$nextTick(() => {
							const clientHeight = document.documentElement.clientHeight;
							const notificationWrapper = document.querySelector('.notification-wrapper');
							const notifHeight = notificationWrapper.offsetHeight;
							if( notifHeight > (clientHeight * 0.6)){
								notificationWrapper.style.height = '65%'; //ÂÜÖÂÆπÂ§öÔºåËÆæ‰∏∫65%È´òÂ∫¶ÔºåÂºπÁ™óÂ∞∫ÂØ∏‰ºöË∑üÈöèÂ±èÂπïÂèòÂåñÔºåÊªöÂä®Êù°ÊúâÊïà
							}
							//else:  notificationWrapper.style.height = 'auto'; //ÂÜÖÂÆπÂ∞ëÔºåËÆæ‰∏∫Ëá™Âä®È´òÂ∫¶ÔºåÂºπÁ™óÂ∞∫ÂØ∏Âõ∫ÂÆö„ÄÇÂºäÁ´ØÔºöÊó†Ê≥ïÊòæÁ§∫ÊªöÂä®Êù°
							//console.log('documentElement clientHeight:' + clientHeight + '\r\n\r\noffsetHeight:' + notifHeight );
						});
					}
				}, 50);
			},
			// ÂÖ≥Èó≠ ÈöêËóèÊ∂àÊÅØÈÄöÁü• ÈÄöÁü•ÊèêÁ§∫Ê°Ü tooltips		
			hideNotification() {
				clearTimeout(this.notificationTimeoutId);
				this.isShowNotification = false; 
			},
			//ËØ¥Êòé Â∏ÆÂä© Â∞èÈóÆÂè∑ mini Help
			showMiniHelp(position){
				let notif =  '';
				let title = '';
				let notifcn = '';
				let notifen = '';
				let text_help = this.settingsLanguage == 'cn' ? 'Â∏ÆÂä©' : 'Help' ;
	
				switch(position) {
				  case 'B-CurrentSystemPrompt':
				  	notifcn = 'Â±ïÁ§∫ÂΩìÂâçÂØπËØùÁöÑÂ∑≤ÁîüÊïàÁöÑÁ≥ªÁªüÊèêÁ§∫ËØçÔºå‰∏çÂèØÁºñËæë„ÄÇ\r\n\r\nÊ∑ªÂä†„ÄÅ‰øÆÊîπ„ÄÅÂèñÊ∂àËØ∑Âú®ÁºñËæëÂå∫Êìç‰ΩúÔºå‰øùÂ≠òÂêéÁîüÊïà„ÄÇ\r\n\r\nÂèñÊ∂àÊñπÂºèÔºöÊ∏ÖÁ©∫ÁºñËæëÂå∫ËæìÂÖ•Ê°ÜÁöÑÂÜÖÂÆπÔºåÁÑ∂Âêé‰øùÂ≠òÔºåÂç≥ÂèØÂèñÊ∂àÁ≥ªÁªüÊèêÁ§∫ËØç„ÄÇ\r\n\r\nÂΩìÂâçÁ≥ªÁªüÊèêÁ§∫ËØçÂ±û‰∫éÂØπËØùÊï∞ÊçÆÔºå‰∏éÂØπËØù‰∏Ä‰∏ÄÂØπÂ∫îÔºåÂàáÊç¢‰∏çÂêåÁöÑÂØπËØùÔºåÁ≥ªÁªüÊèêÁ§∫ËØç‰ºöÈöè‰πãÂèòÂåñ„ÄÇ';
					notifen = 'Display the system prompt that is in effect for the current chat and cannot be edited.\r\n\r\nTo add, modify, or cancel the system prompt, please operate in the [Prompt Editor] and save for changes to take effect.\r\n\r\nTo cancel the system prompt, clear the input box in the [Prompt Editor] and save.\r\n\r\nThe system prompt is part of the chat data and is associated with each individual chat. When switching to a different chat, the system prompt will change accordingly.';
				  	title = '';
					break;
				  case 'B-PromptEditor':
				  	notifcn = 'ÂèØ‰ª•Âú®ËøôÈáåËá™Áî±ÁºñËæëÊèêÁ§∫ËØç„ÄÇ\r\n\r\nÊú™‰øùÂ≠òÁöÑÊèêÁ§∫ËØç‰∏ç‰ºöÂΩ±ÂìçÂà∞[ÂΩìÂâçÁ≥ªÁªüÊèêÁ§∫ËØç]„ÄÇ\r\n\r\nÊèêÁ§∫ËØçÁºñËæëÂô®ÁöÑËçâÁ®ø‰ºöÂ≠òÂÇ®Âú®[ÊèêÁ§∫ËØç]Êï∞ÊçÆ‰∏≠„ÄÇÂÆÉ‰∏çÂ±û‰∫é[ÂØπËØù]Êï∞ÊçÆÔºåÂú®ÂØπËØùÂàóË°®‰∏≠ÂàáÊç¢ÂØπËØùÊó∂Ôºå‰∏ç‰ºöÂΩ±ÂìçÊèêÁ§∫ËØçÁºñËæëÂô®‰∏≠ÁöÑÂÜÖÂÆπ„ÄÇ';
					notifen = 'You can freely edit the prompt.\r\n\r\nUnsaved changes will not affect the system prompt for the current chat.\r\n\r\nThe drafts in the Prompt Editor are saved in the Prompt Generator Data and do not belong to the Chat Data. Switching to a different chat in the Chat List will not affect the content in the Prompt Editor.';
				  	title = '';
					break;
				  case 'A-CheckAPIKey':
				  	notifcn = 'API KeyÔºåÂç≥Êé•Âè£ÂØÜÈí•„ÄÇÊîØÊåÅOpenAIÂÆòÊñπÂØÜÈí•ÂíåÁ¨¨‰∏âÊñπÂπ≥Âè∞ÂØÜÈí•ÔºåÂ∞ÜÂØÜÈí•Á≤òË¥¥Âà∞ËæìÂÖ•Ê°ÜÔºåÁÑ∂ÂêéÂºÄÂßãÈ™åËØÅ„ÄÇ (ÁÇπÂáª [KeyÊ®°Âºè: ...]ÔºåÂú®ÂºπÂá∫Á™óÂè£‰∏≠ÁÇπÂáªËìùËâ≤Â∞èÈóÆÂè∑ [?] ÂèØ‰ª•‰∫ÜËß£Êõ¥Â§ö„ÄÇ)\r\n\r\n  ‚Ä¢ È™åËØÅÊàêÂäüÂêéÔºåÂºÄÂßãËÅäÂ§©ÊàñÊü•ËØ¢ OpenAI API ‰ΩôÈ¢ù„ÄÇ\r\n  ‚Ä¢ ÂΩì Key Ê®°Âºè‰∏∫ [‰ΩøÁî® OpenAI ÂÆòÊñπKey] Êó∂Ôºå[Ëá™Âä®ËΩÆÊç¢ API Key] ÂäüËÉΩ‰ºöËá™Âä®ÂºÄÂêØÔºåËØ•ÂäüËÉΩ‰∏çÊîØÊåÅÊâãÂä®ÂÖ≥Èó≠„ÄÇ\r\n  ‚Ä¢ [Ëá™Âä®ËΩÆÊç¢ API Key] ÊîØÊåÅ Key ÁöÑÊï∞ÈáèÔºö1 ‰∏™Êàñ‰ª•‰∏ä„ÄÇ';
					notifen = 'Enter OpenAI API Key or third-party platform API Key and check. (Click on [Key Mode: ...] to learn more by clicking the blue question mark [?] in the pop-up window.)\r\n\r\n  ‚Ä¢ After checking, you can chat or check OpenAI API balance.\r\n  ‚Ä¢ When the Key Mode is set to [Use OpenAI API Key], the [Auto Key Rotation] function is enabled and cannot be manually turned off. \r\n  ‚Ä¢ [Auto Key Rotation] supports a minimum of 1 key or more.';
					
					notifcn += '\r\n\r\n  ‚Ä¢ API Key ÊòØ‰ªÄ‰πàÊ†∑ÁöÑÔºü\r\n    1) OpenAI ÂÆòÊñπÁöÑ API Key ÊòØ‰ª•‚Äúsk-‚ÄùÂºÄÂ§¥ÁöÑ‰∏Ä‰∏≤ÂØÜÈí•Ôºå‰æãÂ¶Ç sk-bkR8V4tjmD7lXq9aZheZVpc6DtR8vw9VTYFJ1iaohMPpT3Bl\r\n    2) Á¨¨‰∏âÊñπÂπ≥Âè∞ÁöÑ API Key Ê†ºÂºèÁî±Á¨¨‰∏âÊñπÂπ≥Âè∞ËÆæÂÆöÔºåÂèØËÉΩÂêåÊ†∑‰ª• "sk-" ÂºÄÂ§¥Ôºå‰πüÂèØËÉΩÊòØÂÖ∂‰ªñ‰ªªÊÑèÂΩ¢Âºè„ÄÇ';
					notifen += "\r\n\r\n  ‚Ä¢ What does API Key look like?\r\n    1) The API Key from OpenAI starts with 'sk-', like this: sk-bkR8V4tjmD7lXq9aZheZVpc6DtR8vw9VTYFJ1iaohMPpT3Bl .\r\n    2) The format of an API Key for a third-party platform is determined by that platform and may also start with 'sk-' or be in any other format they choose. ( * In countries or regions where OpenAI does not provide services, users may need to use a third-party platform's intermediary service to access GPT.)";
					
					if(!this.isSimpleMode){
						notifcn += '\r\n\r\n  ‚Ä¢ Â¶Ç‰ΩïËé∑ÂèñÂÆòÊñπÁöÑAPI KeyÔºü\r\n    Ê≥®ÂÜåÊàêÂäüÂêéÔºåÊâìÂºÄÂÆòÊñπÊé•Âè£È°µÈù¢ÂÖçË¥πËé∑ÂèñÂç≥ÂèØÔºåÂú∞ÂùÄ https://platform.openai.com/account/api-keys   ‰ΩÜÊòØÔºåÂõΩÂÜÖIPÊó†Ê≥ïÁõ¥Êé•Ê≥®ÂÜåOpenAIË¥¶Âè∑ÔºåÁΩë‰∏äÊúâÂæàÂ§öÊ≥®ÂÜåÊïôÁ®ãÔºåÂÖ∂‰∏≠ÊúÄÂü∫Á°ÄÁöÑÊù°‰ª∂ÊòØÈúÄË¶Å‰ºòË¥®ÁöÑÈ≠îÊ≥ïÔºà"È≠îÊ≥ï"ÊòØ‰∏ÄÁßçÂèØ‰ª•ËÆ©ÊÇ®ÁöÑÊâãÊú∫ÊàñÁîµËÑëÂá∫Ë∂üÂõΩÁöÑÊäÄÊúØÔºåÂ•ΩÁöÑÈ≠îÊ≥ï‰ºöËÆ©OpenAIËÆ§‰∏∫ÊÇ®ÁöÑËÆæÂ§áÊòØÁúüÁöÑÂú®ÂõΩÂ§ñÔºâÔºåÊª°Ë∂≥Ëøô‰∏™Êù°‰ª∂Â∞±ÊúâÊú∫‰ºöÂÖçË¥πÊ≥®ÂÜåË¥¶Âè∑Âπ∂Êã•ÊúâAPI Key„ÄÇ';
					}

					notifcn += '\r\n\r\nÈôÑ Â∏∏Áî®ÁöÑÂÆòÊñπÁΩëÂùÄÔºö\r\n    OpenAIÂÆòÁΩëÔºöhttps://openai.com \r\n    Êü•ÁúãAPI‰ΩôÈ¢ùÔºöhttps://platform.openai.com/account/usage \r\n    ÂÆòÊñπÁâàChatGPT / GPT-4Ôºöhttps://chat.openai.com/\r\n';
					notifen += '\r\n\r\n  ‚Ä¢ OpenAI: https://openai.com \r\n    OpenAI - API Keys: https://platform.openai.com/account/api-keys \r\n    OpenAI - API balance: https://platform.openai.com/account/usage \r\n    OpenAI - ChatGPT / GPT-4: https://chat.openai.com/ \r\n';
					title = '';
					break;
				  case 'A-APISettings':
				  	notifcn = '  ‚Ä¢ Êô∫ËÉΩmax_tokens(Êé®ËçêÂºÄÂêØ): ÂêØÁî®‚ÄúÊô∫ËÉΩmax_tokens‚ÄùÂäüËÉΩÂêéÔºå‰ºöÂá∫Áé∞Â∞èÈóÆÂè∑ [?] ÔºåÂèØ‰ª•ÁÇπÂáª‰∫ÜËß£Êõ¥Â§ö„ÄÇ\r\n\r\n  ‚Ä¢ temperature: ÈªòËÆ§0.7ÔºåÂÆòÊñπÈªòËÆ§1.0„ÄÇtemperature ("Ê∏©Â∫¶") Áî®‰∫éÊéßÂà∂GPTÁîüÊàêÁªìÊûúÁöÑÈöèÊú∫ÊÄß/Â§öÊ†∑ÊÄß/ÂàõÈÄ†Âäõ„ÄÇËøá‰Ωé ‰ºöÂØºËá¥ÁîüÊàêÁöÑÊñáÊú¨Êõ¥Âä†‰øùÂÆàÂíåÈáçÂ§ç„ÄÇËøáÈ´ò ‰ºöÂØºËá¥ÁîüÊàêÁöÑÊñáÊú¨Êõ¥Âä†ÈöèÊú∫ÂíåÂÖ∑ÊúâÂàõÈÄ†ÊÄß (Á∫¶‰ªé1.2ÂºÄÂßãÔºåÂ∞±ÊúâÂá†ÁéáÂá∫Áé∞Êó†‰∏≠ÁîüÊúâÁöÑËØçÊàñ‰π±Á†Å) „ÄÇ\r\n\r\n  ‚Ä¢ max_tokens: ÁîüÊàêÁªìÊûúÊó∂ÁöÑÊúÄÂ§ßtokenÊï∞ÔºåÂèØÈöèÊó∂Ë∞ÉËäÇ„ÄÇÂçïËΩÆÂØπËØù "‰∏ä‰∏ãÊñáÂ∑≤Ê∂àËÄóÁöÑtokenÊï∞Èáè" Âä†‰∏äËÆæÁΩÆÁöÑ "max_tokensÊï∞Èáè" ‰∏çËÉΩË∂ÖËøáÊ®°ÂûãÁöÑ‰∏ä‰∏ãÊñáÈïøÂ∫¶„ÄÇ';
					notifcn += '\r\n\r\n ‚Ä¢ model (Ê®°Âûã): ';
					notifcn += '\r\n  - MCGPT ÂàóÂá∫‰∫ÜÂ∞ΩÂèØËÉΩÂ§öÁöÑÊ®°ÂûãÂêçÁß∞ÔºåÂ∞ΩÁÆ°Êúâ‰∫õÊ®°Âûã‰πãÈó¥ÊòØÂÆåÂÖ®Áõ∏ÂêåÁöÑÔºåÂ¶ÇÊûúÊÇ®‰∏çÁ°ÆÂÆöÂ¶Ç‰ΩïÈÄâÊã©ÔºåÂª∫ËÆÆÔºöChatGPT ÈÄâ "gpt-3.5-turbo"ÔºåGPT-4 ÈÄâ "GPT-4" (8K)„ÄÇ';
					notifcn += '\r\n  - ‰ΩøÁî® GPT4 Ê®°ÂûãÈúÄË¶Å‰ΩøÁî®ÊîØÊåÅ GPT4 ÁöÑ API Key„ÄÇ';
					notifcn += '\r\n  - ËÄÉËôëÂà∞ GPT4 ÁöÑÈ´ò‰ª∑Ê†ºÔºåÂ¶ÇÊûúÊÇ®ÊÉ≥ËäÇÁúÅÊ∂àËÄóÔºåÂª∫ËÆÆÂÖ≥Èó≠"Smart max_tokens"ÂäüËÉΩÔºåÊîπ‰∏∫ÊâãÂä®ËÆæÁΩÆ max_tokens„ÄÇÂè¶Â§ñÔºåËØ∑ÈöèÊó∂ÁïôÊÑè‰∏ä‰∏ãÊñá tokens Êï∞Èáè„ÄÇ';
					notifcn += '\r\n  - Âú®‰ΩøÁî®Á¨¨‰∏âÊñπÊé•Âè£Êó∂ÔºåÁ¨¨‰∏âÊñπ‰∏ç‰∏ÄÂÆöÊîØÊåÅÊâÄÊúâÊ®°ÂûãÔºåÂ∞§ÂÖ∂ÊòØ‰ªòË¥πÁöÑÁ¨¨‰∏âÊñπ‰ª£ÁêÜÔºåËØ∑ÂêëÊúçÂä°Êèê‰æõÊñπÂí®ËØ¢ÂèØÁî®Ê®°ÂûãÂêçÁß∞„ÄÇ';
					if(!this.isSimpleMode){
						notifcn += '\r\n  - ‰∏çÂêåÊ®°ÂûãÁöÑ‰ª∑Ê†ºÂ∑ÆÂºÇÂæàÂ§ßÔºåGPT-3.5 ÁöÑ 16k ÁâàË¶ÅÊØî 4k ÁâàË¥µ‰∏ÄÂÄçÔºåGPT-4 ÁöÑ 32k Áâà‰πüË¶ÅÊØî 8k ÁâàË¥µ‰∏ÄÂÄç„ÄÇËÄå GPT-4 ÁöÑ‰ª∑Ê†ºË¶ÅÊØî GPT3.5 Ë¥µÊï∞ÂçÅÂÄç„ÄÇÊü•ÁúãÂÆòÊñπÊúÄÊñ∞‰ª∑Ê†º: https://openai.com/pricing ';
						notifcn += '\r\n  - ÊØè‰∏™Ê®°ÂûãÁâàÊú¨ÈÉΩÂ∏¶Êúâ‰∏Ä‰∏™ "-MMDD(Êó•Êúü)" ÁöÑÂêéÁºÄÔºå‰æãÂ¶Ç gpt-3.5-turbo-0613„ÄÇÊú™Ê†áÊ≥®Êó•ÊúüÁöÑÊ®°ÂûãÂêçÁß∞Ôºå‰æãÂ¶Ç gpt-3.5-turboÔºåÈÄöÂ∏∏‰ºöÊåáÂêëÊúÄÊñ∞ÁâàÊú¨Ôºà‰æãÂ¶Ç gpt-3.5-turbo ‰ºöÊåáÂêë gpt-3.5-turbo-0613ÔºåÂú®Êñ∞ÁâàÊú¨Êé®Âá∫Ââç‰øùÊåÅ‰∏çÂèòÔºâ„ÄÇ';
						notifcn += '\r\n  - Ê®°ÂûãÊñ∞ÁâàÊú¨Êé®Âá∫ÂêéÔºåÊóßÁâàÊú¨ÈÄöÂ∏∏‰ºöÂú® 3 ‰∏™ÊúàÂêéË¢´ÂºÉÁî®„ÄÇ(ÈÉ®ÂàÜÊ®°ÂûãÂèØËÉΩ‰ºöË¢´Âª∂Êúü)';
						notifcn += '\r\n  - Ê®°ÂûãÁâàÊú¨ÈÉΩÂ∏¶Êúâ‰∏Ä‰∏™ "-16k(ÊîØÊåÅÁöÑÊúÄÂ§ßtokens)" ÁöÑÂêéÁºÄÔºå‰æãÂ¶Ç gpt-3.5-turbo-16k„ÄÇÊú™Ê†áÊ≥®ÁöÑÊ®°ÂûãÂêçÁß∞: gpt-3.5 Êú™Ê†áÊ≥®Êó∂ÊòØÊîØÊåÅ 4KÔºågpt-4 Êú™Ê†áÊ≥®Êó∂ÊòØÊîØÊåÅ 8K„ÄÇ(1K = 1024 tokens)';
						notifcn += '\r\n  - ‰∏çÂêåÊ®°ÂûãÂØπ"Á≥ªÁªüÊèêÁ§∫ËØç"ÁöÑÊïèÊÑüÂ∫¶‰∏çÂêåÔºåÊ®°ÂûãÈÄüÂ∫¶‰πü‰∏çÂêåÔºåÂêåÊó∂‰ª∑Ê†ºÂ∑ÆÂºÇÂèØËÉΩ‰ºöÂæàÂ§ß„ÄÇ‰æãÂ¶Ç: gpt-3.5-turbo-0301 Ê®°ÂûãÂú®Êüê‰∫õÊñπÈù¢Ë°®Áé∞ÂèØËÉΩÊõ¥Á®≥ÂÆöÔºå‰ΩÜÊòØÈÅµÂæ™Êåá‰ª§ÁöÑÁ®ãÂ∫¶„ÄÅÂõûÁ≠îÈÄüÂ∫¶ÈÉΩ‰∏çÂ¶Ç gpt-3.5-turbo-0613„ÄÇ';
					}
					notifcn += '\r\n\r\n ‚Ä¢ Êõ¥Â§ö (PRO): ÁÇπÂáªÊòæÁ§∫Êõ¥Â§öÁöÑAPIÂèÇÊï∞„ÄÇ';
					
					//Âê´ÂçïÂºïÂè∑
					notifen = "  ‚Ä¢ Smart max_tokens (recommended to enable): After enabling the 'Smart max_tokens' feature, a small question mark [?] will appear, which can be clicked to learn more.\r\n\r\n  ‚Ä¢ temperature: The 'temperature' setting controls how creative and diverse the text generated by GPT is. Lower values result in more repetitive and simpler text, while higher values result in more random and creative text. \r\n\r\n  ‚Ä¢ max_tokens: The maximum number of tokens to generate in the chat completion. The total length of input tokens and generated tokens is limited by the model's context length.";
				  	notifen += '\r\n\r\n ‚Ä¢ model: ';
					notifen += '\r\n  - MCGPT lists as many model names as possible, even though some models are exactly the same. If you are unsure about which one to choose, it is recommended to select "gpt-3.5-turbo" for ChatGPT and "GPT-4" (8K) for GPT-4.';
					notifen += '\r\n  - To use the GPT-4 model, you will need an API Key that supports GPT-4.';
					notifen += '\r\n  - Considering the high price of GPT4, if you want to save costs, it is recommended to disable "Smart max_tokens" and manually set "max_tokens". Additionally, please keep an eye on the number of tokens in the context.';
					notifen += '\r\n  - Not all models are necessarily supported by third-party API, especially paid third-party agents. Please consult the service provider for the available model names.';
					if(!this.isSimpleMode){
						notifen += '\r\n  - There is a significant price difference between different models. The 16k version of GPT-3.5 is twice as expensive as the 4k version, and the 32k version of GPT-4 is also twice as expensive as the 8k version. Additionally, the official GPT-4 is priced tens of times higher than GPT-3.5. Please refer to the official pricing table at https://openai.com/pricing for the latest prices.';
						notifen += '\r\n  - Each model version is dated with an -MMDD suffix; e.g.,  gpt-3.5-turbo-0613. The undated model name, e.g.,  gpt-3.5-turbo, will typically point to the latest version (e.g.  gpt-3.5-turbo points to  gpt-3.5-turbo-0613 and remains unchanged until a newer version is released). ';
						notifen += '\r\n  - After a new version is launched, older versions will typically be deprecated 3 months later. (Some models may have their expiration date extended.)';
						notifen += '\r\n  - Each model version is suffixed with something similar to -16k (maximum tokens); e.g.,  gpt-3.5-turbo-16k. For models without a suffix, gpt-3.5 supports 4K tokens, and gpt-4 supports 8K tokens. (1K = 1024 tokens)';
						notifen += '\r\n  - Different models vary in their adherence to instructions (sysyem prompt) and response speed. For instance, the gpt-3.5-turbo-0301 model may exhibit more stability in certain aspects, but it falls behind the gpt-3.5-turbo-0613 model in terms of following instructions and response speed.';
					}
					notifen += '\r\n\r\n  ‚Ä¢ More (PRO)ÔºöClick to display more API parameter settings.\r\n\r\n  ‚Ä¢ OpenAI - API reference: \r\n    https://platform.openai.com/docs/api-reference/chat/create';
					title = '';
					break;
				  case 'A-SmartMaxTokens':
				  	notifcn = 'ÂºÄÂêØ‚ÄúÊô∫ËÉΩmax_tokens‚ÄùÂêéÔºåÂÖ®Ëá™Âä®Ë∞ÉËäÇ max_tokensÔºåÊó†ÈúÄÊâãÂä®Ë∞ÉËäÇ„ÄÇ\r\nÂ¶ÇÊûúÂÖ≥Èó≠‚ÄúÊô∫ËÉΩmax_tokens‚ÄùÔºåÈúÄË¶ÅÊâãÂä®Ë∞ÉËäÇ max_tokensÔºå‰∏îÂèØËÉΩÈúÄË¶ÅÂ§öÊ¨°Ë∞ÉËäÇÔºåÊâçËÉΩËÆ©‰∏ä‰∏ãÊñáÔºàËÆ∞ÂøÜÔºâËææÂà∞È´ò‰ΩøÁî®Áéá„ÄÇ\r\n\r\n  ‚Ä¢ ÈªòËÆ§ÂºÄÂêØ‚ÄúÊô∫ËÉΩmax_tokens‚Äù\r\n  ‚Ä¢ ËøôÊòØ‰∏Ä‰∏™ÈùûÁ≤æÂáÜË∞ÉËäÇÁöÑËÆ°ÁÆóÁ≠ñÁï•„ÄÇÈïøÂØπËØù‰∏≠Ôºå95%ÂèØ‰ª•ÂÅöÂà∞‚ÄúÊô∫ËÉΩ‚ÄùÔºå5%ÈÅáÂà∞ÈîôËØØ‰ºöËá™Âä®ÂÖ≥Èó≠ÔºåÂπ∂ÊèêÁ§∫ÊÇ®ÊâãÂä®Ë∞ÉËäÇ„ÄÇ';
					notifen = 'When "Smart max_tokens" is enabled, max_tokens will be automatically adjusted without manual intervention. \r\nIf "Smart max_tokens" is disabled, you will need to manually adjust max_tokens, which may require multiple adjustments to get the context tokens close to the upper limit of the model. \r\n\r\n  ‚Ä¢ "Smart max_tokens" is enabled by default.\r\n  ‚Ä¢ This is not an OpenAI algorithm, but it can be "smart" about 95% of the time for longer chats. If errors occur, it will automatically disable and prompt you to manually adjust the max_tokens.';
					if(!this.isSimpleMode){
						notifcn += '\r\n  ‚Ä¢ Â¶Ç‰ΩïÂÅöÂà∞Á≤æÂáÜË∞ÉËäÇÔºüGPT-3.5 (ChatGPT) ‰∏é GPT-4 Ê®°ÂûãÂùáÈááÁî® cl100k_base ÁºñÁ†ÅÂô®Ôºåcl100k_base ÂèØ‰ª•Á≤æÂáÜËÆ°ÁÆó tokens „ÄÇÊÇ®ÂèØ‰ª•Ëá™Â∑±‰øÆÊîπ‰ª£Á†Å‰ª•ËææÂà∞ÂÆåÁæéÁöÑÊïàÊûú„ÄÇ\r\n  ‚Ä¢ ‰ª•‰∏ãÁé∞Ë±°‰∏éOpenAIÂÆòÊñπÊúâÂÖ≥ÔºöÂèëÈÄÅÁöÑÁ¨¨‰∏ÄÊù°Ê∂àÊÅØÔºåÈ¢ùÂ§ñÊúâÂ¢ûÂä† 13 tokensÔºå‰πãÂêéÂèëÈÄÅÁöÑÊ∂àÊÅØÔºåÊØèÊù°Â¢ûÂä† 10 tokens„ÄÇ';
						notifen += '\r\n  ‚Ä¢ How to achieve precise adjustments?  Both GPT-3.5 (ChatGPT) and GPT-4 models use the cl100k_base encoder, which can accurately calculate tokens. If you are familiar with this technology, you can modify the code to achieve perfect results.\r\n  ‚Ä¢ The following phenomenon is related to OpenAI: the first message sent will have an additional 13 tokens, and each subsequent message will have an additional 10 tokens added.';
					}
				  	title = '';
					break;
				  case 'A-ProfessionalAPISettings':
				  	notifcn = '  ‚Ä¢ Êé•Âè£ÁΩëÂùÄ: ÁõÆÂâç‰ªÖÊîØÊåÅGPT-3.5 / GPT-4 ÁöÑÊ®°ÂûãÔºåÂØπÂ∫îÁöÑÊé•Âè£ÁΩëÂùÄÂ∫î‰ª• "/v1/chat/completions" ÁªìÂ∞æÔºåÂ¶ÇOpenAIÂÆòÊñπÊé•Âè£ÁΩëÂùÄ "https://api.openai.com/v1/chat/completions" Ôºå‰ΩÜ‰πü‰∏çÊéíÈô§Á¨¨‰∏âÊñπÊé•Âè£ÁöÑÁΩëÂùÄÁªìÊûÑÊúâÊâÄÊîπÂä®„ÄÇ\r\n  ‚Ä¢ ÂÆòÊñπAPIÊé•Âè£ÈúÄË¶ÅÈ≠îÊ≥ïÊâçËÉΩËøûÊé•„ÄÇÁ¨¨‰∏âÊñπAPIÊúâÁöÑÈúÄË¶ÅÈ≠îÊ≥ïÔºåÊúâÁöÑ‰∏çÈúÄË¶Å„ÄÇ\r\n  ‚Ä¢ ÊúâÈ≠îÊ≥ïÁöÑÊÉÖÂÜµ‰∏ãÔºåÊé®Ëçê‰ΩøÁî®ÂÆòÊñπÊé•Âè£ÔºåÂÆûÈôÖ‰ΩìÈ™åÊõ¥Â•Ω (ËøûÂèë3Êù°‰∏ç‰ºöÊä•Èîô„ÄÇË∂ÖËøá1ÂàÜÈíüÊú™‰ΩøÁî®ÔºåËøûÂèë3Êù°‰∏ç‰ºöÈôêÂà∂ÔºåË∂Ö3Êù°ÂêéÊúâ20ÁßíÈôêÂà∂) „ÄÇÂÖçË¥πgptË¥¶Âè∑ÁõÆÂâçÈÉΩÊúâÊØèÂàÜÈíü3Ê¨°ÁöÑË∞ÉÁî®ÈôêÂà∂ (Âêå‰∏ÄË¥¶Âè∑‰∏ãÂ§ö‰∏™Key‰ºöÂÖ±‰∫´ÈôêÂà∂ÔºåÊâÄ‰ª•ËΩÆËØ¢KeyË¶ÅÁî®‰∏çÂêåË¥¶Âè∑ÁöÑKey) Ôºå‰ΩÜÂÆòÊñπÊé•Âè£‰ΩøÁî®Ëµ∑Êù•ÊòéÊòæÊõ¥ÊµÅÁïÖÔºåÊä•ÈîôÂá†Áéá‰ºö‰ΩéÁÇπ„ÄÇ\r\n  ‚Ä¢ Á¨¨‰∏âÊñπÊé•Âè£Êó†Ê≥ï‰øùËØÅÈöêÁßÅÂÆâÂÖ®ÔºåËØ∑Ëá™Ëæ®„ÄÇ';
					if(!this.isSimpleMode){
						notifcn += '\r\n  ‚Ä¢ "È≠îÊ≥ï"ÊòØ‰∏ÄÁßçÂèØ‰ª•ËÆ©ÊÇ®ÁöÑÊâãÊú∫ÊàñÁîµËÑëÂá∫Ë∂üÂõΩÁöÑÊäÄÊúØ„ÄÇ';
					}
					notifcn += '\r\n\r\n  ‚Ä¢ ‰ª•‰∏ã3‰∏™ÂèÇÊï∞ÁöÑËØ¥ÊòéËßÅÂÆòÁΩëÔºö\r\n    top_p: (ÈªòËÆ§‰∏∫1)  https://platform.openai.com/docs/api-reference/chat/create \r\n    presence_penalty: (ÈªòËÆ§‰∏∫0)  https://platform.openai.com/docs/api-reference/chat/create \r\n    frequency_penalty: (ÈªòËÆ§‰∏∫0)  https://platform.openai.com/docs/api-reference/chat/create ';
					notifen = '  ‚Ä¢ API URL: API Endpoint. Currently, only GPT-3.5/GPT-4 models are supported, and the API ENDPOINT URL should end in "/v1/chat/completions", like the official one "https://api.openai.com/v1/chat/completions". But it is not ruled out that the URL of the third-party API may change. \r\n\r\n  ‚Ä¢ top_p: (Defaults to 1)  https://platform.openai.com/docs/api-reference/chat/create \r\n\r\n  ‚Ä¢ presence_penalty: (Defaults to 0)  https://platform.openai.com/docs/api-reference/chat/create \r\n\r\n  ‚Ä¢ frequency_penalty: (Defaults to 0)  https://platform.openai.com/docs/api-reference/chat/create ';
				  	if(!this.isSimpleMode){
						//Êñ∞Áî®Êà∑Ê®°Âºè
						notifcn += '\r\n\r\n####‰ª•‰∏ãÂÜÖÂÆπÂùáÂºïÁî®Ëá™ÁΩëÁªúÔºö\r\nhttps://zhuanlan.zhihu.com/p/606573556 \r\n\r\n';
						notifcn += '1) top_p:   0.0 ~ 1.0 \r\n- ÊåáÂÆöÁîüÊàêÊñáÊú¨ÁöÑÂ§öÊ†∑ÊÄß„ÄÇ‰∏éÂèÇÊï∞ temperature (Ê∏©Â∫¶) Áõ∏‰ººÔºåÂÆÉÊòØ‰∏Ä‰∏™ÂèØÁî®‰∫é‰ª£Êõø temperature ÁöÑÂèÇÊï∞ÔºåÂèØ‰ª•ÊéßÂà∂ÁîüÊàêÊñáÊú¨ÁöÑÈöèÊú∫ÊÄß„ÄÇ\r\n- ‰ºöÊ†πÊçÆÁîüÊàêÊñáÊú¨ÁöÑÊ¶ÇÁéáÂàÜÂ∏ÉÔºåÂè™‰øùÁïôÂâçÈù¢Ê¶ÇÁéá‰πãÂíåËææÂà∞‰∏ÄÂÆöÈòàÂÄºÁöÑËØçËØ≠ÔºåÁÑ∂ÂêéÂÜç‰ªé‰∏≠ÈöèÊú∫ÈÄâÊã©‰∏Ä‰∏™ËØçËØ≠‰Ωú‰∏∫‰∏ã‰∏Ä‰∏™ÁîüÊàêÁöÑËØçËØ≠„ÄÇËæÉÈ´òÁöÑÂÄº‰ºöÂØºËá¥ÁîüÊàêÁöÑÊñáÊú¨Êõ¥ÂÖ∑ÊúâÂ§öÊ†∑ÊÄßÔºå‰ΩÜÊòØ‰ºöÁâ∫Áâ≤‰∏ÄÂÆöÁöÑÂáÜÁ°ÆÊÄßÂíå‰øùÁúüÂ∫¶„ÄÇËæÉ‰ΩéÁöÑÂÄºÂàô‰ºöÂØºËá¥ÁîüÊàêÁöÑÊñáÊú¨Êõ¥Âä†‰øùÈô©ÂíåÂáÜÁ°ÆÔºå‰ΩÜÊòØÂèØËÉΩ‰ºöËøá‰∫éÊ≠ªÊùøÂíåÁº∫‰πèÊñ∞ÊÑè„ÄÇ\r\n\r\n';
						notifcn += '2) presence_penalty:   -2.0 ~ 2.0 \r\n- Ê≠£ÂÄº‰ºöÊ†πÊçÆÊñ∞ tokens Âú®ÊñáÊú¨‰∏≠ÁöÑÁé∞ÊúâÈ¢ëÁéáÂØπÂÖ∂ËøõË°åÊÉ©ÁΩöÔºå‰ªéËÄåÈôç‰ΩéÊ®°ÂûãÈÄêÂ≠óÈáçÂ§çÂêå‰∏ÄË°åÁöÑÂèØËÉΩÊÄß„ÄÇ\r\n- ÊéßÂà∂ÈáçÂ§çÂçïËØçÁöÑÊÉ©ÁΩöÂäõÂ∫¶„ÄÇËæÉÂ§ßÁöÑÊÉ©ÁΩöÂäõÂ∫¶‰ºöÂØºËá¥ÁîüÊàêÊñáÊú¨‰∏≠‰∏çÂ§™ÂèØËÉΩÂá∫Áé∞Áõ∏ÂêåÁöÑÂçïËØçÔºåËÄåËæÉÂ∞èÁöÑÊÉ©ÁΩöÂäõÂ∫¶Âàô‰ºöÂÆπÂøç‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑÈáçÂ§ç„ÄÇ\r\n- ÊéßÂà∂ÊñáÊú¨ÁΩïËßÅËØçÊ±áÂá∫Áé∞ÊÉÖÂÜµ„ÄÇÂΩìÊ≠§ÂèÇÊï∞ÂÄºÂ§ß‰∫é0Êó∂ÔºåÂ∞ÜÊäëÂà∂Ê®°ÂûãÁîüÊàêÈ¢ëÁπÅÂá∫Áé∞ÁöÑÂçïËØçÔºåÂπ∂ÈºìÂä±ÁîüÊàêÁΩïËßÅÁöÑÂçïËØç„ÄÇÂÄºË∂äÂ§ßÔºåÁîüÊàêÁöÑÊñáÊú¨‰∏≠ÁΩïËßÅÂçïËØçÁöÑÊï∞ÈáèÂèØËÉΩË∂äÂ§ö„ÄÇÂ¶ÇÊûúÂÄº‰∏∫0ÔºåÂàô‰∏ç‰ºöËÄÉËôëÂçïËØçÁöÑÈ¢ëÁéáÔºåÂπ∂‰∏îÊØèÊ¨°ÁîüÊàêÁöÑÂçïËØçÊ¶ÇÁéáÂàÜÂ∏ÉÈÉΩÊòØÁõ∏ÂêåÁöÑ„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÈºìÂä±ÁîüÊàêÁΩïËßÅÁöÑÂçïËØçÔºåÂèØ‰ª•Â¢ûÂ§ßÂèÇÊï∞ÂÄº„ÄÇ\r\n\r\n';
						notifcn += '3) frequency_penalty:   -2.0 ~ 2.0 \r\n- Ê≠£ÂÄº‰ºöÊ†πÊçÆÂà∞ÁõÆÂâç‰∏∫Ê≠¢ÊòØÂê¶Âá∫Áé∞Âú®ÊñáÊú¨‰∏≠Êù•ÊÉ©ÁΩöÊñ∞ tokensÔºå‰ªéËÄåÂ¢ûÂä†Ê®°ÂûãË∞àËÆ∫Êñ∞‰∏ªÈ¢òÁöÑÂèØËÉΩÊÄß„ÄÇ\r\n- ÊéßÂà∂Ê®°ÂûãÁîüÊàê‰∏éÊñáÊú¨Ê†∑Êú¨‰∏≠‰∏çÂêåÁöÑÂçïËØçÁöÑÊÉ©ÁΩöÂäõÂ∫¶„ÄÇËæÉÂ§ßÁöÑÊÉ©ÁΩöÂäõÂ∫¶‰ºöÂØºËá¥ÁîüÊàêÊñáÊú¨‰∏≠Êõ¥Â§öÂú∞ÂåÖÂê´ÊñáÊú¨Ê†∑Êú¨‰∏≠Êú™Âá∫Áé∞ÁöÑÂçïËØçÔºåËÄåËæÉÂ∞èÁöÑÊÉ©ÁΩöÂäõÂ∫¶Âàô‰ºöÈôêÂà∂ÁîüÊàêÊñáÊú¨ÁöÑÂ§öÊ†∑ÊÄß„ÄÇ\r\n- ÊéßÂà∂ÊñáÊú¨Âêå‰∏ÄËØçÊ±áÈáçÂ§çÊÉÖÂÜµ„ÄÇÂΩìÊ≠§ÂèÇÊï∞ÂÄºÂ§ß‰∫é0Êó∂ÔºåÂ∞ÜÈºìÂä±Ê®°ÂûãÁîüÊàê‰∏çÂêåÁöÑÂçïËØçÔºåÂπ∂Â∞ΩÂèØËÉΩÈÅøÂÖç‰ΩøÁî®Â∑≤ÁªèÂú®‰πãÂâçÁîüÊàêÁöÑÊñáÊú¨‰∏≠Âá∫Áé∞ËøáÁöÑÂçïËØç„ÄÇÂ¶ÇÊûúÂÄºË∂äÂ§ßÔºåÁîüÊàêÁöÑÊñáÊú¨‰∏≠‰∏çÂêåÂçïËØçÁöÑÊï∞ÈáèÂèØËÉΩË∂äÂ§ö„ÄÇÂ¶ÇÊûúÂÄº‰∏∫0ÔºåÂàô‰∏ç‰ºöËÄÉËôë‰πãÂâçÁîüÊàêÁöÑÂçïËØçÔºåÂπ∂‰∏îÊØèÊ¨°ÁîüÊàêÁöÑÂçïËØçÊ¶ÇÁéáÂàÜÂ∏ÉÈÉΩÊòØÁõ∏ÂêåÁöÑ„ÄÇ ‰æãÂ¶ÇÔºåÂú®ÊñáÊú¨ÁîüÊàê‰ªªÂä°‰∏≠ÔºåÂ¶ÇÊûúÈúÄË¶ÅÈºìÂä±ÁîüÊàê‰∏çÂêåÁöÑÂçïËØçÔºåÂπ∂‰∏îÈÅøÂÖç‰ΩøÁî®Áõ∏ÂêåÁöÑÂçïËØçÔºåÂèØ‰ª•Â¢ûÂ§ßÂèÇËÄÉÂÄº„ÄÇ';
					}
					title = '';
					break;
				  case 'A-GeneralSettings':
					notifcn = '  ‚Ä¢ Âú® [Â∏∏ËßÑËÆæÁΩÆ] ‰∏≠ÔºåÈô§‰∫Ü [ËÆ∞ÂøÜÊ®°Âºè] ‰πãÂ§ñÔºåÂÖ∂‰ªñÈÉΩÊòØÈÄöÁî®ËÆæÁΩÆ„ÄÇ‰ªÖ [ËÆ∞ÂøÜÊ®°Âºè] ÊòØ‰∏é [ÂØπËØù] ÁªëÂÆöÔºåÊØè‰∏™ÂØπËØùÁöÑ [ËÆ∞ÂøÜÊ®°Âºè] ÈÉΩÂèØ‰ª•‰∏çÂêå„ÄÇ\r\n';
					notifcn += '  ‚Ä¢ ËÆ∞ÂøÜÔºåÂç≥‰∏ä‰∏ãÊñá„ÄÇÊñ∞ÂØπËØùÁöÑ [ËÆ∞ÂøÜÊ®°Âºè] ÈªòËÆ§‰∏∫: ‰∏çÈôêÂà∂„ÄÇ\r\n';
					notifcn += '  ‚Ä¢ Â¶ÇÊûú [ËÆ∞ÂøÜÊ®°Âºè] ËÆæÁΩÆ‰∫Ü‰∏äÈôêÔºåÂú®Êé•Ëøë‰∏äÈôêÊó∂Ôºå‰∏ªÁïåÈù¢‰∏äÁöÑ [Ê∏ÖÈô§ËÆ∞ÂøÜ] ÊåâÈíÆ‰ºöÂèò‰∏∫Ê©òÁ∫¢Ëâ≤ÔºåÂΩìËÆ∞ÂøÜËææÂà∞‰∏äÈôêÊó∂Ôºå [Ê∏ÖÈô§ËÆ∞ÂøÜ] ÊåâÈíÆ‰ºöÂèò‰∏∫Á∫¢Ëâ≤ (Âè™ÊòØÊèêÈÜí‰ΩúÁî®ÔºåÊó†ÈúÄÁî®Êà∑Êìç‰Ωú„ÄÇ‰ΩÜÂ¶ÇÊûúÊÇ®‰∏çÊÉ≥‰∏ãÊ¨°ÂèëÈÄÅÊ∂àÊÅØÊó∂ËÆ∞ÂøÜË¢´Ê∏ÖÈô§ÔºåÊ≠§Âàª‰ªçÁÑ∂ÂèØ‰ª•‰øÆÊîπËÆ∞ÂøÜÊ®°Âºè)„ÄÇ\r\n\r\n';
				  	notifcn += '  ‚Ä¢ ÂÖ≥‰∫éÂ§¥ÂÉèËÆæÁΩÆÔºöÊîØÊåÅ"‰∏ä‰º†ÂõæÁâá"„ÄÅ"ÁΩëÁªúÂõæÁâáÁΩëÂùÄ"„ÄÅ"Êú¨Âú∞ÂõæÁâáË∑ØÂæÑ"‰∏âÁßçÊñπÂºè„ÄÇ\r\n  ‚Ä¢ 1) Â¶Ç‰Ωï‰∏ä‰º†ÂõæÁâáÔºü(Êé®ËçêÔºåÊîØÊåÅÊâãÊú∫ÂíåÁîµËÑë)\r\n    ÁÇπÂáª [ËÆæÁΩÆ] > Âè≥‰æßÂ§¥ÂÉèÔºåÊàñËÄÖÁÇπÂáªÂ∑¶‰æß‰∏ãÊãâÊ°ÜÈÄâÊã©‰∏ä‰º†ÂõæÁâá„ÄÇ\r\n  ‚Ä¢ 2) Â¶Ç‰Ωï‰ΩøÁî®ÁΩëÁªúÂõæÁâáÔºü\r\n    Â°´ÂÖ•ÂõæÁâáÁΩëÂùÄÔºåÂπ∂ÁÇπÂáªÊõ¥Êñ∞„ÄÇ\r\n  ‚Ä¢ 3) ÁîµËÑëÁ´ØÂ¶Ç‰Ωï‰ΩøÁî®"Êú¨Âú∞ÂõæÁâáË∑ØÂæÑ"Ôºü\r\n    ÈúÄË¶ÅÊäähtmlÊñá‰ª∂‰∏ãËΩΩÂà∞ÁîµËÑë‰∏≠ÔºåÂú®Êú¨Âú∞ÊâìÂºÄ‰ΩøÁî®Êó∂ÔºåÊâçÊîØÊåÅÊú¨Âú∞ÂõæÁâáË∑ØÂæÑÔºàÂ°´ÂÖ•Áõ∏ÂØπË∑ØÂæÑÊàñÁªùÂØπË∑ØÂæÑÁöÑÊñπÂºèÔºå‰∏çÊòéÁôΩÁöÑÂª∫ËÆÆÁõ¥Êé•‰ΩøÁî®Á¨¨‰∏ÄÁßçÊñπÂºè‰∏ä‰º†Êú¨Âú∞ÂõæÁâáÔºâ„ÄÇ\r\n    ‰ª•‰∏ãÊòØÊú¨Âú∞ÂõæÁâáË∑ØÂæÑÁöÑÁ§∫ËåÉÔºö\r\n    - Mac/Windows‰∏äÁöÑÁõ∏ÂØπË∑ØÂæÑ‰æãÂ≠êÔºö123.jpg ÔºàÂ§¥ÂÉèÈúÄË¶Å‰∏éhtmlÊñá‰ª∂ÊîæÂú®Âêå‰∏ÄÊñá‰ª∂Â§π‰∏≠Ôºâ\r\n    - Mac‰∏äÁöÑÁªùÂØπË∑ØÂæÑ‰æãÂ≠êÔºö/Users/LinTongXue/Downloads/123.jpg \r\n    - windows‰∏äÁöÑÁªùÂØπË∑ØÂæÑ‰æãÂ≠êÔºöD:\\LinTongXue\\123.jpg ';
					
					notifen = '  ‚Ä¢ In the [General Settings] panel, all settings except for [Contextual Mode] are general settings. Only [Contextual Mode] is specific to Chat and can be different for each Chat.\r\n';
					notifen += '  ‚Ä¢ The default [Contextual Mode] for new Chats is: No Limit.\r\n';
					notifen += '  ‚Ä¢ If a limit is set for [Contextual Mode], the [Clear Context] button on the main interface will turn orange-red when it approaches the limit. When the Context reaches the limit, the [Clear Context] button will turn red (this is just a reminder, no user action is required. However, if you do not want the context to be cleared the next time you send a message, you can still modify the [Contextual Mode] at this time).\r\n\r\n';
					notifen += '  ‚Ä¢ Regarding avatar settings: Upload image, Network image, and Local image (path).\r\n  ‚Ä¢ 1) How to upload an image as an avatar? (Recommended, supports both mobile and computer devices) \r\n    Click on "Settings" > Avatar on the right or select "upload an image" from the dropdown menu on the left.\r\n  ‚Ä¢ 2) How to use an online image?\r\n    Enter the URL of the image and click on update.\r\n  ‚Ä¢ 3) How to use a local image (path) as your avatar on Mac/PC?\r\n    You need to download the HTML file to your computer and open it locally to support local images (support relative or absolute paths). \r\n    Here are some examples of local image paths:\r\n    - Mac/Windows relative path:   123.jpg   (the avatar needs to be placed in the same folder as the HTML file)\r\n    - Mac absolute path:   /Users/LinTongXue/Downloads/123.jpg\r\n    - Windows absolute path:   D:\\LinTongXue\\123.jpg';
				  	title = '';
					break;
				  case 'A-ExportChatHistory':
				  	notifcn = '  ‚Ä¢ Â∞ÜÂΩìÂâçÂØπËØùÁöÑËÅäÂ§©ËÆ∞ÂΩïÂØºÂá∫‰∏∫Á∫ØÊñáÊú¨Ê†ºÂºèÔºåÂèØÁõ¥Êé•ÈòÖËØª„ÄÇ\r\n\r\n  ‚Ä¢ ÂØºÂá∫ËÅäÂ§©ËÆ∞ÂΩï ¬∑ ÂçïËΩÆËÆ∞ÂøÜÔºöÂØºÂá∫ÂçïËΩÆËÅäÂ§©ËÆ∞ÂΩïÔºåÂç≥ÈíàÂØπÂΩìÂâçÁöÑ‰∏ä‰∏ãÊñáËÆ∞ÂøÜËøõË°åÂØºÂá∫ÔºåÂåÖÂê´ÊúÄÊñ∞‰øÆÊîπÁöÑÁ≥ªÁªüÊèêÁ§∫ËØçÔºå‰∏çÂê´ÂèëÈÄÅÂ§±Ë¥•ÁöÑ„ÄÅÊí§ÂõûÁöÑ„ÄÅÈáçÈóÆÁöÑËÆ∞ÂΩï„ÄÇÊ†ºÂºèÔºöMarkdown„ÄÇÊñá‰ª∂Á±ªÂûãÔºö.md Êàñ .txt\r\n\r\n  ‚Ä¢ ÂØºÂá∫ËÅäÂ§©ËÆ∞ÂΩï/Êó•Âøó ¬∑ ÂÖ®ÈÉ®ÔºöÂ∞ÜÁΩëÈ°µ‰∏äÁöÑÊâÄÊúâËÅäÂ§©ËÆ∞ÂΩïÔºàÂåÖÂê´ÂèëÈÄÅÂ§±Ë¥•ÁöÑ„ÄÅÊí§ÂõûÁöÑ„ÄÅÈáçÈóÆÁöÑËÆ∞ÂΩïÔºâÂíåÊâÄÊúâÊìç‰ΩúËÆ∞ÂΩïÔºàÂåÖÂê´Á≥ªÁªüÊèêÁ§∫ËØç‰øÆÊîπËÆ∞ÂΩïÔºâÂØºÂá∫Âπ∂‰∏ãËΩΩ„ÄÇÊ†ºÂºèÔºöMarkdown„ÄÇÊñá‰ª∂Á±ªÂûãÔºö.md Êàñ .txt\r\n\r\n  ‚Ä¢ Â¶ÇÊûúÂØºÂá∫Êó∂Ê≤°ÊúâÂèçÂ∫îÊàñ‰∏ãËΩΩÂ§±Ë¥•ÔºåÂèØËÉΩÊòØÂõ†‰∏∫ÊµèËßàÂô®ÊàñËÆæÂ§á‰∏çÂÖºÂÆπ„ÄÇ\r\n\r\n  ‚Ä¢ ÈôÑ ‰∏§‰∏™MarkdownÂú®Á∫øÁºñËæëÂô®ÁΩëÁ´ôÔºö\r\n    https://stackedit.cn/app# \r\n    http://tool.pfan.cn/markdown ';
					notifen = '  ‚Ä¢ Export the chat history of the current chat as plain text format for easy reading.\r\n\r\n  ‚Ä¢ Export Chat History for a Single Round, which includes the current context and the most recent system prompt, but excluding failed messages, undo messages, and resend messages. Exported file format: Markdown. File type: .md | .txt\r\n\r\n  ‚Ä¢ Export All Chat History / Logs, export and download all chat history (including failed messages, undo messages, resend messages) and all operation records (including system prompt modification records) on the webpage. Exported file format: Markdown. File type: .md | .txt \r\n\r\n  ‚Ä¢ If there is no response or the download fails when exporting, it may be due to browser or device incompatibility.\r\n\r\n  ‚Ä¢ Websites for Markdown online editors:\r\n    https://dillinger.io \r\n    https://stackedit.io/app# ';
				  	title = '';
					break;
				  case 'C-ChatList':
					notifcn = '  ‚Ä¢ Âçï‰∏™ÂØπËØùÁöÑÊï∞ÊçÆÂåÖÂê´ËÅäÂ§©ÂéÜÂè≤ËÆ∞ÂΩï (Âê´‰∏ä‰∏ãÊñáËÆ∞ÂøÜ)„ÄÅÂΩìÂâçÁ≥ªÁªüÊèêÁ§∫ËØç (ÂçïÊù°)„ÄÅËÆ∞ÂøÜÊ®°Âºè (‰∏ä‰∏ãÊñáÊ®°Âºè)„ÄÅËÅäÂ§©ËæìÂÖ•Ê°ÜÂÜÖÁöÑËçâÁ®ø„ÄÅ‰ª•Âèä‰∏éÂØπËØùÁõ¥Êé•ÂÖ≥ËÅîÁöÑÂÖ∂‰ªñÊï∞ÊçÆ„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ ÂØπËØùÁöÑÊï∞ÊçÆ‰∏çÂåÖÊã¨Áî®Êà∑ËÆæÁΩÆ„ÄÅÁî®Êà∑Â§¥ÂÉè„ÄÅÊèêÁ§∫ËØçÊ®°Êùø„ÄÅÊèêÁ§∫ËØçÁºñËæëÂô®ËçâÁ®ø„ÄÅÂØÜÈí• (API Key) ÂèäAPIÂèÇÊï∞‰ø°ÊÅØÔºåÂàáÊç¢‰∏çÂêåÂØπËØùÊó∂ÔºåËøô‰∫õÊï∞ÊçÆ‰∏ç‰ºöÂèëÁîüÊîπÂèò„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ ÂèØÂØºÂá∫Âçï‰∏™ÂØπËØùÊï∞ÊçÆÔºåÊàñ‰∏ÄÊ¨°ÂØºÂá∫ÊâÄÊúâÂØπËØùÁöÑÊï∞ÊçÆ„ÄÇÂèØÁî®‰∫éÂàÜ‰∫´ÔºåÂØπÊñπÂØºÂÖ•ÂêéÂèØÊÅ¢Â§çÂØπËØùÊï∞ÊçÆÔºåÂÆåÂÖ®‰∏ÄËá¥„ÄÇ';
					notifcn += '\r\n\r\n  ‚Ä¢ Ëã•ÊµèËßàÂô®ÊîØÊåÅÊú¨Âú∞Â≠òÂÇ® (localStorage) ÔºåÊâÄÊúâÂØπËØùÊï∞ÊçÆÂ∞Ü‰ºöËá™Âä®‰øùÂ≠òÂú®ÊµèËßàÂô®ÁºìÂ≠ò‰∏≠„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ ÈùûÈöêÁßÅÊ®°Âºè (Êó†ÁóïÊ®°Âºè) ‰∏ãÔºå‰ºöÂêåÊ≠•‰∏çÂêåÊ†áÁ≠æÈ°µÈó¥ÁöÑÊï∞ÊçÆÔºåËá™Âä®Êñ∞Â¢û„ÄÅ‰øÆÊîπ„ÄÅÂêàÂπ∂ÔºåÊï∞ÊçÆÂÜ≤Á™Å‰ºöËá™Âä®ÂàõÂª∫ÂâØÊú¨„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ ÂèØÈöèÊó∂ÈÄöËøá [Âà†Èô§Êï∞ÊçÆ] ÂäüËÉΩÊàñÊµèËßàÂô®ÁöÑÊ∏ÖÈô§ÂéÜÂè≤ËÆ∞ÂΩï (Ê∏ÖÈô§ÁºìÂ≠ò) ÂäüËÉΩÊù•Âà†Èô§ÊâÄÊúâÊï∞ÊçÆ„ÄÇ';
					if(!this.isSimpleMode){
						notifcn += '\r\n  ‚Ä¢ ÂØπËØùÂàóË°®ÊåâÁÖßÊúÄËøëÊ¥ªÂä®Êó∂Èó¥ÊéíÂ∫èÔºåÊñ∞ÁöÑÈù†Ââç„ÄÇ';
						notifcn += '\r\n  ‚Ä¢ #ÁºñÂè∑ Âíå #ÊèèËø∞ ÂèØÈöèÊÑè‰øÆÊîπÔºå‰ªÖÊúâÈïøÂ∫¶ÈôêÂà∂„ÄÇ';
						notifcn += '\r\n  ‚Ä¢ ÊâãÂä®ÊàñËá™Âä®ÂàõÂª∫ÂØπËØùÂâØÊú¨Êó∂ÔºåÂâØÊú¨ÁöÑÂàõÂª∫Êó∂Èó¥‰ºöËá™Âä®Âä†1ÁßíÊàñÊõ¥Â§ö„ÄÇ';
						notifcn += '\r\n  ‚Ä¢ Êñ∞ÂØπËØù (Êú™ÂèëÈÄÅËøáÊ∂àÊÅØ) ‰∏ç‰ºöË¢´‰øùÂ≠ò„ÄÇ';
						notifcn += '\r\n  ‚Ä¢ ÂØπËØùÊó•Âøó: Âçï‰∏™ÂØπËØùÁöÑÊâÄÊúâËÆ∞ÂΩï (ÂåÖÂê´Êìç‰ΩúËÆ∞ÂΩï„ÄÅÊí§ÂõûÁöÑÂÜÖÂÆπ‰ª•ÂèäÂèëÈÄÅÂ§±Ë¥•ÁöÑÂÜÖÂÆπÁ≠â)ÔºåÁî®‰∫éÂØºÂá∫ Markdown Ê†ºÂºèÁöÑÁ∫ØÊñáÊú¨ËÅäÂ§©ËÆ∞ÂΩïÔºåÊúâ‰∫õÂØπËØùÊó•ÂøóÂèØËÉΩ‰ºöÊØîËæÉÂ§ß„ÄÇ';
						notifcn += '\r\n  ‚Ä¢ ÊØè‰∏™ÂØπËØùÈÉΩÂèØ‰ª•Âú® [ËÆæÁΩÆ] ‰∏≠ÂçïÁã¨ËÆæÁΩÆËÆ∞ÂøÜÊ®°Âºè (‰∏ä‰∏ãÊñáÊ®°Âºè)ÔºåÊñ∞ÂØπËØùÁöÑËÆ∞ÂøÜÊ®°ÂºèÈªòËÆ§‰∏∫: ‰∏çÈôêÂà∂„ÄÇ';
						notifcn += '\r\n\r\n  ‚Ä¢ ‰ΩøÁî®ÊµèËßàÂô®ÊôÆÈÄöÊ®°ÂºèÊó∂ÔºöÊ†áÁ≠æÈ°µÊàñÊµèËßàÂô®Á™óÂè£ÂèØÈöèÊó∂Âà∑Êñ∞ÊàñÂÖ≥Èó≠ÔºåÊâìÂºÄÊó∂ÂùáËÉΩÊÅ¢Â§çÊï∞ÊçÆÔºå‰∏î‰∏çÂêåÊ†áÁ≠æÈ°µÁöÑÊï∞ÊçÆÊòØÂÖ±‰∫´ÁöÑ (Âêå‰∏ÄÊµèËßàÂô®ÊâìÂºÄÁõ∏ÂêåÁΩëÈ°µÁöÑÊÉÖÂÜµ‰∏ã)„ÄÇ';
						notifcn += '\r\n  ‚Ä¢ ‰ΩøÁî®ÊµèËßàÂô®ÈöêÁßÅÊ®°Âºè (Êó†ÁóïÊ®°Âºè) Êó∂ÔºöÂ§ßÂ§öÊï∞ÊîØÊåÅÊú¨Âú∞Â≠òÂÇ®ÔºåÊ†áÁ≠æÈ°µÂèØÂà∑Êñ∞ÔºåÊ†áÁ≠æÈ°µÊàñÁ™óÂè£‰πãÈó¥‰∏ç‰∫íÈÄöÊï∞ÊçÆÔºåÊ†áÁ≠æÈ°µÂÖ≥Èó≠Êó∂ÔºåÊâÄÊúâÊï∞ÊçÆÈÉΩ‰ºöË¢´ÈîÄÊØÅ„ÄÇ';
					}
					notifen = '  ‚Ä¢ Each chat data includes chat history, the current system prompt, contextual mode, the draft in the chat input box, and other data directly associated with the chat.';
					notifen += '\r\n  ‚Ä¢ Chat data does not include user settings, avatars, prompt generator data, prompt editor drafts, API keys, and API parameter information. These data will not change when switching between different chats.';
					notifen += '\r\n  ‚Ä¢ You can export individual chat data or export all chats at once. This can be used for sharing, and the recipient can import and restore the chat data.';
					notifen += '\r\n\r\n  ‚Ä¢ If the browser supports local storage (localStorage), all data will be automatically saved in the browser cache.';
					notifen += '\r\n  ‚Ä¢ In non-private mode, data is synced between different tabs, automatically adding, modifying, and merging. In case of conflicts, copies are created automatically. ';
					notifen += "\r\n  ‚Ä¢ You can delete all data anytime through [Settings] > [Delete Data] (or by clearing the browser's browsing history).";
					if(!this.isSimpleMode){								
						notifen += '\r\n  ‚Ä¢ The chat list is sorted by last activity time with the newest at the top.';
						notifen += '\r\n  ‚Ä¢ #ID and #description can be freely modified, with length limitations.';
						notifen += '\r\n  ‚Ä¢ When manually or automatically creating a copy of a chat, the chat creation time of the copy will be incremented by 1 second or more.';
						notifen += '\r\n  ‚Ä¢ New chat (with no messages sent) will not be saved.';
						notifen += '\r\n  ‚Ä¢ Chat Logs: All records of individual conversations, including activity logs, retracted messages, and failed messages, are stored. These logs can be exported as plain text chat records in Markdown format. Some logs of chats may be large in size.';
						notifen += '\r\n  ‚Ä¢ You can customize the [Contextual Mode] for each chat in [Settings]. Each chat can have a different setting. The default [Contextual Mode] for new chats is: No Limit.';
						notifen += '\r\n\r\n  ‚Ä¢ In the normal mode of the browser, Tabs or browser windows can be refreshed or closed at any time, and data will be restored upon reopening. Data is shared between different tabs (when opening the same webpage in the same browser).';
						notifen += '\r\n  ‚Ä¢ In private/incognito mode, Local storage is supported in most cases, tabs can be refreshed, but data is not shared between tabs or windows, and cache data is cleared when tabs are closed.';
				  	}
				  	title = '';
					break;
				  case 'A-DataPrivacyAndManagement':
					notifcn = '  ‚Ä¢ ÊâÄÊúâÊï∞ÊçÆ‰ªÖÂ≠òÂÇ®‰∫éÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ® (localStorage) ‰∏≠Ôºå‰∏ç‰ºöÈÄöËøá‰ªª‰ΩïÊñπÂºèÂØπÂ§ñ‰º†Ëæì„ÄÇ\r\n';
					notifcn += '  ‚Ä¢ [Âà†Èô§Êï∞ÊçÆ] ÂèØÊ∏ÖÁ©∫ÊâÄÊúâÊï∞ÊçÆÔºåÊàñËÄÖÈÄöËøáÊµèËßàÂô®ÁöÑÂéÜÂè≤ËÆ∞ÂΩïÊ∏ÖÈô§ÂäüËÉΩÊù•Ê∏ÖÁ©∫Êï∞ÊçÆ (Ê∏ÖÈô§ÁºìÂ≠ò)„ÄÇ';
					if(!this.isSimpleMode){
						notifcn += '\r\n  ‚Ä¢ localStorageÊòØÊµèËßàÂô®Êèê‰æõÁöÑÂäüËÉΩÔºåÁî®‰∫éÂú®Áî®Êà∑ÁöÑÊú¨Âú∞ËÆæÂ§á‰∏äÂ≠òÂÇ®Êï∞ÊçÆ„ÄÇ 1) localStorage‰∏éÂüüÂêçÁõ∏ÂÖ≥ËÅîÔºåÂêå‰∏Ä‰∏™ÂüüÂêç‰∏ãÁöÑÈ°µÈù¢ÂèØ‰ª•ÂÖ±‰∫´Âêå‰∏Ä‰∏™localStorage„ÄÇ 2) ÂØπ‰∫éÊú¨Âú∞ËøêË°åÁöÑHTMLÊñá‰ª∂ (Âú∞ÂùÄ‰ª• file:/// ÂºÄÂ§¥)ÔºålocalStorageÈÄöÂ∏∏ÊòØÂÖ±‰∫´ÁöÑ„ÄÇÂêå‰∏ÄÊµèËßàÂô®‰∏ãÔºå‰∏çÂêåÁöÑÊú¨Âú∞ÁΩëÈ°µÂÖ±Áî®ÁùÄÂêå‰∏Ä‰∏™localStorage (‰ª•ÂÆûÈôÖÊÉÖÂÜµ‰∏∫ÂáÜ)„ÄÇ 3) ‰∏çÂêåÊµèËßàÂô®Êï∞ÊçÆ‰∏ç‰∫íÈÄö„ÄÇ 4) Âú®ÊµèËßàÂô®ÈöêÁßÅÊ®°Âºè‰∏ãÔºåÈÄöÂ∏∏ÊØè‰∏™Ê†áÁ≠æÈ°µÈÉΩÊúâÁã¨Á´ãÁöÑlocalStorage„ÄÇ';
					}
					
					notifcn += '\r\n\r\n  ‚Ä¢ MCGPTÊï∞ÊçÆ:  ÂÖ®Ëá™Âä®‰øùÂ≠ò\r\n';
					notifcn += '    Êï∞ÊçÆÂàÜ‰∏∫4‰∏™ÈÉ®ÂàÜÔºåÊîØÊåÅ‰∏ÄÈîÆÂà†Èô§ÊàñÂØºÂá∫Ôºå‰πüÂèØ‰ª•ÂçïÁã¨Âà†Èô§ÊàñÂØºÂá∫ÔºåÂêåÊó∂ÊîØÊåÅÂàÜ‰∫´ÂíåÂØºÂÖ•ÔºåÂØºÂÖ•Êó∂‰ºöËá™Âä®ÂàÜÊûêÂåÖÂê´ÁöÑÊï∞ÊçÆÁ±ªÂûã„ÄÇ\r\n\r\n';

					notifcn += '  ‚Ä¢ 1) Chat Data List:  ÂØπËØùÊï∞ÊçÆÔºåÂåÖÂê´ÊâÄÊúâÂØπËØùÁöÑÊï∞ÊçÆ„ÄÇÂèØÂØºÂá∫Âçï‰∏™ÂØπËØùÊàñÂÖ®ÈÉ®ÂØπËØù„ÄÇ\r\n';
					if(!this.isSimpleMode){
						notifcn += '    Êõ¥Êñ∞ÊñπÂºèÔºöËá™Âä®ÂêàÂπ∂Êï∞ÊçÆ\r\n    ÂØºÂÖ•Êï∞ÊçÆÔºöËá™Âä®ÂêàÂπ∂Êï∞ÊçÆ\r\n    Â§öÊ†áÁ≠æÈ°µÔºöÂÆûÊó∂ÂêåÊ≠•Êï∞ÊçÆ\r\n\r\n';
					}
					notifcn += '  ‚Ä¢ 2) API Key Data:  ÂØÜÈí•Êï∞ÊçÆÔºåÂåÖÂê´ API Key Êï∞ÊçÆ\r\n';
					if(!this.isSimpleMode){
						notifcn += '    Êõ¥Êñ∞ÊñπÂºèÔºöËá™Âä®ÂêàÂπ∂Êï∞ÊçÆ\r\n    ÂØºÂÖ•Êï∞ÊçÆÔºöËá™Âä®ÂêàÂπ∂Êï∞ÊçÆ\r\n    Â§öÊ†áÁ≠æÈ°µÔºöÂÆûÊó∂ÂêåÊ≠•Êï∞ÊçÆ\r\n\r\n';
					}
					notifcn += '  ‚Ä¢ 3) Prompts Data:  ÊèêÁ§∫ËØçÊï∞ÊçÆÔºåÂåÖÂê´ÊèêÁ§∫ËØçÁ™óÂè£ÁöÑÊï∞ÊçÆ (‰∏çÂåÖÊã¨ÂΩìÂâçÁ≥ªÁªüÊèêÁ§∫ËØç)  *Â§öÂäüËÉΩÂæÖÂºÄÂèë‰∏≠\r\n';
					if(!this.isSimpleMode){
						notifcn += '    Êõ¥Êñ∞ÊñπÂºèÔºöËá™Âä®ÂêàÂπ∂Êï∞ÊçÆ\r\n    ÂØºÂÖ•Êï∞ÊçÆÔºöËá™Âä®ÂêàÂπ∂Êï∞ÊçÆ *ÂäüËÉΩÂæÖÂºÄÂèë‰∏≠\r\n    Â§öÊ†áÁ≠æÈ°µÔºöÊâãÂä®Âà∑Êñ∞ÂèØËé∑ÂèñÊúÄÊñ∞Êï∞ÊçÆ \r\n\r\n';
					}
					notifcn += '  ‚Ä¢ 4) User Settings:  Áî®Êà∑ËÆæÁΩÆÁ±ªÊï∞ÊçÆÔºåÂåÖÊã¨ËÆæÁΩÆ„ÄÅ‰∏ä‰º†ÁöÑÂ§¥ÂÉèÂíå API ÂèÇÊï∞ËÆæÁΩÆ\r\n';
					if(!this.isSimpleMode){
						notifcn += '    Êõ¥Êñ∞ÊñπÂºèÔºöË¶ÜÁõñÊóßÊï∞ÊçÆ\r\n    ÂØºÂÖ•Êï∞ÊçÆÔºöË¶ÜÁõñÊóßÊï∞ÊçÆ\r\n    Â§öÊ†áÁ≠æÈ°µÔºö\r\n';
						notifcn += '     - ÊØè‰∏™Âà∑Êñ∞ÁöÑÈ°µÈù¢ÔºåÂú®Âà∑Êñ∞ÂâçÈÉΩ‰ºöËá™Âä®‰øùÂ≠ò [ËÆæÁΩÆÊï∞ÊçÆ]ÔºåÂà∑Êñ∞ÂêéÂèà‰ºöËØªÂèñ [ËÆæÁΩÆÊï∞ÊçÆ] „ÄÇÂõ†Ê≠§ÔºåËÆæÁΩÆ‰∏ç‰ºöÂèëÁîüÂèòÂåñ„ÄÇ\r\n';
						notifcn += '     - Âà∑Êñ∞„ÄÅÂÖ≥Èó≠„ÄÅÂàáÊç¢Ê†áÁ≠æÈ°µÁ≠âÊìç‰ΩúÈÉΩ‰ºöËß¶ÂèëËá™Âä®‰øùÂ≠òÔºåÊâÄ‰ª•ÊúÄÊñ∞ÁöÑ [ËÆæÁΩÆ] ÈÄöÂ∏∏‰ª•ÊúÄÂêé‰∏ÄÊ¨°Êìç‰ΩúÁöÑÁΩëÈ°µ‰∏∫ÂáÜ„ÄÇ\r\n\r\n';
					}
					notifen = "  ‚Ä¢ All data is stored only in the browser's local storage (localStorage) and is not transmitted externally.\r\n";
					notifen += "  ‚Ä¢ [Delete Data] can clear all data or use the browser's history clearing function to empty the data (clear cache).";
					if(!this.isSimpleMode){
						notifen += "\r\n  ‚Ä¢ localStorage is a browser-provided feature that allows storing data on the user's local device. 1) localStorage is associated with a specific domain, enabling sharing of the same localStorage among pages within the same domain.  2) For locally-run HTML files (address starting with file:///), localStorage is generally shared. In the same browser, different local web pages share the same localStorage (depending on the actual situation).  3) localStorage is not shared across different browsers.  4) In privacy mode, typically each tab has its own isolated localStorage.";
					}

					notifen += '\r\n\r\n  ‚Ä¢ MCGPT Data: Fully automated saving\r\n';
					notifen += '    The data is divided into four parts, supporting one-click deletion or export. It also allows individual deletion or export, and supports sharing and importing. When importing, it automatically analyzes the included data types.\r\n\r\n';

					notifen += '  ‚Ä¢ 1) Chat Data List: Including data from all chats. Can export single or all chats.\r\n';
					if(!this.isSimpleMode){
						notifen += '    Update method: Automatically merge data\r\n    Import method: Automatically merge data\r\n    Multiple tabs: Real-time data synchronization\r\n\r\n';
					}
					notifen += '  ‚Ä¢ 2) API Key Data: Including API Key data *Functionality under development\r\n';
					if(!this.isSimpleMode){
						notifen += '    Update method: Automatically merge data\r\n    Import method: Automatically merge data\r\n    Multiple tabs: Real-time data synchronization\r\n\r\n';
					}
					notifen += '  ‚Ä¢ 3) Prompts Data: Including data from the prompt generator window (excluding current system prompt) *Functionality under development\r\n';
					if(!this.isSimpleMode){
						notifen += '    Update method: Automatically merge data\r\n    Import method: Automatically merge data *Functionality under development\r\n    Multiple tabs: Manually refresh to get the latest data\r\n\r\n';
					}
					notifen += '  ‚Ä¢ 4) User Settings: Including configurations, uploaded user avatar and API parameter settings\r\n';
					if(!this.isSimpleMode){
						notifen += '    Update method: Overwrite old data\r\n    Import method: Overwrite old data\r\n    Multiple tabs:\r\n';
						notifen += '     - Each refreshed page will automatically save settings data before refreshing, and then read settings data after refreshing. Therefore, settings will not change.\r\n';
						notifen += '     - Refreshing, closing, switching tabs, and other operations will trigger automatic saving. Therefore, the latest settings are usually based on the last operation on the webpage.';
					}
					
					//‰∏çÊîØÊåÅÊú¨Âú∞Â≠òÂÇ®Êó∂
					if(!this.isLocalStorageSupported){
						notifcn = 'ÂΩìÂâçÊµèËßàÂô®ÊàñÊµèËßàÂô®Ê®°Âºè‰∏çÊîØÊåÅ"ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®"ÔºåÂ∑≤ÂÖ≥Èó≠‰øùÂ≠òÂäüËÉΩÔºåÂπ∂‰∏ç‰ºöÂ≠òÂÇ®‰ªª‰ΩïÊï∞ÊçÆ„ÄÇ‰ΩÜÊòØÊÇ®‰ªçÁÑ∂ÂèØ‰ª•ÈÄöËøá‰ΩøÁî® [Âà†Èô§Êï∞ÊçÆ] ËøõË°åÂº∫Âà∂Ê∏ÖÁ©∫Êï∞ÊçÆÔºåÂç≥‰ΩøÂΩìÂâçÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®‰∏≠‰∏çÂ∫îËØ•Â≠òÂú®ÊúâÊï∞ÊçÆ„ÄÇ\r\n\r\n';
						notifen = 'The browser or browser mode does not support "browser local storage". The save function has been disabled, and no data will be stored. However, you can still use the "Delete Data" option to forcefully clear any data, even though there should not be any data present in the browser local storage.';
					}
					
					title = '';
					break;
				  case 'D-AutoKeyRotation':
					notifcn = '  ‚Ä¢ MCGPT ÈÄöËøá Key ÁâπÂæÅ„ÄÅÁ¨¨‰∏âÊñπÊé•Âè£ÁöÑÂÖ≥ÈîÆËØçËá™Âä®ÂàÜÁ±ª„ÄÇÂ¶ÇÊûúÊú™Ê≠£Á°ÆËØÜÂà´‰∏∫Á¨¨‰∏âÊñπ Key ÔºåÂàôÂèØ‰ª•ÁÇπÂáª [Á∫ßÂà´] ËøõË°å‰øÆÊîπ (ÂçïÂêëÊìç‰Ωú)„ÄÇ';
					notifcn += '\r\n\r\n  ‚Ä¢ Ëá™Âä®ËΩÆÊç¢ API Key ÁÆóÊ≥ïÊòØÊ†πÊçÆËÆ¢ÈòÖËÆ°ÂàíÂíåÂÖçË¥πËÆ°ÂàíÁöÑÂØÜÈí•ÁâπÊÄßËÆæËÆ°ÁöÑ„ÄÇÁªìÂêà OpenAI ÈîôËØØ‰ª£Á†ÅÔºåÊ†πÊçÆÂÆûÈôÖ‰ΩøÁî®ÊÉÖÂÜµÂä®ÊÄÅÊ†áËÆ∞ API Key Âπ∂Êô∫ËÉΩË∞ÉÁî®ÔºåÊó†ÈúÄ‰∫∫Â∑•Âπ≤È¢Ñ„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ [Ëá™Âä®ËΩÆÊç¢API Key] ‰∏é [Ëá™Âä®ÈáçÈóÆ] ÁöÑÁªìÂêàÔºö(Á¨¨‰∏âÊñπÂçïKeyÊ®°Âºè‰∏ãËß¶ÂèëËá™Âä®ÈáçÈóÆÁöÑÊÉÖÂÜµ‰ºöÂáèÂ∞ë) ÂΩìËØ∑Ê±ÇÂá∫Áé∞ÈîôËØØÊó∂Ôºå‰ºöËá™Âä®Âà§Êñ≠ÊòØÂê¶ÈúÄË¶Å  [Ëá™Âä®ÈáçÈóÆ] „ÄÇ‰∏∫‰∫ÜÊèê‰æõÊõ¥Â•ΩÁöÑÁî®Êà∑‰ΩìÈ™åÔºåËá™Âä®ÈáçËØï‰∏ç‰ºöÊó†ÈôêÂà∂ËøõË°åÔºåÊúâ‰∫õÊÉÖÂÜµ‰ºö‰∏≠Ê≠¢ÈáçËØïÔºåËÄåÈúÄË¶ÅËá™Âä®ÈáçËØïÁöÑÊÉÖÂÜµ‰ºöÁªºÂêàËÄÉËôëÈîôËØØÁ±ªÂûã„ÄÅÂ∑≤ÈáçËØïÊ¨°Êï∞ÂíåÂ∑≤Á≠âÂæÖÊó∂Èó¥Êù•Âà§Êñ≠ÊòØÂê¶ÈÄÇÂêàÈÄöËøáËΩÆÊç¢ Key Êù•ÈáçÂèëËØ∑Ê±Ç„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ Ëá™Âä®ËΩÆÊç¢ API Key ÂäüËÉΩ‰∏çÊîØÊåÅÊâãÂä®ÂÖ≥Èó≠„ÄÇÊîØÊåÅ Key Êï∞ÈáèÔºö1 ‰∏™Êàñ‰ª•‰∏ä„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ ÂØπ‰∫éÈùû‰ªòË¥πÁî®Êà∑ÔºåÂ¶ÇÊûúÊÇ®Êúâ‰∏§‰∏™ OpenAI ÂÖçË¥πËÆ°ÂàíÁöÑË¥¶Âè∑ÔºåÂ∞ÜËé∑ÂæóÂæàÂ•ΩÁöÑ‰ΩìÈ™å„ÄÇÂª∫ËÆÆÂæÄ MCGPT Ê∑ªÂä†ÊØè‰∏™ OpenAI Ë¥¶Âè∑ÁöÑ Key ÁöÑÊï∞Èáè‰∏∫ 2ÔΩû3 ‰∏™ (ËôΩÁÑ∂Áõ∏ÂêåË¥¶Âè∑‰∏ãÁöÑKeyÊòØÂÖ±‰∫´ËØ∑Ê±ÇÈÖçÈ¢ùÁöÑ)ÔºåÂΩìÁÑ∂ÔºåÊØè‰∏™Ë¥¶Âè∑Âè™Âèñ  1 ‰∏™ Key ‰πüÊòØÂèØ‰ª•ÁöÑ„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ Âçï‰∏™Ê∑ªÂä†ÂíåÊâπÈáèÊ∑ªÂä†Ê≤°ÊúâÂå∫Âà´„ÄÇÂçï‰∏™Ê∑ªÂä†Êó∂‰∏ç‰ºöËÆ∞ÂΩïÊó†Êïà KeyÔºåËÄåÊâπÈáèÊ∑ªÂä†Êó∂ÔºåÊó†Êïà Key ‰ºöÂú®Ë¢´ËÆ∞ÂΩï„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ ÊâπÈáèÊ∑ªÂä†‰ªÖÊîØÊåÅ‰ª• "sk-" ÂºÄÂ§¥ÁöÑ KeyÔºåÂèØËØÜÂà´‰∏§ÁßçÊ†ºÂºèÔºö1ÔºâÊØèË°å‰∏Ä‰∏™‰ª•"sk-"ÂºÄÂ§¥ÁöÑ keyÔºõ2ÔºâËØÜÂà´ÊñáÊú¨‰∏≠Â∏¶ÂèåÂºïÂè∑ÁöÑ‰ª•"sk-"ÂºÄÂ§¥„ÄÅÈïøÂ∫¶‰∏∫ 51 ‰ΩçÁöÑ KeyÔºàÊîØÊåÅ‰∏çÊç¢Ë°åÁöÑÊñáÊú¨ÔºåÊØîÂ¶ÇÁõ¥Êé•Â§çÂà∂ JSON Êñá‰ª∂ÁöÑÊñáÊú¨ÂÜÖÂÆπÔºâ„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ ÊâπÈáèÊ∑ªÂä†Êó∂Ôºå‰∏ç‰ºöÁ´ãÂç≥È™åËØÅÊúâÊïàÊÄß„ÄÇÂ¶ÇÊûúÊ∑ªÂä†‰∫ÜÂ§ßÈáèÊó†Êïà KeyÔºåËØ∑Ê±ÇËøáÁ®ã‰∏≠ÔºåÂΩìÂçïÊ¨°ËøûÁª≠Ê£ÄÊµãÂà∞ 20 ‰∏™Êó†Êïà Key Êó∂ÔºåÊ£ÄÊµã‰ºö‰∏≠Ê≠¢„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ ÂèØ‰øÆÊîπÁ∫ßÂà´ÔºåÁÇπÂáª API Key ÁöÑÁ∫ßÂà´ÔºåÊ†πÊçÆÊèêÁ§∫ËøõË°å‰øÆÊîπ„ÄÇÈÄöÂ∏∏‰∏çÈúÄË¶Å‰øÆÊîπÁ∫ßÂà´„ÄÇÂ¶ÇÊûúÊÇ®ÁöÑ‰ªòË¥π Key Ê≤°ÊúâË¢´Ê†áËÆ∞‰∏∫‰ªòË¥πÔºåËøô‰∏çÊòØ‰∏Ä‰∏™ÈóÆÈ¢òÔºå‰∏ç‰ºöÂΩ±ÂìçÂÆûÈôÖ‰ΩøÁî®„ÄÇÂΩìÂá∫Áé∞ËøûÁª≠Ë¢´Ë∞ÉÁî®ÁöÑÊÉÖÂÜµÔºåÂπ∂ËææÂà∞Èâ¥Âà´Ê†áÂáÜÊó∂ÔºåÁ≥ªÁªü‰ºöËá™Âä®Ê†áËÆ∞‰∏∫‰ªòË¥π„ÄÇËøôÈúÄË¶Å‰∏Ä‰∏™ËøáÁ®ãÔºåÂèñÂÜ≥‰∫éÊ∑ªÂä† Key ÁöÑÊï∞Èáè„ÄÅËØ∑Ê±ÇÁöÑÈ¢ëÁéá‰ª•Âèä Key ÊòØÂê¶Áã¨‰∫´ÁöÑÊÉÖÂÜµ„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ Â¶ÇÊûúÊÉ≥ÊÅ¢Â§ç‰πãÂâçË¢´Ê†áËÆ∞‰∏∫"Ë∂ÖÂá∫ÈÖçÈ¢ù"ÁöÑ KeyÔºåÂèØ‰ª•ÊâãÂä®‰øÆÊîπÂÆÉÁöÑÁ∫ßÂà´Ôºå‰ºòÂÖàÊîπÊàê 0 Êàñ 1„ÄÇ';
					notifcn += '\r\n  ‚Ä¢ ÊâπÈáèÂà†Èô§Ôºö[ËÆæÁΩÆ] > [Âà†Èô§Êï∞ÊçÆ]ÔºåÂà†Èô§ÊâÄÊúâ API Key „ÄÇ';
					notifcn += '\r\n  ‚Ä¢ Â¶ÇÊûúÈúÄË¶Å‰øÆÊîπ MCGPT ÁöÑ JSON Êï∞ÊçÆÊñá‰ª∂ÔºåÊé®Ëçê JSON Âú®Á∫øÁºñËæëÂ∑•ÂÖ∑Ôºöhttps://jsoneditoronline.org';

					notifen = '  ‚Ä¢ MCGPT uses key features and keywords from third-party interfaces to automatically categorize. If it is not correctly recognized as a third-party key, you can click [level] to modify it (one-way operation).';
					notifen += '\r\n\r\n  ‚Ä¢ The algorithm of [Auto Key Rotation] is designed according to the characteristics of keys in subscription and free plans. Combining with OpenAI error codes, API Key is dynamically marked and intelligently called based on actual usage.';
					notifen += '\r\n  ‚Ä¢ [Auto Key Rotation] and [Auto Retry]: (Under the "3rd party Key Mode", there will be fewer "Auto-Retry".) When a request encounters an error, the system will automatically determine whether to retry. To provide a better user experience, auto-retry will not be performed indefinitely. Some situations may stop retrying, while situations that require auto-retry will be judged comprehensively based on error types, number of retries, and waiting time to determine whether it is suitable to resend the request by rotating the Key.';
					notifen += '\r\n  ‚Ä¢ [Auto Key Rotation] cannot be manually turned off. Supports Key quantity: 1 or more.';
					notifen += '\r\n  ‚Ä¢ For non-paying users, if you have two OpenAI free plan accounts, you can get a better user experience. It is recommended to add 2-3 Keys for each OpenAI account added to MCGPT (although Keys under the same account share request quota), and of course, only adding 1 Key for each account is also acceptable.';
					notifen += '\r\n  ‚Ä¢ There is no difference between adding a single Key or adding Keys in bulk. Invalid Keys will not be recorded when adding a single Key, while invalid Keys will be recorded when adding Keys in bulk.';
					notifen += '\r\n  ‚Ä¢ [Bulk Add] only supports keys starting with "sk-", and it can recognize two formats: 1) one key starting with "sk-" per line; 2) a Key starting with "sk-" and with a length of 51 characters recognized in a text enclosed in double quotes (Supports text without line breaks, such as directly copying the text content of a JSON file.).';
					notifen += '\r\n  ‚Ä¢ When adding Keys in bulk, the system will not immediately check their validity. If a large number of invalid Keys are added, the check will be stopped when 20 consecutive invalid Keys are detected during the request process.';
					notifen += '\r\n  ‚Ä¢ The level can be modified by clicking on the level of the API Key and following the prompts. Usually, there is no need to modify the level. If your paid Key is not marked as a paid account, it is not an issue and will not impact actual usage. When a Key is called continuously and reaches the identification standard, it will be automatically marked as a paid account. This is a process that depends on the number of Keys added, request frequency, and whether the Key is exclusively used.';
					notifen += '\r\n  ‚Ä¢ If you want to restore a Key that was marked as "Quota exceeded", you can manually modify its level, preferably to 0 or 1.';
					notifen += '\r\n  ‚Ä¢ Batch deletion: [Settings] > [Delete Data] > Delete all API Keys.';
					notifen += '\r\n  ‚Ä¢ If you want to modify the JSON file for MCGPT, we recommend using an online JSON editor tool: https://jsoneditoronline.org';

				  	title = '';
					break;
				  default:
					// ÂΩìexpressionÁöÑÂÄºÈÉΩ‰∏çÁ≠â‰∫é‰ª•‰∏äÂÄºÊó∂ÊâßË°åÁöÑ‰ª£Á†ÅÂùó
				  	notifcn = '';
					notifen = '';
				  	title = '';
				}	

				notif = this.settingsLanguage == 'cn' ? notifcn : notifen ;
				this.showNotification(notif, 'center', title);
			},
	
			// ËÆæÁΩÆÁ™óÂè£ - ÊâìÂºÄËÆæÁΩÆÁ™óÂè£ ÂºπÁ™ó
			openDialogTodo_Settings(){

				//ÊâìÂºÄÂºπÁ™óÂâçÈúÄË¶ÅÂ§ÑÁêÜÁöÑÔºö
				//1. API URLÔºö Â∞ÜÂΩìÂâçapi urlÊÅ¢Â§çÂà∞inputÔºåÊó†ËÆ∫ÊòØÂê¶ÊúâÊïàÔºåÂç≥ÊâìÂºÄÂºπÁ™óÊó∂ÔºåÈªòËÆ§ÊòæÁ§∫ÂΩìÂâç‰ΩøÁî®ÁöÑURL„ÄÇ 
				this.inputApiURL = this.apiURL;
				
				//2. API URLÔºö ‰øùÂ≠òÊåâÈíÆ‰∏çÂèØÁî®„ÄÇurlÂú®‰øÆÊîπÂâç‰øùÊåÅ‰∏çÂèØÁî®Áä∂ÊÄÅ
				this.btnDisabledState_SaveApiURL = true;
				
				//3. API URLÔºö ‰∏ãÊãâÊ°ÜÂåπÈÖç
				// ‰∏ãÊãâÊ°ÜÊòæÁ§∫‰∏∫‚ÄúÈùûÂÆòÊñπ‚Äù/‚Äú3rd party‚Äù // ‰∏ãÊãâÊ°ÜÊòæÁ§∫‰∏∫‚ÄúÂÆòÊñπ‚Äù/‚ÄúOpenAI‚Äù
				let isExist = false;
				if(this.settingsLanguage === 'cn'){
					isExist = this.apiURLOptions_cn.some(item => item.url === this.inputApiURL.toLowerCase());
					if( !isExist && this.isLoadThirdPartyPaidAPIs){
						isExist = this.apiURLOptions_LoadThirdPartyPaidAPIs.some(item => item.url === this.inputApiURL.toLowerCase());
					}
				}else{
					isExist = this.apiURLOptions_en.some(item => item.url === this.inputApiURL.toLowerCase());
				}
				if(isExist){
					this.selectedApiURL = this.inputApiURL.toLowerCase();
				}else{
					this.selectedApiURL = "";
				}
				
				//4. img URLÔºö Â∞ÜÂΩìÂâçÂ§¥ÂÉèÂú∞ÂùÄimg urlÊÅ¢Â§çÂà∞ËæìÂÖ•Ê°ÜinputÔºåÂç≥ÊâìÂºÄÂºπÁ™óÊó∂ÔºåÈªòËÆ§ÊòæÁ§∫ÂΩìÂâç‰ΩøÁî®ÁöÑÂ§¥ÂÉèÁöÑURL„ÄÇ 
				const svgtips = this.settingsLanguage == 'cn' ? this.GPTGreenSVG_UrlText_cn : this.GPTGreenSVG_UrlText_en;
				this.inputGPTImageUrl = this.isgptGreenSvgShow ? svgtips : this.gptAvatarURL;
				this.inputUserImageUrl = this.userAvatarURL;
				
				//5. img URLÔºö Êõ¥Êñ∞Â§¥ÂÉèÊåâÈíÆ‰∏çÂèØÁî®„ÄÇurlÂú®‰øÆÊîπÂâç‰øùÊåÅ‰∏çÂèØÁî®Áä∂ÊÄÅ
				this.btnDisabledState_updateUserImageUrl = true;
				this.btnDisabledState_updateGPTImageUrl = true;
				
				//ÊòæÁ§∫ËÆæÁΩÆÂºπÁ™ó
				this.isShowDialog_Settings = true;
			},
			// ËÆæÁΩÆÁ™óÂè£ - ÁÆÄÁ∫¶Ê®°Âºè/ÈªòËÆ§Ê®°Âºè Normal Mode .  Êñ∞Áî®Êà∑Ê®°Âºè/ÊïôÁ®ãÊ®°Âºè User Onboarding
			changeSimpleMode(ischange){
				
				if ( ischange !== false ){
					let notif = '';
					let notif_time = 6000;
					if(this.isSimpleMode){
						notif = this.settingsLanguage == 'cn' ? 'ÈªòËÆ§Ê®°Âºè (ÁÆÄÁ∫¶Ê®°ÂºèÔºåÈÄÇÂêàÂ∑≤ÁÜüÊÇâÊñ∞ÁâàÊú¨ MCGPT ÁöÑÁî®Êà∑)' : 'Normal Mode (Simple Mode, suitable for users familiar with the new version of MCGPT.)' ;
						notif_time = this.settingsLanguage == 'cn' ? 4500 : 6000;
					}else{
						notif = this.settingsLanguage == 'cn' ? 'Êñ∞Áî®Êà∑Ê®°Âºè (Ê≠§Ê®°Âºè‰∏ã‰ºöÂ¢ûÂä†ÂäüËÉΩÊèêÁ§∫ÔºåÂπ∂Êèê‰æõÊõ¥‰∏∞ÂØåÁöÑÂ∏ÆÂä©ÂÜÖÂÆπ)' : 'User Onboarding (this mode provides more functional prompts and richer help content.)' ;
						notif_time = this.settingsLanguage == 'cn' ? 5500 : 6000;
					}
					this.showNotification(notif, 'bottom', '',6000);
				}
				
				//‰∏Ä‰∫õCSSÊ†∑Âºè/Â∏ÉÂ±Ä
				//Âà§Êñ≠ËÆæÂ§áÂÆΩÂ∫¶ ÊòØÂê¶ÊòæÁ§∫tokens ÁöÑÊñáÂ≠ó / ÂõæÊ†á...
				if (document.documentElement.clientWidth < 450) {
					//let isshow = Math.random() < 0.6  ; //Ê¶ÇÁéá ÈöèÊú∫ 
					//if(this.isSimpleMode){ isshow = false; }
					//this.isShowTotaltokensSVG = !isshow;
					//this.isShowTotaltokensLabel = isshow;//Â∞èÂ±èÂπïÂèØËÄÉËôëÊòæÁ§∫ 
					this.isShowTotaltokensSVG = true; 
					this.isShowTotaltokensLabel = false;//Â∞èÂ±èÂπïÁõ¥Êé•‰∏çÊòæÁ§∫
				}else {
					this.isShowTotaltokensSVG = true;
					this.isShowTotaltokensLabel = !this.isSimpleMode ; // !this.isSimpleMode = ( true && this.isSimpleMode )
				}
				// Âà§Êñ≠ËÆæÂ§áÂÆΩÂ∫¶ ÊòØÂê¶ÊòæÁ§∫‰∏ä‰∏ãÊñá/ËÆ∞ÂøÜ ÁöÑÊñáÂ≠ó 
				if (document.documentElement.clientWidth < 471 ){
					this.isShowQACountLabel = false;
				}else {
					this.isShowQACountLabel = !this.isSimpleMode ; // !this.isSimpleMode = ( true && this.isSimpleMode )
				}
			
			},
			// ËÆæÁΩÆÁ™óÂè£ - ÊòæÁ§∫‰∏ì‰∏öÁ∫ßAPIËÆæÁΩÆ Pro ËÆæÁΩÆÊéßÂà∂Èù¢Êùø
			showProConfig(){
				let notif = '';
				if(this.isShowProConfig){
					this.isShowProConfig = false;
					notif = this.settingsLanguage == 'cn' ? 'ÈöêËóè API‰∏ì‰∏öËÆæÁΩÆ' : 'Hide Professional API Settings' ;
				}else{
					this.isShowProConfig = true;
					notif = this.settingsLanguage == 'cn' ? 'ÊòæÁ§∫ API‰∏ì‰∏öËÆæÁΩÆ' : 'Show Professional API Settings' ;
				}
				this.showNotification(notif, 'bottom');
			},
			// ËÆæÁΩÆÁ™óÂè£ - ÂºÄÂêØ/ÂÖ≥Èó≠Êô∫ËÉΩmax_tokens  Smart max_tokens 
			changeSmartMaxTokens(){ 
				this.isReminded_SmartMaxTokens = 5;//5Ê¨°ÂêéÊèêÈÜí
				const notif_cn =  this.openSmartMaxTokens ? 'Â∑≤ÂêØÁî® Êô∫ËÉΩmax_tokens' : 'Â∑≤ÂÖ≥Èó≠ Êô∫ËÉΩmax_tokens';
				const notif_en =  this.openSmartMaxTokens ? 'Smart max_tokens Enabled' : 'Smart max_tokens Disabled';
				const notif = this.settingsLanguage == 'cn' ? notif_cn : notif_en ;
				this.showNotification(notif, 'bottom');
			},
			// Âà§Êñ≠ÊòØÂê¶ÈúÄË¶ÅÁ¶ÅÁî®ÁΩëÈ°µÁº©Êîæ user-scalable  *ÂÆûÈôÖ‰∏äÊâÄÊúâÊÉÖÂÜµ‰∏ãÈÉΩÂèØ‰ª•Áº©ÊîæÔºåÂè™Á¶ÅiosÔºå‰ΩÜios‰ºöÂøΩÁï•Á¶ÅÁî®Êåá‰ª§
			isDisableZoomOnIOS(){		
				//‰ªÖiphone/ipadÈúÄË¶ÅÁ¶ÅÁî®Áº©ÊîæÔºàÊéíÈô§Â§∏ÂÖãÊµèËßàÂô®Ôºâ„ÄÇ‰∏çÁ¶ÅÁî®Êó∂ÔºåiosËÆæÂ§áÁÇπÂáªËæìÂÖ•Ê°Ü‰ºöÊîæÂ§ßÈ°µÈù¢ÔºåËæìÂÖ•ÂêéÈúÄË¶ÅÊâãÂä®Áº©Â∞èÈ°µÈù¢ÔºåÂØπ‰∫éËÅäÂ§©ÁΩëÈ°µËÄåÂ∑≤Ôºå‰ΩìÈ™å‰∏çÂ•ΩÔºåÂæàÈ∫ªÁÉ¶„ÄÇ Á¶ÅÁî®ÂêéÔºåiosËÆæÂ§á‰∏≠ÁöÑsafari„ÄÅfirefox„ÄÅchrome„ÄÅedgeÈÉΩËøòÂèØ‰ª•ÊîæÂ§ßÔºå‰ºöÂøΩÁï•Êåá‰ª§Ôºå‰ΩÜÊòØQuarkÊµèËßàÂô®Èô§Â§ñ„ÄÇ
				let isIOS = /iPad|iPhone|ios|iPod/.test(navigator.userAgent) ; // Âà§Êñ≠ÊòØÂê¶‰∏∫ iOS ËÆæÂ§á
				let isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent); // Âà§Êñ≠ÊòØÂê¶‰∏∫ Safari ÂÜÖÊ†∏
				let isQuark = /Quark|quark/.test(navigator.userAgent);  // Âà§Êñ≠ÊòØÂê¶‰∏∫ Â§∏ÂÖã ÊµèËßàÂô®Ôºåiphone‰∏≠Quark‰ºö‰∏•Ê†ºÊâßË°åÁ¶ÅÁî®Áº©ÊîæÁöÑÂëΩ‰ª§ÔºåËÄåÂÖ∂‰ªñÊµèËßàÂô®ÈÉΩ‰ºöÂøΩÁï•
				//Êù°‰ª∂ÂÆΩÊùæÁÇπÔºåisSafariÂèØËÉΩÊòØmacÔºåÁ¶ÅÁî®‰∏çÂΩ±Âìç
				if((isIOS || isSafari) && !isQuark){
					//user-scalable=no
					return true;
				}else{
					//user-scalable=yes
					return false;
				}
			},
			// ËÆæÁΩÆÁ™óÂè£ - Êõ¥ÊîπÁßªÂä®Á´ØÈ°µÈù¢ÊòæÁ§∫ÊØî‰æãÔºåÈªòËÆ§0.8  change Page Scaling  mode: true=selected change  false=manual setting
			changePageScaling(mode){ 
				//È™åËØÅÔºåÈÅøÂÖçÊÑèÂ§ñÈîôËØØ
				let checkPageScaling;
				if(mode === false){
					checkPageScaling = parseFloat(this.pageScaling);// this.pageScaling like '0.8'
				}else{
					checkPageScaling = parseFloat(this.selectedPageScaling) / 100; // this.selectedPageScaling like '80%'
					this.selectedPageScaling = '';//Â§çÂéü
				}
				
				// Âà§Êñ≠ÊòØÂê¶‰∏∫Á©∫
				if (isNaN(checkPageScaling)) {
					checkPageScaling = 0.8;
				}
				// Âà§Êñ≠ÊòØÂê¶Âú®ËåÉÂõ¥ÂÜÖ
				if (checkPageScaling < 0.5 || checkPageScaling > 1) { //ÈÄöËøásetAttributeËÆæÁΩÆÔºåË∂ÖËøá100%Ê≤°ÊúâÊïàÊûú
					checkPageScaling = 0.8;
				}
				
				// Á°Æ‰øùÊ†ºÂºèÊ≠£Á°Æ ‰øùÁïô2‰ΩçÂ∞èÊï∞ÁöÑÂ≠óÁ¨¶‰∏≤Âûã
				this.pageScaling = checkPageScaling.toFixed(2); // toString
				
				const user_scalable = this.isDisableZoomOnIOS() ? 'user-scalable=no,' : 'user-scalable=yes,' ; 
				const newContent = 'width=device-width,initial-scale=' + this.pageScaling + ',minimum-scale=0.5,maximum-scale=2,' + user_scalable + 'viewport-fit=cover';
				document.querySelector('meta[name="viewport"]').setAttribute('content', newContent);
				
				if(mode !== false){
					const percent = (parseFloat(this.pageScaling) * 100).toFixed(0) + '%'; //ËΩ¨ÁôæÂàÜÊØî
					const notif = this.settingsLanguage == 'cn' ? 'ÁΩëÈ°µÊòæÁ§∫ÊØî‰æãÂ∑≤Êîπ‰∏∫ ' + percent + ' (Â¶ÇÊûúÁΩëÈ°µÊîæÂ§ß‰∫ÜÔºåËØ∑ÂèåÊåáÊìç‰ΩúÁº©Â∞è)' : 'Page display scale has been changed to ' + percent + ' (If the page is zoomed in, use two fingers to zoom out).' ;
					const notiftime = this.settingsLanguage == 'cn' ? 6500 : 7500;
					this.showNotification(notif, 'bottom', '', notiftime);
					this.changeSimpleMode(false);
				}
			},
			//totaltokens ÊòØÂê¶Ë∂ÖÂá∫ Ê®°Âûãmax_tokensÁöÑÊúÄÂ§ßÂÄº
			isTotaltokens_Exceeds_Maxtokens(modeldata){
				const model_data = modeldata != null ? modeldata : this.gptModelList.find(model => model.modelname === this.apiGPTModel);
				this.isModelDataExist_In_gptModelList(model_data);
				
				if (this.totaltokens > model_data.maxtokens ){ //ÂΩìÂâçtotaltokens Â∑≤ÁªèË∂ÖËøáÊ®°ÂûãÁöÑÊúÄÂ§ßmax_tokensÊï∞  *Ê≥®ÊÑèÔºöËøôÈáå‰∏çË¶ÅÁî®(this.totaltokens >= model_data.maxtokens )Êàñ(this.totaltokens >= model_data.maxtokens - 1 )ÔºåÂê¶ÂàôÂàöÂ•ΩÂà∞Áî®16384ÁöÑÊó∂ÂÄôÔºåÈáçÈóÆ‰ºöÂºπÁ™óË¶ÅÊ±ÇÊç¢Ê®°Âûã„ÄÇ
					const notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâç‰∏ä‰∏ãÊñáËÆ∞ÂøÜÂ∑≤‰ΩøÁî®ÁöÑ tokens Êï∞Èáè‰∏∫ ' + this.totaltokens + ' ÔºåÂ∑≤Ë∂ÖÂá∫ÂΩìÂâçÊ®°ÂûãÊîØÊåÅÁöÑÊúÄÂ§ß max_tokens Êï∞Èáè ( ' + model_data.maxtokens + ' )ÔºÅ\r\nËØ∑Â§ÑÁêÜÂéÜÂè≤ËÆ∞ÂΩïÊàñÂàáÊç¢Âà∞ÊîØÊåÅÊõ¥Â§ß max_tokens ÁöÑÊ®°Âûã„ÄÇ\r\n\r\nÂΩìÂâçÊ®°Âûã(model):  ' + this.apiGPTModel  : 'The current context has used ' + this.totaltokens + ' tokens, which exceeds the maximum max_tokens ' + model_data.maxtokens + ' supported by the current model! \r\nPlease handle the chat history or switch to a model that supports a larger max_tokens.\r\n\r\nThe current model: ' + this.apiGPTModel ;
					setTimeout(() => {
						alert(notif);
					}, 80);//Âª∂ËøüÁõÆÁöÑ„ÄÇÂ¶ÇÊûúÊòØÂàáÊç¢Ê®°Âûã(‰∏ãÊãâÊ°Ü)ÔºåÂºπÂ§™Âø´ÁïåÈù¢‰∏äÊòæÁ§∫ÁöÑÊòØÂàáÊç¢‰πãÂâçÁöÑÊ®°Âûã„ÄÇÂª∂Ëøü‰∏ÄÁÇπÔºåÂàáÊç¢ÂêéÁöÑÊ®°ÂûãÊòæÁ§∫Âá∫Êù•ÂêéÔºåÂÜçÂºπ„ÄÇ
					return true;
				}
				return false;
			},	
			
			// Ê®°ÂûãËµÑÊñôÊòØÂê¶Â≠òÂú®MCGPT‰ª£Á†Å‰∏≠„ÄÇ  Whether the model data exists in the MCGPT code
			isModelDataExist_In_gptModelList(modeldata){
				if(!modeldata){
					const err_model_cn = 'Ë≠¶Âëä\r\n\r\nÂΩìÂâçÁâàÊú¨ÁöÑ MCGPT ‰ª£Á†Å‰∏≠Êú™ÂåÖÂê´ÂΩìÂâçÊ®°Âûã "' + this.apiGPTModel + '" ÔºåËøô‰ºö‰∫ßÁîü‰∏ÄÁ≥ªÂàóÈîôËØØ„ÄÇ\r\n\r\nËß£ÂÜ≥ÊñπÊ≥ïÔºö1) Âú® [ËÆæÁΩÆ] ‰∏≠Êõ¥Êç¢‰∏Ä‰∏™Áé∞ÊúâÁöÑÊ®°ÂûãÔºåÂç≥ÂèØËß£ÂÜ≥ÈóÆÈ¢ò„ÄÇ 2) Â¶ÇÊûúÊÉ≥‰ΩøÁî®Ê®°Âûã "' + this.apiGPTModel + '"Ôºå‰Ω†ÂèØ‰ª•Êõ¥Êç¢Âê´ÊúâËØ•Ê®°ÂûãÁöÑ MCGPT ÁâàÊú¨ÔºåÊàñËÄÖÁºñËæë html ‰ª£Á†ÅÔºåÂ∞ÜËØ•Ê®°ÂûãËµÑÊñôÊ∑ªÂä†Âà∞Ê®°ÂûãÂ∫ì‰∏≠ (‰ª£Á†Å‰∏≠ÊêúÁ¥¢Ê®°ÂûãÂ∫ìÂèòÈáèÂêç: gptModelList)„ÄÇ';
					const err_model_en = 'Warnings\r\n\r\nThe current code does not include the current model "' + this.apiGPTModel + '", which will lead to many errors. \r\n\r\nTo resolve this issue, there are two possible solutions:  1) You can switch to a different existing model in the [Settings] to resolve the problem. 2) If you want to use the model "' + this.apiGPTModel + '", you can either switch to a MCGPT version that includes this model or edit the code to add the model to the model library (search for the variable name "gptModelList").';
					const err_model_msg = this.settingsLanguage == 'cn' ? err_model_cn : err_model_en;
					alert(err_model_msg);
				}
			},
				
			// ËÆæÁΩÆÁ™óÂè£ GPT Model
			changeGPTModel(){
				// if (this.checkBusyStatus()) {
				// 	// Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ
				// 	return;
				// } 
				
				let notif = '';
				const model_data = this.gptModelList.find(model => model.modelname === this.apiGPTModel);
				
				let smart_maxtokens_notif = false; //ÊòØÂê¶Âª∫ËÆÆÂºÄÂêØsmart max_tokens
				//ÂàáÊç¢Ê®°ÂûãÂêéÔºå‰øÆÊ≠£ÂèØËÉΩÂ≠òÂú®ÁöÑapiMaxTokens‰∏çÂêàÁêÜÁöÑÊÉÖÂÜµ ÔºàÂ∞§ÂÖ∂ÊòØÂú®Ê≤°ÊúâÂºÄÂêØsmart max_tokensÁöÑÊó∂ÂÄôÔºâ
				if (this.isTotaltokens_Exceeds_Maxtokens(model_data)){ //ÂΩìÂâçtotaltokens Â∑≤ÁªèË∂ÖËøáÊ®°ÂûãÁöÑÊúÄÂ§ßmax_tokensÊï∞, ÂºπÁ™óË≠¶Âëä + ËøîÂõû
					this.apiMaxTokens = model_data.maxtokens - 1;
					return;
				}
				if ( model_data.maxtokens >= this.totaltokens + 1 ){ //Ëã•Ê≤°ÊúâÂºÄÂêØsmart max_tokensÔºåÈÅøÂÖçtotaltokens + apiMaxTokens Ë∂ÖËøá maxtokens„ÄÇ ‰øùÁïô1ÔºåËÄå‰∏çÊòØÊõ¥Â§ßÁöÑÂ∑ÆÂÄºÔºåÊòØ‰∏∫‰∫ÜÂÆπÊòìË¢´Áî®Êà∑Ê≥®ÊÑèÂà∞apiMaxTokensÁöÑËÆæÁΩÆ‰∏çÂêàÁêÜÔºåÂºïÂØºÁî®Êà∑ÊâãÂä®‰øÆÊîπmax_tokens„ÄÇ
					const diff1 = model_data.maxtokens - this.totaltokens; 
					if (diff1 - this.apiMaxTokens > 200){
						//nothing to do  Â∑ÆÂÄº200‰ª•‰∏äÔºåÁõÆÁöÑÔºösmart_maxtokens_notif = flaseÔºå‰∏çÊèêÈÜí
					}else{
						this.apiMaxTokens = this.apiMaxTokens > diff1 ? diff1 : this.apiMaxTokens;
						smart_maxtokens_notif = true;
					}
				}
				
				if(smart_maxtokens_notif && !this.openSmartMaxTokens && !apiGPTModel.includes('gpt-3.5')){ //Âª∫ËÆÆÂºÄÂêØ && ÂΩìÂâçÊú™ÂºÄÂêØ &&  model‰∏∫GPT-3.5 (GPT4Â§™Ë¥µÔºå‰∏çÊé®ËçêÂºÄÂêØ)
					notif = this.settingsLanguage == 'cn' ? '‰∏çÂêåÊ®°ÂûãÁöÑ max_tokens ‰∏äÈôê‰∏çÂêåÔºåÂª∫ËÆÆÂêØÁî® [Êô∫ËÉΩmax_tokens] ÂäüËÉΩ' : 'The max_tokens limit varies for different models. Enable the [Smart max_tokens] feature for optimal results.' ;
					this.showNotification(notif, 'bottom', '', 5000);
				}else{
					notif = this.settingsLanguage == 'cn' ? '"GPTÊ®°Âûã (model)" ÂèòÊõ¥‰∏∫ ' + this.apiGPTModel : '"model" changed to ' + this.apiGPTModel ;
					this.showNotification(notif, 'bottom', '', 2000);
				}
					
				//ÂàáÊç¢Ê®°ÂûãÂêéÔºåÊ£ÄÊµãÊ®°ÂûãÊòØÂê¶ËøáÊúüÔºåËøáÊúüÊó∂ÊèêÈÜíÁî®Êà∑
				if(this.gptModel_CheckExpiration(this.apiGPTModel, 4000)){ //true:ËØ•Ê®°ÂûãËøáÊúü  Âª∂Êó∂4Áßí
					return;
				}
			},
			// Ê£ÄÊµãModelÊòØÂê¶ËøáÊúü  ËøîÂõûtrue‰∏∫ËøáÊúü
			gptModel_CheckExpiration(model_name, delaytime) {
				if (model_name == null || model_name === ''){
					return false;
				}
				delaytime = delaytime == null ? 0 : delaytime;
				
				try{
					for (const model of this.gptModelList) {
						if (model.modelname === model_name && model.expiredtime !== '') {
							const currentTime = new Date();// Ëé∑ÂèñÂΩìÂâçÊó∂Èó¥
							const expirationDate = new Date(model.expiredtime); // ÂàõÂª∫ËøáÊúüÊó∂Èó¥
							if (currentTime >= expirationDate) {
								const date_YYYYMMDD = this.formatDateYYYYMMDDHHmmss(expirationDate,':').slice(0, 10);
								let urls = '\r\n  ‚Ä¢ Model upgrades: https://platform.openai.com/docs/models/continuous-model-upgrades';
								urls += '\r\n  ‚Ä¢ Deprecations: https://platform.openai.com/docs/deprecations';
								urls += '\r\n  ‚Ä¢ GPT-3.5 Models: https://platform.openai.com/docs/models/gpt-3-5';
								urls += '\r\n  ‚Ä¢ GPT-4 Models: https://platform.openai.com/docs/models/gpt-4';
								const notif_cn = model.modelname + ' ‰∫é ' + date_YYYYMMDD + ' Ë¢´ OpenAI ÂºÉÁî®ÔºåËØ•Ê®°ÂûãÂ∞Ü‰∏çÂÜçÂèØÁî®„ÄÇÊÇ®ÂèØ‰ª•ÁªßÁª≠‰ΩøÁî®ËØ•Ê®°Âûã‰ª•È™åËØÅÂÖ∂ÊòØÂê¶Â∑≤Ë¢´ÂºÉÁî®ÔºåÊàñËÄÖÁõ¥Êé•Êõ¥Êç¢‰∏Ä‰∏™Ê®°Âûã„ÄÇ\r\n\r\n  ‚Ä¢ ËØ∑Ê≥®ÊÑèÔºåOpenAIÂÖ≥‰∫éÊ®°ÂûãÂºÉÁî®ÁöÑÊó∂Èó¥Ë°®ÊòØ‰ºöÂèëÁîüÊîπÂèòÁöÑ„ÄÇÂª∫ËÆÆÁªßÁª≠Â∞ùËØï‰ΩøÁî®ËØ•Ê®°Âûã‰ª•Á°ÆÂÆöÂÖ∂ÂèØÁî®ÊÄß„ÄÇÊ≠§Â§ñÔºåÊÇ®ÂèØ‰ª•ÂèÇËÄÉ‰∏ãÊñπÁöÑ OpenAI ÁΩëÈ°µ‰ª•‰∫ÜËß£Ê®°ÂûãÂºÉÁî®Êó∂Èó¥Ë°®ÊòØÂê¶ÊúâÂèëÁîüÂèòÂåñ„ÄÇ' + urls ;
								const notif_en = model.modelname + ' has been deprecated by OpenAI on ' + date_YYYYMMDD + ", and this model will no longer be available. You can continue to use the model to verify if it has been deprecated, or replace it with a new model.\r\n\r\n  ‚Ä¢ Please note that OpenAI's timeline for model deprecation is subject to change. We recommend continuing to try using the model to determine its availability. Additionally, you can refer to the OpenAI website below to stay updated on any changes to the model deprecation timeline." + urls
								const notif = this.settingsLanguage == 'cn' ? notif_cn : notif_en ;
								setTimeout(() => {
									const title = this.settingsLanguage == 'cn' ? 'ÊèêÈÜí' : 'Alert';
									this.showNotification(notif, 'center', title);
								}, delaytime);
								return true;
							} else {
								return false;
							}
						}
					}
					return false;
				}catch (e) {
					console.error('gptModel_CheckExpiration() - Ê£ÄÊµãModelÊòØÂê¶ËøáÊúü',e);
					return false;
				}
			},
			// ËÆæÁΩÆÁ™óÂè£ Temperature
			changeTemperature(){
				const notif = this.settingsLanguage == 'cn' ? '"temperature" ÂèòÊõ¥‰∏∫ ' + this.apitemperature.toString() : '"temperature" changed to ' + this.apitemperature.toString() ;
				this.showNotification(notif, 'bottom', '', 1800);
			},
			// ËÆæÁΩÆÁ™óÂè£ MaxTokens
			changeMaxTokens(){
				if(this.openSmartMaxTokens){
					return;//Ëá™Âä®Ë∞ÉÊï¥‰∏ç‰ºöÊøÄÂèë‰∫ã‰ª∂ÔºåÂèØ‰ª•‰∏çÁî®return
				}
				const notif = this.settingsLanguage == 'cn' ? '"max_tokens" ÂèòÊõ¥‰∏∫ ' + this.apiMaxTokens.toString() : '"max_tokens" changed to ' + this.apiMaxTokens.toString() ;
				this.showNotification(notif, 'bottom', '', 1800);
			},
			// ËÆæÁΩÆÁ™óÂè£ Top
			changeTopP(){
				const notif = this.settingsLanguage == 'cn' ? '"top_p" ÂèòÊõ¥‰∏∫ ' + this.apiTopP.toString() : '"top_p" changed to ' + this.apiTopP.toString() ;
				this.showNotification(notif, 'bottom', '', 1800);
			},
			// ËÆæÁΩÆÁ™óÂè£ PresencePenalty
			changePresencePenalty(){
				const notif = this.settingsLanguage == 'cn' ? '"presence_penalty" ÂèòÊõ¥‰∏∫ ' + this.apiPresencePenalty.toString() : '"presence_penalty" changed to ' + this.apiPresencePenalty.toString() ;
				this.showNotification(notif, 'bottom', '', 1800);
			},
			// ËÆæÁΩÆÁ™óÂè£ FrequencyPenalty
			changeFrequencyPenalty(){
				const notif = this.settingsLanguage == 'cn' ? '"frequency_penalty" ÂèòÊõ¥‰∏∫ ' + this.apiFrequencyPenalty.toString() : '"frequency_penalty" changed to ' + this.apiFrequencyPenalty.toString() ;
				this.showNotification(notif, 'bottom', '', 1800);
			},

			//Á≤óÁï•ÁöÑ‰º∞ÁÆótokens„ÄÇ‰ªÖÈÄÇÂêà GPT-3.5 & GPT4Ôºå ‰∏çÈÄÇÂêàGPT-3 ÔºåtokensËÆ°ÁÆóÊñπÂºèÂÆåÂÖ®‰∏çÂêå„ÄÇÊúâÊäÄÊúØÁöÑÂèØ‰ª•Áõ¥Êé•ÂÆûÁé∞100%Á≤æÂáÜËÆ°ÁÆóÔºå‰∏çÈúÄË¶Å‰º∞ÁÆó„ÄÇÂèÇËÄÉÂÆòÁΩëÔºåÊàñËÄÖÔºöhttps://gpt-tokenizer.dev
			MCGPTTokenizer(message) {
				// tool Ôºö https://gpt-tokenizer.dev
				// To support new languages ., 
				// 1). you should refer to the englishMixedArr and englishSingleArr to add new codes.  *Different languages are handled differently. The estimation for English is based on words or consecutive letters, while for Chinese, it is based on single characters.
				// 2). Test the new language on the website https://gpt-tokenizer.dev. If the spaces before the words are not counted as one token (1 token), you need to subtract the number of spaces in the "const _space = ..." code, just like how it is handled for English.
				// 3). To estimate the tokens for word groups (or characters) in a language, add the ratio calculation like the way it is handled for English: "const english_tokens = englishMixedArr.length / 0.75 ;".

				// ÂÆö‰πâÂ∑¶Âè≥ÊòØÁ©∫Ê†ºÁöÑÂçïÁã¨ËøûÁª≠Â≠óÁ¨¶ÁöÑÊ≠£ÂàôË°®ËææÂºè
				const englishSingleReg = /\s+[a-zA-Z]+/g; //Â∑¶ËæπÊòØÁ©∫Ê†ºÁöÑËøûÁª≠Ëã±ÊñáÔºåÁî®‰∫é‚ÄúÁ©∫Ê†ºËÆ°ÁÆó‚Äù

				// ÂÆö‰πâ‰∏≠Êñá„ÄÅÊï∞Â≠ó„ÄÅÁâπÊÆäÁ¨¶Âè∑ÁöÑÊ≠£ÂàôË°®ËææÂºè
				const chineseReg = /[\u2E80-\u9FFF]/g;
				const englishReg = /[a-zA-Z]+/g;
				const numberReg = /\d+/g;
				const symbolReg = /[^\u2E80-\u9FFFa-zA-Z0-9\s]/g; //Á¨¶Âè∑ÂèäÂÖ∂‰ªñËØ≠Ë®ÄÊñáÂ≠ó

				// ÂåπÈÖçÁ©∫Ê†º„ÄÅÂà∂Ë°®Á¨¶ÂíåÊç¢Ë°åÁ¨¶ÁöÑÊ≠£ÂàôË°®ËææÂºè
				const spaceReg = /\s+/g;
				const otherSpaceReg = /\s{2,}/g; //‰∏§‰∏™Êàñ‰ª•‰∏äËøûÁª≠

				// ÂÆö‰πâÁªìÊûúÊï∞ÁªÑ
				const chineseMixedArr = [];
				const numberMixedArr = [];
				const symbolMixedArr = [];
				let englishSingleArr = [];
				let englishMixedArr = [];
				const spaceArr = [];
				const otherSpaceArr = [];
				//const otherArr = [];

				// ÊèêÂèñ‰∏≠Êñá
				const chineseMatch = message.match(chineseReg);
				if (chineseMatch) {
					chineseMixedArr.push(...chineseMatch);
				}
	
				// ÊèêÂèñÊï∞Â≠ó
				const numberMatch = message.match(numberReg);
				if (numberMatch) {
					numberMatch.forEach(num => {
						if (num.length > 3) {
							// Ë∂ÖËøá3‰∏™Â≠óÁ¨¶ÁöÑÊï∞Â≠óÈúÄË¶ÅÊãÜÂàÜ
							for (let i = 0; i < num.length; i += 3) {
							  numberMixedArr.push(num.slice(i, i + 3));
							}
						} else {
							numberMixedArr.push(num);
						}
					});
				}

				// ÊèêÂèñÁâπÊÆäÁ¨¶Âè∑ *Á¨¶Âè∑ÂèäÂÖ∂‰ªñËØ≠Ë®ÄÊñáÂ≠ó
				const symbolMatch = message.match(symbolReg);
				if (symbolMatch) {
					symbolMixedArr.push(...symbolMatch);
				}

				// ÊèêÂèñËã±Êñá  
				const englishMatch = message.match(englishReg);
				if (englishMatch) {
					englishMixedArr.push(...englishMatch);
				}
	
				// ÊèêÂèñËã±ÊñáÔºàÂâçÈù¢ÊòØÁ©∫Ê†ºÁöÑËã±ÊñáÔºåÁî®‰∫éËÆ°ÁÆóÁ©∫Ê†ºÊâÄÂç†ÁöÑtokensÔºâ
				const englishMatch_Single = message.match(englishSingleReg);
				if (englishMatch_Single) {
					englishSingleArr.push(...englishMatch_Single);
				}
  
				// ÊèêÂèñÁ©∫Ê†º„ÄÅÂà∂Ë°®Á¨¶ÂíåÊç¢Ë°åÁ¨¶
				const spaceMatch = message.match(spaceReg);
				if (spaceMatch) {
					spaceArr.push(...spaceMatch);//ËøûÁª≠1‰∏™Êàñ‰ª•‰∏ä
				}
				// const spaceMatch = message.match(spaceReg);
				const otherSpaceMatch = message.match(otherSpaceReg);
				// if (spaceMatch) {
				// 	spaceArr.push(...spaceMatch.filter((match) => !otherSpaceReg.test(match))); 
				// }
				if (otherSpaceMatch) {
				 	otherSpaceArr.push(...otherSpaceMatch);//ËøûÁª≠2‰∏™Êàñ‰ª•‰∏ä
				}

				// ÊèêÂèñÂâ©‰ΩôÊú™ÂåπÈÖçÂà∞ÁöÑÂ≠óÁ¨¶ *Â∫îËØ•ÊòØ‰∏çÂ≠òÂú® =null
				//const otherMatch = message.replace(chineseReg, '').replace(englishReg, '').replace(numberReg, '').replace(symbolReg, '').replace(spaceReg, '');
				//if (otherMatch) {
				//	otherArr.push(...otherMatch);
				//}
				
				// È¢Ñ‰º∞"Ëã±ÊñáÁ≠âËØ≠Ë®Ä"ÁöÑtokens  *English, etc. languages.  *ÊµãËØïÂáÜÁ°ÆÂ∫¶Êó∂ÔºåÂØπÊØîÁöÑÊù°‰ª∂Ë¶ÅÁõ∏ÂêåÔºö‰∏çËÉΩÊúâÊ†áÁÇπÁ¨¶Âè∑ ‰∏çËÉΩÊç¢Ë°å ÂçïËØçÂè™ËÉΩÁî®1‰∏™Á©∫Ê†ºÈöîÂºÄ
				const english_tokens = englishMixedArr.length / 0.75 ;
				// È¢Ñ‰º∞"‰∏≠ÊñáÁ≠âËØ≠Ë®Ä"ÁöÑtokens  *Chinese, etc. languages.  *ÊØî‰æãÂèØ‰ª•ÂÅèÂ∞èÔºåËøôÊ†∑‰º∞ÁÆóÁöÑtokensÂ∞ÜÂÅèÂ§ßÔºåËÆ°ÁÆóÁöÑmax_tokensÂ∞ÜÂÅèÂ∞èÔºåËøôÊ†∑‰∏çÂÆπÊòìÂõ†‚Äúmax_tokensÂÅèÂ§ß‚ÄùËÄåÊä•Èîô„ÄÇ
				const chinese_tokens  = chineseMixedArr.length / 0.83 ;
				// È¢Ñ‰º∞‚ÄúÊï∞Â≠ó‚ÄùÁöÑtokens
				const numbers_tokens = numberMixedArr.length / 1;
				// È¢Ñ‰º∞‚ÄúÁ¨¶Âè∑ÂèäÂÖ∂‰ªñËØ≠Ë®ÄÊñáÂ≠ó‚ÄùÁöÑtokens  *Symbols and other languages
				const symbolMixed_tokens = symbolMixedArr.length / 1.3; //ËøôÈáåÊåâÁÖß1‰∏™Á¨¶Âè∑ÂØπÂ∫î0.77‰∏™tokenËÆ°ÁÆó„ÄÇËøôÈÉ®ÂàÜÂ∑ÆÂºÇÂèØËÉΩËæÉÂ§ß„ÄÇÊúâÂçï‰∏™Á¨¶Âè∑Â∞±Âç†Áî®2ÔΩû3‰∏™tokenÁöÑÊÉÖÂÜµÔºàsymbolMixedArr.length / 0.33 ÔΩû 0.5ÔºâÔºåÂ¶ÇÊûúÊï∞ÈáèÂ§öÔºå‰ºöÈùûÂ∏∏‰∏çÂáÜ„ÄÇ
				// È¢Ñ‰º∞‚ÄúÁ©∫Ê†º„ÄÅÂà∂Ë°®Á¨¶ÂíåÊç¢Ë°åÁ¨¶‚ÄùÁöÑtokens
				const _space = spaceArr.length - englishSingleArr.length < 0 ? 0 : spaceArr.length - englishSingleArr.length; //È¶ñÂÖàÊéíÈô§Ëã±ÊñáÂâçÁöÑÁ©∫Ê†ºÔºåÂÖ∂‰ªñËØ≠Ë®ÄÂ§™Â§öÔºåÊó†Ê≥ïÂà§Êñ≠„ÄÇÊØîÂ¶ÇÔºö‰øÑËØ≠ Ê≥ïËØ≠ Á≠âÔºå‰πüÂèØ‰ª•ÂêåËã±ÊñáÔºåËÆ°ÁÆóÊéíÂá∫„ÄÇ
				const _otherspace = otherSpaceArr.length / 2.5; //ËøûÁª≠2‰∏™‰ª•‰∏äÁöÑÁ©∫Ê†ºÔºåÂ¢ûÂä†0.4token„ÄÇ  *ËøûÁª≠2‰∏™‰ª•‰∏äÁöÑÁ©∫Ê†ºÔºåËøûÁùÄÈùûËã±ÊñáÂ≠óÊØçÊó∂ÔºåÈÄöÂ∏∏ÈÉΩ‰ºöÂ¢ûÂä†1‰∏™token„ÄÇËÅîÁ≥ª2‰∏™Êç¢Ë°å‰∏ÄËà¨‰∏çÂ¢ûÂä†„ÄÇ 
				const space_tokens = _space / 1.3 + _otherspace ; 
  
				let msgtokens = english_tokens + chinese_tokens + numbers_tokens + symbolMixed_tokens + space_tokens;
				
				msgtokens = msgtokens * 1.05; //Â¢ûÂä†5%  Increase by 5%. 
				return Math.ceil(msgtokens); //int. ËøîÂõûÈ¢Ñ‰º∞ÁöÑtokens ÔºåÂêë‰∏äÂèñÊï¥Êï∞„ÄÇ
			},
			// Êô∫ËÉΩmax_tokens / Smart max_tokens / Ëá™Âä®Ë∞ÉËäÇmax_tokens„ÄÇ  È¢Ñ‰º∞ÊúÄÂêé‰∏ÄÊù°‰ø°ÊÅØÁöÑtokensÔºåÊô∫ËÉΩË∞ÉËäÇÂèÇÊï∞„ÄÇÊòØÊàëËá™Â∑±ÊÉ≥ÁöÑ‰∏Ä‰∏™È¢Ñ‰º∞Á≠ñÁï•Ôºå‰∏çÂáÜÁöÑ„ÄÇÂ¶ÇÊûúÊÉ≥Ë¶ÅÁ≤æÂáÜÔºåËØ∑Áúã‰∏ãÈù¢ÁöÑÊñπÊ≥ïÔºö ÔºàÂ∫îËØ•ÊòØË¶ÅÂêéÂè∞‰ªÄ‰πàÁöÑÔºåÊàë‰∏ç‰ºöÔºå‰∏çÂ≠¶‰∫ÜÔºâ
			// Not precise. If you want to calculate tokens accurately, please refer to: 1)ÔºàGPT-3.5ÔºâÔºöhttps://gpt-tokenizer.dev   2) OpenAI (GPT-3, not GPT-3.5Ôºâhttps://platform.openai.com/tokenizer
			// ÁÆóÊ≥ï‰∏≠ÁöÑÊï∞Â≠óÈô§‰∫ÜÁâπÂà´ËØ¥ÊòéÁöÑÔºåÂÖ∂‰ªñÈÉΩÊòØÊàëËá™Â∑±ËÆæÂÆöÁöÑÂÄº„ÄÇ There are a lot of numbers in the algorithm, which do not have any special meaning, they are all values that I set up myself for the purpose of strategy.
			autoAdjustMaxTokens(sendMsg) {
			
				if (!this.openSmartMaxTokens){ 
					return;
				}
				if (this.isFixingMaxTokens_SmartMaxTokens){ //‚ÄúÊ≠£Âú®‰øÆÂ§çMaxTokens‚ÄùÁöÑÁä∂ÊÄÅÔºåÊú¨Ê¨°‰∏çËá™Âä®Ë∞ÉËäÇmax_tokens.
					return;
				}
				
				//Ëé∑ÂèñÂΩìÂâçÊ®°Âûã Ê®°ÂûãÊï∞ÊçÆ ‰øùÊä§Ê®°ÂûãÁöÑÂèÇÊï∞/Â±ûÊÄß  Get the current model's model data  - model's parameters/attributes.
				const model_data = this.gptModelList.find(model => model.modelname === this.apiGPTModel);
				this.isModelDataExist_In_gptModelList(model_data);
				
				//ÈáçÈóÆÊó∂(ÊàêÂäüËøáÁöÑ/ÂæóÂà∞ËøáÂõûÂ§çÂêéÁöÑÈáçÈóÆ) When retrying. (After receiving a reply from GPT)  *(4095 4096 4097 16384 16385  gpt-3.5 gpt-4 gpt3.5 gpt4)
				if( this.userMsgTokensForRetry != 0 ){
					this.apiMaxTokens = model_data.maxtokens - this.totaltokens; // Ê≠§Êó∂this.totaltokens‰∏∫Á≤æÂáÜÁöÑtotal tokensÔºàÂ¶ÇÊûúÊèêÁ§∫ËØçÊ≤°ÊúâÂèòÂä®/ÂèòÂåñ‰∏çÂ§ßÁöÑËØùÔºâ„ÄÇ this.totaltokens = ‰∏ä‰∏ãÊñá + Êú¨Ê¨°ÈáçÈóÆÁöÑ‰ø°ÊÅØ 
					//ËøôÈáåÂÖ∂ÂÆûÊ≤°ÂøÖË¶ÅÂáèÂéª‰∏Ä‰∏™ÂÄºÔºåtokensË∂≥Â§üÁöÑÊÉÖÂÜµ‰∏ãÔºåÂáè‰ΩéÁÇπ ‰ª•È¢ÑÈò≤‚ÄúÂõ†‰øÆÊîπÊèêÁ§∫ËØçËÄåÂØºËá¥Ë∂ÖÈ¢ù‚ÄùÁöÑÊÉÖÂÜµ
					if ( this.apiMaxTokens > 4097 ){ // 4096
						this.apiMaxTokens = this.apiMaxTokens - 600 ; 
					}else if ( this.apiMaxTokens > 3500 ){
						this.apiMaxTokens = this.apiMaxTokens - 350 ;
					}else if ( this.apiMaxTokens > 2600 ){
						this.apiMaxTokens = this.apiMaxTokens - 300 ;
					}else if ( this.apiMaxTokens > 1500 ){
						this.apiMaxTokens = this.apiMaxTokens - 200 ;
					}else if ( this.apiMaxTokens > 600 ){
						this.apiMaxTokens = this.apiMaxTokens - 100 ;
					}
					// ÂÖ∂‰ΩôÊÉÖÂÜµÔºö‰∏çÂ§ÑÁêÜÔºåÂèëÁîüÈîôËØØÂàôÊ†πÊçÆÊèêÁ§∫‰ø°ÊÅØÊâãÂä®Ë∞ÉÊï¥„ÄÇ
					return;
				}
				
				//‰ª•‰∏ãÔºöÈùûÈáçÈóÆÊó∂ & Â§±Ë¥•ÂêéÁöÑÈáçÈóÆ„ÄÇ The following code: Non-Retry operation && Retry operation performed after request failure.
				//:?: ÂçïÊù°ÂèëÈÄÅÈóÆÈ¢òÁöÑtokenÊï∞‰ºöÊØîÂÆûÈôÖÁöÑÈ´òÔºåÁñë‰ººÂÆòÊñπ‰ºöÊ∑ªÂä†ÈöêËóèÁöÑÊèêÁ§∫ËØç„ÄÇÁªèËøáÊµãËØïÔºå1„ÄÅÂΩìthis.msgContentÂåÖÂê´Á≥ªÁªüÊèêÁ§∫ËØçËøô‰∏ÄÈ°πÊó∂Ôºà[0]ÔºåÂç≥‰Ωø‰∏∫Á©∫ÔºâÔºåÈ¶ñÊù°‰ºöÈ¢ùÂ§ñÂç†Áî® 13 token Ôºõ 2„ÄÅ‰πãÂêéÊØèÊù°ÂèëÈÄÅÁöÑËÆØÊÅØÈ¢ùÂ§ñÂç†Áî® 10 token „ÄÇ
				//:?: The tokens for sending message are higher than the actual count, which is probably because OpenAI adds hidden prompt words. After testing, 1) when the "system prompt"  is included in the context of this.msgContent in the code (this.msgContent[0]), even if the system prompt is empty, the first message will have an extra 13 tokens; 2) each subsequent message will take up an additional 10 tokens.
				//Êà™Ê≠¢2023-06-10ÔºåOpenAIËßÑÂæãÊ≤°ÊúâÂèòÂåñ„ÄÇAs of June 10th, 2023, there have been no changes in the policies of OpenAI.
				const firstsendmsg_openai = 13;  // tipsÔºöthis.msgTokens[1]ËÆ∞ÂΩïÁöÑÊòØÔºàÊèêÁ§∫ËØç+È¶ñÊù°ÔºâÁöÑtokensÔºå‰∏îÂêéÁª≠‰øÆÊîπÊèêÁ§∫ËØçÂπ∂‰∏ç‰ºöÊõ¥Êñ∞ËøôÈáåÁöÑtokensÊï∞Èáè
				const sendmsg_openai = 10;
				
				
				// È¢Ñ‰º∞ÂΩìÂâçÊ∂àÊÅØÁöÑtokensÊï∞Èáè Estimate the tokens of the current message.
				let estimatedTokens = 0;
				try{
					estimatedTokens = this.MCGPTTokenizer(sendMsg);
				}catch (e) {
					estimatedTokens = Math.ceil(sendMsg.length * 0.75);
					const notif_cn = '\r\n\r\nSafari?(‰∏çÊéíÈô§ÊòØÊµèËßàÂô®ÂÖºÂÆπÊÄßÈóÆÈ¢ò) Âá∫Èîô‰∫Ü(this.MCGPTTokenizer - ‰º∞ÁÆótokensÊó∂Âá∫Èîô‰∫Ü)ÔºåÂèØËÉΩÊòØÂõ†‰∏∫ÊÇ®ÂèëÁöÑÂÜÖÂÆπÂ§™Â§™Â§™Â§ß‰∫ÜÔΩû\r\nËØ∑ÈÅøÂÖçÂèëÈÄÅÂ§ßÈáèÊñáÊú¨ÔºåÂª∫ËÆÆÊÇ®Êí§ÂõûÂàöÂàöÂèëÈÄÅÁöÑÂÜÖÂÆπ„ÄÇÂ§ßÈáèÊñáÊú¨‰ºöÂç†Áî®Êú¨Âú∞Â≠òÂÇ®Á©∫Èó¥ÔºåËÄåÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®ÈÄöÂ∏∏Âè™ÊîØÊåÅ5-10MBÁöÑÂÆπÈáè„ÄÇÂèëÈÄÅÂ§ßÈáèÊñáÊú¨ÂèØËÉΩ‰ºöÂØºËá¥Ëá™Âä®‰øùÂ≠ò‰∏çÊñ≠Â§±Ë¥•ËÄåÈ¢ëÁπÅÊä•Èîô„ÄÇ';
					const notif_en = '\r\n\r\nSafari?(It is possible that this is a browser compatibility issue.) Oops, an error occurred (this.MCGPTTokenizer - There seems to be an error in the token calculation), possibly because the content you provided is tooooo large!\r\nPlease avoid sending large amounts of text. It is recommended that you withdraw the content you just sent. Large amounts of text can occupy local storage space, and browser local storage usually supports a capacity of only 5-10MB. Sending large amounts of text may result in frequent errors due to continuous failure of automatic saving.';
					const notif = this.settingsLanguage == 'cn' ? notif_cn : notif_en;
					this.showNotification('Error Message: ' + e.message + notif, 'center','Error - this.MCGPTTokenizer');
				}
		//	console.log("ÂΩìÂâçÈ¢Ñ‰º∞ÁöÑtokens: " + estimatedTokens);
				if ( this.msgContent.length < 2 ){ //Â¶ÇÊûúÊòØÈ¶ñÊù°‰ø°ÊÅØ
					estimatedTokens = estimatedTokens + firstsendmsg_openai ;
					let sysprompt = this.msgContent[0]["content"] ;
					if ( sysprompt != '') { //Â¶ÇÊûúÂ≠òÂú®Á≥ªÁªüÊèêÁ§∫ËØç
						const syspromptTokens = this.MCGPTTokenizer(sysprompt); //È¢Ñ‰º∞Á≥ªÁªüÊèêÁ§∫ËØçÁöÑtokens
		//	console.log("Ê≠§‰∏∫È¶ñÊù°Ê∂àÊÅØÔºåÂä†‰∏äÁ≥ªÁªüÊèêÁ§∫ËØçÂêéÁöÑÈ¢Ñ‰º∞ÁöÑtokensÔºàÊú™Âä†‰∏ä13tokensÔºâ : " + syspromptTokens);
						estimatedTokens = estimatedTokens + syspromptTokens;
					}
				}else { //ÈùûÈ¶ñÊù°Ôºå‰∏çÈúÄË¶ÅËÆ°ÁÆóÁ≥ªÁªüÊèêÁ§∫ËØçÔºåÂõ†‰∏∫ÂÆÉÁöÑÁ≤æÂáÜtokensÊï∞Èáè‰ºöË¢´ÂåÖÂê´Âú®this.totaltokensÂΩì‰∏≠
					estimatedTokens = estimatedTokens + sendmsg_openai ;
				}
				
	 	//	console.log("ÂΩìÂâçÈ¢Ñ‰º∞ÁöÑtokensÔºàÂê´+13/+10ÔºõËã•ÊòØÈ¶ñÊù°Ê∂àÊÅØÔºåËøôÈáåËøòÂåÖÂê´‰∫ÜÊèêÁ§∫ËØçÁöÑtokensÔºâ: " + estimatedTokens);
	
				
				// (4095 4096 4097 16384 16385  gpt-3.5 gpt-4 gpt3.5 gpt4) Â¶ÇÊûúÂçáÁ∫ß‰∏∫GPT4 GPT-4Ê®°ÂûãÔºåËøôÈáåÁöÑ4096ÈúÄË¶Å‰øÆÊîπ  If upgraded to the GPT-4 model, the value of 4096 here needs to be modified. 
				// ËÆ°ÁÆóÈúÄË¶ÅËÆæÁΩÆÁöÑmax_tokens   
				// *MCGPTTokenizer‰∏≠ÔºåÈ¢Ñ‰º∞estimatedTokensÁöÑÁªìÊûú‰ºöÂÅèÂ§ßÁÇπÔºàÂ§öÊï∞Êó∂ÂÄôÔºâ
				let remainingTokens = model_data.maxtokens - this.totaltokens - estimatedTokens; //È¢Ñ‰º∞Ââ©‰ΩôÁöÑ ÂèØÁî®‰∫émax_tokensÁöÑÊï∞Èáè
		//	console.log("max_tokensÂàùÊ≠•ËÆæÂÆö‰∏∫: " + Math.ceil(remainingTokens));
				let n = 0 ;
				let larger_maxtokens_n = 0;
				let larger_maxtokens_i = 0;
				if ( model_data.maxtokens < 4100 && estimatedTokens < 500 ){ //4096
					n = 200 - (estimatedTokens * 150 / 500); //È¢Ñ‰º∞ÁöÑtokenË∂äÂ∞ë nÂ∞±Ë∂äÂ§ß ÂÖÅËÆ∏ËÆæÁΩÆmax_tokensÊõ¥È´ò‰∏ÄÁÇπÔºõ *Ê≤°Êúâ‰ªÄ‰πàÁâπÂà´Ôºå‰∏çËøô‰πàÂÅö‰πüÂèØ‰ª•
				}else if(model_data.maxtokens > 16300 && estimatedTokens < 500 ){
					larger_maxtokens_n = 200 - (estimatedTokens * 150 / 500);
				}
				
				if(model_data.maxtokens > 4100){ //16384
					larger_maxtokens_i = remainingTokens / 4096 * 400;
				}
				
				//v7.29 ÂõûÈ°æ/Â§áÂøòÔºö1 ‰∏ªË¶ÅÂü∫‰∫é‚ÄúÂ§öÊï∞ÊÉÖÂÜµ‰∏ãMCGPTTokenizerÁöÑÈ¢Ñ‰º∞ÂÄº‰ºöÂÅèÂ§ß‚ÄùÔºåÈªòËÆ§ÂèëÈÄÅÂÜÖÂÆπÁöÑtokenË∂äÂ§ßÔºåÈ¢ÑÁïôÁöÑËØØÂ∑ÆÈáè‰πüÂ∞±Ë∂äÂ§ß„ÄÇ 2 ‰ª•‰∏ã‰ª£Á†Å‰ªÖÊòØÂæÆË∞É  3 ‰ª•‰∏ãÊï∞ÂÄºÂùáÊ≤°ÊúâÁâπÊÆäÊÑè‰πâ 
				//  4 ÂΩìremainingTokensÊé•ËøëÊ®°ÂûãÁöÑmax_tokens‰∏äÈôêÊó∂ÔºåËØ¥ÊòéÊèêÈóÆÂÜÖÂÆπÁöÑtokenÂæàÂ∞èÔºåÊâÄ‰ª•‰ΩøÁî®nËøõ‰∏ÄÊ≠•ÂæÆË∞ÉÔºåË∞ÉÁöÑ‰∏çÂ§öÔºåÊÑè‰πâ‰πü‰∏çÂ§ß„ÄÇÂè¶Â§ñÔºåÊ≠§Êó∂Âç≥‰ΩøÊèêÈóÆÂè™Áî®‰∫Ü10Êù•‰∏™tokenÔºå‰πü‰ºöÁÆóÊàê200Êù•‰∏™token„ÄÇÂõ†‰∏∫gptÈÄöÂ∏∏‰∏ç‰ºöÂõûÂ§çËææÂà∞‚ÄúÊé•Ëøë4000tokenÔºà‰∏äÈôêÔºâ‚ÄùÊàñËÄÖ‚ÄúÊé•Ëøë165000tokenÔºà‰∏äÈôêÔºâ‚ÄùÁöÑÂÜÖÂÆπÈáèÔºåÊâÄ‰ª•ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂ§öËÆ°ÁÆó‰∫õËØØÂ∑ÆÂπ∂‰∏ç‰ºöÂΩ±Âìç‰ΩøÁî®‰ΩìÈ™å‰∏éÂõûÂ§çË¥®Èáè„ÄÇ
				// remainingTokens = Math.ceil(remainingTokens); //Âêë‰∏äÂèñÊï¥Êï∞
				if ( remainingTokens > 15800 && model_data.maxtokens > 16300 && model_data.maxtokens < 16400 ){ //Ê®°Á≥äÁöÑÊåáÂÆö16384ÔºåÂ¶ÇÊûúÊúâË∂ÖËøá16384ÁöÑÊñ∞Ê®°ÂûãÔºåÂ∫îËØ•Ë∑≥Ëá≥remainingTokens = remainingTokens - larger_maxtokens_i
					remainingTokens = remainingTokens - 400 + larger_maxtokens_n;
				}else if ( remainingTokens > 15000 && model_data.maxtokens > 16300 && model_data.maxtokens < 16400 ){ //Ê®°Á≥äÁöÑÊåáÂÆö16384
					remainingTokens = remainingTokens - 370 + larger_maxtokens_n;
				}else if ( remainingTokens > 4096 ){ // Ë∂ÖËøá 4096 ÁöÑÊ®°Âûã
					remainingTokens = remainingTokens - larger_maxtokens_i;
				}else if ( remainingTokens > 3500 ){
					remainingTokens = remainingTokens - 400 + n;
				}else if ( remainingTokens > 2500 ){
					remainingTokens = remainingTokens - 370 + n;
				}else if ( remainingTokens > 1500 ){
					remainingTokens = remainingTokens - 300 ;
				}else if ( remainingTokens > 1000 ){
					remainingTokens = remainingTokens - 250 ;
				}else if ( remainingTokens > 600 ){
					remainingTokens = remainingTokens - 200 ;
				}else if ( remainingTokens > 500 ){
					remainingTokens = remainingTokens - 100 ;
				}else if ( remainingTokens > 300 ){
					remainingTokens = remainingTokens - 80 ;
				}else if ( remainingTokens > 100 ){
					remainingTokens = remainingTokens - 35 ;
				}else if ( remainingTokens > 25 ){
					remainingTokens = remainingTokens - 10;
				}else if ( remainingTokens > 0 ){
					remainingTokens = (remainingTokens - 3) > 0 ? (remainingTokens - 3) : remainingTokens ;
				}else { // <= 0
					//"Smart max_tokens"È©±Âä®ÁöÑËá™Âä®ÈáçÈóÆÂäüËÉΩÔºåËÆ°ÁÆóÈîôËØØ > Âõ†‰∏∫max_tokensËÆæÁΩÆËøáÈ´òËÄåÂØºËá¥Êä•Èîô > ‰ªéÊä•Èîô‰ø°ÊÅØ‰∏≠Ëé∑ÂæóÁ≤æÂáÜÁöÑtokensÔºàmsgÔºâ > Á≤æÂáÜËÆæÁΩÆmax_tokens > Ëá™Âä®ÈáçÈóÆ 
					// (4095 4096 4097 16384 16385  gpt-3.5 gpt-4 gpt3.5 gpt4)
					// v7.29 ‰∏∫‰∫ÜÈÄÇÈÖç16kÁöÑÊ®°Âûã + Êúâ‰∫ÜËΩÆËØ¢/ËΩÆÊç¢keyÂäüËÉΩÂêéÂèØ‰ª•Êó†ÊÉß"429ÈîôËØØ"„ÄÇ *ÂèëÈÄÅÁöÑÂçïÊù°ÂÜÖÂÆπË∂äÂ§ßÔºåÈ¢Ñ‰º∞ÁöÑËØØÂ∑Æ‰πü‰ºöÂ¢ûÂ§ß 
					// ÊØî‰æãÔºö600 => 100 ÔºåË¶Å‰πà‰øùËØÅGPTÁöÑÂõûÂ§çÁ©∫Èó¥(‰øùËØÅÂõûÂ§çË¥®Èáè)ÔºåË¶Å‰πàÂ∞±ÊïÖÊÑèÊä•ÈîôÊøÄÊ¥ªËá™Âä®ÈáçÈóÆÂäüËÉΩ„ÄÇ *Âª∫ËÆÆÂÖçË¥πËÆ°ÂàíË¶Å‰ΩøÁî®2‰∏™Ë¥¶Âè∑ÁöÑKeyÊù•ËΩÆËØ¢„ÄÇ
					let temp_x = estimatedTokens / 6;
					
					//ÈÄöËøá‚ÄúÂèØÁî®Key‚ÄùÁöÑÊï∞ÈáèË∞ÉÊï¥ÊØî‰æãÔºåÊõ¥Âä†ÊøÄËøõÔºåÂá∫ÈîôÁöÑÊ¶ÇÁéá‰πüÊèêÈ´òÔºåÁõÆÁöÑÊòØÊøÄÊ¥ªËá™Âä®ÈáçÈóÆ/Ëá™Âä®‰øÆÂ§ç
					const good_key_count = this.apiCheckedData.filter(apidata => [0, 1, 2, 3].includes(apidata.level)).length;
					if (good_key_count >= 3 || this.apiCheckedData.some(apikeydata => apikeydata.level === 0)) {
						temp_x = estimatedTokens / 4;
					} else if (good_key_count >= 2){
						temp_x = estimatedTokens / 5.3;
					}
					
					remainingTokens = temp_x >= 50 ? temp_x : 50;
				}
		//	console.log("max_tokensÊúÄÁªàËÆæ‰∏∫(ÂæÆË∞ÉÔºåÂáèÂ∞èÔºåÈôç‰ΩéÈîôËØØÂèëÁîüÁéá) : " + Math.ceil(remainingTokens));
				this.apiMaxTokens = Math.ceil(remainingTokens);
			},
			
			// ËÆæÁΩÆÁ™óÂè£ - ‰øùÂ≠òÊé•Âè£ÁΩëÂùÄ API URL
			saveApiURL() {
				if (this.checkBusyStatus()) {
					// Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ
					return;
				} 

				let notif = '' ;
	
				//‰∏çÂ°´ÂÜô/‰øùÁïôÁ©∫ÁôΩÔºåÂ∞ÜÊÅ¢Â§çÈªòËÆ§ÁöÑÂÆòÊñπÊé•Âè£
				if (this.inputApiURL.trim() == '') {
  
					this.inputApiURL = this.OpenAI_API_URL;
					this.apiURL = this.inputApiURL;
	 
					//ÈúÄË¶ÅÂÅö‰∫õÂ§ÑÁêÜ ÊîπÂèòÂΩìÂâçÁä∂ÊÄÅ ÈúÄË¶ÅÈáçÊñ∞È™åËØÅ„ÄÇ
					this.selectedApiURL = this.inputApiURL; //1 ‰∏ãÊãâÊ°ÜÊòæÁ§∫‰∏∫‚ÄúÂÆòÊñπ‚Äù/‚ÄúGPT‚Äù
					this.btnDisabledState_SaveApiURL = true; //2 ‰øùÂ≠òÊåâÈíÆÂèò‰∏∫‰∏çÂèØÁî®
					////v7.10 ÈÄªËæëÊõ¥ÊîπÔºå‰∏çÂÜçÁªëÂÆöAPI URL‰∏éAPI KeyÔºåÂì™ÊÄïAPI URLÊó†ÊïàÔºå‰πü‰∏çÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
					////v7.10 delete... this.inputapichange(true); // 3 ÈáçÊñ∞È™åËØÅAPI KeyÊó∂ ÊîπÂèòÊåâÈíÆÁ≠âÁä∂ÊÄÅ
					this.check_KeyMode_byURL_ChangeKey(); // 4 Â¶ÇÊûúÊòØÁ¨¨‰∏âÊñπKeyÊ®°ÂºèÔºåÂàáÊç¢OpenAI APIÂêéÔºåÊîπÂõûOpenAI KeyËΩÆÊç¢Ê®°Âºè + ÊåâÈíÆÁä∂ÊÄÅ + Ëá™Âä®ÊÅ¢Â§çÂèØÁî®ÁöÑOpenAI Key
					notif = this.settingsLanguage == 'cn' ? 'Â∑≤ÈáçÁΩÆ‰∏∫OpenAIÂÆòÊñπÊé•Âè£' : 'API URL (endpoint) has been restored to the OpenAI link.' ;
					const time = this.settingsLanguage == 'cn' ? 2500 : 3800 ; 
					this.showNotification(notif, 'bottom','',time);
				}else{

					let isExists = false; //ÊòØÂê¶Â∑≤Áü•ÁöÑAPI URL
					try{
						isExists = this.apiURLOptions_cn.some(option => option.url.trim() === this.inputApiURL.toLowerCase().trim()) || 
							this.apiURLOptions_en.some(option => option.url.trim() === this.inputApiURL.toLowerCase().trim()) ||
							this.apiURLOptions_LoadThirdPartyPaidAPIs.some(option => option.url.trim() === this.inputApiURL.toLowerCase().trim());
					}catch (e) {
						isExists = false;
					}
					
					if( !isExists ){ // Êú™Áü•ÁöÑÊÉÖÂÜµÔºåÈúÄË¶ÅÈ™åËØÅ
						// 1. È™åËØÅÁΩëÂùÄ ÂºÄÂ§¥Âè™ÂÖÅËÆ∏http:// Âíå https:// ‰∏§Áßç„ÄÇ 
						const urlRegex = /^(https?|http):\/\/[^\s/$.?#]+\.[^\s]*$/;
						if (!urlRegex.test(this.inputApiURL.toLowerCase().trim())) {
							notif = this.settingsLanguage == 'cn' ? 'ÁΩëÂùÄÊ†ºÂºèÈîôËØØÔºåËØ∑ËæìÂÖ•‰ª• https:// Êàñ http:// ÂºÄÂ§¥ÁöÑÂÆåÊï¥ÁöÑÊé•Âè£ÁΩëÂùÄÂêéÈáçÊñ∞‰øùÂ≠ò' : 'URL format is incorrect. Please enter a complete API URL starting with https:// or http:// and save again.' ;
							const time = this.settingsLanguage == 'cn' ? 4000 : 5500 ; 
							this.showNotification(notif, 'bottom','',3800);
							return;
						}

						// 2. È™åËØÅthis.inputApiURLËøô‰∏™ÁΩëÂùÄÊòØÂê¶‰ª•/v1/chat/completionsÁªìÂ∞æÔºåÂ¶ÇÊûú‰∏çÊòØÔºåÂàôÂºπÁ™óÁî±Áî®Êà∑Á°ÆËÆ§ÊòØÁªßÁª≠ËøòÊòØËøîÂõû
						if (!this.inputApiURL.toLowerCase().trim().endsWith('/v1/chat/completions')) {
							const msg = '\r\n\r\n';
							const notif_cn = 'GPT-3.5„ÄÅGPT-4 ËÅäÂ§©Êé•Âè£ÁΩëÂùÄÁöÑÊ†áÂáÜÊ†ºÂºèÂ∫î‰ª• "/v1/chat/completions" ÁªìÂ∞æÔºåÂ¶ÇÂÆòÊñπÊé•Âè£ "https://api.openai.com/v1/chat/completions"„ÄÇ\r\n\r\n‰ΩÜ‰∏çÊéíÈô§Ê≠§Êé•Âè£ÊòØÂèØÁî®ÁöÑÔºåËØ∑Á°ÆËÆ§ÊòØÂê¶ÁªßÁª≠‰øùÂ≠òÔºü' ;
							const notif_en = 'The standard format for the GPT-3.5 and GPT-4 chat API URL should end with "/v1/chat/completions", such as the OpenAI API "https://api.openai.com/v1/chat/completions".\r\n\r\nHowever, it is not ruled out that the current API URL is usable. Please confirm if you want to continue saving?';
							notif = this.settingsLanguage == 'cn' ? notif_cn : notif_en ;
							if (!confirm(notif)) {
								return;
							}
						}
					}

					// 3. ‰øùÂ≠ò
					this.apiURL = this.inputApiURL.trim();
	  
					// 4. ÈúÄË¶ÅÂÅö‰∫õÂ§ÑÁêÜ ÊîπÂèòÂΩìÂâçÁä∂ÊÄÅ ÈúÄË¶ÅÈáçÊñ∞È™åËØÅ
					this.btnDisabledState_SaveApiURL = true; //1 ‰øùÂ≠òÊåâÈíÆÂèò‰∏∫‰∏çÂèØÁî®
					////v7.10 ÈÄªËæëÊõ¥ÊîπÔºå‰∏çÂÜçÁªëÂÆöAPI URL‰∏éAPI KeyÔºåÂì™ÊÄïAPI URLÊó†ÊïàÔºå‰πü‰∏çÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
					////v7.10 delete... this.inputapichange(true); // 2 ÈáçÊñ∞È™åËØÅAPI KeyÊó∂ ÊîπÂèòÊåâÈíÆÁ≠âÁä∂ÊÄÅ
					
					const keymode_old = this.isThirdPartyAPIKeyEnabled;
					const keymode_now = this.check_KeyMode_byURL();
					if( keymode_old && !keymode_now ){
					// 3 ‰ªéÁ¨¨‰∏âÊñπKeyÊ®°ÂºèÔºåÂàáÊç¢‰∏∫OpenAI APIÂêéÔºåÊîπÂõûOpenAI KeyËΩÆÊç¢Ê®°Âºè(‰∏äÈù¢this.check_KeyMode_byURLÁöÑ‰ª£Á†Å)
						this.check_KeyMode_byURL_ChangeKey(keymode_old, keymode_now);//ÊåáÂÆö{‰ªé"Á¨¨‰∏âÊñπKeyÊ®°Âºè"ÂàáÊç¢‰∏∫"OpenAI KeyÊ®°Âºè"ÁöÑÊÉÖÂΩ¢}
					}	
	  
					// 5. ÈÄöÁü•
					notif = this.settingsLanguage == 'cn' ? '‰øùÂ≠òÊàêÂäü' : 'Save successful' ;
					this.showNotification(notif, 'bottom');
					
					// 6.  *‰∏çÂèØ‰ΩøÁî®check_KeyMode_byURL_ChangeKey‰ª£Êõø{6},‰ª£Á†ÅÊúâÂèòÂä®
					if(this.isThirdPartyAPIKeyEnabled){ //Á¨¨‰∏âÊñπÂçïKeyÊ®°Âºè Third-party Key mode *Êó†ËÆ∫‰πãÂâçÊòØÂì™ÁßçÊ®°ÂºèÔºåÂè™Ë¶ÅÂΩìÂâçÊòØÁ¨¨‰∏âÊñπKeyÊ®°ÂºèÔºåÂ∞±ÊâßË°å‰ª£Á†Å
						let delaytime = 0;
						const temp_apidataArray = this.apiCheckedData.filter(apidata => apidata.vpn === 'third-party' && apidata.apiurl.toLowerCase() === this.apiURL.toLowerCase());
						if(temp_apidataArray.length < 1){ //‰∏çÂ≠òÂú®ÂåπÈÖçÂΩìÂâçÊé•Âè£ÁöÑÁ¨¨‰∏âÊñπKey
							delaytime = 1000;
							if( this.btnDisabledState_CheckAPI ){ //ÈùûÁºñËæëÁä∂ÊÄÅÔºå‰∏çÂèØÁî®ÁöÑÁä∂ÊÄÅ
								this.api = '';//
								this.changeButtonDisabledState(true);//ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
							}
						}
						setTimeout(() => {
							this.restoreApiKeyInput(false, false); //ÊÅ¢Â§çÂèØÁî®ÁöÑÁ¨¨‰∏âÊñπKey
						}, delaytime); //Â≠òÂú®ÂåπÈÖçÁöÑKeyÊó∂ÔºåÁ´ãÂç≥ÊâßË°å/ÊÅ¢Â§ç„ÄÇ ‰∏çÂ≠òÂú®ÂåπÈÖçÁöÑKeyÊó∂ÔºåÂª∂Ëøü1ÁßíÂºπÂá∫Á™óÂè£ÔºåÊâãÂä®ÈÄâKey
					}
				}
			},
			
			// ËÆæÁΩÆÁ™óÂè£ - 
			loadThirdPartyPaidAPIs(){
				this.isLoadThirdPartyPaidAPIs = !this.isLoadThirdPartyPaidAPIs;
				
				let isExist = false;
				if(this.settingsLanguage === 'cn'){
					isExist = this.apiURLOptions_cn.some(item => item.url === this.inputApiURL.toLowerCase());
					if( !isExist && this.isLoadThirdPartyPaidAPIs){
						isExist = this.apiURLOptions_LoadThirdPartyPaidAPIs.some(item => item.url === this.inputApiURL.toLowerCase());
					}
				}else{
					isExist = this.apiURLOptions_en.some(item => item.url === this.inputApiURL.toLowerCase());
				}
				if(isExist){
					this.selectedApiURL = this.inputApiURL.toLowerCase();
				}else{
					this.selectedApiURL = "";
				}
				
				let notif;
				notif = this.settingsLanguage == 'cn' ? (this.isLoadThirdPartyPaidAPIs ? 'Â∑≤ÊòæÁ§∫Á¨¨‰∏âÊñπ‰ª£ÁêÜÂπ≥Âè∞ (Âú®Âè≥‰æßÈ¢ÑËÆæÈÄâÈ°π‰∏≠)' : 'Â∑≤ÈöêËóèÁ¨¨‰∏âÊñπ‰ª£ÁêÜÂπ≥Âè∞ (Âè≥‰æßÈ¢ÑËÆæÈÄâÈ°π)') : (this.isLoadThirdPartyPaidAPIs ? 'Third-party API displayed (in the pre-set option on the right)' : 'Third-party API hidden (pre-set option on the right)') ;
				this.showNotification(notif, 'bottom','',2900);
			}, 
			
			// ËÆæÁΩÆÁ™óÂè£ - API URL‰∏ãÊãâÊ°Ü  Êõ¥Êñ∞
			updateInputApiURL(){
				this.inputApiURL = this.selectedApiURL;
				this.saveApiURL(); //‰øùÂ≠òÊìç‰Ωú
			}, 
			// ËÆæÁΩÆÁ™óÂè£ - API URLËæìÂÖ•Ê°Ü Êõ¥Êñ∞
			inputApiURLChange(){
				this.selectedApiURL = ''; //ÈáçÁΩÆ‰∏ãÊãâÊ°Ü‰∏∫Á©∫ÔºåÊòæÁ§∫‰∏ãÊãâÁÆ≠Â§¥
				this.btnDisabledState_SaveApiURL = false; //‰øùÂ≠òÊåâÈíÆÂèò‰∏∫ÂèØÁî®
			}, 
		
			
			//ÂΩìÂâçÁä∂ÊÄÅ‰∏∫"ÂèëÈÄÅ‰∏≠"Êàñ"È™åËØÅkey‰∏≠"Êó∂ÔºåÈúÄË¶ÅÁ¶ÅÊ≠¢‰∏Ä‰∫õÊìç‰Ωú Some operations should be prohibited when the current state is "sending" or "checking api key."
			checkBusyStatus(mode) {
				let tip = '';
				if( this.isSendingNow || this.isSendingNow_ForSmartMaxTokens ){
					tip = this.settingsLanguage == 'cn' ? 'Ê≠£Âú®ÂèëÈÄÅÊ∂àÊÅØÔºåËØ∑Á≠âÂèëÈÄÅÁªìÊùüÂêéÂÜçÁªßÁª≠Êìç‰Ωú' : 'Sending message, please wait until finished before continuing.'  ;
					this.showNotification(tip, 'bottom','',2900);
					return true;
				}
				if( this.isCheckingApiKeyNow){
					tip = this.settingsLanguage == 'cn' ? 'Ê≠£Âú®È™åËØÅ API KeyÔºåËØ∑Á≠âÈ™åËØÅÁªìÊùüÂêéÂÜçÁªßÁª≠Êìç‰Ωú' : 'Verifying API Key, please wait until finished before continuing.'  ;
					this.showNotification(tip, 'bottom','',2900);
					return true;
				}
				if (mode === 'ForChat' && this.localStorageEvent_chatDataList_update_start ){
					tip = this.settingsLanguage == 'cn' ? 'Ê≠£Âú®Ê†áÁ≠æÈ°µ‰πãÈó¥ÂêåÊ≠•Êï∞ÊçÆÔºåËØ∑1ÔΩû2ÁßíÂêéÂÜçÁªßÁª≠Êìç‰Ωú' : 'Synchronizing data between tabs, please wait 1 to 2 seconds before continuing.'  ;
					this.showNotification(tip, 'bottom','',3900);
					return true;
				}
				return false;
			},
			
			// ËÆæÁΩÆÁ™óÂè£ - Â§¥ÂÉè URLËæìÂÖ•Ê°Ü
			inputImageUrlChange(role) {
				if(role == 'user'){
					this.btnDisabledState_updateUserImageUrl = false;
				}else{
					this.btnDisabledState_updateGPTImageUrl = false;
				}
			},
			// ËÆæÁΩÆÁ™óÂè£ - Â§¥ÂÉè‰∏ãÊãâÊ°Ü
			updateSelectedImage(role) {
				let imageurl = this.selectedImageUrl;
				this.selectedImageUrl = ''; //Â§çÂéü
 
 				//if (!imageurl.trim().startsWith('http://') && !imageurl.trim().startsWith('https://') && !imageurl.trim().startsWith('file:///')) 
				//ÂèëÁé∞‰ª•‰∏ä‰ª£Á†ÅÊ≤°ÊúâÊéíÈô§Áõ∏ÂØπË∑ØÂæÑÔºåÂΩìÂ≠òÂú®Áõ∏ÂØπË∑ØÂæÑÂ§¥ÂÉèÊó∂Ôºå‰ºö‰∫ßÁîüÊó†Ê≥ïÂàáÊç¢Â§¥ÂÉèÁöÑÂ∞èbug„ÄÇ ÁõÆÂâçSVGÂ§¥ÂÉèÂè™Êúâ‰∏ÄÁßçÔºå‰πüÊ≤°ÂøÖË¶ÅÂà§Êñ≠„ÄÇ
				
				//ÂΩìÈÄâÊã©ÁöÑÊòØGPTÁöÑÁªøËâ≤SVGÂõæÂÉèÊó∂
				if( imageurl == 'https://kimi.xinu.ink/gpt.jpg' ){
					if(role == 'gpt'){ 
						this.inputGPTImageUrl = this.settingsLanguage == 'cn' ? this.GPTGreenSVG_UrlText_cn : this.GPTGreenSVG_UrlText_en;
					}
				}else if ( imageurl == 'uploadimage' ) {
					//‰∏ä‰º†ÂõæÁâá ‰∏ä‰º†Â§¥ÂÉè upload image
					this.openFileDialog_Avatar(role);
					return;
				}else {
				 	if(role == 'user'){
						this.inputUserImageUrl = imageurl;
					}else {
						this.inputGPTImageUrl = imageurl;
					}
				}
				this.updateAvatar(role);//‰øùÂ≠ò Êõ¥Êñ∞ save update
			},		
			// ËÆæÁΩÆÁ™óÂè£ - Êõ¥Êñ∞Â§¥ÂÉè  shownotifÔºöÊòØÂê¶ÂÖÅËÆ∏ÈÄöÁü•ÔºàÂΩìËØªÂèñÁºìÂ≠òÊó∂Ôºå‰∏çÈúÄË¶ÅÈÄöÁü•Ôºâ
			updateAvatar(role, shownotif) {
				let imageUrl = '';
				let notif = '';
				let isShowNotif = shownotif === false ? shownotif : true ;
				
				if(role == 'user'){
					imageUrl = this.inputUserImageUrl.trim();
				}else {
					imageUrl = this.inputGPTImageUrl.trim();
				} 
	
				if(imageUrl == ''){
					notif = this.settingsLanguage == 'cn' ? 'ÂõæÁâáÁöÑÁΩëÂùÄ‰∏∫Á©∫' : 'Image URL is empty' ;
					if (isShowNotif){
						this.showNotification(notif, 'bottom');
					}
					return;
				}
	
				//Â¶ÇÊûúÊòØGPTÁªøËâ≤ÁöÑSVGÂ§¥ÂÉè„ÄÇÊâãÂä®Êõ¥Êñ∞
				if ( role != 'user' && (imageUrl == this.GPTGreenSVG_UrlText_cn || imageUrl == this.GPTGreenSVG_UrlText_en) ) {
					this.gptAvatarURL = "" ; //imgUrlÊ∏ÖÁ©∫
				  	this.isgptGreenSvgShow = true; //ÊòæÁ§∫<svg> Âπ∂ÈöêËóè<img>
					this.btnDisabledState_updateGPTImageUrl = true;
					
					notif = this.settingsLanguage == 'cn' ? 'Â∑≤Êõ¥Êç¢Â§¥ÂÉè' : 'Avatar has been updated' ;
					if (isShowNotif){
						this.showNotification(notif, 'bottom');
					}
					return;
				}

				const img = new Image();
				notif = this.settingsLanguage == 'cn' ? 'Êõ¥Êç¢‰∏≠...' : 'Updating...' ;
				if (isShowNotif){
					this.showNotification(notif, 'bottom','',2900);
				}
				
				
				img.onload = () => {
					// ÂõæÁâáÂä†ËΩΩÊàêÂäüÔºåÊõ¥Êñ∞Â§¥ÂÉè
					if(role == 'user'){
						this.userAvatarURL = this.inputUserImageUrl; 
						this.btnDisabledState_updateUserImageUrl = true; 
					}else {
						this.gptAvatarURL = this.inputGPTImageUrl;
						this.isgptGreenSvgShow = false; //ÈöêËóè<svg> Âπ∂ÊòæÁ§∫<img>
						this.btnDisabledState_updateGPTImageUrl = true;
					}
					notif = this.settingsLanguage == 'cn' ? 'Â∑≤Êõ¥Êç¢Â§¥ÂÉè' : 'Avatar has been updated' ;

					if (isShowNotif){
						//ÂøÖÈ°ªÂª∂ËøüÔºåÂê¶ÂàôÂΩìurl‰∏çÂèòÊó∂ÔºåÁû¨Èó¥ÊøÄÊ¥ªonload‰∫ã‰ª∂ÔºåÊ≠§Êó∂ÈÉ®ÂàÜÊâãÊú∫‰∏ä‰ºöÂá∫Áé∞Â∫ïÈÉ®ÈÄöÁü•Ê∂àÊÅØ‰ºöÂá∫Áé∞Ê®™Áßª/Èó™Ë∑≥ÁöÑÊÉÖÂÜµ„ÄÇ
						setTimeout(() => {
							this.showNotification(notif, 'bottom');
						}, 1250);
					}
				};
  
				img.onerror = () => {
					if(role == 'user'){
						this.btnDisabledState_updateUserImageUrl = false; 
					}else {
						this.btnDisabledState_updateGPTImageUrl = false;
					}
					// ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•ÔºåÊèêÁ§∫Áî®Êà∑
					let message  = this.settingsLanguage == 'cn' ? 'Êó†Ê≥ï‰ΩøÁî®ËØ•ÂõæÁâá‰Ωú‰∏∫Â§¥ÂÉèÔºåËØ∑ÈÄâÊã©ÂÖ∂‰ªñÂõæÁâá' : 'Unable to use this image as an avatar. Please select another image.';
				
					if (isShowNotif){
						//Ê∏ÖÈô§ÂÆöÊó∂Âô® ÁÑ∂ÂêéÊâãÂä®ÊèêÂâçÈöêËóèÈÄöÁü•
						clearTimeout(this.notificationTimeoutId);
						setTimeout(() => {
							this.isShowNotification = false;
							this.notificationTimeoutId = -1;
						}, 600); // Âª∂ËøüÔºåÂÖàÁ°Æ‰øùÁ¨¨‰∏Ä‰∏™ÈÄöÁü•È°∫Âà©ÁöÑÂºπÂá∫ÔºåÁÑ∂ÂêéÂÜçÊéßÂà∂ÊâãÂä®ÂÖ≥Èó≠ÈÄöÁü•„ÄÇ ‰∏çÂª∂ËøüÁöÑËØùÔºåÊ≠§Êó∂this.isShowNotificationËøòÂèØËÉΩ‰∏∫falseÔºàÂ∞öÊú™ÂºπÂá∫Ôºâ„ÄÇ
					
						//Âª∂Ëøü0.8ÁßíÔºåÁõÆÁöÑÔºöÊéßÂà∂È°∫Â∫èÔºåÂÖàÁ°Æ‰øùÁ¨¨‰∏Ä‰∏™ÈÄöÁü•È°∫Âà©ÁöÑÂºπÂá∫ÔºåÁÑ∂ÂêéÂÆöÊó∂ÊâãÂä®ÈöêËóèÈÄöÁü•ÔºåÊúÄÂêéÂÜçÂºπÁ™óË≠¶Âëä„ÄÇ
						setTimeout(() => {
							alert(message);
						}, 800);
					}else {
						if ( !(role == 'user' && this.userAvatarURL === 'https://kimi.xinu.ink/top.JPG') ){ //Âú®ÂõΩÂÜÖÔºåÊú™ÊâìÂºÄV. P_NÔºåÈªòËÆ§ÁöÑ"biliÂ§¥ÂÉè"Â§ßÊ¶ÇÁéá‰ºöÂä†ËΩΩÂ§±Ë¥•ÔºåÊâÄ‰ª•ÊéíÈô§
							// ÊÅ¢Â§çÊú¨Âú∞Â≠òÂÇ®ÁöÑÂ§¥ÂÉèÔºàÁΩëÂùÄ„ÄÅË∑ØÂæÑ„ÄÅ‰∏ä‰º†ÁöÑÂ§¥ÂÉèÔºâÔºåÈÅáÂà∞ÈîôËØØÊó∂
							const rolestr = this.settingsLanguage == 'cn' ? (role == 'user' ? '[Áî®Êà∑Â§¥ÂÉè]' : '[GPTÂ§¥ÂÉè]') : (role == 'user' ? '[User Avatar]' : '[GPT Avatar]');
							notif = this.settingsLanguage == 'cn' ?  rolestr + ' Êú™ËÉΩÂä†ËΩΩ' : rolestr + ' failed to load' ;
							const delaytime = this.isShowNotification ? 5000 : 200;
							setTimeout(() => {
								this.showNotification(notif, 'bottom', '', 2000);
							}, delaytime);
						}
					}
				};
  
				img.src = imageUrl;
			},
			
			//Ê∑ªÂä†‰∏ä‰º†Â§¥ÂÉèÁöÑinputÊéß‰ª∂ÔºàÂà†Èô§ > Ê∑ªÂä† > Âä†‰∫ã‰ª∂Ôºâ
			addInput_FileDialog_Avatar(role) {
				const isInputExit = role == 'user' ? document.getElementById('inputFileAvatar-user') : document.getElementById('inputFileAvatar-gpt'); 
				const dialogSettings = document.getElementById("dialog-settings");
				const div_userAvataror = document.getElementById("div-upload-userAvataror");
				const div_gptAvataror = document.getElementById("div-upload-gptAvataror");
				const div_gptAvataror_SVG = document.getElementById("div-upload-gptAvataror-SVG");
				
				//Âà†Èô§
				if (isInputExit){ //inputÂ∑≤Â≠òÂú®„ÄÇÁõÆÂâçÁöÑÈÄªËæëÔºåÂ∫îËØ•ÊØèÊ¨°ÈÉΩÂ∫îËØ•Ë¶ÅÂ≠òÂú®
					if(role == 'user'){
						div_userAvataror.onclick = null; // ÁßªÈô§‰πãÂâçÁöÑÁÇπÂáª‰∫ã‰ª∂
					}else {
						div_gptAvataror.onclick = null; // ÁßªÈô§‰πãÂâçÁöÑÁÇπÂáª‰∫ã‰ª∂
						div_gptAvataror_SVG.onclick = null; // ÁßªÈô§‰πãÂâçÁöÑÁÇπÂáª‰∫ã‰ª∂
					}
					isInputExit.onchange = null;
					dialogSettings.removeChild(isInputExit);//ÊØèÊ¨°ÈÉΩÁßªÈô§
				}
				
				//Ê∑ªÂä†
				const input = document.createElement('input'); 
				input.type = 'file';
				input.accept = 'image/*';
				input.style.display = 'none'; //ÈöêËóèÁöÑÔºåÂè™ÊúâÈÄöËøá‰∏ãÊãâÊ°ÜÈÄâÈ°πÊàñÁÇπÂáªËÆæÁΩÆ‰∏≠ÁöÑÂ§¥ÂÉèÊâçËÉΩÊâìÂºÄÈÄâÊã©ÂõæÁâáÁöÑÂØπËØùÊ°Ü„ÄÇ
				//input.style.zIndex = 999999; //Ë∞ÉËØïÁöÑÊó∂ÂÄôÈúÄË¶Å
				input.id = role == 'user' ? 'inputFileAvatar-user' : 'inputFileAvatar-gpt';
				
				dialogSettings.appendChild(input);
				
				//DIV‰∫ã‰ª∂
				if(role == 'user'){
					div_userAvataror.onclick = () => input.click();  // ‰øÆÊîπdivÁöÑÁÇπÂáª‰∫ã‰ª∂
				}else {
					div_gptAvataror.onclick = () => input.click(); // ‰øÆÊîπdivÁöÑÁÇπÂáª‰∫ã‰ª∂ 
					div_gptAvataror_SVG.onclick = () => input.click(); // ‰øÆÊîπdivÁöÑÁÇπÂáª‰∫ã‰ª∂ 
				}
				
				
				//‰∫ã‰ª∂ onchange
				input.onchange = (event) => {
					let notif = '';
					let notiftype = 'bottom';
 					if ( !event.target || !event.target.files || event.target.files.length == 0) {
						return;
					}

					const file = event.target.files[0]; //blob
					const filesize = file.size / 1024 ;
					const url = URL.createObjectURL(file); //blob url
					if(role == 'user'){
						//Âà§Êñ≠ÂõæÁâáÂ§ßÂ∞è„ÄÇ Ëã•Â§ß‰∫é350kÔºåÊèêÈÜí‰∏çÂ≠òÂà∞ÊµèËßàÂô®ÁºìÂ≠òÔºåÂà∑Êñ∞ÂêéÂ§¥ÂÉèÂ∞ÜË¢´Ê∏ÖÈô§
						if (filesize > 350) {
							// ÂõæÁâáÂ§ßÂ∞èË∂ÖËøá‰∫Ü350k
							const notif_cn = '‰∏ä‰º†ÁöÑÂõæÁâáÂ§ßÂ∞èË∂ÖËøá‰∫Ü 350KB (0.35MB)ÔºåÂõ†Ê≠§Êó†Ê≥ï‰øùÂ≠òÂà∞ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ® (localStorage) ‰∏≠„ÄÇËøô‰∏ç‰ºöÂΩ±Âìç‰ΩøÁî®ÔºåÂè™ÊòØÂú®Âà∑Êñ∞ÊàñÈáçÊñ∞ÊâìÂºÄÁΩëÈ°µÂêéÔºå[Áî®Êà∑Â§¥ÂÉè]‰ºöÂ§±ÊïàÔºåÈúÄË¶ÅÈáçÊñ∞‰∏ä‰º†„ÄÇ\r\n\r\n  ‚Ä¢ localStorageÂÆπÈáèÊúâÈôêÔºåÊâÄ‰ª•ÈôêÂà∂Âè™Â≠òÂÇ®Â§ßÂ∞èÂú® 350KB (0.35MB) ‰ª•ÂÜÖÁöÑ1Âº†ÂõæÁâáÔºå‰∏îÂè™ËÉΩÊòØ[Áî®Êà∑Â§¥ÂÉè]„ÄÇ\r\n  ‚Ä¢ ‰∏ä‰º†ÁöÑÂõæÁâá‰ªÖ‰ºöÁºìÂ≠òÂú®ÊÇ®ÁöÑÊµèËßàÂô®‰∏≠ÔºåÂπ∂‰∏ç‰ºöÈÄöËøá‰ªª‰ΩïÊñπÂºèÂØπÂ§ñ‰º†Ëæì„ÄÇ';
							const notif_en = "The image you uploaded exceeds 350KB (0.35MB) in size and cannot be stored in the browser's local storage (localStorage). This will not affect usage, but the [User Avatar] will need to be re-uploaded when the page is reopened or refreshed.\r\n\r\n  ‚Ä¢ Due to limited capacity, localStorage restricts the storage of only one image under 350KB (0.35MB) and it can only be the user avatar. \r\n  ‚Ä¢ The uploaded images will only be stored in your browser cache and will not be transmitted over the network.";
							notif = this.settingsLanguage == 'cn' ? notif_cn : notif_en ;
							notiftype = 'center';
						}else {
							//Â∞ÜÂ§¥ÂÉèÂ≠òÂÇ®Âà∞localStorageÂè™Êúâ‰∏ÄÁßçÊñπÊ≥ïÔºåÂ∞±ÊòØÁÇπÂáªÁî®Êà∑ÁöÑ‚Äú‰∏ãÊãâÊ°Ü‚ÄùÊàñ‚ÄúÂ§¥ÂÉè‚ÄùÔºåÁÑ∂Âêé‰∏ä‰º†„ÄÇ  Â¶ÇÊûúÊòØÈÄöËøáÁÇπÂáªgptÁöÑ‚Äú‰∏ãÊãâÊ°Ü‚ÄùÊàñ‚ÄúÂ§¥ÂÉè‚Äù‰∏ä‰º†ÔºåÁÑ∂ÂêéÂ§çÂà∂blob url‰øùÂ≠òÂà∞Áî®Êà∑Â§¥ÂÉèÁöÑÔºåËøôÁßçÊÉÖÂÜµ‰∏ç‰ºöÂ≠òÂÇ®Âà∞localStorageÔºåÂà∑Êñ∞ÂêéÂ§±Êïà„ÄÇ
							
							// ÂõæÁâáÂ§ßÂ∞èÂú®350k‰ª•ÂÜÖ
							this.userAvatarUp_blobUrl = url; //(user & blob <= 350)
							this.userAvatarUp_blob = file; //(user & blob <= 350)
							// Êñá‰ª∂Á¨¶ÂêàË¶ÅÊ±ÇÔºåÂ∞ÜÂõæÁâá‰øùÂ≠òÂà∞LocalStorage
							const reader = new FileReader();
							reader.readAsDataURL(file);
							reader.onload = () => {
								this.userAvatarUp_base64 = reader.result; //(user & blob <= 350)
							};
						
							//ÊèêÁ§∫
							notif = this.settingsLanguage == 'cn' ? '‰∏ä‰º†ÊàêÂäüÔºàÂõæÁâá‰ªÖ‰ºöÁºìÂ≠òÂú®ÊÇ®ÁöÑÊµèËßàÂô®‰∏≠ÔºåÂπ∂‰∏ç‰ºöÈÄöËøá‰ªª‰ΩïÊñπÂºèÂØπÂ§ñ‰º†ËæìÔºâ' : 'Upload successful (the image will only be stored in the browser cache and will not be transmitted over the network).' ;
							notiftype = 'bottom';
						}
					}else {
						const notif_cn = '‰∏ä‰º†ÁöÑ[GPTÂ§¥ÂÉè]Ôºå‰∏ç‰ºöÂ≠òÂÇ®Âà∞ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ® (localStorage) ‰∏≠ÔºåÂú®Âà∑Êñ∞ÊàñÈáçÊñ∞ÊâìÂºÄÁΩëÈ°µÂêéÔºå‰∏ä‰º†ÁöÑ[GPTÂ§¥ÂÉè]Â∞Ü‰ºöÂ§±ÊïàÔºåÈúÄË¶ÅÈáçÊñ∞‰∏ä‰º†„ÄÇ\r\n\r\n  ‚Ä¢ localStorageÂÆπÈáèÊúâÈôêÔºåÊâÄ‰ª•ÈôêÂà∂Âè™Â≠òÂÇ®Â§ßÂ∞èÂú® 350KB (0.35MB) ‰ª•ÂÜÖÁöÑ1Âº†ÂõæÁâáÔºå‰∏îÂè™ËÉΩÊòØ[Áî®Êà∑Â§¥ÂÉè]„ÄÇ\r\n  ‚Ä¢ ‰∏ä‰º†ÁöÑÂõæÁâá‰ªÖ‰ºöÁºìÂ≠òÂú®ÊÇ®ÁöÑÊµèËßàÂô®‰∏≠ÔºåÂπ∂‰∏ç‰ºöÈÄöËøá‰ªª‰ΩïÊñπÂºèÂØπÂ§ñ‰º†Ëæì„ÄÇ';
						const notif_en = "The uploaded [GPT Avatar] will not be stored in the browser's local storage (localStorage). After reopening or refreshing the page, the uploaded [GPT Avatar] will become invalid and need to be re-uploaded.\r\n\r\n  ‚Ä¢ Due to limited capacity, localStorage restricts the storage of only one image under 350KB (0.35MB) and it can only be the [User Avatar]. \r\n  ‚Ä¢ The uploaded images will only be stored in your browser cache and will not be transmitted over the network.";
						notif = this.settingsLanguage == 'cn' ? notif_cn : notif_en ;
						notiftype = 'center';
					}

					// Â∞ÜÊñá‰ª∂Âú∞ÂùÄËµãÂÄºÁªôimageUrlÔºåÂπ∂ÊâßË°åupdateAvatarÊñπÊ≥ï
					if(role == 'user'){
						this.inputUserImageUrl = url;
					}else {
						this.inputGPTImageUrl = url;
					}
					
					this.updateAvatar(role, true);//Êõ¥Êñ∞Â§¥ÂÉè true = show notif.
					
					//ÔºàÂà†ÊóßÁöÑ > Âä†Êñ∞ÁöÑ > Âä†Êñ∞ÁöÑ‰∫ã‰ª∂ÔºâÊØèÊ¨°‰∏ä‰º†ÂêéÔºåÁ´ãÈ©¨Êç¢‰∏™Êñ∞ÁöÑ‰∏ä‰º†Êéß‰ª∂ÔºàÂ§ßÊ¶ÇÊòØÂõ†‰∏∫input‰∏ä‰º†Êéß‰ª∂ÁöÑÁâπÊÆäÊÄßÂêßÔºåÁΩë‰∏äÊïôÁ®ãÊòØËøô‰πàÂÅöÁöÑÔºåGPT‰πüÊòØÊé®ËçêÊâãÂä®Ê∑ªÂä†&Âà†Èô§Ôºâ  
					this.addInput_FileDialog_Avatar(role);
					
					//Âª∂ËøüÊâßË°å ‰πãÂâç‰ºöÂá∫Áé∞‚ÄúÊõ¥Êç¢‰∏≠...‚ÄùÂíå‚ÄúÂ∑≤Êõ¥Êç¢Â§¥ÂÉè‚Äù
					setTimeout(() => {
						const bottom_time = this.settingsLanguage == 'cn' ? 5200 : 6500;
						const center_title = this.settingsLanguage == 'cn' ? 'ÊèêÈÜí' : 'Tip'; // ÊèêÈÜí ‰ø°ÊÅØ
						this.showNotification(notif, notiftype, center_title, bottom_time);
					}, 2600);//ÊØ´ÁßíÔºåms
				};
				
				return input;
			},
  
			//Ôºà‰∏ãÊãâÊ°Ü Ë∞ÉÁî®Ôºâ‰∏ä‰º†ÂõæÁâá ‰∏ä‰º†Â§¥ÂÉè upload image
			openFileDialog_Avatar(role) {
				
				const isInputExit = role == 'user' ? document.getElementById('inputFileAvatar-user') : document.getElementById('inputFileAvatar-gpt'); 
				if(isInputExit){
					isInputExit.click();
				}else{
					const input = this.addInput_FileDialog_Avatar(role);
					isInputExit.click();
				}
				
				let isIOS = /iPad|iPhone|ios|iPod/.test(navigator.userAgent) && !window.MSStream; // Âà§Êñ≠ÊòØÂê¶‰∏∫ iOS ËÆæÂ§á
				let isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent); // Âà§Êñ≠ÊòØÂê¶‰∏∫ Safari ÂÜÖÊ†∏
				if( isIOS || isSafari ) {
					//iphoneÊàñ Safari(iphone/mac) ÈúÄË¶ÅÁÇπÂáªÂ§¥ÂÉèÊâçËÉΩ‰∏ä‰º†
					const notif = this.settingsLanguage == 'cn' ? 'SafariÊµèËßàÂô®(Mac/iPhone)‰∏éiPhoneÂÖ®Á≥ªÂàóÊú∫ÂûãÔºå‰ªÖÊîØÊåÅÈÄöËøáÁÇπÂáªÂè≥‰æßÂ§¥ÂÉèÊù•‰∏ä‰º†ÂõæÁâá' : 'For Safari (Mac/iPhone) and iPhone users, uploading images is only supported by clicking the "Avatar" on the right-hand side.';
					const notiftime = this.settingsLanguage == 'cn' ? 5500 : 7300;
					this.showNotification(notif, 'bottom', '', notiftime);
				}
			},
			// ËÆæÁΩÆÁ™óÂè£ - Êõ¥Êç¢ËØ≠Ë®Ä ‰∏≠Ëã±ÊñáÂàáÊç¢
			changeLanguage() {
				//Êõ¥Êñ∞ÂéüÁîüÂÖ®Â±ÄÂèòÈáè window.currentlang  ÂΩìÂâçËØ≠Ë®Ä Current Language
				window.currentlang = this.settingsLanguage;

				//btn - ÂèëÈÄÅ Send 
				if ( this.sentext == 'ÂÖàÈ™åËØÅAPI' || this.sentext == 'Check API First' ) {
					this.sentext = this.settingsLanguage == 'cn' ? 'ÂÖàÈ™åËØÅAPI' : 'Check API First';
				}else if ( this.sentext == 'ÂèëÈÄÅ' || this.sentext == 'Send' ) {
					this.sentext = this.settingsLanguage == 'cn' ? 'ÂèëÈÄÅ' : 'Send';
				}else if ( this.sentext == 'API KeyÈîôËØØ' || this.sentext == 'API Key Error' ) {
					this.sentext = this.settingsLanguage == 'cn' ? 'API KeyÈîôËØØ' : 'API Key Error';
				}else if ( this.sentext == 'ÈáçÊñ∞È™åËØÅAPI' || this.sentext == 'Recheck API' ) {
					this.sentext = this.settingsLanguage == 'cn' ? 'ÈáçÊñ∞È™åËØÅAPI' : 'Recheck API';
				}else if ( this.sentext == 'ËØ∑ÈáçÂèë'|| this.sentext == 'Please Retry'  ) {
					this.sentext = this.settingsLanguage == 'cn' ? 'ËØ∑ÈáçÂèë' : 'Please Retry';
				}

				//btn - È™åËØÅ Check API Key 
				if ( this.apibtntext == 'Â∑≤È™åËØÅ' || this.apibtntext == 'Checked' ) {
					this.apibtntext = this.settingsLanguage == 'cn' ? 'Â∑≤È™åËØÅ' : 'Checked';
				}else if ( this.apibtntext == '<< È™åËØÅ' || this.apibtntext == '<< Check' ) {
					this.apibtntext = this.settingsLanguage == 'cn' ? '<< È™åËØÅ' : '<< Check';
				}

				//input - GPTÂ§¥ÂÉè url text
				if ( this.inputGPTImageUrl.trim() == this.GPTGreenSVG_UrlText_cn || this.inputGPTImageUrl.trim() == this.GPTGreenSVG_UrlText_en ) {
					this.inputGPTImageUrl = this.settingsLanguage == 'cn' ? this.GPTGreenSVG_UrlText_cn : this.GPTGreenSVG_UrlText_en;
				}
		 
			},
			// ËÆæÁΩÆÁ™óÂè£ - ËÆ∞ÂøÜÊ®°Âºè/‰∏ä‰∏ãÊñáÊ®°Âºè  Contextual Mode
			changeContextualMode() {
				const notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÂØπËØùÁöÑ [ËÆ∞ÂøÜÊ®°Âºè] Â∑≤ÂèòÊõ¥' + (this.isSimpleMode ? '' : '„ÄÇ ÊèêÁ§∫: ÊØè‰∏™ÂØπËØùÁöÑ [ËÆ∞ÂøÜÊ®°Âºè] ÈÉΩÊòØÁã¨Á´ãÁöÑ') : 'The [Contextual Mode] of the current Chat has been changed.' + (this.isSimpleMode ? '' : '  Tip: The [Contextual Mode] of each Chat is independent.') ;
				const time = this.settingsLanguage == 'cn' ? (this.isSimpleMode ? 1600 : 2500) : (this.isSimpleMode ? 1900 : 3000) ;
				this.showNotification(notif, 'bottom', '', time);
			},
			// ËÆæÁΩÆÁ™óÂè£ - ÊîπÂèòÂ≠ó‰ΩìÂ§ßÂ∞è 
			changeStyle_FontSize() {
			
			},
			// ËÆæÁΩÆÁ™óÂè£ - ÊòæÁ§∫ ÈöêËóè Êó∂Èó¥ ÂæÆ‰ø°Ê†∑Âºè 
			changeStyle_Time_WechatStyle() {
				//1„ÄÅadd_span_WeChatStyleDatetime() ÊâãÂä®Ê∑ªÂä†Êñ∞ÁöÑÂæÆ‰ø°Êó∂Èó¥Ôºå Ê∑ªÂä†Êó∂Âà§Êñ≠ÊòØÂê¶ÊòæÁ§∫ + Âà§Êñ≠Ê†∑Âºè(‰∏éÊ∂àÊÅØÊó∂Èó¥ÊúâÂÖ≥ËÅî)  +Ôºà*‰∏éÂàÜÂâ≤Á∫øÁöÑÂÖ≥ËÅî ÊîπÊ†∑ÂºèÂÜôÂú®ÂàÜÂâ≤Á∫øÁöÑ‰ª£Á†ÅÈáåÔºâ
				//2„ÄÅchangeStyle_Time_WechatStyle()  ÊîπÂèò‰πãÂâçÁöÑÂæÆ‰ø°Êó∂Èó¥ÁöÑÊòæÁ§∫Áä∂ÊÄÅ + ÂàÜÂâ≤Á∫øÁöÑÊ†∑Âºè  +Ôºà*‰∏éÊ∂àÊÅØÊó∂Èó¥ÁöÑÂÖ≥ËÅî ÊîπÊ†∑ÂºèÂÜôÂú®Ê∂àÊÅØÊó∂Èó¥ÁöÑ‰ª£Á†ÅÈáåÔºâ
				//Â∫îËØ•Ê≤°ÈóÆÈ¢ò „ÄÇ ÊâãÂä®Ê∑ªÂä†ÔºåÊó†Ê≥ïÁªëÂÆöÂèòÈáè

				let newcontexthrbottom = this.settingsTime_WechatStyle ? '20px' : '33px';
				document.querySelectorAll('.newcontext-hr').forEach(function(element) {
					element.style.marginBottom = newcontexthrbottom;
				});
			},
			// ËÆæÁΩÆÁ™óÂè£ - ÊòæÁ§∫ ÈöêËóè Ê∂àÊÅØÊó∂Èó¥  
			changeStyle_Time() {
				//1„ÄÅÈùûÊâãÂä®Ê∑ªÂä†„ÄÇÊòæÁ§∫Áä∂ÊÄÅÂÜôÂú®<div v-if="x.my" class="msgdatetimediv" :style="{ display: settingsTime_Message == 1 ? 'none' : 'block' }" >
				// classÂèØ‰ª•ÁªëÂÆö styleÂèØ‰ª•ÁªëÂÆö ÁõÆÂâç‰ΩøÁî®ÂèòÈáèÊéßÂà∂Êñ∞ÊóßÊ∂àÊÅØÊó∂Èó¥ÁöÑÊòæÁ§∫Áä∂ÊÄÅ
				//2„ÄÅchangeStyle_Time() ‰ªÖÊîπÂèòÊ†∑Âºè„ÄÇ ‰øÆÊîπ‰πãÂâçÁöÑÊ∂àÊÅØÊó∂Èó¥ÁöÑÊ†∑ÂºèÔºö Á¨¨3ÁßçÊ®°ÂºèÂ¢ûÂ§ßÈó¥Ë∑ùÈúÄË¶ÅÊîπÂèòÊ†∑Âºè + ÂΩìÂæÆ‰ø°Êó∂Èó¥ÊòæÁ§∫Êó∂ÔºåËøòÈúÄË¶ÅÊîπÂèòÂæÆ‰ø°Êó∂Èó¥ÁöÑÊ†∑Âºè
				//3„ÄÅÊºèÊ¥ûÔºöÁº∫Â∞ëÊñ∞Ê∂àÊÅØÊó∂Èó¥Âà§Êñ≠Ê†∑ÂºèÁöÑ‰ª£Á†Å 
				//   ‰∏Ä„ÄÅuserinfoÂíåaiinfo Ê∑ªÂä†ÁªëÂÆö marginTop : settingsTime_Message == 3 ? '27px' : '17px'  ,ÁªëÂÆöÂêéÂèØÊ≥®ÈáäÂà†Èô§changeStyle_Time()ÈáåÁöÑÂØπÂ∫î‰ª£Á†Å„ÄÇ
				//   ‰∫å„ÄÅuserÊ∂àÊÅØÊó∂Èó¥ Âíå ÂæÆ‰ø°Êó∂Èó¥(Âè™‰ºöÂ≠òÂú®userËøôËæπ) ÊòØÂêåÊó∂‰∫ßÁîüÁöÑÔºåÊñ∞Â¢ûÂæÆ‰ø°Êó∂Èó¥ÁöÑÊ†∑ÂºèÂà§Êñ≠Â∑≤ÁªèÂÜôÂú®add_span_WeChatStyleDatetime()ÔºåÊó†ÈúÄÂÜçÂÅöÂ§ÑÁêÜ„ÄÇ
				//   changeStyle_Time() Âè™ÈúÄË¶Å‰øÆÊîπ‰πãÂâçÁöÑÂæÆ‰ø°Êó∂Èó¥Ê†∑ÂºèÂç≥ÂèØ„ÄÇ
				
			},
			// ËÆæÁΩÆÁ™óÂè£ - ÊòæÁ§∫ ÈöêËóè ÂàÜÂâ≤Á∫ø
			changeStyle_DividerLine() {
				//1„ÄÅchangeStyle_DividerLine() ‰øÆÊîπ‰πãÂâçÁöÑÂàÜÂâ≤Á∫øÁöÑÊòæÁ§∫Áä∂ÊÄÅ ‰∏çÊîπÂèòÊ†∑Âºè
				//2„ÄÅadd_hr_newRoundContext() ÊâãÂä®Ê∑ªÂä†Êñ∞ÂàÜÂâ≤Á∫øÊó∂ 1Âà§Êñ≠ÊòØÂê¶ÊòæÁ§∫Êñ∞ÂàÜÂâ≤Á∫ø 2Âà§Êñ≠Êñ∞ÂàÜÂâ≤Á∫øÁöÑÊ†∑ÂºèÔºàÂèóÂæÆ‰ø°Ê†∑ÂºèÊó∂Èó¥ÁöÑÂΩ±ÂìçÔºâ*ÂàÜÂâ≤Á∫ø‰∏éÊ∂àÊÅØÊó∂Èó¥ ‰πãÈó¥Êó†Ê†∑ÂºèÂÖ≥ËÅî
				//3„ÄÅchangeStyle_Time_WechatStyle() Âè™ÊúâÂΩìÂæÆ‰ø°Ê†∑ÂºèÊó∂Èó¥ÁöÑÁä∂ÊÄÅÂèëÁîüÊîπÂèòÊó∂ÔºåÊâç‰ºöÊîπÂèò‰πãÂâçÂàÜÂâ≤Á∫øÁöÑÊ†∑Âºè
				// Â∫îËØ•Ê≤°ÈóÆÈ¢ò ÊâãÂä®Ê∑ªÂä†ÔºåÊó†Ê≥ïÁªëÂÆöÂèòÈáè
	
				let displayStyle = this.settingsDividerLine ? 'block' : 'none';
				document.querySelectorAll('.newcontext-hr').forEach(function(element) {
					element.style.display = displayStyle;
				});
			},
			// ËÆæÁΩÆÁ™óÂè£ - Âø´Êç∑ÈîÆ ÂäüËÉΩÈîÆ For PC
			handleShortcut(event) {
				var key = event.key || event.keyCode || event.which;
				if (key === 'F1' || key === 112) {
					event.preventDefault(); // Èò≤Ê≠¢ÊµèËßàÂô®ÈªòËÆ§Ë°å‰∏∫
					// Ê∏ÖÈô§ËÆ∞ÂøÜ
					if(!this.settingsShortcut_Clear){return;}//Êú™ÂºÄÂêØÂø´Êç∑ÈîÆÊó∂ ËøîÂõû
					if(this.btnDisabledState_Clear){return;}//Ê∏ÖÈô§ËÆ∞ÂøÜÊåâÈíÆ‰∏çÂèØÁî®Êó∂ ËøîÂõû
		
					if(this.isShowDialog_Settings){return;}//ËÆæÁΩÆÁ™óÂè£ÊâìÂºÄÊó∂ ËøîÂõû
					if(this.isShowDialog_PromptGenerator){return;}//ÊèêÁ§∫ËØçÁ™óÂè£ÊâìÂºÄÊó∂ ËøîÂõû
					if(this.isShowNotification && this.setNotificationPosition === 'center'){return;}// ÈÄöÁü•‰∏∫"‰∏≠ÂøÉÈÄöÁü•"Êó∂ÔºåËøîÂõû
					if(this.isShowDialog_ChatList){return;}//ÂØπËØùÂàóË°®Á™óÂè£ÊâìÂºÄÊó∂ ËøîÂõû
					if(this.isShowDialog_AutoKeyRotation){return;}//Ëá™Âä®ËΩÆÊç¢API KeyÁ™óÂè£ÊâìÂºÄÊó∂ ËøîÂõû
					
					//ÂÖ∂‰ªñÂºπÁ™ó 1111111
		
					this.clearContext(); //Ê∏ÖÈô§ËÆ∞ÂøÜ
				} 
	  
				if (key === 'F2' || key === 113) {
					event.preventDefault(); // Èò≤Ê≠¢ÊµèËßàÂô®ÈªòËÆ§Ë°å‰∏∫
					// È™åËØÅAPI Key ***v8.27 ÊîπÁî®ÈÄî ÊîπÊàê"ÊâìÂºÄKeyÊ®°ÂºèÁ™óÂè£"ÁöÑÂø´Êç∑ÈîÆ Change the original purpose to "Open Key Mode window".
					if(!this.settingsShortcut_CheckApiKey){return;}//Êú™ÂºÄÂêØÂø´Êç∑ÈîÆÊó∂ ËøîÂõû
					if(this.isShowNotification && this.setNotificationPosition === 'center'){return;}// ÈÄöÁü•‰∏∫"‰∏≠ÂøÉÈÄöÁü•"Êó∂ÔºåËøîÂõû
					
					if(this.isShowDialog_AutoKeyRotation){
						this.isShowDialog_AutoKeyRotation = false;
						return;
					}else{
						this.clickOpenAutoKeyRotation();
					}
				} 
	  
				if (key === 'F3' || key === 114) {
					event.preventDefault(); // Èò≤Ê≠¢ÊµèËßàÂô®ÈªòËÆ§Ë°å‰∏∫
					// Êí§ÈîÄ
					if(!this.settingsShortcut_Undo){return;}//Êú™ÂºÄÂêØÂø´Êç∑ÈîÆÊó∂ ËøîÂõû
					if(this.btnDisabledState_Undo){return;}//Êí§ÈîÄÊåâÈíÆ‰∏çÂèØÁî®Êó∂ ËøîÂõû
		
					if(this.isShowDialog_Settings){return;}//ËÆæÁΩÆÁ™óÂè£ÊâìÂºÄÊó∂ ËøîÂõû
					if(this.isShowDialog_PromptGenerator){return;}//ÊèêÁ§∫ËØçÁ™óÂè£ÊâìÂºÄÊó∂ ËøîÂõû
					if(this.isShowNotification && this.setNotificationPosition === 'center'){return;}// ÈÄöÁü•‰∏∫"‰∏≠ÂøÉÈÄöÁü•"Êó∂ÔºåËøîÂõû
					if(this.isShowDialog_ChatList){return;}//ÂØπËØùÂàóË°®Á™óÂè£ÊâìÂºÄÊó∂ ËøîÂõû
					if(this.isShowDialog_AutoKeyRotation){return;}//Ëá™Âä®ËΩÆÊç¢API KeyÁ™óÂè£ÊâìÂºÄÊó∂ ËøîÂõû
					
					//ÂÖ∂‰ªñÂºπÁ™ó 1111111
		
					this.undo();//Êí§ÈîÄ
				} 
	  
				if (key === 'F4' || key === 115) {
					event.preventDefault(); // Èò≤Ê≠¢ÊµèËßàÂô®ÈªòËÆ§Ë°å‰∏∫
					// ÈáçÈóÆ
					if(!this.settingsShortcut_Retry){return;}//Êú™ÂºÄÂêØÂø´Êç∑ÈîÆÊó∂ ËøîÂõû
					if(this.btnDisabledState_Undo){return;}//‰∏éÊí§ÈîÄÁõ∏Âêå„ÄÇ Êí§ÈîÄÊåâÈíÆ‰∏çÂèØÁî®Êó∂ ËøîÂõû
		
					if(this.isShowDialog_Settings){return;}//ËÆæÁΩÆÁ™óÂè£ÊâìÂºÄÊó∂ ËøîÂõû
					if(this.isShowDialog_PromptGenerator){return;}//ÊèêÁ§∫ËØçÁ™óÂè£ÊâìÂºÄÊó∂ ËøîÂõû
					if(this.isShowNotification && this.setNotificationPosition === 'center'){return;}// ÈÄöÁü•‰∏∫"‰∏≠ÂøÉÈÄöÁü•"Êó∂ÔºåËøîÂõû
					if(this.isShowDialog_ChatList){return;}//ÂØπËØùÂàóË°®Á™óÂè£ÊâìÂºÄÊó∂ ËøîÂõû
					if(this.isShowDialog_AutoKeyRotation){return;}//Ëá™Âä®ËΩÆÊç¢API KeyÁ™óÂè£ÊâìÂºÄÊó∂ ËøîÂõû
					
					//ÂÖ∂‰ªñÂºπÁ™ó 1111111
					
					this.retry();//ÈáçÈóÆ
				}
			},		
			//Âà§Êñ≠ÊòØÂê¶Â≠òÂú®‰ª£Á†ÅÂùóÁöÑÂèçÂºïÂè∑ÔºåÊòØÂê¶ÊúâËøûÁª≠3‰∏™Êàñ‰ª•‰∏äÁöÑÂèçÂºïÂè∑ÔºàÈÄöÂ∏∏Âè™‰ºöÈÅáÂà∞3ÔΩû5‰∏™ÁöÑÊÉÖÂÜµÔºâÔºåÊâæÂ≠òÂú®ÁöÑÊúÄÈïøÁöÑÔºåÁÑ∂ÂêéËøîÂõûÈïøÂ∫¶Âä†1ÁöÑËøûÁª≠ÂèçÂºïÂè∑„ÄÇ ËøûÁª≠ÈïøÂ∫¶Â§öÂ∞ëÂÜ≥ÂÆö‰∫ÜÂæ™ÁéØÊ¨°Êï∞ÔºåÈôêÂà∂100„ÄÇ
			//ÁõÆÁöÑÊòØÁâπÊÆäÊÉÖÂÜµ‰∏ãÈúÄË¶ÅÂà©Áî®‰ª£Á†ÅÂùóÊù•ÂåÖË£πÊï¥ÊÆµÊèêÁ§∫ËØçÂÜÖÂÆπÔºåÂ¶ÇÊûúÊ≤°ÊúâË∂≥Â§üÈïøÂ∫¶ÁöÑÂèçÂºïÂè∑Ôºåmarkdown‰∏äÁöÑÊéíÁâàÂèØËÉΩ‰ºöÂæà‰π±
			findMaxBackticks(str) {
				let pattern, regex;
				// Check for 5 backticks
				pattern = "`{5}"; 
				regex = new RegExp(pattern);
				if (regex.test(str)) {
					// Check for more than 5 backticks
					for (let i = 6; i <= 100; i++) {
						pattern = "`".repeat(i);
						regex = new RegExp(pattern);
						if (!regex.test(str)) {
							return "`".repeat(i);
						}
					}
				} else {
				// Check for 4, 3 backticks
					for (let i = 4; i >= 3; i--) {
						pattern = "`".repeat(i);
						regex = new RegExp(pattern);
						if (regex.test(str)) {
							return "`".repeat(i + 1);
						}
					}
				}
				return '';
			},	
			// ËÆæÁΩÆÁ™óÂè£ - Ê∑ªÂä†ÊèêÁ§∫ËØçÂà∞ËÅäÂ§©ËÆ∞ÂΩï‰∏≠ÔºàChatHistory.txtÔºâ	
			addSystemPromptToChatHistory(head_cn,head_en){
				//ÊèêÁ§∫ËØç ‰ΩøÁî®‰∏§ÁßçmarkdownËØ≠Ê≥ïÔºö
				//		1„ÄÅÂºïÁî®„ÄÇÂΩìÊ≤°ÊúâÁ©∫Ë°å„ÄÅÊ≤°Êúâ```‰ª£Á†ÅÂùóÊó∂Ôºå‰ΩøÁî®"> "ÂºïÁî®ËØ≠Ê≥ï„ÄÇÊèêÁ§∫ËØçÊï¥ÊÆµÊòæÁ§∫‰∏∫ÂºïÁî®Ôºå‰∏éËÅäÂ§©ËÆ∞ÂΩïÂå∫ÂàÜÂºÄ„ÄÇ
				//		2„ÄÅ‰ª£Á†ÅÂùó„ÄÇÂΩìÊèêÁ§∫ËØç‰∏≠Â≠òÂú®Á©∫Ë°å „ÄÅ```‰ª£Á†ÅÂùóÊó∂ÔºåÂØºÂá∫ËÅäÂ§©ËÆ∞ÂΩïÁöÑmarkdownËßÜÂõæ‰ºöÊòæÂæóÂæà‰π±ÔºåÊ≠§Êó∂‰ΩøÁî®‰ª£Á†ÅÂùóËØ≠Ê≥ïÊù•ÂåÖË£πÊï¥ÊÆµÊèêÁ§∫ËØçÔºå‰ΩÜÊèêÁ§∫ËØç‰∏≠Êú¨Ë∫´ÂæàËÉΩÂ≠òÂú®‚Äú```‚ÄùÁîöËá≥Êõ¥ÈïøÁöÑÂèçÂºïÂè∑ÔºåËøô‰ºöÂØºËá¥ÂåÖË£πÂ§±Ë¥•ÔºåÊâÄ‰ª•Ë¶ÅÁî®Êõ¥ÈïøÁöÑÂèçÂºïÂè∑„ÄÇ
				//		  ...‰πüÂèØ‰ª•Áõ¥Êé•ÂÜôÊ≠ªÔºåÊØîÂ¶ÇÁõ¥Êé•Áî®10‰∏™ÂèçÂºïÂè∑Êù•ÂåÖË£π„ÄÇ‰ΩÜÊòØËã•Â∞ÜÂØºÂá∫ÁöÑËÆ∞ÂΩïÂÜç‰Ωú‰∏∫ÊèêÁ§∫ËØç‰ΩøÁî®ÁöÑËØùÔºå‰∏ãÊ¨°ÂØºÂá∫ËÅäÂ§©ËÆ∞ÂΩïÊó∂Â∞±Êó†Ê≥ïÂåÖË£π‰∫ÜÔºàÂèçÂºïÂè∑ÈïøÂ∫¶Áõ∏ÂêåÔºâ„ÄÇ
				const regex = /\r?\n\r?\n/;  //Ê≠£ÂàôÔºåÂåπÈÖçËøûÁª≠‰∏§‰∏™Êç¢Ë°åÁ¨¶(Âç≥ÂåπÈÖçÊòØÂê¶Â≠òÂú®Á©∫Ë°åÔºåÊîØÊåÅUnix„ÄÅWindowsÁöÑÊç¢Ë°åÁ¨¶)
				let hasMultipleLines = regex.test(this.gptSystemPromptReadOnly.trim()); //ÊòØÂê¶Â≠òÂú®Á©∫Ë°å  ÂåÖÂê´Á©∫Ë°åÊó∂Êó†Ê≥ïÊîØÊåÅÂºïÁî®ËØ≠Ê≥ï"> "
				let backticks = this.findMaxBackticks(this.gptSystemPromptReadOnly.trim()); //ÊèêÁ§∫ËØç‰∏≠ÂèØËÉΩÂ≠òÂú®ÁöÑÊúÄÈïøÁöÑËøûÁª≠ÂèçÂºïÂè∑„ÄÇ ËøîÂõû‚ÄúÈïøÂ∫¶Âä†1ÁöÑËøûÁª≠ÂèçÂºïÂè∑‚Äù
				hasMultipleLines = backticks != '' ? true : hasMultipleLines ; //Â¶ÇÊûúÂê´Êúâ3‰∏™Êàñ‰ª•‰∏äÁöÑÂèçÂºïÂè∑ÔºåÂêåÊ†∑‰∏çËÉΩ‰ΩøÁî®"ÂºïÁî®"ËØ≠Ê≥ï
				backticks = backticks == '' ? '````' : backticks ; //Êõ¥Êñ∞ÂèòÈáèÔºå‰∏ÄÁßçÊÉÖÂÜµ‰ºöÁî®Âà∞ÔºöÂΩìÊèêÁ§∫ËØç(‰∏çÂåÖÂê´‰ª£Á†ÅÂùó&&ÂåÖÂê´Á©∫Ë°å)ÁöÑÊó∂ÂÄôÔºåÊ≠§Êó∂Áî®‰∫éÂåÖË£πÊèêÁ§∫ËØçÁöÑ‰ª£Á†ÅÂùóÈúÄË¶Å3‰∏™ÂèçÂºïÂè∑Ôºå3‰∏™Â∞±Â§üÔºå‰ΩÜËøòÊòØÁî®4‰∏™Âêß
	
				//v6.01 ‰∏Ä‰∏™ÂºÄÂÖ≥ÔºåchatHistoryPromptOnlyUseBackticks=true ÂÖ®ÈÉ®‰ΩøÁî®ÂèçÂºïÂè∑ÔºåchatHistoryPromptOnlyUseBackticks=false Ëá™Âä®Âà§Êñ≠‰ΩøÁî®ÂºïÁî®ÊàñËÄÖÂèçÂºïÂè∑
				//v6.01 When chatHistoryPromptOnlyUseBackticks=true, only backtick syntax will be used. When chatHistoryPromptOnlyUseBackticks=false, the system will automatically determine whether to use quote syntax or backtick syntax.
				if ( this.chatHistoryPromptOnlyUseBackticks ) {
					hasMultipleLines = true;
				}
	
				let addMarkdownSyntaxStart = hasMultipleLines ? ( '\r\n' + backticks + '\r\n' ) : '\r\n> ' ;  // (> ÂêéÈù¢Êúâ‰∏™Á©∫Ê†º)
				let addMarkdownSyntaxEnd = hasMultipleLines ? ( '\r\n' + backticks + '\r\n\r\n' ) : '\r\n\r\n' ; 
				let nullprompt = '';  //ÊèêÁ§∫ËØç‰∏∫Á©∫ÁöÑÊÉÖÂÜµ
				if( this.gptSystemPromptReadOnly.trim() == '' ){
					nullprompt = this.settingsLanguage == 'cn' ? ': Á©∫' : ': None' ; 
					addMarkdownSyntaxStart = '\r\n'; 
					addMarkdownSyntaxEnd = '\r\n' ;
				}
				let txt_lang = this.settingsLanguage == 'cn' ? ( head_cn + nullprompt + addMarkdownSyntaxStart ) : ( head_en + nullprompt + addMarkdownSyntaxStart ) ;
				//1.ÊèêÁ§∫ËØç‰∏∫Á©∫„ÄÇ  2.ÊèêÁ§∫ËØçÂê´ÊúâÁ©∫Ë°åÔºå‰ΩÜ‰∏çÂê´Êúâ```‰ª£Á†ÅÂùó„ÄÇ  3.ÊèêÁ§∫ËØçÂê´Êúâ```‰ª£Á†ÅÂùóÔºàËøûÁª≠3‰∏™Êàñ‰ª•‰∏äÁöÑÂèçÂºïÂè∑‰∏∫markdownÁöÑ‰ª£Á†ÅÂùóÔºå3‰∏™‰ª•‰∏ãÊòØ"Ë°å‰ª£Á†ÅÔºåÂçïË°å"Ôºâ
				// ‰πüÂèØ‰ª•Áõ¥Êé•ËÄÉËôëÂè™‰ΩøÁî®‚Äú‰ª£Á†ÅÂùó‚ÄùÂåÖË£πÔºåËÄå‰∏ç‰ΩøÁî®‚ÄúÂºïÁî®‚Äù„ÄÇ‚ÄúÂºïÁî®‚ÄùÂá∫Áé∞Â§±Ë¥•ÁöÑÊ¶ÇÁéá‰πü‰∏çÂ∞èÔºåÊµãËØï‰∏≠ÂèëÁé∞‰∏çÂêåÁöÑÂú®Á∫ømarkdownÁºñËæëÂô®ÁöÑÂ∑ÆÂºÇËøòËõÆÂ§ß„ÄÇ
				this.chathistory  += ( txt_lang + this.gptSystemPromptReadOnly.trim() + addMarkdownSyntaxEnd );
			},
			// ËÆæÁΩÆÁ™óÂè£ - ÊÅ¢Â§çÈªòËÆ§ APIËÆæÁΩÆ
			restoreDefault_APISettings(){
				//if (this.checkBusyStatus()) {
				//	// Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ 
				//	return;
				//}
		 
		 		this.openSmartMaxTokens = true; //ÈªòËÆ§ÂºÄÂêØÔºålocalStorageÊó†Ê≠§ÂèòÈáè
				
				this.apitemperature = JSON.parse(JSON.stringify(this.userVariables_default.apitemperature)); //ËøôÈáåÂÖ∂ÂÆû‰∏çÈúÄË¶ÅÂèåÂêëÁªëÂÆö
				this.apiMaxTokens = JSON.parse(JSON.stringify(this.userVariables_default.apiMaxTokens));
				this.apiGPTModel = JSON.parse(JSON.stringify(this.userVariables_default.apiGPTModel));

				const notif = this.settingsLanguage == 'cn' ? 'APIËÆæÁΩÆ Â∑≤ÊÅ¢Â§çÈªòËÆ§ÂÄº' : 'API Settings have been reset to default values.' ;
				const time = this.settingsLanguage == 'cn' ? 2500 : 3300 ;
				this.showNotification(notif, 'bottom', '', time);
			},
			// ËÆæÁΩÆÁ™óÂè£ - ÊÅ¢Â§çÈªòËÆ§ APIËÆæÁΩÆ ‰∏ì‰∏ö
			restoreDefault_ProfessionalAPISettings(){
				if (this.checkBusyStatus()) {
					// Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ
					return;
				}

				/////Ôºàv8.13 ‰∏çÊÅ¢Â§çAPI URLÔºâ ÂêåÊ≠•saveApiURL‰∏≠ÂÖ≥‰∫é‰øùÂ≠òÈªòËÆ§urlÁöÑÊ≠•È™§
				///Ôºàv8.13 ‰∏çÊÅ¢Â§çAPI URLÔºâ this.inputApiURL = this.OpenAI_API_URL ; //ËæìÂÖ•Ê°ÜÊòæÁ§∫ÁöÑapi url
				///Ôºàv8.13 ‰∏çÊÅ¢Â§çAPI URLÔºâ this.apiURL = JSON.parse(JSON.stringify(this.inputApiURL)); // ÁúüÊ≠£ÁöÑÁöÑapi url
				///Ôºàv8.13 ‰∏çÊÅ¢Â§çAPI URLÔºâ this.selectedApiURL = JSON.parse(JSON.stringify(this.inputApiURL)); //‰∏ãÊãâÊ°ÜÊòæÁ§∫‰∏∫‚ÄúÂÆòÊñπ‚Äù/‚ÄúGPT‚Äù
				////v7.10 ÈÄªËæëÊõ¥ÊîπÔºå‰∏çÂÜçÁªëÂÆöAPI URL‰∏éAPI KeyÔºåÂì™ÊÄïAPI URLÊó†ÊïàÔºå‰πü‰∏çÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ„ÄÇ
				////v7.10 delete... this.inputapichange(true); // ÈáçÊñ∞È™åËØÅAPI KeyÊó∂ ÊîπÂèòÊåâÈíÆÁ≠âÁä∂ÊÄÅ
				///Ôºàv8.13 ‰∏çÊÅ¢Â§çAPI URLÔºâ this.btnDisabledState_SaveApiURL = true; //‰øùÂ≠òÊåâÈíÆÁä∂ÊÄÅÊîπ‰∏∫‰∏çÂèØÁî®
	 
				this.apiTopP = JSON.parse(JSON.stringify(this.userVariables_default.apiTopP));//ËøôÈáåÂÖ∂ÂÆû‰∏çÈúÄË¶ÅÂèåÂêëÁªëÂÆö
				this.apiPresencePenalty = JSON.parse(JSON.stringify(this.userVariables_default.apiPresencePenalty));
				this.apiFrequencyPenalty = JSON.parse(JSON.stringify(this.userVariables_default.apiFrequencyPenalty));

				const notif = this.settingsLanguage == 'cn' ? 'API‰∏ì‰∏öËÆæÁΩÆ Â∑≤ÊÅ¢Â§çÈªòËÆ§ÂÄº„ÄÇ ÊèêÁ§∫: Êé•Âè£ÁΩëÂùÄ (API URL) ÈúÄÊâãÂä®‰øÆÊîπ' : 'Professional API Settings have been reset to default values. Tip: API URL (Endpoint) needs to be manually modified.' ;
				const time = this.settingsLanguage == 'cn' ? 5000 : 6500 ; 
				this.showNotification(notif, 'bottom', '', time); //this.inputapichange ‰ºöÂºπÁ¨¨‰∫å‰∏™ÈÄöÁü•
			},
			// ËÆæÁΩÆÁ™óÂè£ - ÊÅ¢Â§çÈªòËÆ§ Â∏∏ËßÑËÆæÁΩÆ
			restoreDefault_GeneralSettings(){
				if (this.checkBusyStatus()) {
					// Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ
					return;
				}

				this.settingsFontSize = JSON.parse(JSON.stringify(this.userVariables_default.settingsFontSize ));//ËøôÈáåÂÖ∂ÂÆû‰∏çÈúÄË¶ÅÂèåÂêëÁªëÂÆö
				this.changeStyle_FontSize();

				this.settingsTime_WechatStyle = JSON.parse(JSON.stringify(this.userVariables_default.settingsTime_WechatStyle ));
				this.changeStyle_Time_WechatStyle();

				this.settingsTime_Message = JSON.parse(JSON.stringify(this.userVariables_default.settingsTime_Message ));
				this.changeStyle_Time();

				this.settingsDividerLine = JSON.parse(JSON.stringify(this.userVariables_default.settingsDividerLine ));
				this.changeStyle_DividerLine();

				//8.26 ÈúÄÊâãÂä® need manually // *this.chatVariables_default
				//8.26 ÈúÄÊâãÂä® need manually this.settingsContextualMode = JSON.parse(JSON.stringify(this.chatVariables_default.settingsContextualMode )); // ***ChatData
				//8.26 ÈúÄÊâãÂä® need manually //this.changeContextualMode();

				this.settingsShortcut_CheckApiKey = JSON.parse(JSON.stringify(this.userVariables_default.settingsShortcut_CheckApiKey ));
				this.settingsShortcut_Clear = JSON.parse(JSON.stringify(this.userVariables_default.settingsShortcut_Clear ));
				this.settingsShortcut_Undo = JSON.parse(JSON.stringify(this.userVariables_default.settingsShortcut_Undo ));
				this.settingsShortcut_Retry = JSON.parse(JSON.stringify(this.userVariables_default.settingsShortcut_Retry ));

				const notif = this.settingsLanguage == 'cn' ? 'Â∏∏ËßÑËÆæÁΩÆ Â∑≤ÊÅ¢Â§çÈªòËÆ§ËÆæÁΩÆ„ÄÇ ÊèêÁ§∫: ËÆ∞ÂøÜÊ®°Âºè„ÄÅËØ≠Ë®ÄÂíåÂ§¥ÂÉèËÆæÁΩÆÈúÄÊâãÂä®‰øÆÊîπ' : 'General Settings have been reset to default values. Tip: Contextual Mode, Language, and Avatar settings need to be manually modified.' ;
				const time = this.settingsLanguage == 'cn' ? 5000 : 6500 ;
				this.showNotification(notif, 'bottom', '', time);
			},
			
			// ËÆæÁΩÆÁ™óÂè£ - ÁÇπÂáªÊâìÂºÄÂØπËØùÂàóË°®
			clickOpenChatList() {
				this.isShowDialog_ChatList = true;
				const notif = this.settingsLanguage == 'cn' ? 'Âú®ËÅäÂ§©ÁïåÈù¢‰∏≠ÔºåÁÇπÂáª‰ªªÊÑèÂ§¥ÂÉèÂèØÂø´ÈÄüÊâìÂºÄÂØπËØùÂàóË°®' : 'In the chat interface, clicking on any avatar quickly opens the chat list.' ;
				this.showNotification(notif, 'bottom', '', 6500);
			},
			// ËÆæÁΩÆÁ™óÂè£ - ÁÇπÂáªÊâìÂºÄÊèêÁ§∫ËØçÁ™óÂè£
			clickOpenPromptGenerator() {
				this.isShowDialog_PromptGenerator = true;
				const notif = this.settingsLanguage == 'cn' ? 'Âú®ËÅäÂ§©ÁïåÈù¢‰∏≠ÔºåÁÇπÂáªÊñúÊùÜ (/) ÂèØÂø´ÈÄüÊâìÂºÄÊèêÁ§∫ËØçÁ™óÂè£' : 'In the chat interface, clicking on the slash (/) quickly opens the Prompt Generator.' ;
				this.showNotification(notif, 'bottom', '', 6500);
			},
			// ËÆæÁΩÆÁ™óÂè£ - ÂØºÂá∫ËÅäÂ§©ËÆ∞ÂΩï‰∏ãÊãâÊ°Ü
			changeSelectedExportChatHistory() {
				let exportType = this.selectedExportChatHistory;
				this.selectedExportChatHistory = ''; //Â§çÂéü
				let notif = this.settingsLanguage == 'cn' ? 'Ê≠£Âú®ÂØºÂá∫ { #' + this.chatid + ' } ÁöÑËÅäÂ§©ËÆ∞ÂΩï' : 'Exporting chat history of { #' + this.chatid + ' }' ;
				this.showNotification(notif, 'bottom', '',4000);
				
				if( exportType == 'ChatHistory_Single_MD' ){
				//ÂçïËΩÆËÆ∞ÂøÜ (.md)
					this.ExportData_SingleRound(true,true,false,'markdown');
				}else if( exportType == 'ChatHistory_Single_TXT' ){
				//ÂçïËΩÆËÆ∞ÂøÜ (.txt)
					this.ExportData_SingleRound(true,true,false,'plain');
				}else if( exportType == 'ChatHistory_ALL_MD' ){
				//ÂÖ®ÈÉ® (.md)
					this.ExportData(this.chathistory,this.exportTXTFileName,'markdown');
				}else if( exportType == 'ChatHistory_ALL_TXT' ){
				//ÂÖ®ÈÉ® (.txt)
					this.ExportData(this.chathistory,this.exportTXTFileName,'plain');
				}
			},
			
			
			// ËÆæÁΩÆÁ™óÂè£ - Êï∞ÊçÆÁÆ°ÁêÜData Management ÁºìÂ≠òlocalStorage Âà†Èô§Êï∞ÊçÆ Delete Data
			changeSelectedDeleteLocalStorageData(){
				if (this.checkBusyStatus('ForChat')) {
					this.selectedDeleteLocalStorageData = ''; //Â§çÂéü
					//Â∫ïÈÉ®‰ºöÂá∫Áé∞ÈÄöÁü•tooltips„ÄÇ Â¶ÇÊûúËøîÂõû trueÔºå Ê≠£Âú®ÂèëÈÄÅ Êàñ Ê≠£Âú®È™åËØÅ Êàñ Ê≠£Âú®Ê†áÁ≠æÈ°µÈó¥ÂêåÊ≠•Êï∞ÊçÆ
					return;
				}
				let notif = '';
				let notiftime = 2000; //ÈÄöÁü•ÊòæÁ§∫ÁöÑÊó∂Èó¥
				let delaytime = 0;//Âª∂ËøüÊó∂Èó¥
				if(!this.isLocalStorageSupported){
					//ÊµèËßàÂô®ÂΩìÂâç‰∏çÊîØÊåÅlocalStorageÊó∂
					notif = this.settingsLanguage == 'cn' ? 'Ê≠£Âú®Â∞ùËØïÂº∫Âà∂Ê∏ÖÈô§ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®(localStorage)...' : 'Forcefully deleting browser local storage in progress...' ;
				}
				if(!this.isLocalStorageAllowed){
					//‰∏çÂÖÅËÆ∏ÁºìÂ≠òÊó∂
					notif = this.settingsLanguage == 'cn' ? 'Ê≠£Âú®Â∞ùËØïÂº∫Âà∂Ê∏ÖÈô§ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®(localStorage)...' : 'Forcefully deleting browser local storage in progress...' ;
				}
				if (notif !== ''){
					this.showNotification(notif, 'bottom', '', 3500);
					delaytime = 2500;
				}
				notif = '';
				let typeStr = this.selectedDeleteLocalStorageData;
				this.selectedDeleteLocalStorageData = ''; //Â§çÂéü
				
				try{
					if(typeStr === 'DeleteAllData'){
					//'1) ‰∏ÄÈîÆÂà†Èô§ÊâÄÊúâÊï∞ÊçÆ', type: 'DeleteAllData'
						//v7.17 ‰∏çËÉΩÁî®localStorage.clear()ÔºåÁîµËÑëÊú¨Âú∞ËøêË°åÔºåfileÂçèËÆÆÊâÄÊúâÁΩëÁ´ôÂÖ±Áî®‰∏Ä‰∏™localStorageÔºåclear()‰ºöÂà†Èô§ÊâÄÊúâÊú¨Âú∞ÂÖÅËÆ∏ÁöÑÁΩëÁ´ôÁöÑÁºìÂ≠òÊï∞ÊçÆ
						//Êîπ‰∏∫ÂàÜÂà´Âà†Èô§4È°πÊï∞ÊçÆ //ÂÖàÂà†1Ê¨°
						localStorage.removeItem('chatDataList');
						localStorage.removeItem('apikeyData');
						localStorage.removeItem('promptsData');
						localStorage.removeItem('userSettings');
						
						notif = this.settingsLanguage == 'cn' ? 'Â∑≤Âà†Èô§ÊâÄÊúâÊï∞ÊçÆ' : 'All data has been deleted' ;
						
						//1 List
						this.chatDataList = [];//ÁïåÈù¢‰∏≠Âà†Èô§List
						this.chatList_addNewChatData(true);//Ê∑ªÂä†Êñ∞ÂØπËØù
						//2 API Key
						this.setVariablesToThis(this.apikeyData_default, this.apikeyData_default, true);
						//this.inputapichange(false); ÈáçÂ§çÁöÑÔºåÂêéÈù¢‰ºöÊâßË°å
						this.lastAPIKeyInputText = '';
						this.lastAPIKeyInputText_Available = '';
						if(this.defaultAPIKey !== '' || this.default_apiKeyArray_WrittenInTheCode.length > 0 ){
							notif += this.settingsLanguage == 'cn' ? '„ÄÇÔºàÂØÜÈí•: ÈÉ®ÂàÜÂÜôÂú®‰ª£Á†ÅÈáåÁöÑ API Key Êó†Ê≥ïË¢´Âà†Èô§ÔºåÂà∑Êñ∞Âêé‰ºöÊÅ¢Â§çÔºâ' : '. (API keys: Some API Keys written in the code cannot be deleted and will be restored after refreshing.)' ;
							notiftime = 7000;
						}
						//3 Prompts
						this.setVariablesToThis(this.promptsData_default, this.promptsData_default, true);
						this.btnDisabledState_SetSystemPrompt = false;
						//4 User Settings
						this.userAvatarUp_base64 = ''; //Ê∏ÖÁ©∫
						this.userAvatarUp_blob = null; //Ê∏ÖÁ©∫
						this.userAvatarUp_blobUrl = ''; //Ê∏ÖÁ©∫
						this.inputUserImageUrl = 'https://kimi.xinu.ink/top.JPG'; //ÊÅ¢Â§çÈªòËÆ§Â§¥ÂÉèurl
						this.updateAvatar('user', false);//Âà∑Êñ∞Â§¥ÂÉè false=Don't show notif.
						this.inputGPTImageUrl = this.settingsLanguage == 'cn' ? this.GPTGreenSVG_UrlText_cn : this.GPTGreenSVG_UrlText_en;
						this.updateAvatar('gpt', false);
						
						this.setVariablesToThis(this.userVariables_default, this.userVariables_default, true); //*userVariables ÂèòÈáè
						this.inputApiURL = this.apiURL;
						this.selectedApiURL = this.inputApiURL;
						this.settingsContextualMode = JSON.parse(JSON.stringify(this.chatVariables_default.settingsContextualMode ));//Â±û‰∫échatdataÁöÑÂèòÈáèÔºå‰∏çÂ±û‰∫éuserVariables„ÄÇÈúÄË¶ÅÊâãÂä®ËÆæÁΩÆ *8.26 ËøôË°å‰ª£Á†ÅÊúâÁÇπÂ§ö‰Ωô
						
						this.openSmartMaxTokens = true; //localStorageÊó†Ê≠§ÂèòÈáè„ÄÇÈªòËÆ§ÂºÄÂêØÔºåÈúÄË¶ÅÊâãÂä®ËÆæÁΩÆ„ÄÇ
						this.changePageScaling(false);//ÈúÄË¶ÅÂú®changeSimpleMode‰πãÂâç
						this.changeLanguage();
						this.changeSimpleMode(false);
						this.inputapichange(false); // ÈáçÊñ∞È™åËØÅAPI KeyÊó∂ ÊîπÂèòÊåâÈíÆÁ≠âÁä∂ÊÄÅ
						this.btnDisabledState_SaveApiURL = true; //‰øùÂ≠òÊåâÈíÆÁä∂ÊÄÅÊîπ‰∏∫‰∏çÂèØÁî®
						this.changeStyle_FontSize();
						this.changeStyle_Time_WechatStyle();
						this.changeStyle_Time();
						this.changeStyle_DividerLine();
						//this.changeContextualMode();
						
						//ÊúÄÂêéÂÜçÂà†‰∏ÄÊ¨°  //‰∏çËÉΩ‰ΩøÁî®localStorage.clear();
						//Êîπ‰∏∫ÂàÜÂà´Âà†Èô§4È°πÊï∞ÊçÆ //ÂÖàÂà†1Ê¨°
						localStorage.removeItem('chatDataList');
						localStorage.removeItem('apikeyData');
						localStorage.removeItem('promptsData');
						localStorage.removeItem('userSettings');
					}else if(typeStr === 'DeleteChatDataList'){
					//'2) Âà†Èô§[ÂØπËØù]Êï∞ÊçÆ', type: 'DeleteChatDataList'
						this.chatDataList = [];//ÂÖàÂú®ÁïåÈù¢‰∏≠Âà†Èô§List
						localStorage.removeItem('chatDataList');//‰πãÂêéÂú®ÁºìÂ≠ò‰∏≠Âà†Èô§List
						this.chatList_addNewChatData(true);//Ê∑ªÂä†Êñ∞ÂØπËØù
						notif = this.settingsLanguage == 'cn' ? 'Â∑≤Âà†Èô§ÊâÄÊúâÂØπËØùÊï∞ÊçÆ' : 'All chat data has been deleted' ;
					}else if(typeStr === 'DeleteAPIKeyData'){
					//'3) Âà†Èô§[ÂØÜÈí• API Key]Êï∞ÊçÆ', type: 'DeleteAPIKeyData'
						localStorage.removeItem('apikeyData');
						//Ê†πÊçÆÂèòÈáèÂàóË°®ÂíåÈªòËÆ§ÂÄº ËøòÂéüÈªòËÆ§ÂèòÈáè
						this.setVariablesToThis(this.apikeyData_default, this.apikeyData_default, true);
						// API Key ÊîπÂèòÊåâÈíÆÁ≠âÁä∂ÊÄÅ
						this.inputapichange(false); 
						this.lastAPIKeyInputText = '';
						this.lastAPIKeyInputText_Available = '';
						//this.defaultAPIKey Ëøô‰∏™‰∏çÂà†ÔºåÁî®‰∫éËÆ∞ÂΩïÂÜôÂú®‰ª£Á†ÅÁöÑÂçï‰∏™KeyÔºàthis.api)„ÄÇ
						notif = this.settingsLanguage == 'cn' ? 'Â∑≤Âà†Èô§ÂØÜÈí• (API Key) Êï∞ÊçÆ' : 'API Keys data has been deleted' ;
						if(this.defaultAPIKey !== '' || this.default_apiKeyArray_WrittenInTheCode.length > 0 ){
							notif += this.settingsLanguage == 'cn' ? '„ÄÇ ÈÉ®ÂàÜÂÜôÂú®‰ª£Á†ÅÈáåÁöÑ API Key Êó†Ê≥ïË¢´Âà†Èô§ÔºåÂà∑Êñ∞Âêé‰ºöÊÅ¢Â§ç' : '. Some API Keys written in the code cannot be deleted and will be restored after refreshing.' ;
							notiftime = 6000;
						}
					}else if(typeStr === 'DeletePromptsData'){
					//'4) Âà†Èô§[ÊèêÁ§∫ËØç]Êï∞ÊçÆ', type: 'DeletePromptsData'
						localStorage.removeItem('promptsData');
						//Ê†πÊçÆÂèòÈáèÂàóË°®ÂíåÈªòËÆ§ÂÄº ËøòÂéüÈªòËÆ§ÂèòÈáè
						this.setVariablesToThis(this.promptsData_default, this.promptsData_default, true);
						//‰øùÂ≠òÊèêÁ§∫ËØçÊåâÈíÆ ËÆæ‰∏∫ÂèØÁî® *ÈíàÂØπ‰πãÂâç‰øùÂ≠òËøáÁ≥ªÁªüÊèêÁ§∫ËØçÁöÑÊÉÖÂÜµÔºå‰øùÂ≠òÂêéÂèò‰∏∫‰∏çÂèØÁî®„ÄÇÊ≠§Êó∂ÊåâÈíÆÈúÄË¶ÅÂèò‰∏∫ÂèØÁî®
						this.btnDisabledState_SetSystemPrompt = false;
						notif = this.settingsLanguage == 'cn' ? 'Â∑≤Âà†Èô§ÊèêÁ§∫ËØçÊï∞ÊçÆ' : 'Prompts data has been deleted' ;
					}else if(typeStr === 'DeleteUploadedUserAvatar'){
					//'5) Âà†Èô§[‰∏ä‰º†ÁöÑÁî®Êà∑Â§¥ÂÉè]', type: 'DeleteUploadedUserAvatar'
						this.userAvatarUp_base64 = ''; //Ê∏ÖÁ©∫
						this.userAvatarUp_blob = null; //Ê∏ÖÁ©∫
						this.userAvatarUp_blobUrl = ''; //Ê∏ÖÁ©∫
						this.inputUserImageUrl = 'https://kimi.xinu.ink/top.JPG'; //ÊÅ¢Â§çÈªòËÆ§Â§¥ÂÉèurl
						this.updateAvatar('user', false);//Âà∑Êñ∞Â§¥ÂÉè false=Don't show notif.
						this.localStorage_SaveData(null,'userSettings');//‰øùÂ≠ò Êõ¥Êñ∞localStorage
						notif = this.settingsLanguage == 'cn' ? 'Â∑≤Âà†Èô§‰∏ä‰º†ÁöÑÁî®Êà∑Â§¥ÂÉè' : 'Uploaded user avatar have been deleted' ;
					}else if(typeStr === 'DeleteSettingsData'){
					//'6) Âà†Èô§[ËÆæÁΩÆ]Êï∞ÊçÆ', type: 'DeleteSettingsData'
						//userÂ§¥ÂÉèÊÅ¢Â§çÈªòËÆ§ Âà†Èô§ÂèØËÉΩÂ≠òÂú®ÁöÑ‰∏ä‰º†ÁöÑÁî®Êà∑Â§¥ÂÉèÊï∞ÊçÆ
						this.userAvatarUp_base64 = ''; //Ê∏ÖÁ©∫
						this.userAvatarUp_blob = null; //Ê∏ÖÁ©∫
						this.userAvatarUp_blobUrl = ''; //Ê∏ÖÁ©∫
						this.inputUserImageUrl = 'https://kimi.xinu.ink/top.JPG'; //ÊÅ¢Â§çÈªòËÆ§Â§¥ÂÉèurl
						this.updateAvatar('user', false);//Âà∑Êñ∞Â§¥ÂÉè false=Don't show notif.
						//gptÂ§¥ÂÉèÊÅ¢Â§çÈªòËÆ§
						this.inputGPTImageUrl = this.settingsLanguage == 'cn' ? this.GPTGreenSVG_UrlText_cn : this.GPTGreenSVG_UrlText_en;
						this.updateAvatar('gpt', false);
						
						//Âà†Èô§localStorage
						localStorage.removeItem('userSettings');
						//Ê†πÊçÆÂèòÈáèÂàóË°®ÂíåÈªòËÆ§ÂÄº ËøòÂéüÈªòËÆ§ÂèòÈáè
						this.setVariablesToThis(this.userVariables_default, this.userVariables_default, true);
						
						//Êõ¥Êñ∞ËæìÂÖ•Ê°Ü„ÄÅ‰∏ãÊãâÊ°Ü
						this.inputApiURL = this.apiURL;
						this.selectedApiURL = this.inputApiURL;
						
						//ËøòÂéüÈªòËÆ§ÂèòÈáèÂêéÁöÑÊìç‰Ωú ÂèÇËÄÉ[ÊÅ¢Â§çÈªòËÆ§restoreDefault]‰∏≠ÁöÑÊ≠•È™§
						this.openSmartMaxTokens = true; //ÈªòËÆ§ÂºÄÂêØÔºålocalStorageÊó†Ê≠§ÂèòÈáè
						this.changePageScaling(false);//ÈúÄË¶ÅÂú®changeSimpleMode‰πãÂâç
						this.changeLanguage();
						this.changeSimpleMode(false);

						this.inputapichange(false); // ÈáçÊñ∞È™åËØÅAPI KeyÊó∂ ÊîπÂèòÊåâÈíÆÁ≠âÁä∂ÊÄÅ
						this.btnDisabledState_SaveApiURL = true; //‰øùÂ≠òÊåâÈíÆÁä∂ÊÄÅÊîπ‰∏∫‰∏çÂèØÁî®

						this.changeStyle_FontSize();
						this.changeStyle_Time_WechatStyle();
						this.changeStyle_Time();
						this.changeStyle_DividerLine();
						//this.changeContextualMode();
						
						
						//Êó†ÈúÄ‰øùÂ≠ò
						
						//ÈÄöÁü•
						notif = this.settingsLanguage == 'cn' ? 'Â∑≤Âà†Èô§ËÆæÁΩÆÊï∞ÊçÆ' : 'Settings data has been deleted' ;
					}
					
					setTimeout(() => {
						this.showNotification(notif, 'bottom','',notiftime);
					}, delaytime);
				}catch (e) {
					notif = this.settingsLanguage == 'cn' ? 'Âá∫Èîô‰∫Ü\r\n\r\nÈîôËØØ‰ø°ÊÅØÔºö' + e.message : 'Error\r\n\r\nError Message: ' + e.message ;
					this.showNotification(notif, 'center','Error - changeSelectedDeleteLocalStorageData()');
					console.error('changeSelectedDeleteLocalStorageData() - Âà†Èô§Êï∞ÊçÆ',e);
				}
				
			},
			
			// ËÆæÁΩÆÁ™óÂè£ - Êï∞ÊçÆÁÆ°ÁêÜData Management ÁºìÂ≠òlocalStorage ÂØºÂá∫Êï∞ÊçÆ Export JSON
			changeSelectedExportLocalStorageData(){
				if (this.checkBusyStatus('ForChat')) {
					this.selectedExportLocalStorageData = ''; //Â§çÂéü
					//Â∫ïÈÉ®‰ºöÂá∫Áé∞ÈÄöÁü•tooltips„ÄÇ Â¶ÇÊûúËøîÂõû trueÔºå Ê≠£Âú®ÂèëÈÄÅ Êàñ Ê≠£Âú®È™åËØÅ Êàñ Ê≠£Âú®Ê†áÁ≠æÈ°µÈó¥ÂêåÊ≠•Êï∞ÊçÆ
					return;
				}
				if(!this.isLocalStorageSupported){
					//ÊµèËßàÂô®ÂΩìÂâç‰∏çÊîØÊåÅlocalStorageÊó∂
					return;//Â∑≤ÁªëÂÆöÁ¶ÅÁî®ÊåâÈíÆ
				}
				if(!this.isLocalStorageAllowed){
					//‰∏çÂÖÅËÆ∏ÁºìÂ≠òÊó∂
					//‰∏¥Êó∂Á¶ÅÊ≠¢ÔºåÂèØËÉΩÂ≠òÂú®ÂéÜÂè≤Êï∞ÊçÆÔºåÂÖÅËÆ∏ÂØºÂá∫ return;
				}
				
				let notif = '';
				let typeStr = this.selectedExportLocalStorageData;
				this.selectedExportLocalStorageData = ''; //Â§çÂéü
				
				try{
					//1 ÂÖà‰øùÂ≠ò‰∏ÄÊ¨°  ‰øùÂ≠òÊâÄÊúâÊï∞ÊçÆ
					this.localStorage_SaveData(null,null);
					
				//2 Á¨¨‰∫åÊ¨°‰øùÂ≠ò  ÂèØËÉΩ‰ºöÂá∫Áé∞‚ÄúÂêåÊ≠•‚ÄùÔºåÂä†‰∏™Âª∂ËøüÂÜç‰øùÂ≠ò‰∏ÄÊ¨°
				setTimeout(() => {
					//2 Á¨¨‰∫åÊ¨°‰øùÂ≠òÊâÄÊúâÊï∞ÊçÆ
					this.localStorage_SaveData(null,null);
					let dataString = '';
					let fileName = this.exportJSONFileName ;
					let dataObject = {};
					
					if(typeStr === 'ExportAllData'){
					//'1) ‰∏ÄÈîÆÂØºÂá∫ÊâÄÊúâÊï∞ÊçÆ
						notif = this.settingsLanguage == 'cn' ? 'Ê≠£Âú®ÂØºÂá∫JSONÊñá‰ª∂ - ÊâÄÊúâÊï∞ÊçÆ' : 'Exporting JSON file - All Data' ;
				
						//Ëé∑ÂèñÊâÄÊúâMCGPTÁõ∏ÂÖ≥ÁöÑÊï∞ÊçÆÔºåÁõÆÂâçÊúâ4‰∏™key
						const includedKeys = ["userSettings", "chatDataList", "apikeyData", "promptsData"];
						includedKeys.forEach(function(key) {
							const value = localStorage.getItem(key);
							if (value !== null && value !== undefined) {
								dataObject[key] = JSON.parse(value);
							}
						});
						
						if (Object.keys(dataObject).length == 0){ //Á©∫
							notif = this.settingsLanguage == 'cn' ? 'ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®(localStorage) - Êï∞ÊçÆ‰∏∫Á©∫Ôºå‰∏≠Ê≠¢ÂØºÂá∫' : "No data available for export in the browser's local storage." ;
							this.showNotification(notif, 'bottom','',5500);
							return;
						}
						fileName += 'AllData';//Êñá‰ª∂Âêç

					}else if(typeStr === 'ExportChatDataList'){
					//'2) ÂØºÂá∫[ÂØπËØù]Êï∞ÊçÆ
						notif = this.settingsLanguage == 'cn' ? 'Ê≠£Âú®ÂØºÂá∫JSONÊñá‰ª∂ - ÊâÄÊúâÂØπËØùÊï∞ÊçÆ' : 'Exporting JSON file - All Chat Data' ;
						const data_chatDataList = localStorage.getItem('chatDataList');//Ëé∑ÂèñÊï∞ÊçÆ
						if(data_chatDataList == null){
							notif = this.settingsLanguage == 'cn' ? 'ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®(localStorage) - Êó†ÂØπËØùÊï∞ÊçÆÔºå‰∏≠Ê≠¢ÂØºÂá∫' : "No Chat Data available for export in the browser's local storage." ;
							this.showNotification(notif, 'bottom','',5500);
							return;
						}
						dataObject['chatDataList'] = JSON.parse(data_chatDataList);
						fileName += 'AllChatData'; //Êñá‰ª∂Âêç
					}else if(typeStr === 'ExportAPIKeyData'){
					//'3) ÂØºÂá∫[ÂØÜÈí•/API Key]Êï∞ÊçÆ
						notif = this.settingsLanguage == 'cn' ? 'Ê≠£Âú®ÂØºÂá∫JSONÊñá‰ª∂ - ÂØÜÈí•/API KeyÊï∞ÊçÆ' : 'Exporting JSON file - API Keys Data' ;
						const data_apikeyData = localStorage.getItem('apikeyData');//Ëé∑ÂèñÊï∞ÊçÆ
						const apikeydata_obj = JSON.parse(data_apikeyData);
						if(data_apikeyData == null || apikeydata_obj == null || (  apikeydata_obj.api === '' &&  (apikeydata_obj.apiCheckedData == null || apikeydata_obj.apiCheckedData.length === 0)  )){
							notif = this.settingsLanguage == 'cn' ? 'ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®(localStorage) - Êó†ÂØÜÈí•/API KeyÊï∞ÊçÆÔºå‰∏≠Ê≠¢ÂØºÂá∫' : "No API Keys Data available for export in the browser's local storage." ;
							this.showNotification(notif, 'bottom','',5500);
							return;
						}
						dataObject['apikeyData'] = JSON.parse(data_apikeyData);
						fileName += 'APIKeyData'; //Êñá‰ª∂Âêç
					}else if(typeStr === 'ExportPromptsData'){
					//'4) ÂØºÂá∫[ÊèêÁ§∫ËØç]Êï∞ÊçÆ'
						notif = this.settingsLanguage == 'cn' ? 'Ê≠£Âú®ÂØºÂá∫JSONÊñá‰ª∂ - ÊèêÁ§∫ËØçÊï∞ÊçÆ' : 'Exporting JSON file - Prompt Generator Data' ;
						const data_promptsData = localStorage.getItem('promptsData');//Ëé∑ÂèñÊï∞ÊçÆ
						if(data_promptsData == null){
							notif = this.settingsLanguage == 'cn' ? 'ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®(localStorage) - Êó†ÊèêÁ§∫ËØçÊï∞ÊçÆÔºå‰∏≠Ê≠¢ÂØºÂá∫' : "No Prompt Generator Data available for export in the browser's local storage." ;
							this.showNotification(notif, 'bottom','',5500);
							return;
						}
						dataObject['promptsData'] = JSON.parse(data_promptsData);
						fileName += 'PromptsData'; //Êñá‰ª∂Âêç
					}else if(typeStr === 'ExportSettingsData'){
					//'5) ÂØºÂá∫[ËÆæÁΩÆ]Êï∞ÊçÆ'
						notif = this.settingsLanguage == 'cn' ? 'Ê≠£Âú®ÂØºÂá∫JSONÊñá‰ª∂ - ËÆæÁΩÆÊï∞ÊçÆ' : 'Exporting JSON file - Settings Data' ;
						const data_userSettings = localStorage.getItem('userSettings');//Ëé∑ÂèñÊï∞ÊçÆ
						if(data_userSettings == null){
							notif = this.settingsLanguage == 'cn' ? 'ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®(localStorage) - Êó†ËÆæÁΩÆÊï∞ÊçÆÔºå‰∏≠Ê≠¢ÂØºÂá∫' : "No Settings Data available for export in the browser's local storage." ;
							this.showNotification(notif, 'bottom','',5500);
							return;
						}
						dataObject['userSettings'] = JSON.parse(data_userSettings);
						fileName += 'SettingsData'; //Êñá‰ª∂Âêç
					}
					
					this.showNotification(notif, 'bottom','',4000);
					//ËΩ¨Â≠óÁ¨¶‰∏≤
					dataString = JSON.stringify(dataObject); 
					//ÂØºÂá∫
					this.ExportData_JSON(dataString, fileName);
				}, 150);//Á¨¨‰∫åÊ¨°‰øùÂ≠òÔºåÂª∂Ëøü‰øùÂ≠ò
				}catch (e) {
					notif = this.settingsLanguage == 'cn' ? 'Âá∫Èîô‰∫Ü\r\n\r\nÈîôËØØ‰ø°ÊÅØÔºö' + e.message : 'Error\r\n\r\nError Message: ' + e.message ;
					this.showNotification(notif, 'center','Error - changeSelectedExportLocalStorageData()');
					console.error('changeSelectedExportLocalStorageData() - ÂØºÂá∫Êï∞ÊçÆ',e);
				}
				
			},
			
			// ËÆæÁΩÆÁ™óÂè£ - Êï∞ÊçÆÁÆ°ÁêÜData Management ÁºìÂ≠òlocalStorage ÂØºÂÖ•Êï∞ÊçÆ Import JSON
			importLocalStorageData(){
				if (this.checkBusyStatus('ForChat')) {
					//Â∫ïÈÉ®‰ºöÂá∫Áé∞ÈÄöÁü•tooltips„ÄÇ Â¶ÇÊûúËøîÂõû trueÔºå Ê≠£Âú®ÂèëÈÄÅ Êàñ Ê≠£Âú®È™åËØÅ Êàñ Ê≠£Âú®Ê†áÁ≠æÈ°µÈó¥ÂêåÊ≠•Êï∞ÊçÆ
					return;
				}
				let notif = '';
				let notiftime = 2500; //ÈÄöÁü•ÊòæÁ§∫ÁöÑÊó∂Èó¥
				let delaytime = 0;//Âª∂ËøüÊó∂Èó¥
				const temp_settingsLanguage = this.settingsLanguage; //ÊÅ¢Â§çËÆæÁΩÆÂèØËÉΩ‰ºöÂØºËá¥ÈÄöÁü•Ê∂àÊÅØ‰∏≠Âá∫Áé∞‰∏§ÁßçËØ≠Ë®ÄÔºåÂõ∫ÂÆö‰∏∫ÊÅ¢Â§çËÆæÁΩÆÂâçÁöÑËØ≠Ë®Ä
				if(!this.isLocalStorageSupported){
					//ÊµèËßàÂô®ÂΩìÂâç‰∏çÊîØÊåÅlocalStorageÊó∂
					notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÊµèËßàÂô®ÊàñÊµèËßàÂô®Ê®°Âºè‰∏çÊîØÊåÅÊú¨Âú∞Â≠òÂÇ®(localStorage)ÂäüËÉΩ' : 'The browser or browser mode does not support local storage.' ;
				}
				if(!this.isLocalStorageAllowed){
					//‰∏çÂÖÅËÆ∏ÁºìÂ≠òÊó∂
					notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®Â∑≤Ë¢´Á¶ÅÁî®ÔºåÂØºÂÖ•ÂäüËÉΩ‰∏çÂèØÁî®' : "The browser's local storage has been disabled and cannot be imported." ;
				}
				if (notif !== ''){
					this.showNotification(notif, 'bottom', '', 3500);
					return;
				}
				notif = '';
				
				try{
					//1 ÂÖà‰øùÂ≠ò‰∏ÄÊ¨°  ‰øùÂ≠òÊâÄÊúâÊï∞ÊçÆ
					this.localStorage_SaveData(null,null);
					
				//2 Á¨¨‰∫åÊ¨°‰øùÂ≠ò  ÂèØËÉΩ‰ºöÂá∫Áé∞‚ÄúÂêåÊ≠•‚ÄùÔºåÂä†‰∏™Âª∂ËøüÂÜç‰øùÂ≠ò‰∏ÄÊ¨°
				setTimeout(() => {
					//2 Á¨¨‰∫åÊ¨°‰øùÂ≠òÊâÄÊúâÊï∞ÊçÆ
					this.localStorage_SaveData(null,null);
					
					const isInputExit = document.getElementById('inputFileImportData'); 
					const dialogSettings = document.getElementById("dialog-settings");
					
					if (isInputExit){ //Èò≤Ê≠¢‰πãÂâçÊ≤°Âà†ÊàêÂäü
						isInputExit.onchange = null;
						dialogSettings.removeChild(isInputExit);//ÁßªÈô§
					}
					
					let fileInput = document.createElement('input');//Êñ∞Âª∫ÂØºÂÖ•Êéß‰ª∂
					fileInput.type = 'file';
					fileInput.accept = '.json';
					fileInput.style.display = 'none';
					fileInput.id = 'inputFileImportData';
					//Ê∑ªÂä†Êéß‰ª∂
					dialogSettings.appendChild(fileInput);
					//ÈÄâÂèñÊñá‰ª∂Âêé change‰∫ã‰ª∂
					fileInput.onchange = (e) => { 
						//ÈÄâÂèñÁªìÊûú
						let file = e.target.files[0];
						//Â¶ÇÊûúÊúâÈÄâÂèñÊñá‰ª∂
						if (file) {
							let reader = new FileReader();
							//Start. ËØªÂèñ‰∫ã‰ª∂
							reader.onload = (event) => {
							  try{
								var contentsJSON = event.target.result;
								let dataObject = JSON.parse(contentsJSON);
								//ÈîôËØØ Êñá‰ª∂ÈîôËØØ Ê†ºÂºèÈîôËØØ
								if ( dataObject === null || typeof dataObject === 'undefined' || typeof dataObject !== 'object') {
									notif = this.settingsLanguage == 'cn' ? 'Êñá‰ª∂ÈîôËØØÔºåÈùûMCGPTÁöÑÊï∞ÊçÆÊñá‰ª∂' : 'File error, not a data file for MCGPT' ;
									this.showNotification(notif, 'bottom','',6000);
									return;
								}
								//ÈîôËØØ Êó†ÊúâÊïàÊï∞ÊçÆ
								if ( !dataObject.hasOwnProperty('chatDataList') && !dataObject.hasOwnProperty('apikeyData') && !dataObject.hasOwnProperty('promptsData') && !dataObject.hasOwnProperty('userSettings') ) {
									notif = this.settingsLanguage == 'cn' ? 'Êñá‰ª∂ÈîôËØØÔºåÊú™ÂåÖÂê´MCGPTÊï∞ÊçÆ' : 'File error, does not contain MCGPT data' ;
									this.showNotification(notif, 'bottom','',6000);
									return;
								}
								
								notif = temp_settingsLanguage == 'cn' ? 'ÂØºÂÖ•ÁöÑÊï∞ÊçÆÊ∏ÖÂçïÔºö' : 'Imported data list:' ;
								
								//Âê´ÊúâchatDataListÊï∞ÊçÆ *Êï∞ÊçÆ‰ºöÂêàÂπ∂
								if(dataObject.hasOwnProperty('chatDataList')){
									let newChatDataList = dataObject['chatDataList'];
									let newChatDataCount = 0;
									let duplicateChatDataCount = 0;
									let partiallyDuplicateChatDataCount = 0;
									let nonDuplicateChatDataCount = 0;
										
									newChatDataList.forEach(newChatData => {
										let isDuplicate = false;
										let renamedChatCreatedTime = newChatData['chatcreatedtime'];
										let renamedChatID = newChatData['chatid'];
  
										this.chatDataList.forEach(existingChatData => {
											if (existingChatData['chatcreatedtime'] === newChatData['chatcreatedtime']) {
												// Check if the chat data objects are the same
												if (JSON.stringify(existingChatData) === JSON.stringify(newChatData)) {
													isDuplicate = true;
													duplicateChatDataCount++;
													return;
												}
												// Rename the chatcreatedtime for the new chat data
												renamedChatCreatedTime = this.newChatCreatedTime_ForCopyChatData(newChatData);//ÁîüÊàêÊñ∞ÁöÑchatcreatedtime
												renamedChatID += this.settingsLanguage == 'cn' ? ' ÂâØÊú¨[ÂØºÂÖ•ÂÜ≤Á™Å]' : ' Copy [Import Conflict]' ;
												//chatlasttime ‰øùÊåÅ‰∏çÂèòÔºå‰∏ç‰øÆÊîπ
												partiallyDuplicateChatDataCount++;
											}
										});
  
										if (!isDuplicate) {
											newChatData['chatcreatedtime'] = renamedChatCreatedTime;
											newChatData['chatid'] = renamedChatID;
											this.chatDataList.push(newChatData);
											nonDuplicateChatDataCount++;
										}
										
										newChatDataCount++;
									});
									nonDuplicateChatDataCount = nonDuplicateChatDataCount - partiallyDuplicateChatDataCount;//‰øÆÊ≠£
									//console.log("New chat data count:", newChatDataCount);
									//console.log("Duplicate chat data count:", duplicateChatDataCount);
									//console.log("Partially duplicate chat data count:", partiallyDuplicateChatDataCount);
									//console.log("Non-duplicate chat data count:", nonDuplicateChatDataCount);
									
									//‰øùÂ≠òÊï¥‰∏™List
									if(this.isLocalStorageAllowed && this.isLocalStorageSupported){
										localStorage.setItem('chatDataList', JSON.stringify(this.chatDataList));
									}
									const list_notif_cn = '\r\n\r\n  ‚Ä¢ ÂØπËØùÊï∞ÊçÆ: OKÔºåÂØºÂÖ•ÂÆåÊàêÔºåÊï∞ÊçÆÂ∑≤ÂêàÂπ∂„ÄÇJSONÊñá‰ª∂ÂåÖÂê´ÂØπËØùËÆ∞ÂΩï ' + newChatDataCount + ' Êù°ÔºåÂÖ∂‰∏≠ÔºöÂÖ®Êñ∞ÁöÑÂØπËØù ' + nonDuplicateChatDataCount + ' Êù°ÔºõÂ∑≤Â≠òÂú®ÁöÑÂØπËØù(ÂÆåÂÖ®‰∏ÄËá¥) ' + duplicateChatDataCount + ' Êù°ÔºõÂÜÖÂÆπÂÜ≤Á™ÅÁöÑÂØπËØù(Â≠òÂú®Â∑ÆÂºÇ) ' + partiallyDuplicateChatDataCount + ' Êù°„ÄÇ';
									const list_notif_en = '\r\n\r\n  ‚Ä¢ Chat Data: OK, import successful, the data has been merged.  The JSON file contains ' + newChatDataCount + ' chat entries: ' + nonDuplicateChatDataCount + ' new entries, ' + duplicateChatDataCount + ' existing entries, and ' + partiallyDuplicateChatDataCount + ' conflicting entries.';
									notif += temp_settingsLanguage == 'cn' ? list_notif_cn : list_notif_en;
								}
								//Âê´ÊúâapikeyDataÊï∞ÊçÆ *Êï∞ÊçÆ‰ºöÂêàÂπ∂
								if(dataObject.hasOwnProperty('apikeyData')){
									let new_apikeyData = dataObject['apikeyData'];//Âè™ÂèñÂÖ∂‰∏≠ÁöÑapiCheckedDataÊï∞ÊçÆ
									//ÂØºÂÖ•ÁöÑÂ∑≤È™åËØÅÁöÑapikeyÊï∞ÁªÑÊï∞ÊçÆ apiCheckedData
									let new_apiCheckedData = new_apikeyData == null ? [] : new_apikeyData.apiCheckedData;
									new_apiCheckedData = new_apiCheckedData == null ? [] : new_apiCheckedData; //new_apikeyData.apiCheckedDataÂèØËÉΩ‰∏∫nullÔºàÊàñË¢´ÁºñËæëËøáËÄå‰∫ßÁîüÈîôËØØÔºâ
									new_apiCheckedData = new_apiCheckedData.filter(apidata => apidata.apikey && apidata.apikey.trim() !== '');//ÊéíÈô§Á©∫È°πÔºåÂ∞§ÂÖ∂ÊòØ1.7.05ÁâàÊú¨ÁöÑÊï∞ÊçÆ
													
									// Âæ™ÁéØnew_apiCheckedData È™åËØÅÊï∞ÊçÆ & ÂÖºÂÆπÊÄßÂ§ÑÁêÜ
									//Âà§Êñ≠Â±ûÊÄßÊòØÂê¶Â≠òÂú®‰∏îÊï∞ÊçÆÊòØÂê¶ÂêàÊ≥ïÔºåÂ¶ÇÊûúÁº∫Â∞ëÂ±ûÊÄß Êàñ Â±ûÊÄßÊï∞ÊçÆ‰∏çÂêàÊ≥ïÔºåÂ∞±Ë°•‰∏äÂ±ûÊÄßÂíåÈªòËÆ§ÂÄº
									this.validateApiCheckedData(new_apiCheckedData);
									

									// ÂêàÂπ∂Êõ¥Êñ∞Êï∞ÊçÆÂà∞this.apiCheckedData
									const newData = this.apiCheckedData.filter(apidata => apidata.apikey && apidata.apikey.trim() !== '');//ÊéíÈô§Á©∫È°π

									//Êï∞ÊçÆÁªüËÆ°
									let updatedApiCount = 0;//Â≠òÂú®-ËæÉÊñ∞Êï∞ÊçÆ-Ë¶ÜÁõñ
									let notUpdatedApiCount = 0;//Â≠òÂú®-ËæÉÊóßÊï∞ÊçÆ-‰∏çË¶ÜÁõñ
									let newApiCount = 0;//‰∏çÂ≠òÂú®-Êñ∞Â¢û
									let existingApiCount = 0;//Â∑≤Â≠òÂú®

									//Êõ¥Êñ∞Â∑ÆÂºÇÊï∞ÊçÆÔºå Êñ∞Â¢û Êàñ Êõ¥Êñ∞
									new_apiCheckedData.forEach(apidata => {
										//‰∏∫‰∫Ü‰øùËØÅÊàêÂäüÁéáÁöÑÂáÜÁ°ÆÂ∫¶ÂíåÂÆûÊïàÊÄßÔºåÂêàÂπ∂Êó∂ÈúÄË¶Å‰øÆÊîπÊàêÂäüÊ¨°Êï∞ ‰∏é Â§±Ë¥•Ê¨°Êï∞   
										//*Â¶ÇÊûúÊï∞Â≠óÂæàÂ§ßÔºåÂØºÂÖ•ÂêéÊàêÂäüÁéáÂæàÈöæÂèòÂåñ„ÄÇÊâÄ‰ª•ÂêàÂπ∂Êó∂ÈôêÂà∂ÊàêÂäüÊ¨°Êï∞/Â§±Ë¥•Ê¨°Êï∞ÊúÄÈ´ò‰∏∫20Ê¨°ÔºåÂØºÂÖ•ÂêéÔºåÊàêÂäüÁéá‰ºöÊ†πÊçÆÂÆûÈôÖÁöÑ‰ΩøÁî®ÊÉÖÂÜµÂø´ÈÄüÂèòÂåñ
										//ÂΩì apidata.succcount Êàñ apidata.failcount Â§ß‰∫é 20 Êó∂ÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÂÆÉ‰ª¨ÁöÑÂÄºÊåâÊØî‰æãÁº©Â∞èÂà∞ 20 ‰ª•ÂÜÖ
										if (apidata.succcount > 20 || apidata.failcount > 20) {
											const maxCount = Math.max(apidata.succcount, apidata.failcount);
											const scaleFactor = maxCount / 20;
											apidata.succcount = Math.ceil(apidata.succcount / scaleFactor);
											apidata.failcount = Math.ceil(apidata.failcount / scaleFactor);
										}
										
										
										const existingApiIndex = newData.findIndex(api => api.apikey === apidata.apikey);
										if (existingApiIndex !== -1) {//Â≠òÂú® - Êõ¥Êñ∞
											const existingApi = newData[existingApiIndex];
											// ÊØîËæÉupdatetimeÔºå‰ª•Êõ¥Êñ∞ÊúÄÊñ∞ÁöÑÊï∞ÊçÆ
											if (apidata.updatetime > existingApi.updatetime) {
												newData[existingApiIndex] = apidata;
												updatedApiCount++;//Ë¶ÜÁõñ ÁªüËÆ°
											}else{
												notUpdatedApiCount++;//‰∏çË¶ÜÁõñ ÁªüËÆ°
											}
										} else {//‰∏çÂ≠òÂú® - Êñ∞Â¢û
											newData.push(apidata);
											newApiCount++;//Êñ∞Â¢û ÁªüËÆ°
										}
									});
									this.apiCheckedData = newData;
									existingApiCount = (updatedApiCount + notUpdatedApiCount);
				
									//console.log("ÂØºÂÖ•ÁöÑÊï∞Èáè: " + new_apiCheckedData.length);
									//console.log("Â∑≤Â≠òÂú®ÁöÑÊï∞Èáè: " + existingApiCount);
									//console.log("Â∑≤Â≠òÂú® - Ë¶ÜÁõñÊõ¥Êñ∞ÁöÑÊï∞Èáè: " + updatedApiCount);
									//console.log("Â∑≤Â≠òÂú® - Êú™Ë¶ÜÁõñÁöÑÊï∞Èáè: " + notUpdatedApiCount);
									//console.log("Êñ∞Â¢ûÁöÑÊï∞Èáè: " + newApiCount);
									
									const apikeyData = this.getVariablesFromThis(this.apikeyData_default);
									//ÊâãÂä®Â¢ûÂä†ÁâàÊú¨
									apikeyData.version = this.apikeyData_Version; 
									//ÂÖà‰øùÂ≠ò‰∏ÄÊ¨°
									localStorage.setItem('apikeyData', JSON.stringify(apikeyData)); 
									
									if(!this.btnDisabledState_CheckAPI){ //Â¶ÇÊûúÂΩìÂâçÊòØ‚ÄúÊú™ÈÄöËøáÈ™åËØÅ‚ÄùÁöÑÁä∂ÊÄÅ
										const temp_apidataArray = this.apiCheckedData.filter(apidata => apidata.vpn === 'third-party' && apidata.apiurl.toLowerCase() === this.apiURL.toLowerCase());
										// OpenAI Key || (Á¨¨‰∏âÊñπÂçïKeyÊ®°Âºè Third-party Key mode  && Â≠òÂú®ÂèØÁî®ÁöÑKey )  Âç≥ÊéíÈô§Á¨¨‰∏âÊñπÊó†ÂèØÁî®KeyÁöÑÊÉÖÂÜµÔºåÂéüÂõ†ÔºöÁ¨¨‰∏âÊñπÊ®°ÂºèÊó†ÂèØÁî®KeyÊó∂Ôºå‰ºöÂºπÁ™ó+Â∫ïÈÉ®ÈÄöÁü•Ôºå‰ΩìÈ™å‰∏çÂ•Ω
										if(!this.isThirdPartyAPIKeyEnabled || (this.isThirdPartyAPIKeyEnabled && temp_apidataArray.length > 0) ){ 
											//ÊÅ¢Â§çapikeyÂà∞ËæìÂÖ•Ê°ÜÔºåÂπ∂ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
											this.restoreApiKeyInput(false,false);
										}
									}
									
									const apikey_notif_cn = '\r\n\r\n  ‚Ä¢ ÂØÜÈí•/API KeyÊï∞ÊçÆ: OKÔºåÂØºÂÖ•ÂÆåÊàêÔºåÊï∞ÊçÆÂ∑≤ÂêàÂπ∂ÔºåÂ∞ÜËá™Âä®ËΩÆÊç¢API Key„ÄÇJSONÊñá‰ª∂ÂåÖÂê´API KeyÊï∞Èáè ' + new_apiCheckedData.length + ' ‰∏™ÔºåÂÖ∂‰∏≠ÔºöÊñ∞ÁöÑ ' + newApiCount + ' ‰∏™ÔºõÂ∑≤Â≠òÂú®ÁöÑ ' + existingApiCount + ' ‰∏™ (Êõ¥Êñ∞ËæÉÊñ∞‰ΩøÁî®Êó•ÊúüÁöÑ ' + updatedApiCount + ' ‰∏™ÔºåÊó†ÈúÄÊõ¥Êñ∞ÁöÑ ' + notUpdatedApiCount + ' ‰∏™)„ÄÇ';
									const apikey_notif_en = '\r\n\r\n  ‚Ä¢ API Keys Data: OK, import successful, the data has been merged. Additionally, the API Keys will be automatically rotated.  The JSON file contains ' + new_apiCheckedData.length + ' API Keys: ' + newApiCount + ' new keys; ' + existingApiCount + ' existing keys (updated ' + updatedApiCount + ' data with newer usage dates and ' + notUpdatedApiCount + ' do not require updates).';
									notif += temp_settingsLanguage == 'cn' ? apikey_notif_cn : apikey_notif_en;
									
								}
								//Âê´ÊúâpromptsDataÊï∞ÊçÆ *Êï∞ÊçÆ‰ºöÂêàÂπ∂
								if(dataObject.hasOwnProperty('promptsData')){
									notif += temp_settingsLanguage == 'cn' ? '\r\n\r\n  ‚Ä¢ ÊèêÁ§∫ËØçÊï∞ÊçÆ: ÊöÇ‰∏çÊîØÊåÅÂØºÂÖ•' : '\r\n\r\n  ‚Ä¢ Prompt Generator Data: Import is not supported at the moment, under development.';
									//1111111111
								}
								//Âê´ÊúâuserSettingsÊï∞ÊçÆ *Êï∞ÊçÆ‰∏ç‰ºöÂêàÂπ∂ÔºåÂè™‰ºöË¶ÜÁõñ
								if(dataObject.hasOwnProperty('userSettings')){
									// ËøòÂéüÁî®Êà∑ËÆæÁΩÆÊï∞ÊçÆ userSettings
									this.islocalStorageFirstLoad = true;//open  *RestoreData_userSettings‰∏≠ÊúâÊ≠§ÂºÄÂÖ≥
									this.RestoreData_userSettings(dataObject['userSettings']);//ËøòÂéü
									this.islocalStorageFirstLoad = false;//close
									
									notif += temp_settingsLanguage == 'cn' ? '\r\n\r\n  ‚Ä¢ ËÆæÁΩÆÊï∞ÊçÆ: OKÔºåÂØºÂÖ•ÂÆåÊàêÔºåÂ∑≤Êõ¥Êñ∞‰∏∫Êñ∞ÁöÑËÆæÁΩÆ' : '\r\n\r\n  ‚Ä¢ Settings Data: OK, import successful, the data has been replaced with new settings.';
								}
								
								//‰øùÂ≠ò Âà∑Êñ∞ËÆæÁΩÆÂèÇÊï∞
								setTimeout(() => {
									//‰øùÂ≠ò ‰øùÂ≠òÊâÄÊúâÊï∞ÊçÆ
									this.localStorage_SaveData(null,null);
									//Ê∂âÂèäÂà∞ËÆæÁΩÆÂèÇÊï∞ÁöÑÂèòÂåñÔºåÈáçÊñ∞ËØªÂèñ‰∏ÄÊ¨°Ôºå‰ºöÂ∫îÁî®ËÆæÁΩÆÂèÇÊï∞
									const chat_Data = this.chatDataList.find(c => c.chatcreatedtime === this.chatcreatedtime);
									this.loadChatData(chat_Data);//ËØªÂèñ
									
									this.changePageScaling(false);//ÈúÄË¶ÅÂú®changeSimpleMode‰πãÂâç
									this.changeLanguage();
									this.changeSimpleMode(false);
									//ÂÖ∂‰ªñËØªÂèñÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
									this.$nextTick(() => {
										// 1 2 3 4 5
										this.todoList_ChatDataRestored('hasdata');
									});
								}, 0);
								//ÈÄöÁü•
								const title = temp_settingsLanguage == 'cn' ? 'ÂØºÂÖ•Êä•Âëä' : 'Import Report' ;
								setTimeout(() => {
									this.showNotification(notif, 'center',title);
								}, 650);
							  }catch (e) { //reader.onload = (event) => 
									const e_message = e.message ? e.message : '';
									const e_name = e.name ? e.name : '';
									if( !this.localStorageExceedsMaximum(e_message,e_name)){ //ÂÖàÂà§Êñ≠ÊòØÂê¶Êú¨Âú∞Â≠òÂÇ®Êª°‰∫Ü Determining if it is due to running out of local storage capacity
										notif = this.settingsLanguage == 'cn' ? 'Âá∫Èîô‰∫Ü\r\n\r\nÈîôËØØ‰ø°ÊÅØÔºö' + e.message : 'Error\r\n\r\nError Message: ' + e.message ;
										this.showNotification(notif, 'center','Err - { reader.onload = (event) => }');
										console.error('importLocalStorageData() - reader.onload = (event) => ‰∫ã‰ª∂',e);
									}else{
									//ÊèêÈÜíÁî®Êà∑ Â≠òÂÇ®Á©∫Èó¥Áî®Èáè Âèä Êñá‰ª∂Â§ßÂ∞è 
										let localStorageSize_A = null; //ÊâÄÊúâÊú¨Âú∞Êï∞ÊçÆ ÁÆóÊ≥ïA
										let localStorageSize_B = null; //ÊâÄÊúâÊú¨Âú∞Êï∞ÊçÆ ÁÆóÊ≥ïB
										localStorageSize_A = this.calculateLocalStorageSize();
										localStorageSize_B = this.calculateLocalStorageUsage();
										notif = this.settingsLanguage == 'cn' ? 'ÂØºÂÖ•Â§±Ë¥• - Êú¨Âú∞Â≠òÂÇ®Á©∫Èó¥‰∏çË∂≥\r\n\r\n' : 'Import Failed - Insufficient Local Storage Space\r\n\r\n' ;
										let notif_temp = '';
										
										if (localStorageSize_A !== null && localStorageSize_B !== null && localStorageSize_A !== localStorageSize_B ) {
										// Âùá‰∏ç‰∏∫null
											//Âà§Êñ≠Â§ßÂ∞èÔºåÂ∞èÁöÑËµãÂÄºÁªôAÔºåÂ§ßÁöÑËµãÂÄºÁªôB
											if (localStorageSize_A > localStorageSize_B) {
												let temp = localStorageSize_A;
												localStorageSize_A = localStorageSize_B;
												localStorageSize_B = temp;
											}
											notif_temp = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®Â∑≤‰ΩøÁî® ' : "The current browser's local storage usage is ";
											notif_temp = notif_temp + (this.settingsLanguage == 'cn' ? localStorageSize_A + ' ÔΩû ' +  localStorageSize_B + ' MB' : localStorageSize_A + ' ÔΩû ' +  localStorageSize_B + ' MB') ;
											notif_temp = '\r\n\r\n' + notif_temp + '„ÄÇ';
										}else{
										// Âè™Êúâ‰∏Ä‰∏™ÂèòÈáè‰∏∫ null ÁöÑÊÉÖÂÜµ , ËøôÈáå‰∏çËÄÉËôëÈÉΩÁ≠â‰∫énullÁöÑÊÉÖÂÜµ
											localStorageSize_A = localStorageSize_A === null ? localStorageSize_B : localStorageSize_A ;
											notif_temp = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®Â∑≤‰ΩøÁî® ' : "The current browser's local storage usage is ";
											notif_temp = notif_temp + (this.settingsLanguage == 'cn' ? localStorageSize_A + ' MB' :  localStorageSize_A + ' MB') ;
											notif_temp = '\r\n\r\n' + notif_temp + '„ÄÇ';
										}
							
										const sizeInMB = this.calculateStringSize(contentsJSON, 'utf-16') / 1024 / 1024;
										const sizeStr = sizeInMB.toFixed(3) + ' MB';
										notif = notif + (this.settingsLanguage == 'cn' ? 'Êú¨Ê¨°ÂØºÂÖ•ÁöÑ JSON Êï∞ÊçÆÂ§ßÂ∞è‰∏∫ ' + sizeStr  : 'The size of the JSON data imported this time is ' + sizeStr ) ;
										notif = notif + notif_temp  + (this.settingsLanguage == 'cn' ? 'ÊµèËßàÂô®ÈÄöÂ∏∏‰ªÖÊîØÊåÅÁ∫¶ 5MB Êàñ 10MB ÁöÑÊú¨Âú∞Â≠òÂÇ®Á©∫Èó¥ (localStorage)Ôºå‰∏çÂêåÊµèËßàÂô®ÂíåÁâàÊú¨‰πãÈó¥ÂèØËÉΩ‰ºöÊúâÊâÄÂ∑ÆÂºÇ„ÄÇÂ¶ÇÊûúÁî±‰∫éÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®Á©∫Èó¥‰∏çË∂≥ËÄåÂØºÂÖ•Â§±Ë¥•ÔºåÊÇ®ÂèØ‰ª•Â∞ùËØïÂà†Èô§‰∏Ä‰∫õÂØπËØùÊï∞ÊçÆ (ÊàñÂÖàÊäπÊéâÊó•Âøó)ÔºåÊàñËÄÖÂ∞ùËØïÊõ¥Êç¢ÊµèËßàÂô®ÂêéÂÜçÊ¨°ÂØºÂÖ•„ÄÇ\r\nÂª∫ËÆÆ: Âú®ÈáçÊñ∞ÂØºÂÖ•‰πãÂâçÂÖàÂà∑Êñ∞È°µÈù¢„ÄÇ' : 'Browsers typically only support around 5MB or 10MB of local storage space, with variations across different browsers and versions. If the import fails due to insufficient browser storage space, you can try deleting some chat data or erase logs, or switch to a different browser and try again. \r\nSuggestion: Refresh the page before importing again.' );
										alert(notif);
									}
							  }
							//End. reader.onload = (event) => ...
							};
							//ËØªÂèñÂÜÖÂÆπ
							reader.readAsText(file);
						}
						// ‰ªéDOM‰∏≠ÁßªÈô§fileInputÂÖÉÁ¥†
						fileInput.remove();
					}//End - fileInput.onchange()
								
					notif = this.settingsLanguage == 'cn' ? 'ÂØºÂÖ•Êï∞ÊçÆÔºöËá™Âä®È™åËØÅÁî±MCGPTÂØºÂá∫ÁöÑJSONÊï∞ÊçÆÊñá‰ª∂' : 'Import: Auto-validating the JSON data file exported by MCGPT.';
					this.showNotification(notif, 'bottom','',20000);
					
					//ÊøÄÊ¥ªÂØºÂÖ•Êéß‰ª∂ÔºåÂºπÂá∫Êñá‰ª∂ÈÄâÂèñÊ°Ü
					fileInput.click(); 
					
				}, 150);//Á¨¨‰∫åÊ¨°‰øùÂ≠òÔºåÂª∂Ëøü‰øùÂ≠ò
				}catch (e) {
					const e_message = e.message ? e.message : '';
					const e_name = e.name ? e.name : '';
					if( !this.localStorageExceedsMaximum(e_message,e_name)){ //ÂÖàÂà§Êñ≠ÊòØÂê¶Êú¨Âú∞Â≠òÂÇ®Êª°‰∫Ü Determining if it is due to running out of local storage capacity
						notif = this.settingsLanguage == 'cn' ? 'Âá∫Èîô‰∫Ü\r\n\r\nÈîôËØØ‰ø°ÊÅØÔºö' + e.message : 'Error\r\n\r\nError Message: ' + e.message ;
						this.showNotification(notif, 'center','Err - importLocalStorageData()');
						console.error('importLocalStorageData() - ÂØºÂÖ•Êï∞ÊçÆ',e);
					}
				}
				
			},
			
			// ËÆæÁΩÆÁ™óÂè£ - Êï∞ÊçÆÁÆ°ÁêÜData Management ÁºìÂ≠òlocalStorage ËÆ°ÁÆó
			getLocalStorageSize(){
				if(!this.isLocalStorageSupported){
					return;//ÊµèËßàÂô®ÂΩìÂâç‰∏çÊîØÊåÅlocalStorageÊó∂
				}
				if(!this.isLocalStorageAllowed){
					// return; ‰∏çÂÖÅËÆ∏ÁºìÂ≠òÊó∂Ôºå‰∏ç‰ª£Ë°®Ê≤°ÊúâÊï∞ÊçÆ
				}
				if (this.checkBusyStatus('ForChat')) {
					//Â∫ïÈÉ®‰ºöÂá∫Áé∞ÈÄöÁü•tooltips„ÄÇ Â¶ÇÊûúËøîÂõû trueÔºå Ê≠£Âú®ÂèëÈÄÅ Êàñ Ê≠£Âú®È™åËØÅ Êàñ Ê≠£Âú®Ê†áÁ≠æÈ°µÈó¥ÂêåÊ≠•Êï∞ÊçÆ
					return;
				}
				
				//1 ÂÖà‰øùÂ≠ò‰∏ÄÊ¨°  ‰øùÂ≠òÂΩìÂâçÊï∞ÊçÆ
				this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠òÂØπËØù
				
				//2 Á¨¨‰∫åÊ¨°‰øùÂ≠ò  ‰øùÂ≠òÊâÄÊúâÊï∞ÊçÆ,ÂåÖÊã¨‰∏ä‰º†ÁöÑÂ§¥ÂÉè„ÄÇ ‰∏§Ê¨°‰øùÂ≠ò‰πãÈó¥ÂèØËÉΩ‰ºöÂá∫Áé∞‚ÄúÂêåÊ≠•‚ÄùÔºåÂä†‰∏™Âª∂Ëøü
				setTimeout(() => {
					this.localStorage_SaveData(null,null);//‰øùÂ≠òÊâÄÊúâÊï∞ÊçÆ
					
					//‰øùÂ≠òÂêé Âª∂ËøüËÆ°ÁÆó
					setTimeout(() => {
						let localStorageSize_A = null; //ÊâÄÊúâÊú¨Âú∞Êï∞ÊçÆ ÁÆóÊ≥ïA
						let localStorageSize_B = null; //ÊâÄÊúâÊú¨Âú∞Êï∞ÊçÆ ÁÆóÊ≥ïB
						let avatarSize = null; //ÂçïÁã¨-‰∏ä‰º†Â§¥ÂÉè
						let chatDataListSize = null; //ÂçïÁã¨-ËÅäÂ§©Êï∞ÊçÆ
						let promptsDataSize = null; //ÂçïÁã¨-ÊèêÁ§∫ËØç
						let chatDataListSize_chatHistoryLogs = 0; //ÂçïÁã¨-ËÅäÂ§©Êï∞ÊçÆ‰∏≠ÁöÑ LogsÈÉ®ÂàÜ
						try{
							localStorageSize_A = this.calculateLocalStorageSize();
						}catch (e) {}
						try{
							localStorageSize_B = this.calculateLocalStorageUsage();
						}catch (e) {}
						try{
							avatarSize = this.calculateLocalStorageUsage_Item('avatar');
						}catch (e) {}
						try{
							chatDataListSize = this.calculateLocalStorageUsage_Item('chatDataList');
						}catch (e) {}
						try{
							promptsDataSize = this.calculateLocalStorageUsage_Item('promptsData');
						}catch (e) {}
						try{ //v7.27 ËÆ°ÁÆóÊó•Âøó (Áî®‰∫éÂØºÂá∫Âçï‰∏™ÂØπËØùÁöÑmarkdownÊ†ºÂºèÁöÑÂÖ®ÈÉ®ËÅäÂ§©ËÆ∞ÂΩï‰∏éÊìç‰ΩúËÆ∞ÂΩï)
							let logs_totalSize = 0;
							this.chatDataList.forEach((chatData) => {
								const chathistoryString = chatData.chatVariables.chathistory;
								const sizeInMB = this.calculateStringSize(chathistoryString, 'utf-16') / 1024 / 1024;
								logs_totalSize += sizeInMB;
							});
							chatDataListSize_chatHistoryLogs = logs_totalSize.toFixed(4);
						}catch (e) {}
						
						let notif = '';
						const head = this.settingsLanguage == 'cn' ? 'ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ® (localStorage) ‰ΩøÁî®ÊÉÖÂÜµÔºö\r\n' : 'The usage of browser local storage (localStorage) :\r\n';
						
						avatarSize = avatarSize == null ? 0 : avatarSize;
						chatDataListSize = chatDataListSize == null ? 0 : chatDataListSize;
						promptsDataSize = promptsDataSize == null ? 0 : promptsDataSize;
						avatarSize = avatarSize.toString() === '0' ? '0.0000' : avatarSize;
						chatDataListSize = chatDataListSize.toString() === '0' ? '0.0000' : chatDataListSize;
						promptsDataSize = promptsDataSize.toString() === '0.0003' ? ' < 0.0003' : promptsDataSize;
						chatDataListSize_chatHistoryLogs = chatDataListSize_chatHistoryLogs === null ? '0.0000' : chatDataListSize_chatHistoryLogs;
						let otherSizeStr = '\r\n';
						otherSizeStr += this.settingsLanguage == 'cn' ? '\r\n  ÈÉ®ÂàÜÊï∞ÊçÆÁöÑÂ≠òÂÇ®ÊÉÖÂÜµÂ¶Ç‰∏ã:' : '\r\n  Storage status for some data:' ;
						otherSizeStr += this.settingsLanguage == 'cn' ? '\r\n  ‚Ä¢ ËÅäÂ§©Êï∞ÊçÆÂç†Áî®Ôºö' + chatDataListSize + ' MB  (ÂÖ∂‰∏≠Êó•ÂøóÈÉ®ÂàÜÂç†Áî®Ôºö' + chatDataListSize_chatHistoryLogs + ' MB)' : '\r\n  ‚Ä¢ Chat data size: ' + chatDataListSize + ' MB  (with "Logs" size: ' + chatDataListSize_chatHistoryLogs + ' MB)';
						otherSizeStr += this.settingsLanguage == 'cn' ? '\r\n  ‚Ä¢ Áî®Êà∑Â§¥ÂÉè(ËΩ¨Á†ÅÂêé)Âç†Áî®Ôºö' + avatarSize + ' MB' : '\r\n  ‚Ä¢ User avatar (encoded) size: ' + avatarSize + ' MB' ;
						otherSizeStr += this.settingsLanguage == 'cn' ? '\r\n  ‚Ä¢ ÊèêÁ§∫ËØçÊï∞ÊçÆÂç†Áî®Ôºö' + promptsDataSize + ' MB' : '\r\n  ‚Ä¢ Prompts data size: ' + promptsDataSize + ' MB' ;
						otherSizeStr += '\r\n  ‚Ä¢ ...';
						
					//if ( !this.isSimpleMode ){
							otherSizeStr += this.settingsLanguage == 'cn' ? '\r\n\r\n  Â∞èË¥¥Â£´:' : '\r\n\r\n  Tips:' ;
							otherSizeStr += this.settingsLanguage == 'cn' ? '\r\n  ‚Ä¢ ÁîµËÑëÁ´ØÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®ÈÄöÂ∏∏‰∏∫ 10MB' : '\r\n  ‚Ä¢ Local storage for desktop browsers is typically 10MB.' ;
							otherSizeStr += this.settingsLanguage == 'cn' ? '\r\n  ‚Ä¢ ÁßªÂä®Á´ØÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®ÈÄöÂ∏∏‰∏∫ 5MB' : '\r\n  ‚Ä¢ Local storage for mobile browsers is typically 5MB.' ;
							otherSizeStr += this.settingsLanguage == 'cn' ? '\r\n  ‚Ä¢ Safari (iPhone / Mac) ÁöÑÊú¨Âú∞Â≠òÂÇ®‰∏ÄËà¨‰∏∫ 5MB' : '\r\n  ‚Ä¢ Local storage for Safari (iPhone / Mac) is usually 5MB.' ;
							otherSizeStr += this.settingsLanguage == 'cn' ? '\r\n  ‚Ä¢ "Êó•Âøó": Âçï‰∏™ÂØπËØùÁöÑÊâÄÊúâËÆ∞ÂΩï (ÂåÖÂê´Êìç‰ΩúËÆ∞ÂΩï„ÄÅÊí§ÂõûÁöÑÂÜÖÂÆπ‰ª•ÂèäÂèëÈÄÅÂ§±Ë¥•ÁöÑÂÜÖÂÆπÁ≠â)ÔºåÁî®‰∫éÂØºÂá∫ Markdown Ê†ºÂºèÁöÑÁ∫ØÊñáÊú¨ËÅäÂ§©ËÆ∞ÂΩïÔºåÊúâ‰∫õÂØπËØùÊó•ÂøóÂèØËÉΩ‰ºöÊØîËæÉÂ§ß„ÄÇ' : '\r\n  ‚Ä¢ "Logs": All records of individual conversations, including activity logs, retracted messages, and failed messages, are stored. These logs can be exported as plain text chat records in Markdown format. Some logs of chats may be large in size.' ;
							otherSizeStr += this.settingsLanguage == 'cn' ? '\r\n  ‚Ä¢ Â¶Ç‰ΩïÂà†Èô§ÂØπËØùÊó•Âøó: ÊâìÂºÄ [ÂØπËØùÂàóË°®]ÔºåÁÇπÂáª [...] ÈÄâ ÊäπÊéâÊó•Âøó' : '\r\n  ‚Ä¢ How to delete chat logs: Open the [Chat List], click on [...], and select Erase logs.' ;
					//}
						
						if (localStorageSize_A !== null && localStorageSize_B !== null && localStorageSize_A !== localStorageSize_B ) {
						// Âùá‰∏ç‰∏∫null
							//Âà§Êñ≠Â§ßÂ∞èÔºåÂ∞èÁöÑËµãÂÄºÁªôAÔºåÂ§ßÁöÑËµãÂÄºÁªôB
							if (localStorageSize_A > localStorageSize_B) {
								let temp = localStorageSize_A;
								localStorageSize_A = localStorageSize_B;
								localStorageSize_B = temp;
							}
							notif = this.settingsLanguage == 'cn' ? 'Â∑≤‰ΩøÁî®Ôºö' + localStorageSize_A + ' ÔΩû ' +  localStorageSize_B + ' MB' : 'Used: ' + localStorageSize_A + ' ÔΩû ' +  localStorageSize_B + ' MB' ;
							notif = head + notif;
							if ( (5 - localStorageSize_B) > -0.1 ){
								notif += this.settingsLanguage == 'cn' ? '\r\nÈ¢ÑËÆ°Ââ©‰ΩôÂèØÁî® (ÂÅáËÆæ‰∏äÈôê‰∏∫ 5MB)Ôºö' + (5 - localStorageSize_B).toFixed(4) + ' MB\r\nÈ¢ÑËÆ°Ââ©‰ΩôÂèØÁî® (ÂÅáËÆæ‰∏äÈôê‰∏∫ 10MB)Ôºö' + (10 - localStorageSize_B).toFixed(4) + ' MB' : '\r\nEstimated Remaining Size (assuming a limit of 5MB): ' + (5 - localStorageSize_B).toFixed(4) + ' MB\r\nEstimated Remaining Size (assuming a limit of 10MB): '  + (10 - localStorageSize_B).toFixed(4) + ' MB' ;
							}else{
								notif += this.settingsLanguage == 'cn' ? '\r\nÈ¢ÑËÆ°Ââ©‰ΩôÂèØÁî® (ÂÅáËÆæ‰∏äÈôê‰∏∫ 10MB)Ôºö' + (10 - localStorageSize_B).toFixed(4) + ' MB' : '\r\nEstimated Remaining Size (assuming a limit of 10MB): ' + (10 - localStorageSize_B).toFixed(4) + ' MB' ;
							}
							notif += otherSizeStr;
						}else if ((localStorageSize_A === null && localStorageSize_B !== null) || (localStorageSize_A !== null && localStorageSize_B === null) || (localStorageSize_A !== null && localStorageSize_A === localStorageSize_B) ) {
						// Âè™Êúâ‰∏Ä‰∏™ÂèòÈáè‰∏∫ null ÁöÑÊÉÖÂÜµ
							localStorageSize_A = localStorageSize_A === null ? localStorageSize_B : localStorageSize_A ;
							notif = this.settingsLanguage == 'cn' ? 'Â∑≤‰ΩøÁî®Ôºö' + localStorageSize_A + ' MB' : 'Used: ' + localStorageSize_A + ' MB' ;
							notif = head + notif;
							if ( (5 - localStorageSize_B) > -0.1 ){
								notif += this.settingsLanguage == 'cn' ? '\r\nÈ¢ÑËÆ°Ââ©‰ΩôÂèØÁî® (ÂÅáËÆæ‰∏äÈôê‰∏∫ 5MB)Ôºö' + (5 - localStorageSize_A).toFixed(4) + ' MB\r\nÈ¢ÑËÆ°Ââ©‰ΩôÂèØÁî® (ÂÅáËÆæ‰∏äÈôê‰∏∫ 10MB)Ôºö' + (10 - localStorageSize_A).toFixed(4) + ' MB' : '\r\nEstimated Remaining Size (assuming a limit of 5MB): ' + (5 - localStorageSize_A).toFixed(4) + ' MB\r\nEstimated Remaining Size (assuming a limit of 10MB): '  + (10 - localStorageSize_A).toFixed(4) + ' MB' ;
							}else{
								notif += this.settingsLanguage == 'cn' ? '\r\nÈ¢ÑËÆ°Ââ©‰ΩôÂèØÁî® (ÂÅáËÆæ‰∏äÈôê‰∏∫ 10MB)Ôºö' + (10 - localStorageSize_A).toFixed(4) + ' MB' : '\r\nEstimated Remaining Size (assuming a limit of 10MB): ' + (10 - localStorageSize_A).toFixed(4) + ' MB' ;
							}
							notif += otherSizeStr;
						}else{
						// Âùá‰∏∫null
							notif = this.settingsLanguage == 'cn' ? 'Âá∫Èîô‰∫ÜÔºåËÆ°ÁÆóÂ§±Ë¥•„ÄÇ' : 'Error occurred, calculation failed.' ;
							notif = head + notif;
						}
						
						let notiftime = 0;
						if(this.isShowNotification){
							notiftime = 1300; //Â¶ÇÊûúÈÄöÁü•ÂºπÁ™óÂ∑≤ÁªèÂ≠òÂú®ÔºåÂª∂Ëøü1.3ÁßíÂºπÂá∫
						}
						setTimeout(() => {
							const title = this.settingsLanguage == 'cn' ? 'Áî®ÈáèÁªüËÆ°' : 'Usage statistics' ;
							this.showNotification(notif, 'center', title);
						}, notiftime);//Âª∂ËøüÂºπÂá∫
						
					}, 100);//Âª∂ËøüËÆ°ÁÆó
				}, 150);//Á¨¨‰∫åÊ¨°‰øùÂ≠òÔºåÂª∂Ëøü‰øùÂ≠ò

			},
			//ËÆ°ÁÆóÊú¨Âú∞Â≠òÂÇ®ÁöÑÂ§ßÂ∞è ÊñπÊ≥ïA
			calculateLocalStorageSize() {
				let totalSize = 0;

				// ÈÅçÂéÜlocalStorageÁöÑÊØè‰∏™È°πÁõÆ
				for (var i = 0; i < localStorage.length; i++) {
					let key = localStorage.key(i);
					let value = localStorage.getItem(key);

					// Â∞ÜÈîÆÂíåÂÄºÊãºÊé•ÊàêÂ≠óÁ¨¶‰∏≤ÔºåËÆ°ÁÆóÂ§ßÂ∞è
					let itemSize = this.calculateStringSize(key + value, 'utf-16');
					totalSize += itemSize;
				}

				totalSize = totalSize / (1024 * 1024); //convertToMB
				totalSize = totalSize.toFixed(4); 

				return totalSize;
			},
			//ËÆ°ÁÆóÊú¨Âú∞Â≠òÂÇ®ÁöÑÂ§ßÂ∞è ÊñπÊ≥ïA ÁÆóÊ≥ï
			//calculateStringSize()‰ª£Á†ÅÊù•Ê∫ê‰∫éÁΩëÁªúÔºåÂÖ∂‰ªñÁöÑ‰ª£Á†ÅÁî±GPTÂÆåÊàê
			calculateStringSize(str, charset) {
				var total = 0,
					charCode,
					i,
					len;
				charset = charset ? charset.toLowerCase() : '';
				if(charset === 'utf-16' || charset === 'utf16'){
					for(i = 0, len = str.length; i < len; i++){
						charCode = str.charCodeAt(i);
						if(charCode <= 0xffff){
							total += 2;
						}else{
							total += 4;
						}
					}
				}else{
					for(i = 0, len = str.length; i < len; i++){
						charCode = str.charCodeAt(i);
						if(charCode <= 0x007f) {
							total += 1;
						}else if(charCode <= 0x07ff){
							total += 2;
						}else if(charCode <= 0xffff){
							total += 3;
						}else{
							total += 4;
						}
					}
				}
				return total;
			},
			//ËÆ°ÁÆóÊú¨Âú∞Â≠òÂÇ®ÁöÑÂ§ßÂ∞è ÊñπÊ≥ïB *Âú®Êú¨Âú∞Â≠òÂÇ®‰∏≠ÔºåÊï∞ÊçÆÈÄöÂ∏∏‰ª•Â≠óÁ¨¶‰∏≤ÁöÑÂΩ¢ÂºèÂ≠òÂÇ®„ÄÇÂú®Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåÂ≠óÁ¨¶‰∏≤ÊòØ‰ª•UTF-16ÁºñÁ†ÅË°®Á§∫ÁöÑÔºåËøôÊÑèÂë≥ÁùÄÊØè‰∏™Â≠óÁ¨¶Âç†Áî®2‰∏™Â≠óËäÇÔºà16‰ΩçÔºâ
			calculateLocalStorageUsage() {
				let totalBytes = 0;

				// ÈÅçÂéÜlocalStorageÁöÑÊØè‰∏™È°πÁõÆ
				for (var i = 0; i < localStorage.length; i++) {
					let key = localStorage.key(i);
					let value = localStorage.getItem(key);

					// ËÆ°ÁÆóÊØè‰∏™È°πÁõÆÁöÑÂ≠óËäÇÊï∞
					let bytes = key.length + value.length * 2;
					totalBytes += bytes;
				}

				// Â∞ÜÂ≠óËäÇÊï∞ËΩ¨Êç¢‰∏∫ÂèØËØªÁöÑÂÆπÈáèÊ†ºÂºè
				let bytesToKB = totalBytes / 1024;
				let bytesToMB = bytesToKB / 1024;
				bytesToMB = bytesToMB.toFixed(4);
				
				// ËøîÂõûÊÄªÂÆπÈáè
				return bytesToMB;
			},
			//ËÆ°ÁÆóÊú¨Âú∞Â≠òÂÇ®-Âçï‰∏™ItemÁöÑÂ§ßÂ∞è  Âõ∫ÂÆö3È°πÔºö1) avatarÊü•Â§¥ÂÉèÂç†Áî®Â§ßÂ∞è   2) chatDataListÊü•ËÅäÂ§©ËÆ∞ÂΩïÂç†Áî®Â§ßÂ∞è   3) promptsDataÊü•ÊèêÁ§∫ËØçÂç†Áî®Â§ßÂ∞è
			calculateLocalStorageUsage_Item(keyname) {
				keyname = keyname === 'avatar' ? 'userSettings' : keyname; //Â§¥ÂÉèÂ≠òÂÇ®Âú®userSettings‰∏≠
				let objectString = localStorage.getItem(keyname);
				let bytesToMB = 0;
				if (objectString) {
					if(keyname === 'userSettings'){
						let userSettings = JSON.parse(objectString);
						if (userSettings.avatar) {//ËΩ¨Á†ÅÂêéÁöÑÂ§¥ÂÉè
							// Â≠óËäÇÊï∞ÈúÄË¶Åx2  ËΩ¨KB  ËΩ¨MB  Áïô4‰ΩçÂ∞èÊï∞ÁÇπ
							bytesToMB = (JSON.stringify(userSettings.avatar).length * 2 / 1024 / 1024).toFixed(4);
							// ËøîÂõûÂÆπÈáè
							return bytesToMB;
						}
					}else if(keyname === 'chatDataList' || keyname === 'promptsData'){
						// Â≠óËäÇÊï∞ÈúÄË¶Åx2  ËΩ¨KB  ËΩ¨MB  Áïô4‰ΩçÂ∞èÊï∞ÁÇπ
						bytesToMB = ((keyname.length + objectString.length * 2) / 1024 / 1024).toFixed(4);
						// ËøîÂõûÂÆπÈáè
						return bytesToMB;
					}
				}
				return null;
			},
			//Êú¨Âú∞Â≠òÂÇ®Ë∂ÖÂá∫ÊµèËßàÂô®ÁöÑÊúÄÂ§ßÈôêÂà∂
			localStorageExceedsMaximum(errormessage,errorname) {
				errormessage = errormessage == null ? '' : errormessage ;
				errorname = errormessage == null ? '' : errorname ;
				const errName = errorname.toUpperCase();
				const temp_a = errormessage.includes("quota") && errormessage.includes("exceeded");
				const temp_b = errorname.includes("QuotaExceededError") || (errName.includes("EXCEEDED") && errName.includes("QUOTA")) || (errName.includes("ERROR") && errName.includes("QUOTA"));
				if(temp_a || temp_b){
					let notif_cn = "  ‚Ä¢ ÊÇ®ÁöÑÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®Â∑≤Ë∂ÖËøáÊúÄÂ§ßÂÆπÈáèÈôêÂà∂„ÄÇ\r\n  ‚Ä¢ Â¶ÇÊûúÈ¢ëÁπÅÂºπÂá∫Êú¨ÊèêÁ§∫ÔºåÊòØÂõ†‰∏∫Ëá™Âä®‰øùÂ≠òÊó∂Áî±‰∫éÂ≠òÂÇ®Á©∫Èó¥‰∏çË∂≥ËÄå‰øùÂ≠òÂ§±Ë¥•ÔºåËØ∑Â∞ΩÂø´ÈáäÊîæÂ≠òÂÇ®Á©∫Èó¥ÔºåÂê¶ÂàôÊñ∞Êï∞ÊçÆÂ∞ÜÊåÅÁª≠‰øùÂ≠òÂ§±Ë¥• (ÊúÄËøëÁöÑÊï∞ÊçÆ‰ºö‰∏¢Â§±)„ÄÇ\r\n\r\nÂ∞èË¥¥Â£´:\r\n  ‚Ä¢ ‰∏çÂêåÊµèËßàÂô®ÁöÑÊú¨Âú∞Â≠òÂÇ®ÈôêÈ¢ù‰∏çÂêåÔºåÂ∏∏ËßÅÁöÑÈôêÈ¢ù‰∏∫ 10MBÊàñ 5MB„ÄÇÊÇ®ÂèØ‰ª•ÊâìÂºÄÊñ∞È°µÈù¢Ôºå[ËÆæÁΩÆ] > [Êï∞ÊçÆÁÆ°ÁêÜ‰∏éÈöêÁßÅ]‰∏≠ÔºåÁÇπÂáªÊâìÂºÄÊúÄÂêé‰∏Ä‰∏™ [Áî®ÈáèÁªüËÆ°]Ôºå‰ª•Êü•ÁúãÊú¨Âú∞Â≠òÂÇ®ÁöÑ‰ΩøÁî®ÊÉÖÂÜµ„ÄÇ";
					notif_cn += "\r\n  ‚Ä¢ Âú®  [Êï∞ÊçÆÁÆ°ÁêÜ‰∏éÈöêÁßÅ] ‰∏≠ÊÇ®ÂèØ‰ª•Âà†Èô§ÂÖ®ÈÉ®ÂØπËØùÊï∞ÊçÆÔºåÂú® [ÂØπËØùÂàóË°®Á™óÂè£] ‰∏≠ÊÇ®ÂèØ‰ª•ÈÄâÊã©ÊÄßÂà†Èô§Âçï‰∏™ÂØπËØùÊï∞ÊçÆÊàñÊäπÊéâÂØπËØùÊó•Âøó„ÄÇÈúÄË¶ÅÂ§á‰ªΩÁöÑÂØπËØùÂèØÈÄâÊã©ÂØºÂá∫ JSON Êñá‰ª∂„ÄÇ\r\n  ‚Ä¢ ÂØºÂÖ•Êó∂ËØ∑Ê≥®ÊÑè: 1) Á°Æ‰øùÊú¨Âú∞Â≠òÂÇ®ÊúâË∂≥Â§üÁöÑÂèØÁî®Á©∫Èó¥Êù•ÂÆπÁ∫≥ÂØºÂÖ•ÁöÑÊï∞ÊçÆ; 2) Ë∂ÖËøá 5MB ÁöÑÊï∞ÊçÆÈúÄË¶Å‰ΩøÁî®ÊîØÊåÅ 10MB Êú¨Âú∞Â≠òÂÇ®ÁöÑÊµèËßàÂô®Êù•ËøõË°åÂØºÂÖ•; 3) ÂèØ‰ΩøÁî®ÈöêÁßÅÊ®°ÂºèÊàñ‰ΩøÁî®ÂÖ∂‰ªñÊµèËßàÂô®Êù•‰∏¥Êó∂Â§ÑÁêÜÊï∞ÊçÆ„ÄÇ";
					let notif_en = "  ‚Ä¢ The browser's local storage has exceeded the maximum capacity limit.\r\n  ‚Ä¢ If this prompt frequently pops up, it is because the automatic saving fails due to insufficient storage space. Please free up storage space as soon as possible, otherwise new data will continue to fail to save (The most recent data will be lost).\r\n\r\nTips:\r\n  ‚Ä¢ Different browsers have different limits for local storage, with the most common limits being 10MB or 5MB. You can open a new page and go to [Settings] > [Data Privacy and Management]. Click on the last option [Usage Statistics] to view the usage of local storage.";
					notif_en += "\r\n  ‚Ä¢ In [Data Privacy and Management], you can delete all chat data, and in [Chat List], you can selectively delete individual chat data or erase logs. Before deletion, you can choose to export a JSON file as a backup.\r\n  ‚Ä¢ Note when importing: 1) Ensure sufficient available space in local storage to accommodate imported data; 2) Use a browser that supports 10MB local storage for importing data exceeding 5MB; 3) Use privacy mode or an alternative browser to temporarily handle the data.";
					const notif = this.settingsLanguage == 'cn' ? notif_cn : notif_en ;
					const title = this.settingsLanguage == 'cn' ? 'Êú¨Âú∞Â≠òÂÇ® (localStorage) Á©∫Èó¥‰∏çË∂≥' : "Insufficient local storage space" ;
					setTimeout(() => {
						this.showNotification(notif, 'center', title); 
					}, 2000);//Âª∂ËøüÔºåÈÅøÂÖç‰πãÂâçÊúâÈÄöÁü•
					return true;
				}else{
					return false;
				}
			},
			

			//‰∫ã‰ª∂ Êï∞ÊçÆÂêåÊ≠• Êï∞ÊçÆÂ∑ÆÂºÇ Êï∞ÊçÆÂêàÂπ∂
			localStorageEvent_chatDataList(key, newValue, oldValue) {
				if (!this.isLocalStorageAllowed || !this.isLocalStorageSupported){
					return; //‰∏çÊîØÊåÅÁºìÂ≠òÊàñ‰∏çÂÖÅËÆ∏ÁºìÂ≠òÔºåËøîÂõû
				}
				
				this.localStorageEvent_chatDataList_update_start = true ; //Êõ¥Êñ∞ÂºÄÂßã
				
				const newData = JSON.parse(event.newValue || '[]'); // Â∞ÜÊñ∞Êï∞ÊçÆËΩ¨Êç¢‰∏∫Êï∞ÁªÑ
				const oldData = JSON.parse(event.oldValue || '[]'); // Â∞ÜÊóßÊï∞ÊçÆËΩ¨Êç¢‰∏∫Êï∞ÁªÑ
				const added = newData.filter(x => !oldData.some(y => y.chatcreatedtime === x.chatcreatedtime)); // ÊèêÂèñÊñ∞Â¢ûÁöÑÊï∞ÊçÆ
				const removed = oldData.filter(x => !newData.some(y => y.chatcreatedtime === x.chatcreatedtime)); // ÊèêÂèñÂà†Èô§ÁöÑÊï∞ÊçÆ
				const modified = newData.filter(x => {
					const oldItem = oldData.find(y => y.chatcreatedtime === x.chatcreatedtime);
					return oldItem && JSON.stringify(oldItem) !== JSON.stringify(x);
				}); // ÊèêÂèñ‰øÆÊîπÁöÑÊï∞ÊçÆ
				//console.log(new Date().toLocaleTimeString(), ' Êñ∞Â¢ûÁöÑÊï∞ÊçÆÔºö', added);
				//console.log(new Date().toLocaleTimeString(), ' Âà†Èô§ÁöÑÊï∞ÊçÆÔºö', removed);
				//console.log(new Date().toLocaleTimeString(), ' ‰øÆÊîπÁöÑÊï∞ÊçÆÔºö', modified);
				
				added.forEach(chatdata => {
					if (chatdata.chatcreatedtime === null) {
						// Â§ÑÁêÜÊñ∞Â¢ûÁöÑÊï∞ÊçÆÔºåid ‰∏∫ null
						// Êó†ÈúÄÂ§ÑÁêÜ
					} else if (chatdata.chatcreatedtime === this.chatcreatedtime) {
						// Â§ÑÁêÜÊñ∞Â¢ûÁöÑÊï∞ÊçÆÔºåid Á≠â‰∫é selectID
						// Ë≠¶ÂëäÂÖ∂‰ªñÁ™óÂè£Êñ∞Â¢ûÁõ∏ÂêåidÁöÑÊï∞ÊçÆ ÊÑèÂ§ñ Â∑≤Ëá™Âä®ÂàõÂª∫ÂâØÊú¨  ÂéüidÂêåÊ≠•
						// Ê≠£Â∏∏‰∏çÂ∫îËØ•Âá∫Áé∞ËøôÁßçÊÉÖÂÜµÔºåÂêåÊ≠•‰ª£Á†ÅÈÄªËæë‰∏çÂ§üÂÆåÂñÑÊâçÊúâÂèØËÉΩÂá∫Áé∞Ê≠§ÊÉÖÂÜµ
						
						//1) ÂàõÂª∫ÂâØÊú¨
						let chat_Data = this.getSelectedChatData();//Ëé∑ÂèñÂΩìÂâçchatdata
						chat_Data.chatcreatedtime = this.newChatCreatedTime_ForCopyChatData(chat_Data);//ÁîüÊàêÊñ∞ÁöÑchatcreatedtime
						chat_Data.chatlasttime = this.formatDateYYYYMMDDHHmmss(new Date(),':'); //Áé∞Âú®ÁöÑÊó∂Èó¥
						chat_Data.chatid += this.settingsLanguage == 'cn' ? ' ÂâØÊú¨[ÂêåÊ≠•-ÂàõÂª∫Êó∂Èó¥ÂÜ≤Á™Å]' : ' Copy [Sync - Created Time Conflict]' ;
						const chatDataCopy = JSON.parse(JSON.stringify(chat_Data)); 
							
						//Êñ∞Â¢ûÂà∞List
						this.chatDataList.unshift(chat_Data);
							
						//ËØªÂèñ ËØªÂèñÂØπËØùÊï∞ÊçÆ ËøòÂéüËÅäÂ§©ËÆ∞ÂΩï ÊÅ¢Â§çËÅäÂ§©ËÆæÁΩÆ
						this.loadChatData(chat_Data);
				
						//ÂÖ∂‰ªñËØªÂèñÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
						this.$nextTick(() => {
							// 1 2 3 4 5
							this.todoList_ChatDataRestored('hasdata');
						});
							
						//2) ÂêåÊ≠•Êñ∞Â¢ûÂéüÂßãchatdata
						this.chatDataList.unshift(chatdata);
						this.chatDataList_Sort();// ChatDataListÊéíÂ∫è
						
						//3) ‰øùÂ≠òÔºö ÂâØÊú¨
						this.saveChatData_Single(chat_Data); //Âçï‰∏ÄÁöÑ‰øùÂ≠òÔºå‰∏çÂΩ±ÂìçÁïåÈù¢‰ªª‰ΩïÊï∞ÊçÆ
						
						//ÂõûÂà∞È°∂ÈÉ®
						this.gotoTop_List();
					} else {
						// Â§ÑÁêÜÊñ∞Â¢ûÁöÑÊï∞ÊçÆÔºåid ‰∏çÁ≠â‰∫é selectID
						// Êñ∞Â¢û
						this.chatDataList.unshift(chatdata);
						this.chatDataList_Sort();// ChatDataListÊéíÂ∫è
					}
				})

				removed.forEach(chatdata => {
					if (chatdata.chatcreatedtime === null) {
						// Â§ÑÁêÜÂà†Èô§ÁöÑÊï∞ÊçÆÔºåid ‰∏∫ null
						// Êó†ÈúÄÂ§ÑÁêÜ
					} else if (chatdata.chatcreatedtime === this.chatcreatedtime) {
						// Â§ÑÁêÜÂà†Èô§ÁöÑÊï∞ÊçÆÔºåid Á≠â‰∫é selectID
						// Ë≠¶ÂëäÂÖ∂‰ªñÁ™óÂè£Âà†Èô§‰∫ÜÂΩìÂâçÂØπËØùÔºåËØ∑ÈóÆÊòØÂê¶‰øùÁïôÂâØÊú¨Ôºü  ÁªßÁª≠Ôºö1)ÂàõÂª∫ÂâØÊú¨+2)ÂêåÊ≠•Âà†Èô§„ÄÇ   ÂèñÊ∂àÔºö1)ÂêåÊ≠•Âà†Èô§„ÄÇ
						
						// 6.26 Êîπ‰∏∫‰∏çË≠¶ÂëäÔºåÁõ¥Êé•Âà†Èô§
						
							const del_chatid = this.chatid;
							
							//1) ÂêåÊ≠•Âà†Èô§ÂéüÂßãchatdata
							this.chatDataList = this.chatDataList.filter(c => c.chatcreatedtime !== chatdata.chatcreatedtime); //Âà†Èô§ÁõÆÊ†áÂØπËØùÔºå‰øùÁïôÂÖ∂‰ªñÂØπËØù
					
							//2) 
							if(this.chatDataList == [] || this.chatDataList.length == 0){
								//Âª∂ËøüÂºπÊ∂àÊÅØ
								setTimeout(() => {
									const notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÂØπËØù { #' + del_chatid + ' } Âú®ÂêåÊ≠•ËøáÁ®ã‰∏≠Ë¢´Âà†Èô§„ÄÇ\r\nÂΩìÂâçÂàóË°®Á©∫ÔºåÂ∑≤‰∏∫ÊÇ®Ëá™Âä®Ê∑ªÂä†Êñ∞ÁöÑÂØπËØù' : 'The chat { #' + del_chatid + ' } was deleted during synchronization.\r\nThe chat list is empty. A new chat has been automatically added.' ;
									const title = this.settingsLanguage == 'cn' ? 'ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ® - ÂêåÊ≠• - ÈÄöÁü•' : 'Browser Local Storage Sync Notification' ;
									this.showNotification(notif, 'center', title); 
								}, 1400);
								//Ê∑ªÂä†Êñ∞ÂØπËØù
								this.chatList_addNewChatData(true);
							}else{
								//Âª∂ËøüÂºπÊ∂àÊÅØ
								setTimeout(() => {
									const notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÂØπËØù { #' + del_chatid + ' } Âú®ÂêåÊ≠•ËøáÁ®ã‰∏≠Ë¢´Âà†Èô§' : 'The chat { #' + del_chatid + ' } was deleted during synchronization.' ;
									const title = this.settingsLanguage == 'cn' ? 'ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ® - ÂêåÊ≠• - ÈÄöÁü•' : 'Browser Local Storage Sync Notification' ;
									this.showNotification(notif, 'center', title); 
								}, 1400);
								
								//7 ËØªÂèñ ËØªÂèñÂØπËØùÊï∞ÊçÆ ËøòÂéüËÅäÂ§©ËÆ∞ÂΩï ÊÅ¢Â§çËÅäÂ§©ËÆæÁΩÆ
								this.loadChatData(this.chatDataList[0]);
				
								//ÂÖ∂‰ªñËØªÂèñÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
								this.$nextTick(() => {
									// 1 2 3 4 5 6
									this.todoList_ChatDataRestored('hasdata', 50);		
								});
								
								//ÂõûÂà∞È°∂ÈÉ®
								this.gotoTop_List();
							}
						//}
						
					} else {
						// Â§ÑÁêÜÂà†Èô§ÁöÑÊï∞ÊçÆÔºåid ‰∏çÁ≠â‰∫é selectID
						// Áõ¥Êé•Âà†Èô§
						this.chatDataList = this.chatDataList.filter(c => c.chatcreatedtime !== chatdata.chatcreatedtime); //Âà†Èô§ÁõÆÊ†áÂØπËØùÔºå‰øùÁïôÂÖ∂‰ªñÂØπËØù
					}
				})

				modified.forEach(chatdata => {
					if (chatdata.chatcreatedtime === null) {
						// Â§ÑÁêÜ‰øÆÊîπÁöÑÊï∞ÊçÆÔºåid ‰∏∫ null
						// Êó†ÈúÄÂ§ÑÁêÜ
					} else if (chatdata.chatcreatedtime === this.chatcreatedtime) {
						// Â§ÑÁêÜ‰øÆÊîπÁöÑÊï∞ÊçÆÔºåid Á≠â‰∫é selectID
						// Ë≠¶ÂëäÂÖ∂‰ªñÁ™óÂè£‰øÆÊîπ ÊòØÂê¶‰øùÁïôÂâØÊú¨ ÁªßÁª≠ÂàôÂàõÂª∫ÂâØÊú¨+ÂêåÊ≠•‰øÆÊîπ ÂèñÊ∂àÂàôÂêåÊ≠•‰øÆÊîπ
						
						// 6.26 Êîπ‰∏∫‰∏çË≠¶ÂëäÔºåÁõ¥Êé•Â¢ûÂä†ÂâØÊú¨ + Âà†Èô§
						
						//Ëé∑ÂèñÂΩìÂâçchatdataÔºàÊúÄÊñ∞Ôºâ
						let chat_Data = this.getSelectedChatData();
						//ÂØπÊØîchatdataÔºåÂ∑ÆÂºÇÊòØÂê¶Ë∂ÖÂá∫ "chatlasttime"„ÄÅ"chatid"„ÄÅ"chattitle"„ÄÅ"version"„ÄÅ"msg" Ëøô4È°π„ÄÇ Ë∂ÖÂá∫true=Áõ¥Êé•Ë¶ÜÁõñ ‰∏çÂàõÂª∫ÂâØÊú¨„ÄÇ Êú™Ë∂ÖÂá∫false=‰∏çË¶ÜÁõñ ÂàõÂª∫ÂâØÊú¨„ÄÇ
						//Âç≥ Âè™ÊòØ‰øÆÊîπid Âíå titleÔºå‰∏ç‰øÆÊîπÂàõÂª∫ÂâØÊú¨
						const need_to_create_copy =  !this.compareChatData(chatdata, chat_Data);
							
						if(need_to_create_copy){
							const old_chatid = this.chatid;
							
							// 1) ÂàõÂª∫ÂâØÊú¨
							//let chat_Data = this.getSelectedChatData();//Ëé∑ÂèñÂΩìÂâçchatdata
							chat_Data.chatcreatedtime = this.newChatCreatedTime_ForCopyChatData(chat_Data);//ÁîüÊàêÊñ∞ÁöÑchatcreatedtime
							chat_Data.chatlasttime = this.formatDateYYYYMMDDHHmmss(new Date(),':'); //Áé∞Âú®ÁöÑÊó∂Èó¥
							chat_Data.chatid += this.settingsLanguage == 'cn' ? ' ÂâØÊú¨[ÂêåÊ≠•ÂÜ≤Á™Å]' : ' Copy [Sync Conflict]' ;
							const chatDataCopy = JSON.parse(JSON.stringify(chat_Data)); 
							
							const new_chatid = chat_Data.chatid;
							
							//Êñ∞Â¢ûÂà∞List
							this.chatDataList.unshift(chatDataCopy);
							
							//ËØªÂèñ ËØªÂèñÂØπËØùÊï∞ÊçÆ ËøòÂéüËÅäÂ§©ËÆ∞ÂΩï ÊÅ¢Â§çËÅäÂ§©ËÆæÁΩÆ
							this.loadChatData(chatDataCopy);
				
							//ÂÖ∂‰ªñËØªÂèñÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
							this.$nextTick(() => {
								// 1 2 3 4 5
								this.todoList_ChatDataRestored('hasdata');
							});
							const notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÂØπËØù { #' + old_chatid + ' } Âú®ÂêåÊ≠•ËøáÁ®ã‰∏≠Ë¢´‰øÆÊîπÔºåÂ∑≤‰∏∫ÊÇ®Ëá™Âä®ÂàõÂª∫ÂØπËØùÁöÑÂâØÊú¨ { #' + new_chatid + ' } „ÄÇ\r\nÂΩì‰∏Ä‰∏™ÂØπËØùÂú®Â§ö‰∏™Ê†áÁ≠æÈ°µÊàñÁ™óÂè£‰∏≠ÂêåÊó∂Ë¢´ÊâìÂºÄÊó∂Ôºå‰ºöÂá∫Áé∞ËøôÁßçÊÉÖÂÜµ„ÄÇ' : 'The chat { #' + old_chatid + ' } has been modified during synchronization, and a copy of the chat has been created { #' + new_chatid + ' } .\r\nThis can occur when a conversation is opened in multiple tabs/windows at once.' ;
							const title = this.settingsLanguage == 'cn' ? 'ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ® - ÂêåÊ≠• - ÈÄöÁü•' : 'Browser Local Storage Sync Notification' ;
							this.showNotification(notif, 'center', title);
							
							// 2) ÂêåÊ≠•chatdata
							// ËßÅ‰∏ãÊñπ‰ª£Á†Å
							
							// 3) ‰øùÂ≠òÔºö ÂâØÊú¨
							this.saveChatData_Single(chatDataCopy); //Âçï‰∏ÄÁöÑ‰øùÂ≠òÔºå‰∏çÂΩ±ÂìçÁïåÈù¢‰ªª‰ΩïÊï∞ÊçÆ
							
							//ÂõûÂà∞È°∂ÈÉ®
							this.gotoTop_List();
						}
						
						// ÂêåÊ≠•chatdata ÔºàÈÄâÊã©Á°ÆÂÆöÊàñÂèñÊ∂àÈÉΩÈúÄË¶ÅÂêåÊ≠•Ôºâ
						let chat_Data_modified = this.chatDataList.find(c => c.chatcreatedtime === chatdata.chatcreatedtime);//ÊâæÂá∫ÈúÄË¶Å‰øÆÊîπÁöÑÂØπËØù
						chatdata = JSON.parse(JSON.stringify(chatdata));
						Object.assign(chat_Data_modified, chatdata); //Êõ¥Êñ∞ÊõøÊç¢ÔºåÂ∞Üchat_Data_modifiedÂêåÊ≠•Êõ¥Êñ∞‰∏∫chatdataÁöÑÊï∞ÊçÆ
						
						if(!need_to_create_copy){
							//7 ËØªÂèñ ËØªÂèñÂØπËØùÊï∞ÊçÆ ËøòÂéüËÅäÂ§©ËÆ∞ÂΩï ÊÅ¢Â§çËÅäÂ§©ËÆæÁΩÆ
							this.loadChatData(chat_Data_modified);
				
							//ÂÖ∂‰ªñËØªÂèñÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
							this.$nextTick(() => {
								// 1 2 3 4 5 6
								this.todoList_ChatDataRestored('hasdata', 50);		
							});
						}
					} else {
						// Â§ÑÁêÜ‰øÆÊîπÁöÑÊï∞ÊçÆÔºåid ‰∏çÁ≠â‰∫é selectID
						// ‰øÆÊîπ
						// ÂêåÊ≠•chatdata
						let chat_Data_modified = this.chatDataList.find(c => c.chatcreatedtime === chatdata.chatcreatedtime);//ÊâæÂá∫ÈúÄË¶Å‰øÆÊîπÁöÑÂØπËØù
						chatdata = JSON.parse(JSON.stringify(chatdata));
						Object.assign(chat_Data_modified, chatdata); //Êõ¥Êñ∞ÊõøÊç¢ÔºåÂ∞Üchat_Data_modifiedÂêåÊ≠•Êõ¥Êñ∞‰∏∫chatdataÁöÑÊï∞ÊçÆ
					}
				})
				
				this.localStorageEvent_chatDataList_update_start = false ; //Êõ¥Êñ∞ÁªìÊùü
				
				this.localStorage_SaveData(null,'chatDataList');//ÈáçÊñ∞‰øùÂ≠ò‰∏ÄÊ¨°
			},
			
			//‰ª•‰∏ãÊòØ‰∏Ä‰∏™JavaScriptÂáΩÊï∞ÔºåÂ∞ÜÊØîËæÉ‰∏§‰∏™chatData_defaultÂØπË±°ÊòØÂê¶ÂÆåÂÖ®Áõ∏ÂêåÔºàÈô§‰∫Ü chatlasttime„ÄÅchatid Âíå chattitle Â±ûÊÄßÔºâÔºö
			//ËØ•ÂáΩÊï∞Êé•Âèó‰∏§‰∏™chatData_defaultÂØπË±°‰Ωú‰∏∫ÂèÇÊï∞ÔºåÂπ∂ÊåâÂ±ûÊÄßÊØîËæÉÂÆÉ‰ª¨„ÄÇ Â¶ÇÊûú‰∏§‰∏™ÂØπË±°ÂÖ∑ÊúâÁõ∏ÂêåÁöÑÊâÄÊúâÂ±ûÊÄßÂÄºÔºàÈô§‰∫Ü chatlasttime„ÄÅchatid Âíå chattitleÔºâÔºåÂàôËØ•ÂáΩÊï∞Â∞ÜËøîÂõû trueÔºåÂê¶ÂàôËøîÂõû false„ÄÇ
			compareChatData(chatData1, chatData2) {
				const whitelist = ["chatlasttime", "chatid", "chattitle", "version", "msg"]; //Â¢ûÂä†Âà∞5‰∏™ÔºåÂä†‰∏äversion„ÄÅmsg(ËÅäÂ§©ËæìÂÖ•Ê°ÜÂÜÖÂÆπ)
				for (let prop in chatData1) {
					if (!whitelist.includes(prop) && JSON.stringify(chatData1[prop]) !== JSON.stringify(chatData2[prop])) {
						return false;
					}
				}
				return true;
			},
			
			// ÂàõÂª∫ÂâØÊú¨Êó∂ÔºåÁîüÊàêÊñ∞ÁöÑ‰∏çÈáçÂ§çÁöÑchatcreatedtime
			newChatCreatedTime_ForCopyChatData(chatdata){
				let copytime = new Date(chatdata.chatcreatedtime.replace(/-/g, "/")).getTime();//ÂéüÂßãÂàõÂª∫Êó∂Èó¥ÁöÑÊó∂Èó¥Êà≥
				copytime = copytime + 1000 ; //Â¢ûÂä†1Áßí
				let newcreatedtime = this.formatDateYYYYMMDDHHmmss(new Date(copytime),':');
				//ÂΩìÂâçchatDataList = this.chatDataList
				//Ëé∑ÂèñÊúÄÊñ∞Êú¨Âú∞Â≠òÂÇ®‰∏≠ÁöÑchatDataList
				let localStorage_chatDataList = this.localStorage_GetDataByKey('chatDataList');
				localStorage_chatDataList = localStorage_chatDataList == null ? [] : localStorage_chatDataList;
							
				// Âæ™ÁéØÂà§Êñ≠ÊòØÂê¶Â≠òÂú®ÂÜ≤Á™Å
				while (this.isTimeConflict(newcreatedtime, localStorage_chatDataList, this.chatDataList)) {
					copytime += 1000; // Â¢ûÂä†1Áßí
					newcreatedtime = this.formatDateYYYYMMDDHHmmss(new Date(copytime), ':'); // ÈáçÊñ∞ËΩ¨Êç¢‰∏∫Êó•ÊúüÂ≠óÁ¨¶‰∏≤
				}
				return newcreatedtime;
			},
			
			// Âà§Êñ≠Êó∂Èó¥ÊòØÂê¶‰∏éÊï∞ÁªÑ‰∏≠ÁöÑÊó∂Èó¥ÂÜ≤Á™Å  ÂàõÂª∫ÂâØÊú¨chatcreatedtime
			isTimeConflict(time, array1, array2) {
				for (let i = 0; i < array1.length; i++) {
					if (array1[i].chatcreatedtime === time) {
						return true;
					}
				}
				for (let i = 0; i < array2.length; i++) {
					if (array2[i].chatcreatedtime === time) {
						return true;
					}
				}
				return false;
			},
			
			//Ê£ÄÊµãÊµèËßàÂô®ÊòØÂê¶ÊîØÊåÅlocalStorage
			checkLocalStorageSupport() {
				const testKey = '__test__';
				const storage = window.localStorage;
				try {
					// Ê£ÄÊü•ÊòØÂê¶ÊîØÊåÅ localStorage
					if (!storage) {
						return false;
					}
					// Ê£ÄÊü•ÊòØÂê¶ÂèØ‰ª•ÂÜôÂÖ•„ÄÅËØªÂèñÂíåÂà†Èô§Êï∞ÊçÆ
					storage.setItem(testKey, testKey);
					if (storage.getItem(testKey) !== testKey) {
						return false;
					}
					storage.removeItem(testKey);
					return true;
				} catch (e) {
					const e_message = e.message ? e.message : '';
					const e_name = e.name ? e.name : '';
					this.localStorageExceedsMaximum(e_message,e_name);
					
					return false;
				}
			},
			
			// localStorage Êú¨Âú∞Â≠òÂÇ® ‰øùÂ≠òÊï∞ÊçÆÂà∞Êú¨Âú∞Â≠òÂÇ®(Âè™‰øùÂ≠òÂçïÊù°ÂØπËØù)  Êï∞ÊçÆ*4ÔºöÁî®Êà∑ËÆæÁΩÆ+ÂØπËØùËÆ∞ÂΩï(ÂΩìÂâçÂØπËØù)+ÂØÜÈí•Êï∞ÊçÆ+ÊèêÁ§∫ËØçÊï∞ÊçÆ 
			localStorage_SaveData(event, keyname) {

				if(!this.isLocalStorageSupported){
					return;//ÊµèËßàÂô®ÂΩìÂâç‰∏çÊîØÊåÅlocalStorageÊó∂
				}
				if(!this.isLocalStorageAllowed){
					return;//‰∏çÂÖÅËÆ∏ÁºìÂ≠òÊó∂
				}
				if(this.isSendingNow || this.isCheckingApiKeyNow || this.isSendingNow_ForSmartMaxTokens){//Ê≠£Âú®ÂèëÈÄÅÊó∂ Êàñ Ê≠£Âú®È™åËØÅÊó∂
					if(keyname == null || keyname == 'chatDataList' || keyname == 'apikeyData' ){
						return;
					}
				}
				if(this.localStorageEvent_chatDataList_update_start){
					return;//Ê≠£Âú®Ê†áÁ≠æÈ°µÈó¥ÂêåÊ≠•Êï∞ÊçÆ
				}
				
				//keyname‰∏∫Á©∫Êó∂Ôºå‰∏∫Ëá™Âä®‰øùÂ≠òÔºåÂêåÊó∂‰øùÂ≠ò4Á±ªÊï∞ÊçÆ
				if(keyname == null){
					let SECONDS_IN_MS=3000; 
					let timeSinceLastUpdate=Date.now()-this.localStorage_lastSaveTime || Infinity ;
					//‰ªé‰∫ã‰ª∂ÊøÄÊ¥ª‰øùÂ≠òÊó∂ÔºåÈúÄË¶ÅËøõË°åÊó∂Èó¥Âà§Êñ≠„ÄÇ Èùû‰∫ã‰ª∂ÊøÄÊ¥ªÔºåÂ∞ÜÁ´ãÈ©¨‰øùÂ≠òÔºàÈúÄË¶Å>=0.5ÁßíÔºâ„ÄÇ
					if(event && event.type){
						if(event.type == 'WindowBlur'){
							timeSinceLastUpdate=Date.now()-this.localStorage_lastSaveTime_onblur || Infinity ;
							SECONDS_IN_MS = 10000;
						}else if(event.type == 'pagehide' || event.type == 'unload' || event.type == 'beforeunload'){
							SECONDS_IN_MS = 400;
							this.localStorage_lastSaveTime_onblur = this.localStorage_lastSaveTime;
						}else{
							this.localStorage_lastSaveTime_onblur = this.localStorage_lastSaveTime;
						}
					
						if(timeSinceLastUpdate < SECONDS_IN_MS) { //Ë∑ùÁ¶ª‰∏äÊ¨°Â∞è‰∫é3Áßí/10Áßí/0.4Áßí
							//if(event && event.type){
							//	console.log(`[${event.type}] - ${timeSinceLastUpdate /1000}sÂÜÖÂ∑≤ÊúâÂÖ∂‰ªñ‰∫ã‰ª∂ÊøÄÊ¥ª‰∫ÜÂêåÊ≠•ÊµÅÁ®ã.`);
							//}
							return;
						}else{ //Ë∂ÖËøá‰∏âÁßíÈíü/ÂçÅÁßíÈíüÂàôÁ´ãÂç≥ËøõË°å‰øùÂ≠ò‰∏éÊõ¥Êñ∞„ÄÇ
							//if(event && event.type){
							//	console.log(`[${event.type}] - Ê≠£Âú®‰øùÂ≠òÂà∞ÁºìÂ≠ò‰∏≠`);
							//}
							// nothing to do
						}
					}else{
						SECONDS_IN_MS = 100;
						if(timeSinceLastUpdate < SECONDS_IN_MS) { //Ë∑ùÁ¶ª‰∏äÊ¨°Â∞è‰∫é0.1Áßí
							return;
						}
					}
				}
				
				// - 1.Áî®Êà∑ËÆæÁΩÆ userSettings
				if(keyname == null || keyname == 'userSettings'){
					this.saveUserSettings();// ‰øùÂ≠òUserSettings
				}
				
				// - 2.Êõ¥Êñ∞ËÅäÂ§©Êï∞ÊçÆChatDataList(Âè™Êõ¥Êñ∞ÂΩìÂâçÂØπËØù chatData)
				if(keyname == null || keyname == 'chatDataList'){
					this.saveChatData_Selected();// ‰øùÂ≠òChatData
					this.chatDataList_Sort();// ChatDataListÊéíÂ∫è
				}
				
				// - 3.API KeyÊï∞ÊçÆ  API Keys Data
				if(keyname == null || keyname == 'apikeyData'){
					this.saveApikeyData();// ‰øùÂ≠òapikeyData
				}
				
				// - 4.ÊèêÁ§∫ËØçÊï∞ÊçÆ  Prompts Data
				if(keyname == null || keyname == 'promptsData'){
					this.savePromptsData();// ‰øùÂ≠òPrompts Data
				}
				
				if(keyname == null){
					this.localStorage_lastSaveTime = Date.now(); //Êõ¥Êñ∞‰øùÂ≠òÊó∂Èó¥
					this.localStorage_lastSaveTime_onblur = Date.now(); //Êõ¥Êñ∞‰øùÂ≠òÊó∂Èó¥
				}
			},

			// localStorage Êú¨Âú∞Â≠òÂÇ® Ëé∑ÂèñÂçïÁã¨ÁöÑÊï∞ÊçÆ
			localStorage_GetDataByKey(keyname) {
				if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
					return null;//ÊµèËßàÂô®ÂΩìÂâç‰∏çÊîØÊåÅlocalStorage Êàñ ‰∏çÂÖÅËÆ∏ÁºìÂ≠ò
				}else{
					try {
						const data = JSON.parse(localStorage.getItem(keyname)); 
						if(data != null){
							return data;
						}else{
							return keyname == 'chatDataList' ? [] : null ; //chatDataListÊÑèÂ§ñ‰∏∫nullÊó∂ÔºåËøîÂõûÁ©∫Êï∞ÁªÑ
						}
					}catch(e){
						console.error('localStorage_GetDataByKey()',e);
						this.showNotification('keyname:\r\n' + keyname + 'Error Name:\r\n' + e.name + '\r\n\r\nError Message:\r\n' + e.message, 'center', 'Error - localStorage_GetDataByKey()');
						return null;
					}
				}
			},
			
			// localStorage Êú¨Âú∞Â≠òÂÇ® ÊÅ¢Â§çÊú¨Âú∞Â≠òÂÇ®Êï∞ÊçÆ  Êï∞ÊçÆ*4ÔºöÁî®Êà∑ËÆæÁΩÆ+ÂØπËØùËÆ∞ÂΩï+ÂØÜÈí•Êï∞ÊçÆ+ÊèêÁ§∫ËØçÊï∞ÊçÆ
			localStorage_RestoreData() {
				// ËØªÂèñ
				let userSettings = this.localStorage_GetDataByKey('userSettings');
				let chatDataList = this.localStorage_GetDataByKey('chatDataList');
				let apikeyData = this.localStorage_GetDataByKey('apikeyData');
				let promptsData = this.localStorage_GetDataByKey('promptsData');
				//console.log('localStorage_RestoreData() - userSettings: ',userSettings);
				//console.log('localStorage_RestoreData() - chatDataList: ',chatDataList);
				//console.log('localStorage_RestoreData() - apikeyData: ',apikeyData);
				//console.log('localStorage_RestoreData() - promptsData: ',promptsData);
	
				if (userSettings === null && (chatDataList === null || chatDataList.length === 0) && apikeyData === null && promptsData === null ) {
					return false;
				}

				// ÁâàÊú¨ÂÖºÂÆπÊÄßÂ§ÑÁêÜ - none
				// Êó•ÊúüÔºö7.09  userSettings - Êñ∞Â¢ûÂèòÈáè pageScalingÔºàÁßªÂä®ËÆæÂ§áÈ°µÈù¢ÊØî‰æãÔºâ
				
					
				// - Start 1.
				// ËøòÂéüÁî®Êà∑ËÆæÁΩÆÊï∞ÊçÆ userSettings
				this.RestoreData_userSettings(userSettings);
				// - End 1.
				
				// - 3.
				// ÊâπÈáèËøòÂéüAPI KeyÊï∞ÊçÆ  API Keys Data
				apikeyData = apikeyData == null ? {} : apikeyData;
				this.setVariablesToThis(apikeyData, this.apikeyData_default, true);//Ê†πÊçÆÂèòÈáèÂàóË°®ÂíåÈªòËÆ§ÂÄº ËøòÂéüÂèòÈáè
				//Âà†Èô§apikey‰∏∫Á©∫ÁöÑÈ°πÔºà‰∏çÊéíÈô§ÊúâÁ©∫ÂÄºÔºåv7.10‰πãÂâçÔºö1.ÂàùÊ¨°È™åËØÅÂâçapiCheckedData‰ºöÊúâÁ©∫È°π„ÄÇ 2.Êú¨Âú∞Â≠òÂÇ®‰πü‰ºöÂ≠òÂÇ®Á©∫È°πÔºâ
				this.apiCheckedData = this.apiCheckedData.filter(item => item.apikey.trim() !== '');
				//Âæ™ÁéØthis.apiCheckedData È™åËØÅÊï∞ÊçÆ & ÂÖºÂÆπÊÄßÂ§ÑÁêÜ
				//Âà§Êñ≠Â±ûÊÄßÊòØÂê¶Â≠òÂú®‰∏îÊï∞ÊçÆÊòØÂê¶ÂêàÊ≥ïÔºåÂ¶ÇÊûúÁº∫Â∞ëÂ±ûÊÄß Êàñ Â±ûÊÄßÊï∞ÊçÆ‰∏çÂêàÊ≥ïÔºåÂ∞±Ë°•‰∏äÂ±ûÊÄßÂíåÈªòËÆ§ÂÄº
				this.validateApiCheckedData(this.apiCheckedData);
								
				// - 4.
				// ÊâπÈáèËøòÂéüÊèêÁ§∫ËØçÊï∞ÊçÆ  Prompts Data
				promptsData = promptsData == null ? {} : promptsData;
				this.setVariablesToThis(promptsData, this.promptsData_default, true);//Ê†πÊçÆÂèòÈáèÂàóË°®ÂíåÈªòËÆ§ÂÄº ËøòÂéüÂèòÈáè
				
				// - 2. chatÊï∞ÊçÆ   *Ë∞ÉÂà∞Âú® 3„ÄÅ4 ‰πãÂêéÊâßË°å
				this.chatDataList = chatDataList == null ? [] : chatDataList;
				this.chatDataList_Sort();// ChatDataListÊéíÂ∫è
				const selectedChatData = (this.chatDataList == null || this.chatDataList[0] == null) ? {} : JSON.parse(JSON.stringify(this.chatDataList[0])) ; //this.chatDataList[0] ÊúÄÊñ∞‰∏ÄÊ¨°ÂØπËØù
				this.loadChatData(selectedChatData); //ËØªÂèñÂØπËØùÊï∞ÊçÆ ËøòÂéüËÅäÂ§©ËÆ∞ÂΩï ÊÅ¢Â§çËÅäÂ§©ËÆæÁΩÆ

				//ËÆæÁΩÆÈ¶ñÊ¨°ËØªÂèñlocalStorage = false
				this.islocalStorageFirstLoad = false;
				return true;
			},
			
			// ËøòÂéüÁî®Êà∑ËÆæÁΩÆÊï∞ÊçÆ userSettings
			RestoreData_userSettings(userSettings){
				if(userSettings === null){
					return;
				}
				// - Start 1.
				// Áî®Êà∑ËÆæÁΩÆ userÂèòÈáè
				const userVariables = userSettings.userVariables == null ? {} : userSettings.userVariables; // userÂèòÈáè
				this.setVariablesToThis(userVariables, this.userVariables_default, true);//Ê†πÊçÆÂèòÈáèÂàóË°®ÂíåÈªòËÆ§ÂÄº ËøòÂéüÂèòÈáè
								
				// Ëé∑ÂèñÂ§¥ÂÉèURL
				let isErr = ( userSettings.userAvatarURL == null || userSettings.userAvatarURL.trim() == '');
				const userAvatarURL = isErr ? this.userAvatarURL : userSettings.userAvatarURL; //*Ê≥®ÊÑèÔºöÈúÄË¶Å‚Äúconst userAvatarURL‚Äù ÔºåËÄå‰∏çËÉΩÁõ¥Êé•ËµãÂÄºÁªôthis.userAvatarURL= Âõ†‰∏∫ÂèØËÉΩÊòØÊó†ÊïàÁöÑ ËµãÂÄºÁ≠â‰∫éÊòØÁõ¥Êé•Âä†ËΩΩÂõæÁâá Êó†ÊïàÁöÑÂõæÁâá‰ºöÊä•Èîô
				//isErr = ( userSettings.gptAvatarURL == null || userSettings.gptAvatarURL.trim() == '');
				isErr = ( userSettings.gptAvatarURL == null  );
				const gptAvatarURL = isErr ? this.gptAvatarURL : userSettings.gptAvatarURL;

				// ËΩ¨Êç¢Áî®Êà∑Â§¥ÂÉè base64 To Blob 
				const avatar = userSettings.avatar;
				try {
					//‰ªÖÈ¶ñÊ¨°ËØªÂèñlocalStorageÊó∂ÔºåÈúÄË¶ÅÈáçÊñ∞ËΩ¨Êç¢„ÄÅÁîüÊàêÂÖ®Êñ∞ÁöÑblob Url„ÄÇ
					if (this.islocalStorageFirstLoad && avatar && avatar != '') {
						const arr = avatar.split(',');
						const type = arr[0].match(/:(.*?);/)[1];
						const bstr = atob(arr[1]);
						let n = bstr.length;
						const u8arr = new Uint8Array(n);
						while (n--) {
							u8arr[n] = bstr.charCodeAt(n);
						}
		
						this.userAvatarUp_base64 = avatar;
						this.userAvatarUp_blob = new Blob([u8arr], { type }); 
						this.userAvatarUp_blobUrl = URL.createObjectURL(this.userAvatarUp_blob);
					}
				  } catch (e) {
					console.error("userSettings.avatarËΩ¨Êç¢ËøáÁ®ãÂá∫Èîô");
					this.userAvatarUp_base64 = '';
					this.userAvatarUp_blob = null;
					this.userAvatarUp_blobUrl = '';
				}

				// Áî®Êà∑Â§¥ÂÉè User Avatar
				//È¶ñÊ¨°ËØªÂèñlocalStorageÊó∂ && Â§¥ÂÉè‰∏∫‰∏ä‰º†ÁöÑÂõæÁâáÊó∂ && blob Url‰∏∫ÊúâÊïàÁöÑblobÂú∞ÂùÄÊó∂(ËΩ¨Êç¢Âá∫ÈîôÊó∂ÂèØËÉΩ‰∏∫Á©∫)
				if(this.islocalStorageFirstLoad && userAvatarURL.startsWith('blob:') && this.userAvatarUp_blobUrl.startsWith('blob:')){
					this.inputUserImageUrl = JSON.parse(JSON.stringify(this.userAvatarUp_blobUrl)); //ÂÖ®Êñ∞ÁöÑblob Url
				}else{
					this.inputUserImageUrl = userAvatarURL;//‰∏çÂèòÔºå‰øùÊåÅ‰∏äÊ¨°ÁöÑËÆæÁΩÆ„ÄÇÂèØËÉΩÊòØÔºöÁΩëÂùÄ„ÄÅÊú¨Âú∞Ë∑ØÂæÑ„ÄÅ‰∏ä‰º†ÂõæÁâáÁöÑ‰ªçÊúâÊïàÁöÑblob url
				}

				// GPTÂ§¥ÂÉè GPT Avatar
				//È¶ñÊ¨°ËØªÂèñlocalStorageÊó∂
				const greenSVG = this.settingsLanguage == 'cn' ? this.GPTGreenSVG_UrlText_cn : this.GPTGreenSVG_UrlText_en;
				if(this.islocalStorageFirstLoad){
					if(gptAvatarURL.startsWith('blob:') || gptAvatarURL == ''){ //‰∏äÊ¨°ÊòØ‰∏ä‰º†Â§¥ÂÉè && ‰∏äÊ¨°ÊòØÈªòËÆ§GPTÁöÑGreenSVGÂ§¥ÂÉè
						this.inputGPTImageUrl = greenSVG;
					}else {
						this.inputGPTImageUrl = gptAvatarURL; //‰∏çÂèòÔºå‰øùÊåÅ‰∏äÊ¨°ÁöÑËÆæÁΩÆ„ÄÇÂèØËÉΩÊòØÔºöÁΩëÂùÄ„ÄÅÊú¨Âú∞Ë∑ØÂæÑ
					}
				}else{
					this.inputGPTImageUrl = this.isgptGreenSvgShow ? greenSVG : gptAvatarURL; //‰∏çÂèòÔºå‰øùÊåÅ‰∏äÊ¨°ÁöÑËÆæÁΩÆ„ÄÇÂèØËÉΩÊòØÔºöÁΩëÂùÄ„ÄÅÊú¨Âú∞Ë∑ØÂæÑ„ÄÅGreenSVG„ÄÅ‰∏ä‰º†ÁöÑ‰ªçÊúâÊïàÁöÑÂõæÁâáÁöÑblob url
				}

				//Êõ¥Êñ∞Áî®Êà∑„ÄÅGPTÂ§¥ÂÉè
				this.updateAvatar('user', false);//‰øùÂ≠ò Êõ¥Êñ∞ save update  false=Don't show notif.
				this.updateAvatar('gpt', false);
				
				// - End 1.
			},	
			
			// È™åËØÅÂíå‰øÆÊ≠£apiCheckedDataÁöÑÊï∞ÊçÆÁªìÊûÑÂíåÊï∞ÊçÆÂêàÊ≥ïÊÄß„ÄÇ ÊÅ¢Â§çÊï∞ÊçÆÊó∂ / ‰øùÂ≠òÊï∞ÊçÆÊó∂ / ÂØºÂÖ•Êï∞ÊçÆÊó∂
			validateApiCheckedData (apicheckedcata){
				// v7.18 Â¶ÇÊûúÊÇ®ÈúÄË¶ÅÊâãÂä®‰øÆÊîπapikeyDataÁöÑJSONÊñá‰ª∂ËøõË°åÊâπÈáèÊ∑ªÂä†API KeyÔºåÂè™ÈúÄË¶ÅËÆ∞ÂΩïapikey‰∏Ä‰∏™Â±ûÊÄßÂç≥ÂèØÔºåÂØºÂÖ•JSONÊñá‰ª∂Ôºå‰ª£Á†Å‰ºöËá™Âä®Ê∑ªÂä†ÂÖ∂‰ªñÂ±ûÊÄßÔºåÂπ∂Â°´ÂÖ•ÈªòËÆ§ÂÄº„ÄÇ
				// v7.18 If you need to manually modify the JSON file of apikeyData for bulk addition of API Keys, you only need to record the apikey attribute. Import the JSON file and the code will automatically add other attributes and fill in the default values.
				
				//v7.18 Âæ™ÁéØapicheckedcata È™åËØÅÊï∞ÊçÆ & ÂÖºÂÆπÊÄßÂ§ÑÁêÜ
				//Âà§Êñ≠Â±ûÊÄßÊòØÂê¶Â≠òÂú®‰∏îÊï∞ÊçÆÊòØÂê¶ÂêàÊ≥ïÔºåÂ¶ÇÊûúÁº∫Â∞ëÂ±ûÊÄß Êàñ Â±ûÊÄßÊï∞ÊçÆ‰∏çÂêàÊ≥ïÔºåÂ∞±Ë°•‰∏äÂ±ûÊÄßÂíåÈªòËÆ§ÂÄº
				apicheckedcata.forEach(apiData => {
					apiData.apikey = typeof apiData.apikey === 'string' ? apiData.apikey : ''; //Not nullÔºåDefault:''  
					apiData.apiurl = typeof apiData.apiurl === 'string' ? apiData.apiurl : ''; //Not nullÔºåDefault:''  *v7.18 not used
					apiData.date1 = Number.isInteger(apiData.date1) ? apiData.date1 : 0; //Not nullÔºåIntÔºåDefault:0
					apiData.date2 = Number.isInteger(apiData.date2) ? apiData.date2 : 0; //Not nullÔºåIntÔºåDefault:0
					apiData.date3 = Number.isInteger(apiData.date3) ? apiData.date3 : 0; //Not nullÔºåIntÔºåDefault:0
					apiData.nexttime = Number.isInteger(apiData.nexttime) ? apiData.nexttime : 0;  //Not nullÔºåIntÔºåDefault:0
										
					apiData.level = apiData.level != null && typeof apiData.level === 'number' ? apiData.level : null;  //Allowing nullÔºånull or IntÔºåInt:01234589ÔºåDefault:null
										
					//......apiData.freq = Number.isInteger(apiData.freq) ? apiData.freq : 0; xxxxxxxx number
					apiData.freq = typeof apiData.freq === 'number' && ! isNaN(apiData.freq) ? apiData.freq : 0; //Not nullÔºånumberÔºåDefault:0  *v7.18 not used
					apiData.vpn = typeof apiData.vpn === 'string' ? apiData.vpn : ''; //Not nullÔºåDefault:''  *v8.05  ‚Äúvpn‚ÄùÊîπÁî®ÈÄîÔºåÊîπ‰∏∫Â≠òÂÇ®‚Äútag‚Äù „ÄÇ"vpn" has been repurposed to store "tag"
					apiData.vpn = ( apiData.vpn.includes("GPT-") || apiData.vpn === "third-party" ) ? apiData.vpn : ''; //*v8.05  ‚Äúvpn‚ÄùÊîπÁî®ÈÄîÔºåÊîπ‰∏∫Â≠òÂÇ®‚Äútag‚Äù „ÄÇ"vpn" has been repurposed to store "tag"
					apiData.owner = typeof apiData.owner === 'string' ? apiData.owner : 'me'; //Not nullÔºåDefault:''  *v7.18 not used
					apiData.succcount = Number.isInteger(apiData.succcount) ? apiData.succcount : 0; //Not nullÔºåIntÔºåDefault:0
					apiData.failcount = Number.isInteger(apiData.failcount) ? apiData.failcount : 0; //Not nullÔºåIntÔºåDefault:0
					//......apiData.succrate = Number.isInteger(apiData.succrate) ? apiData.succrate : 0; xxxxxxxx number
					apiData.succrate = typeof apiData.succrate === 'number' && !isNaN(apiData.succrate) ? apiData.succrate : 0; //Not nullÔºånumberÔºåDefault:0
					apiData.updatetime = Number.isInteger(apiData.updatetime) ? apiData.updatetime : 0; //Not nullÔºåIntÔºåDefault:0
				});
			},	
			
			// ÊâπÈáèËøòÂéüÂèòÈáèÂà∞this  variablesË¶ÅËøòÂéüÁöÑÂèòÈáè   variables_defaultÂèòÈáèÁöÑÂàóË°®/ÈªòËÆ§ÂÄº   isusedefault Áº∫Â§±Êï∞ÊçÆÊó∂ÊòØÂê¶‰ΩøÁî®ÈªòËÆ§ÂÄº
			setVariablesToThis(variables, variables_default, isusedefault){
				Object.keys(variables_default).forEach(key => {
					if (variables_default.hasOwnProperty(key)) {
						if (variables.hasOwnProperty(key)) {
							this[key] = variables[key];
						} else {
							if(isusedefault === true){
								this[key] = JSON.parse(JSON.stringify(variables_default[key]));
							}
						}
					}
				});
			},		
				
			// ‰ªéthis‰∏≠ÁîüÊàê/Ëé∑ÂèñÂèòÈáè ËøîÂõûÂèòÈáè{}  variables_defaultÂèòÈáèÁöÑÂàóË°®
			getVariablesFromThis(variables_default){
				const variables = {};
				Object.keys(variables_default).forEach(key => {
					if (variables_default.hasOwnProperty(key)) {
						variables[key] = this[key]
					}
				})
				return variables;
			},
		
			// ‰øùÂ≠òÁî®Êà∑ËÆæÁΩÆ UserSettings
			saveUserSettings(){
				const userVariables = this.getVariablesFromThis(this.userVariables_default);
				
				const userSettings = {
					version: this.userSettings_Version,
					avatar: this.userAvatarUp_base64,
					userAvatarURL: this.userAvatarURL,
					gptAvatarURL: this.gptAvatarURL,
					userVariables
				};
				try{
					//‰øùÂ≠òÂà∞localStorage	
					localStorage.setItem('userSettings', JSON.stringify(userSettings)); 
				}catch(e){
					const e_message = e.message ? e.message : '';
					const e_name = e.name ? e.name : '';
					this.localStorageExceedsMaximum(e_message,e_name);
				}
			},
					
			// ‰øùÂ≠òAPI Keys Data  Êõ¥Êñ∞ÂêàÂπ∂ÊúÄÊñ∞Êï∞ÊçÆÔºåÂîØ‰∏Ä‰∏çË∂≥ÔºöÂ§öÊ†áÁ≠æ‰∏çÂêåÊ≠•Âà†Èô§ÔºåÈúÄË¶ÅÂà†Èô§Êó∂ÔºåÂ∫îËØ•Âè™‰øùÁïô‰∏Ä‰∏™Ê†áÁ≠æÈ°µ„ÄÇÂê¶ÂàôÂÖ∂‰ªñÊú™ÂÖ≥Èó≠ÁöÑÊ†áÁ≠æÈ°µÂ§ßÊ¶ÇÁéá‰ºöÊÅ¢Â§çÂ∑≤Âà†Èô§ÁöÑkey„ÄÇ
			saveApikeyData(){
				//Ëé∑ÂèñÊúÄÊñ∞API Keys Data
				let localStorage_apikeyData = this.localStorage_GetDataByKey('apikeyData');
				//Ëé∑ÂèñÊúÄÊñ∞Â∑≤È™åËØÅÁöÑapikeyÊï∞ÁªÑÊï∞ÊçÆ apiCheckedData
				let storage_apiCheckedData = localStorage_apikeyData == null ? [] : localStorage_apikeyData.apiCheckedData;
				storage_apiCheckedData = storage_apiCheckedData == null ? [] : storage_apiCheckedData;
				storage_apiCheckedData = storage_apiCheckedData.filter(apidata => apidata.apikey && apidata.apikey.trim() !== '');//ÊéíÈô§Á©∫È°π
				
				// Âæ™ÁéØstorage_apiCheckedData È™åËØÅÊï∞ÊçÆ & ÂÖºÂÆπÊÄßÂ§ÑÁêÜ
				//Âà§Êñ≠Â±ûÊÄßÊòØÂê¶Â≠òÂú®‰∏îÊï∞ÊçÆÊòØÂê¶ÂêàÊ≥ïÔºåÂ¶ÇÊûúÁº∫Â∞ëÂ±ûÊÄß Êàñ Â±ûÊÄßÊï∞ÊçÆ‰∏çÂêàÊ≥ïÔºåÂ∞±Ë°•‰∏äÂ±ûÊÄßÂíåÈªòËÆ§ÂÄº
				this.validateApiCheckedData(storage_apiCheckedData);

				// ÂêàÂπ∂Êõ¥Êñ∞Êï∞ÊçÆÂà∞this.apiCheckedData
				const newData = this.apiCheckedData.filter(apidata => apidata.apikey && apidata.apikey.trim() !== '');//ÊéíÈô§Á©∫È°π

				//Êõ¥Êñ∞Â∑ÆÂºÇÊï∞ÊçÆÔºå Êñ∞Â¢û Êàñ Êõ¥Êñ∞
				storage_apiCheckedData.forEach(apidata => {
					const existingApiIndex = newData.findIndex(api => api.apikey === apidata.apikey);
					if (existingApiIndex !== -1) {//Â≠òÂú®-Êõ¥Êñ∞
						const existingApi = newData[existingApiIndex];
						// ÊØîËæÉupdatetimeÔºå‰ª•Êõ¥Êñ∞ÊúÄÊñ∞ÁöÑÊï∞ÊçÆ
						if (apidata.updatetime > existingApi.updatetime) {
							newData[existingApiIndex] = apidata;
						}
					} else {//‰∏çÂ≠òÂú®-Êñ∞Â¢û
						newData.push(apidata);
					}
				});
				this.apiCheckedData = newData;
				
				const apikeyData = this.getVariablesFromThis(this.apikeyData_default);
				//ÊâãÂä®Â¢ûÂä†ÁâàÊú¨
				apikeyData.version = this.apikeyData_Version; 
				try{
					//‰øùÂ≠òÂà∞localStorage	
					localStorage.setItem('apikeyData', JSON.stringify(apikeyData)); 
				}catch(e){
					const e_message = e.message ? e.message : '';
					const e_name = e.name ? e.name : '';
					this.localStorageExceedsMaximum(e_message,e_name);
				}
			},
								
			// ‰øùÂ≠òÊèêÁ§∫ËØç Prompts Data
			savePromptsData(){
				//Ëé∑ÂèñÊúÄÊñ∞Prompts Data
				let localStorage_promptsData = this.localStorage_GetDataByKey('promptsData');
				//Ëé∑ÂèñÊúÄÊñ∞promptsÊï∞ÁªÑÊï∞ÊçÆ gptPrompts
				let gptPrompts = localStorage_promptsData == null ? [] : localStorage_promptsData.gptPrompts;
				//
				//ÊèêÁ§∫ËØç ÂæÖÂºÄÂèë111111111 
				
				const promptsData = this.getVariablesFromThis(this.promptsData_default);
				//ÊâãÂä®Â¢ûÂä†ÁâàÊú¨
				promptsData.version = this.promptsData_Version;
				try{
					//‰øùÂ≠òÂà∞localStorage	
					localStorage.setItem('promptsData', JSON.stringify(promptsData)); 
				}catch(e){
					const e_message = e.message ? e.message : '';
					const e_name = e.name ? e.name : '';
					this.localStorageExceedsMaximum(e_message,e_name);
				}
			},
					
			// ‰øùÂ≠òÂΩìÂâçÂØπËØù ChatData
			saveChatData_Selected(){
				//Ëé∑ÂèñÂΩìÂâçchatdata
				let chat_Data = this.getSelectedChatData();
				if(chat_Data == null || chat_Data.chatcreatedtime == null ){
					return; //chatcreatedtime == null Êñ∞ÂØπËØù‰∏ç‰øùÂ≠ò
				}
				
				//Â¶ÇÊûúÂΩìÂâç‰∏çÊòØÊñ∞ÂØπËØùÔºå‰ΩÜÊòØÂ≠òÂú®Êñ∞ÂØπËØù/Á©∫ÂØπËØùÔºåÈúÄË¶ÅÂú®Âà∑Êñ∞ListÂêéÁªôË°•‰∏ä
				const chatdata_null = this.chatDataList.find(c => c.chatcreatedtime === null);
				
				//Ëé∑ÂèñÊúÄÊñ∞chatDataList
				let localStorage_chatDataList = this.localStorage_GetDataByKey('chatDataList');
				if(localStorage_chatDataList == null){
					return;
				}
				
				//*Ê≠£Â∏∏ÊÉÖÂÜµ‰∏ãÔºåÊó†ÈúÄÂéªnull„ÄÇ Â¶ÇÊûúÊÑèÂ§ñÂ≠òÂú®Êñ∞ÂØπËØù(chatcreatedtime=null)ÔºåÈ°∫‰æøÂéªÈô§
				localStorage_chatDataList = localStorage_chatDataList.filter(c => c.chatcreatedtime !== null);
					
				//ÈÄöËøáÂΩìÂâçÁöÑchat_Data.chatcreatedtime(ÂØπËØùÁöÑÂàõÂª∫Êó∂Èó¥ÔºåÂîØ‰∏ÄÂÄº)ÊâæÂà∞ÂØπËØù *gptËøòÊé®Ëçê‰∏™ÊñπÊ≥ï:‰ΩøÁî®find ÂíåObject.assign
				const chatdataIndex = localStorage_chatDataList.findIndex((chatdata) => chatdata.chatcreatedtime === chat_Data.chatcreatedtime);
				if (chatdataIndex !== -1) {
					localStorage_chatDataList[chatdataIndex] = chat_Data;// Â≠òÂú®Êó∂ÔºåÊõ¥Êñ∞
				} else {
					localStorage_chatDataList.unshift(chat_Data); // ‰∏çÂ≠òÂú®Êó∂ÔºåÊñ∞Â¢û
				}
				
				try{
					//‰øùÂ≠òÂà∞localStorage
					localStorage.setItem('chatDataList', JSON.stringify(localStorage_chatDataList)); 
				}catch(e){
					const e_message = e.message ? e.message : '';
					const e_name = e.name ? e.name : '';
					this.localStorageExceedsMaximum(e_message,e_name);
				}
				
				//‰øùÂ≠òÂêéÔºåËøòÂéüÂèØËÉΩÂ≠òÂú®ÁöÑÊñ∞ÂØπËØù/Á©∫ÂØπËØù
				if(chatdata_null != null){
					localStorage_chatDataList.unshift(chatdata_null);//ËøòÂéüÂΩìÂâçÊ†áÁ≠æÈ°µÁöÑÊñ∞ÂØπËØù
				}
				
				//ÂêåÊ≠•this.chatDataList
				this.chatDataList = localStorage_chatDataList;
			},
								
			// ‰øùÂ≠òÂçïÊù°ÂØπËØù ChatData ‰∏çÊîπÂèò‰∏çÂà∑Êñ∞this.chatDataList
			saveChatData_Single(chatdata){
				if(chatdata == null || chatdata.chatcreatedtime == null ){
					return; //chatcreatedtime == null Êñ∞ÂØπËØù‰∏ç‰øùÂ≠ò
				}
				
				//Ëé∑ÂèñÊúÄÊñ∞chatDataList
				let localStorage_chatDataList = this.localStorage_GetDataByKey('chatDataList');
				if(localStorage_chatDataList == null){
					return;
				}
					
				//ÈÄöËøáÂΩìÂâçÁöÑchatdata.chatcreatedtime(ÂØπËØùÁöÑÂàõÂª∫Êó∂Èó¥ÔºåÂîØ‰∏ÄÂÄº)ÊâæÂà∞ÂØπËØù *gptËøòÊé®Ëçê‰∏™ÊñπÊ≥ï:‰ΩøÁî®find ÂíåObject.assign
				const chatdataIndex = localStorage_chatDataList.findIndex((c) => c.chatcreatedtime === chatdata.chatcreatedtime);
				if (chatdataIndex !== -1) {
					localStorage_chatDataList[chatdataIndex] = chatdata;// Â≠òÂú®Êó∂ÔºåÊõ¥Êñ∞
				} else {
					localStorage_chatDataList.unshift(chatdata); // ‰∏çÂ≠òÂú®Êó∂ÔºåÊñ∞Â¢û
				}
				
				try{
					//‰øùÂ≠òÂà∞localStorage
					localStorage.setItem('chatDataList', JSON.stringify(localStorage_chatDataList));
				}catch(e){
					const e_message = e.message ? e.message : '';
					const e_name = e.name ? e.name : '';
					this.localStorageExceedsMaximum(e_message,e_name);
				}
			},
											
			// *Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂  ‰øùÂ≠òÂçïÊù°ÂØπËØù Êõ¥Êñ∞List  ChatData  NoLocalStorage
			saveChatData_NoLocalStorage(chatdata){
				let chat_Data = chatdata;
				if (chatdata == null){
					//Ëé∑ÂèñÂΩìÂâçchatdata
					chat_Data = this.getSelectedChatData();
				}
				if(chat_Data == null || chat_Data.chatcreatedtime == null ){
					return; //chatcreatedtime == null Êñ∞ÂØπËØù‰∏ç‰øùÂ≠ò
				}
					
				//ÈÄöËøáÂΩìÂâçÁöÑchat_Data.chatcreatedtime(ÂØπËØùÁöÑÂàõÂª∫Êó∂Èó¥ÔºåÂîØ‰∏ÄÂÄº)ÊâæÂà∞ÂØπËØù
				const chatdataIndex = this.chatDataList.findIndex((chatdata) => chatdata.chatcreatedtime === chat_Data.chatcreatedtime);
				if (chatdataIndex !== -1) {
					this.chatDataList[chatdataIndex] = chat_Data;// Â≠òÂú®Êó∂ÔºåÊõ¥Êñ∞
				} else {
					this.chatDataList.unshift(chat_Data); // ‰∏çÂ≠òÂú®Êó∂ÔºåÊñ∞Â¢û
				}
				
				//ÊéíÂ∫è
				this.chatDataList_Sort();
			},
			
			// chatDataListÊéíÂ∫è
			chatDataList_Sort(){
				if(this.chatDataList != null){
					//ÊéíÂ∫è Â∞ÜÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥ËΩ¨‰∏∫Êó∂Èó¥Êà≥ÂêéÔºåËøõË°åÊéíÂ∫èÔºåÈôçÂ∫èÔºåÊñ∞Âú®‰∏äÔºånullÁΩÆÈ°∂„ÄÇ {safari‰∏çËÆ§"yyyy-MM-dd HH:mm:ss"Ê†ºÂºè„ÄÇÈÄöËøáreplace(/-/g, "/") ËΩ¨Ê†ºÂºè‰∏∫yyyy/MM/dd HH:mm:ss ÔºåÂÖºÂÆπapple‰∫ßÂìÅ ios macos„ÄÇ} {Â¶ÇÊûú chatlasttime ‰∏∫Á©∫ÔºåÂèØ‰ª•‰ΩøÁî® new Date('9999-12-31') Êù•Ë°®Á§∫‰∏Ä‰∏™ËæÉÊôöÁöÑÊó•Êúü„ÄÇ}
					this.chatDataList.sort((a, b) => {
						const aTime = a.chatlasttime ? new Date(a.chatlasttime.replace(/-/g, "/")).getTime() : new Date('9999-12-31').getTime();
						const bTime = b.chatlasttime ? new Date(b.chatlasttime.replace(/-/g, "/")).getTime() : new Date('9999-12-31').getTime();
						return bTime - aTime;
					});
				}
			},
			
			// Ëé∑ÂèñÂΩìÂâçÂØπËØùÊï∞ÊçÆ return chatData  
			getSelectedChatData(){
				let chatVariables = this.getVariablesFromThis(this.chatVariables_default);
				chatVariables = JSON.parse(JSON.stringify(chatVariables));
				
				// *6.21 ‰∏çË¶ÅÁõ¥Êé•‰ΩøÁî®this.selectedChatDataÔºàÊú™ÂêåÊ≠•ÔºåÊú™ÊâãÂä®Êõ¥Êñ∞Ôºâ
				let chatData = {
					version: this.chatDataList_Version,
					chatcreatedtime: this.chatcreatedtime,
					chatlasttime: this.chatlasttime,
					chatid: this.chatid,
					chattitle: this.chattitle,

					msgList: this.msgList,
					msgContent: this.msgContent,
					msgTokens: this.msgTokens,
					msgContentForMsgList_SingleRound: this.msgContentForMsgList_SingleRound,
					msg: this.msg,
					chatVariables
					
				};
				
				chatData = JSON.parse(JSON.stringify(chatData)); //Èò≤Ê≠¢ÂèåÂêëÁªëÂÆö
				return chatData;
			},
			
			// ÂØπËØùÂàóË°®Á™óÂè£ - ÁÇπÂáªÂØπËØù
			chatList_ClickChatData(chatdata){
				let notif = '';
				if (chatdata.chatcreatedtime === this.chatcreatedtime){ //this.selectedChatData.chatcreatedtime
					return; //Â∑≤ÁªèÈÄâ‰∏≠ÔºåÈáçÂ§çÁÇπÂáª
				}
				
				//0 Ê≠£ÂøôÔºåÁ®çÂêéÂÜçÊìç‰Ωú
				if (this.checkBusyStatus('ForChat')) {
					//Â∫ïÈÉ®‰ºöÂá∫Áé∞ÈÄöÁü•tooltips„ÄÇ Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅ Êàñ Ê≠£Âú®È™åËØÅ Êàñ Ê≠£Âú®Ê†áÁ≠æÈ°µÈó¥ÂêåÊ≠•Êï∞ÊçÆ
					return;
				} 
				
				//1 ÂÖà‰øùÂ≠òÂΩìÂâçdata *‰ºöËé∑ÂèñÊúÄÊñ∞List
				this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
				//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
				if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
					this.saveChatData_NoLocalStorage(null);
				}
				
				//chatdataÂèØËÉΩ‰∏çÊòØÊúÄÊñ∞Ôºå‰ªéList‰∏≠ÂèñÊúÄÊñ∞
				const chat_Data = this.chatDataList.find(c => c.chatcreatedtime === chatdata.chatcreatedtime);
				
				//7 ËØªÂèñ ËØªÂèñÂØπËØùÊï∞ÊçÆ ËøòÂéüËÅäÂ§©ËÆ∞ÂΩï ÊÅ¢Â§çËÅäÂ§©ËÆæÁΩÆ
				this.loadChatData(chat_Data);
				
				//ÂÖ∂‰ªñËØªÂèñÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
				this.$nextTick(() => {
					// 1 2 3 4 5
					this.todoList_ChatDataRestored('hasdata');
				});
				notif = this.settingsLanguage == 'cn' ? 'Â∑≤ÂàáÊç¢ÂØπËØù' : 'Chat is switched' ;
				this.showNotification(notif, 'bottom');
			},			
			
			// Âä†ËΩΩ/ËØªÂèñÂØπËØùÊï∞ÊçÆ ËøòÂéüËÅäÂ§©ËÆ∞ÂΩï ÊÅ¢Â§çËÅäÂ§©ËÆæÁΩÆ
			loadChatData(chatdata){
				this.selectedChatData = chatdata == null ? {} : JSON.parse(JSON.stringify(chatdata)) ;//Èò≤Ê≠¢ÂèåÂêëÁªëÂÆö
				let chatVariables = this.selectedChatData.chatVariables ==  null ? {} : this.selectedChatData.chatVariables ; // chatÂèòÈáè
				chatVariables = JSON.parse(JSON.stringify(chatVariables));
					
				//Êìç‰ΩúÊï∞ÊçÆ‰πãÂâçÔºåÂÖàÂà†Èô§ÂèØËÉΩÂ≠òÂú®ÁöÑËÆ∞ÂøÜÂàÜÂâ≤Á∫ø <hr>Ê†áÁ≠æ ÂàÜÂâ≤Á∫øÊòØÁã¨Á´ãÂ≠òÂú®ÁöÑ ÈùûÁªëÂÆö ‰ºö‰∏ÄÁõ¥Â≠òÂú® ÈúÄË¶ÅÂÖàÂà†Èô§
				const hrElements = document.querySelectorAll('hr.newcontext-hr');
				for (let i = 0; i < hrElements.length; i++) {
					hrElements[i].remove();
				}
				//Êìç‰ΩúÊï∞ÊçÆ‰πãÂâçÔºåÂÖàÂà†Èô§‰πãÂâçÈ°µÈù¢‰∏äÁöÑÊâÄÊúâÁöÑÊ∞îÊ≥°Ê°Ü‰∏≠ÁöÑ‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ(Ê∞îÊ≥°Ê°Ü+ÂÜÖÈÉ®ÂèØËÉΩÂ≠òÂú®ÁöÑ‰ª£Á†ÅÂùó) <button>Ê†áÁ≠æ ‰∏ÄÈîÆÂ§çÂà∂ÊòØÁã¨Á´ãÂ≠òÂú®ÁöÑ ÈùûÁªëÂÆö ÈáçÂ§çÊ∏≤Êüì‰ºöÂá∫Áé∞ÈáçÂ§çÊåâÈíÆ ÈúÄË¶ÅÂÖàÂà†Èô§
				//ÈáçÂè†ÁöÑÊåâÈíÆÂú®ÁïåÈù¢‰∏äÁúã‰∏çÂá∫Êù•ÔºåÂΩì‰ΩøÁî®‰∏ÄÈîÆÂ§çÂà∂Êó∂ÔºåÊØè‰∏™ÊåâÈíÆÈÉΩ‰ºöÊàê‰∏∫‰∏Ä‰∏™Á©∫Ë°åÔºåÂΩ±ÂìçÂ§çÂà∂ÁöÑÂÜÖÂÆπ
				const msgcopydiv = document.querySelectorAll('.msgcopydiv');
				for (let i = 0; i < msgcopydiv.length; i++) {
					const copybtn = msgcopydiv[i].querySelectorAll('.copybtn');
					for (let j = 0; j < copybtn.length; j++) {
						copybtn[j].remove();
					}
				}
				
				// ÊâπÈáèËøòÂéüchatÂèòÈáè  *Èò≤ÁªëÂÆö
				this.setVariablesToThis(chatVariables, this.chatVariables_default, true);//Ê†πÊçÆÂèòÈáèÂàóË°®ÂíåÈªòËÆ§ÂÄº ËøòÂéüÂèòÈáè
				
				// ÊâπÈáèËøòÂéüchat dataÂèòÈáè  *Èò≤ÁªëÂÆö  //ÈúÄË¶ÅÊéíÈô§ÔºöÂèòÈáè„ÄÅÁâàÊú¨Ôºåthis.chatData_defaultÂàóË°®‰∏≠Â∑≤ÊéíÈô§
				this.setVariablesToThis(JSON.parse(JSON.stringify(this.selectedChatData)), this.chatData_default, false);//Ê†πÊçÆÂèòÈáèÂàóË°®ÂíåÈªòËÆ§ÂÄº ËøòÂéüÂèòÈáè
				
				// ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ *Âª∂Ëøü10ms È¶ñÊ¨°Âä†ËΩΩÁΩëÈ°µÊó∂ÔºåÂä†Âª∂ËøüÁ°Æ‰øùapikeyÊï∞ÊçÆÂÖàËØªÂèñÂÆåÔºåÈÅøÂÖçapikeyÊï∞ÊçÆÊú™ÂáÜÂ§áÂ•ΩÂØºËá¥ÊåâÈíÆÁä∂ÊÄÅÈîôËØØ
				setTimeout(() => {
					this.inputapichange(false); //false=‰∏çÂºπÈÄöÁü•
				}, 10);
				
				// ‰øùÂ≠òÊèêÁ§∫ËØçÊåâÈíÆ ËÆæ‰∏∫ÂèØÁî®
				this.btnDisabledState_SetSystemPrompt = false;
				
			},
			
			// ÂØπËØùÂàóË°®Á™óÂè£ - ‰øÆÊîπChat ID
			chatList_EditChatID(chatdata){
				event.stopPropagation();
				
				//0 Ê≠£ÂøôÔºåÁ®çÂêéÂÜçÊìç‰Ωú
				if (this.checkBusyStatus('ForChat')) {
					//Â∫ïÈÉ®‰ºöÂá∫Áé∞ÈÄöÁü•tooltips„ÄÇ Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅ Êàñ Ê≠£Âú®È™åËØÅ Êàñ Ê≠£Âú®Ê†áÁ≠æÈ°µÈó¥ÂêåÊ≠•Êï∞ÊçÆ
					return;
				} 
				//1 ÂÖà‰øùÂ≠òÂΩìÂâçdata *‰ºöËé∑ÂèñÊúÄÊñ∞ÁöÑList (this.chatDataList)
				this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
				
			//ÂºπÁ™óÂâç Âª∂Êó∂0.1Áßí  *ÂêåÊ≠•ÁºìÂÜ≤
			setTimeout(() => {	
				// Ê†πÊçÆidÊü•ÊâæÂØπÂ∫îÁöÑÂØπËØù  *Êï∞ÊçÆ‰ºöÁªëÂÆö
				const chat_Data = this.chatDataList.find(c => c.chatcreatedtime === chatdata.chatcreatedtime);
				if (chat_Data) {
					// ÊòæÁ§∫ÂºπÁ™óÔºåÂÖÅËÆ∏Áî®Êà∑ËæìÂÖ•Êñ∞ÁöÑID
					let newID = null;
					const maxLength = 20; //ÂèØ‰ª•‰∏çÂÅöÈôêÂà∂Ôºå20Âπ∂Êó†ÁâπÊÆäÊÑè‰πâ
					const regex = /[^\x00-\xff]/g; // ÂåπÈÖç‰∏≠Êó•Èü©Á≠âÊñáÂ≠óÊàñÂÖ®ËßíÁ¨¶Âè∑ÁöÑÊ≠£ÂàôË°®ËææÂºè
					let text = this.settingsLanguage == 'cn' ? '‰øÆÊîπÂØπËØùIDÔºö' : 'Edit Chat ID:';
					let err = false;
					this.is_Alert_Confirm_Prompt_Open = true;
					while (newID === null || newID.replace(regex, "aa").length > maxLength) {
						newID = newID === null ? (chat_Data.chatid == null ? '' : chat_Data.chatid) : newID;
						if (err){
							text = this.settingsLanguage == 'cn' ? '‰øÆÊîπÂØπËØùIDÔºåÊúÄÂ§ß ' + maxLength + ' ‰∏™Â≠óÁ¨¶(‰∏≠Êñá‰∏∫10‰∏™Â≠ó)Ôºö' : 'Edit Chat ID, maximum length is ' + maxLength + ' .(some characters may take up more than one character space):';
						}
						newID = window.prompt(text, newID);
						if (newID === null) {
							break; // Áî®Êà∑ÁÇπÂáª‰∫ÜÂèñÊ∂àÊåâÈíÆÔºåÁªìÊùüÂæ™ÁéØ
						}
						err = true;
					}
					setTimeout(() => {
						this.is_Alert_Confirm_Prompt_Open = false;
					}, 100);
					
				//ÂºπÁ™óÂêé Âª∂Êó∂0.2Áßí  *ÂêåÊ≠•ÁºìÂÜ≤
				setTimeout(() => {
				
					if(newID !== null){ //chat_Data‰øÆÊîπÂêéÔºåthis.chatDataList‰∏≠ÂØπÂ∫îÊï∞ÊçÆ‰ºöËá™Âä®Êõ¥Êñ∞
					
						//Á¨¨‰∫å‰∏™ÂÆöÊó∂Âô®‰ºöÂØºËá¥ÁªëÂÆöÂ§±ÁÅµ(ÂõûËΩ¶ÊàñÁÇπÂáªÁ°ÆËÆ§Âêé ‰∏ç‰ºöÁ´ãÂç≥Êõ¥Êñ∞)ÔºåÈáçÊñ∞ÂÜçÁªëÂÆö‰∏ÄÊ¨°chat_Data
						const chat_Data = this.chatDataList.find(c => c.chatcreatedtime === chatdata.chatcreatedtime);
					
						chat_Data.chatid = newID.trim();
						if(chat_Data.chatcreatedtime === this.chatcreatedtime){ //this.selectedChatData.chatcreatedtime
							this.chatid = newID.trim();
						}
				
						if(chat_Data.chatcreatedtime != null ){ //Â¶ÇÊûú‰øÆÊîπÂØπË±°‰∏çÊòØÊñ∞ÂØπËØùÔºåÈÇ£‰πàÊâãÂä®‰øùÂ≠òÂà∞localStorage
							////Â∞ÜÊúÄÊñ∞ÁöÑthis.chatDataListÔºàÈúÄË¶ÅÂéªnullÔºâ‰øùÂ≠òÂà∞localStorage
							//const newChatDataList =  this.chatDataList.filter(c => c.chatcreatedtime !== null);
							//localStorage.setItem('chatDataList', JSON.stringify(newChatDataList));
							this.saveChatData_Single(chat_Data); //Âçï‰∏ÄÁöÑ‰øùÂ≠òÔºå‰∏çÂΩ±ÂìçÁïåÈù¢‰ªª‰ΩïÊï∞ÊçÆ
						}
						
						const notif = this.settingsLanguage == 'cn' ? '‰øÆÊîπÊàêÂäü' : 'Modification successful' ;
						this.showNotification(notif, 'bottom');
					}
				//Âª∂Êó∂0.2Áßí
				}, 200);
				}
			//Âª∂Êó∂0.1Áßí
			}, 100);
			},
			
			// ÂØπËØùÂàóË°®Á™óÂè£ - ‰øÆÊîπChat Title
			chatList_EditChatTitle(chatdata){
				event.stopPropagation();
				
				//0 Ê≠£ÂøôÔºåÁ®çÂêéÂÜçÊìç‰Ωú
				if (this.checkBusyStatus('ForChat')) {
					//Â∫ïÈÉ®‰ºöÂá∫Áé∞ÈÄöÁü•tooltips„ÄÇ Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅ Êàñ Ê≠£Âú®È™åËØÅ Êàñ Ê≠£Âú®Ê†áÁ≠æÈ°µÈó¥ÂêåÊ≠•Êï∞ÊçÆ
					return;
				} 
				//1 ÂÖà‰øùÂ≠òÂΩìÂâçdata *‰ºöËé∑ÂèñÊúÄÊñ∞ÁöÑList (this.chatDataList)
				this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
				
			//ÂºπÁ™óÂâç Âª∂Êó∂0.1Áßí  *ÂêåÊ≠•ÁºìÂÜ≤
			setTimeout(() => {	
				// Ê†πÊçÆidÊü•ÊâæÂØπÂ∫îÁöÑÂØπËØù  *Êï∞ÊçÆ‰ºöÁªëÂÆö
				let chat_Data = this.chatDataList.find(c => c.chatcreatedtime === chatdata.chatcreatedtime);
				if (chat_Data) {
					// ÊòæÁ§∫ÂºπÁ™óÔºåÂÖÅËÆ∏Áî®Êà∑ËæìÂÖ•Êñ∞ÁöÑÊ†áÈ¢ò
					let newTitle = null;
					const maxLength = 46; //ÂèØ‰ª•‰∏çÂÅöÈôêÂà∂Ôºå46Âπ∂Êó†ÁâπÊÆäÊÑè‰πâ
					const regex = /[^\x00-\xff]/g; // ÂåπÈÖç‰∏≠Êó•Èü©Á≠âÊñáÂ≠óÊàñÂÖ®ËßíÁ¨¶Âè∑ÁöÑÊ≠£ÂàôË°®ËææÂºè
					let text = this.settingsLanguage == 'cn' ? '‰øÆÊîπÂØπËØùÊ†áÈ¢òÔºö' : 'Edit Chat Title:';
					let err = false;
					this.is_Alert_Confirm_Prompt_Open = true;
					while (newTitle === null || newTitle.replace(regex, "aa").length > maxLength) {
						newTitle = newTitle === null ? chat_Data.chattitle : newTitle;
						if (err){
							text = this.settingsLanguage == 'cn' ? '‰øÆÊîπÂØπËØùÊ†áÈ¢òÔºåÊúÄÂ§ß ' + maxLength + ' ‰∏™Â≠óÁ¨¶(‰∏≠Êñá‰∏∫23‰∏™Â≠ó)Ôºö' : 'Edit Chat Title, max ' + maxLength + ' characters (some characters may take up more than one character space):';
						}
						newTitle = window.prompt(text, newTitle);
						if (newTitle === null) {
							break; // Áî®Êà∑ÁÇπÂáª‰∫ÜÂèñÊ∂àÊåâÈíÆÔºåÁªìÊùüÂæ™ÁéØ
						}
						err = true;
					}
					setTimeout(() => {
						this.is_Alert_Confirm_Prompt_Open = false;
					}, 100);
					
				//ÂºπÁ™óÂêé Âª∂Êó∂0.2Áßí  *ÂêåÊ≠•ÁºìÂÜ≤
				setTimeout(() => {
					
					if(newTitle !== null){ //chat_Data‰øÆÊîπÂêéÔºåthis.chatDataList‰∏≠ÂØπÂ∫îÊï∞ÊçÆ‰ºöËá™Âä®Êõ¥Êñ∞
					
						//Á¨¨‰∫å‰∏™ÂÆöÊó∂Âô®‰ºöÂØºËá¥ÁªëÂÆöÂ§±ÁÅµ(ÂõûËΩ¶ÊàñÁÇπÂáªÁ°ÆËÆ§Âêé ‰∏ç‰ºöÁ´ãÂç≥Êõ¥Êñ∞)ÔºåÈáçÊñ∞ÂÜçÁªëÂÆö‰∏ÄÊ¨°chat_Data
						chat_Data = this.chatDataList.find(c => c.chatcreatedtime === chatdata.chatcreatedtime);
					
						chat_Data.chattitle = newTitle.trim();
						if(chat_Data.chatcreatedtime === this.chatcreatedtime){ //this.selectedChatData.chatcreatedtime
							this.chattitle = newTitle.trim();
						}
				
						if(chat_Data.chatcreatedtime != null ){ //Â¶ÇÊûú‰øÆÊîπÂØπË±°‰∏çÊòØÊñ∞ÂØπËØùÔºåÈÇ£‰πàÊâãÂä®‰øùÂ≠òÂà∞localStorage
							////Â∞ÜÊúÄÊñ∞ÁöÑthis.chatDataListÔºàÈúÄË¶ÅÂéªnullÔºâ‰øùÂ≠òÂà∞localStorage
							//const newChatDataList =  this.chatDataList.filter(c => c.chatcreatedtime !== null);
							//localStorage.setItem('chatDataList', JSON.stringify(newChatDataList));
							this.saveChatData_Single(chat_Data); //Âçï‰∏ÄÁöÑ‰øùÂ≠òÔºå‰∏çÂΩ±ÂìçÁïåÈù¢‰ªª‰ΩïÊï∞ÊçÆ
						}
						
						const notif = this.settingsLanguage == 'cn' ? '‰øÆÊîπÊàêÂäü' : 'Modification successful' ;
						this.showNotification(notif, 'bottom');
					}
				//Âª∂Êó∂0.2Áßí
				}, 200);
				}
			//Âª∂Êó∂0.1Áßí
			}, 100);
			},	
						
			// ÂØπËØùÂàóË°®Á™óÂè£ - Êñ∞ÁöÑÂØπËØù  Êàñ  Âä†ËΩΩÁΩëÈ°µÊó†Êú¨Âú∞Êï∞ÊçÆÊó∂ÁöÑÂàùÂßãÂåñ
			chatList_addNewChatData(isblankpage){
				let notif = '';
				const isBlank_OnPageLoad = (isblankpage == event || isblankpage == null ) ? false : isblankpage;
				
				if( !isBlank_OnPageLoad ){ //(ÈùûÂä†ËΩΩÊñ∞È°µÈù¢) ÁÇπÂáªÊ∑ªÂä†Êñ∞ÂØπËØùÊó∂
					//0 Ê≠£ÂøôÔºåÁ®çÂêéÂÜçÊìç‰Ωú
					if (this.checkBusyStatus('ForChat')) {
						//Â∫ïÈÉ®‰ºöÂá∫Áé∞ÈÄöÁü•tooltips„ÄÇ Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅ Êàñ Ê≠£Âú®È™åËØÅ Êàñ Ê≠£Âú®Ê†áÁ≠æÈ°µÈó¥ÂêåÊ≠•Êï∞ÊçÆ
						return;
					}
					//1 ÂΩìÂâçÈùûÊñ∞ÂØπËØùÔºåÂàôÂÖà‰øùÂ≠ò„ÄÇ ÂΩìÂâç‰∏∫Êñ∞ÂØπËØùÔºåÂàôËøîÂõû„ÄÇ
					if(this.chatcreatedtime != null){ //this.selectedChatData.chatcreatedtime
						this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
						//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
						if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
							this.saveChatData_NoLocalStorage(null);
						}
						//ÂΩìÂâçËôΩÁÑ∂‰∏çÊòØÊñ∞ÂØπËØùÔºå‰ΩÜÊòØÂàóË°®ÈáåÂ≠òÂú®Êñ∞ÁöÑÂØπËØù
						const nullIndex = this.chatDataList.findIndex((chatdata) => chatdata.chatcreatedtime === null);
						if (nullIndex !== -1) {
							notif = this.settingsLanguage == 'cn' ? 'ÂàóË°®‰∏≠Â∑≤Â≠òÂú®Á©∫ÁôΩÂØπËØùÔºåÊòØÂê¶ÁªßÁª≠ÁîüÊàêÊñ∞ÁöÑÂØπËØùÔºü' : 'New blank chat exists in the list. Continue creating a new chat?' ;
							this.is_Alert_Confirm_Prompt_Open = true;
							const confirmed = confirm(notif); //Áî®Êà∑ÈÄâÊã©ÊòØÂê¶ÁªßÁª≠ÔºåÁªßÁª≠‰ºöÂà†Èô§‰πãÂâçÁöÑÁ©∫ÁôΩÂØπËØù
							if (!confirmed) {
								setTimeout(() => {
									this.is_Alert_Confirm_Prompt_Open = false;
								}, 100);
								return;//ÂèñÊ∂à Â∞ÜËøîÂõû
							}
							setTimeout(() => {
								this.is_Alert_Confirm_Prompt_Open = false;
							}, 100);
						}
					}else{
						if(this.chatDataList.length > 0){
							notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÂ∑≤ÁªèÊòØÊñ∞ÁöÑÂØπËØù' : 'A new chat has already been started.' ;
							this.showNotification(notif, 'bottom');
							return; //ËøîÂõûÔºåÂè™ËÉΩÂ≠òÂú®‰∏Ä‰∏™Êñ∞ÁöÑÂØπËØù
						}else{ 
							//length==0ÔºåÊÑèÂ§ñ‰∏∫Á©∫Êó∂ÔºåÁªßÁª≠ÊâßË°å„ÄÇÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ã‰∏ç‰ºöÂá∫Áé∞ËøôÁßçÊÉÖÂÜµ
						}
					}
				}
				
				//2 Êñ∞ÂØπËØùÁöÑÈªòËÆ§ÂèòÈáè ÈªòËÆ§ÂÄº 
				const chatVariables = JSON.parse(JSON.stringify(this.chatVariables_default));
				
				//3 Êñ∞ÂØπËØùchatdataÈªòËÆ§ËÆæÁΩÆ
				let chatData = JSON.parse(JSON.stringify(this.chatData_default));
				chatData.version = this.chatDataList_Version;//ÊâãÂä®Ê∑ªÂä†ÁâàÊú¨Âè∑
				chatData.chatVariables = chatVariables; //ÊâãÂä®Ê∑ªÂä†chatVariables
				
				//ÂèòÊõ¥chatid  = ÂàùÂßãÂåñÊñ∞ID
				let newChatId = 1;
				while (this.chatDataList.some((chatdata) => parseInt(chatdata.chatid) === newChatId)) {
				  newChatId++;
				}
				chatData.chatid = newChatId.toString() ; //Chat ID *ÂèØÈáçÂ§ç
				
				if( !isBlank_OnPageLoad ){ //ÈùûÂä†ËΩΩÊñ∞È°µÈù¢ & Â≠òÂú®Êú¨Âú∞Êï∞ÊçÆÊó∂
					//4 Â¶ÇÊûúÂ≠òÂú®nullÁöÑchatdataÔºåÂÖàÂà†Èô§ÔºåÂÜçÊñ∞Â¢û
					this.chatDataList = this.chatDataList.filter(c => c.chatcreatedtime !== null);
					//5 ÊéíÂ∫è
					this.chatDataList_Sort();
				}
				
				//6 Êñ∞Â¢û
				this.chatDataList.unshift(chatData); 
				//7 ËØªÂèñ ËØªÂèñÂØπËØùÊï∞ÊçÆ ËøòÂéüËÅäÂ§©ËÆ∞ÂΩï ÊÅ¢Â§çËÅäÂ§©ËÆæÁΩÆ
				this.loadChatData(this.chatDataList[0]); //Ê≠§Êó∂chatcreatedtime‰∏∫nullÔºå‰∏ÄÂÆöÊòØ[0]„ÄÇ*ÈîôËØØÁöÑÊó•ÊúüÔºåÊØîÂ¶ÇÂØºÂÖ•2025Âπ¥ÁöÑchatdataÔºå‰πü‰∏ç‰ºöÂΩ±Âìç[0]
				
				//8 ÈíàÂØπÊñ∞ÂØπËØù/Á©∫ÂØπËØù ÂÖ∂‰ªñÂçïÁã¨ÁöÑËÆæÁΩÆ/ÂèòÈáèÔºö
				//ÂÖ∂‰ªñËØªÂèñÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
				this.$nextTick(() => {
					// 1 3 4 5 7
					this.todoList_ChatDataRestored('new');	
				});
				
				if( !isBlank_OnPageLoad ){ //(ÈùûÁΩëÈ°µÂä†ËΩΩ) ÁÇπÂáªÊ∑ªÂä†Êñ∞ÂØπËØùÊó∂
					notif = this.settingsLanguage == 'cn' ? 'Êñ∞ÂØπËØùÂºÄÂßã' : 'New chat started' ;
					this.showNotification(notif, 'bottom');
				}
			},
			
			// chat dataËøòÂéüÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
			todoList_ChatDataRestored(mode,notiftime){
				//1 È¶ñÊù° Ê¨¢ËøéËØ≠
				this.initTheFirstMessage(); //First Message 
				
				//2 (ÊúâÊï∞ÊçÆÊó∂) ÊÅ¢Â§çÊ†∑Âºè Êõ¥Êñ∞Ê†∑Âºè
				if(mode == 'hasdata'){
					this.add_hr_For_ChatDataRestored(); //ÂÖàÊâãÂä®Ê∑ªÂä†ÂàÜÂâ≤Á∫ø
					this.changeStyle_Time_WechatStyle();
					this.changeStyle_FontSize(); //6.20 ÊöÇÊó∂Êó†ÂÜÖÂÆπ
					this.changeStyle_Time(); //6.20 ÊöÇÊó∂Êó†ÂÜÖÂÆπ
					this.changeStyle_DividerLine(); //ÊúÄÂêéÔºåÊòØÂê¶ÊòæÁ§∫ÂàÜÂâ≤Á∫ø
					
					//v7.17 ÂΩìËÅäÂ§©ËæìÂÖ•Ê°ÜÊúâÂÜÖÂÆπÊó∂ÔºåÈúÄË¶ÅÈáçÊñ∞ËÆ∞ÂΩïmaxHeightÔºåÂà∑Êñ∞ÂêéÊàñÂàáÊç¢ÂØπËØùÂêéÔºåÁÇπÂáªËæìÂÖ•Ê°ÜÊâçËÉΩÊÅ¢Â§çÊ≠£Á°ÆÁöÑÈ´òÂ∫¶   max-height maxHeight
					let textarea_Chat = document.querySelector('.textareachatinputbox');
					const scrollHeight = textarea_Chat.scrollHeight;
					const height6px = parseInt(scrollHeight) + 6; // +
					if( parseInt(scrollHeight) <= 38){
						textarea_Chat.style.maxHeight = '38px';
					}else if( parseInt(scrollHeight) < 450){
						//textarea_Chat.style.maxHeight = scrollHeight + 'px'; // -
						textarea_Chat.style.maxHeight = height6px.toString() + 'px'; // +
					}
					else{
						textarea_Chat.style.maxHeight = '456px'; // + 6
					}
				}
				
				//3 ÊîπÂèòÊåâÈíÆÊñáÂ≠ó
				const isuser = this.msgList[this.msgList.length - 1]["my"];
				if( !isuser && (this.sentext == 'ËØ∑ÈáçÂèë'|| this.sentext == 'Please Retry') ){
					this.sentext = this.settingsLanguage == 'cn' ? 'ÂèëÈÄÅ' : 'Send';
				}
				if( isuser && (this.sentext == 'ÂèëÈÄÅ'|| this.sentext == 'Send') ){
					this.sentext = this.settingsLanguage == 'cn' ? 'ËØ∑ÈáçÂèë' : 'Please Retry';
				}
				
				//4 ÊâπÈáèÊ∑ªÂä†‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ Êï¥‰∏™È°µÈù¢(Âê´È¶ñÊù°Ê¨¢ËøéËØ≠)
				this.initAddCopyButtonForMessage();
							
				//5 Êõ¥Êñ∞Á¨¨‰∏ÄÊù°Ê∂àÊÅØ/Ê¨¢ËøéËØ≠ÁöÑdatetime
				const firstDatetime = this.formatDateYYYYMMDDHHmmss(new Date(),':');
				this.msgList[0]['datetime'] = this.msgList[0]['datetime'] == "2000-01-01 00:00:00" ? firstDatetime : this.msgList[0]['datetime']; //‰∏çÁ≠â‰∫é2000Âπ¥ÁöÑÊó∂Èó¥ÔºåËØ¥ÊòéËØªÂèñ‰∫ÜÁºìÂ≠ò
				this.msgContentForMsgList_SingleRound[0]['datetime']  = this.msgContentForMsgList_SingleRound[0]['datetime'] == "2000-01-01 00:00:00" ? firstDatetime : this.msgContentForMsgList_SingleRound[0]['datetime'];
				
				//6 (ÊúâÊï∞ÊçÆÊó∂) Âª∂ËøüÊªöÂä®
				if(notiftime != null && typeof notiftime === 'number'){
					//Âª∂Ëøü****ÊØ´ÁßíÔºåÊªöÂä®Âà∞ÊúÄ‰∏ãÊñπ
					setTimeout(() => {
						this.scrollToBottomView(); 
					}, notiftime);	
				}else{
					//ÂÖ∂‰ªñÊÉÖÂÜµ‰∏çÂª∂Ëøü„ÄÇÊéíÈô§Êñ∞ÂØπËØù
					if(mode != 'new'){
						this.scrollToBottomView(); 
					}
				}
				
				//7 (Êñ∞ÁöÑÂØπËØù) Èùû‰∏≠Êñá Êîπ# Chat History 
				if(mode == 'new'){
					if(this.settingsLanguage != 'cn'){
						this.chathistory = '# Chat History  \r\n\r\n' ;
					}
				}
			},
				
			// ÂØπËØùÂàóË°®Á™óÂè£ - Êõ¥Â§öÊìç‰ΩúÔºöÂàõÂª∫ÂâØÊú¨ Ê∏ÖÁ©∫  *tipsÔºöÊâãÊú∫/ÁßªÂä®Á´ØÔºåÁÇπÂáª‰∏ãÊãâÊ°ÜÂêé‰ºöËé∑ÂæóÁÑ¶ÁÇπÔºà‰∏ÄÂÆöÊòØÂΩìÂâçÂØπËØùÔºâ„ÄÇÁîµËÑëÁ´Ø‰∏ç‰ºöËé∑ÂæóÁÑ¶ÁÇπÔºå‰∏ç‰∏ÄÂÆöÊòØÂΩìÂâçÂØπËØù„ÄÇ
			changeSelectedChatListMoreOptions(chatdata){
				event.stopPropagation();
				if (this.checkBusyStatus('ForChat')) {
					this.selectedChatListMoreOptions = ''; //Â§çÂéü
					//Â∫ïÈÉ®‰ºöÂá∫Áé∞ÈÄöÁü•tooltips„ÄÇ Â¶ÇÊûúËøîÂõû trueÔºå Ê≠£Âú®ÂèëÈÄÅ Êàñ Ê≠£Âú®È™åËØÅ Êàñ Ê≠£Âú®Ê†áÁ≠æÈ°µÈó¥ÂêåÊ≠•Êï∞ÊçÆ
					return;
				}
				
				let optionsStr = this.selectedChatListMoreOptions;
				this.selectedChatListMoreOptions = ''; //Â§çÂéü
				const iscurrentdata = ( this.chatcreatedtime === chatdata.chatcreatedtime ); //this.selectedChatData.chatcreatedtime
				
				
				if(optionsStr === 'CreateCopy'){
				// 2) ÂàõÂª∫ÂâØÊú¨
					//1 ÂÖà‰øùÂ≠òÂΩìÂâçdata  Âà∑Êñ∞ChatDataList
					this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
					//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
					if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
						this.saveChatData_NoLocalStorage(null);
					}
				
				//Âª∂Êó∂0.15Áßí  *ÂêåÊ≠• ÁºìÂÜ≤
				setTimeout(() => {
					let chat_Data = this.chatDataList.find(c => c.chatcreatedtime === chatdata.chatcreatedtime);//Á°Æ‰øùchatdataÊï∞ÊçÆÊúÄÊñ∞Ôºå‰∏ªË¶ÅÈíàÂØπcopyÂΩìÂâçÂØπËØùÁöÑÊÉÖÂÜµ
					let chatDataCopy = JSON.parse(JSON.stringify(chat_Data));
					chatDataCopy.chatcreatedtime = this.newChatCreatedTime_ForCopyChatData(chat_Data);//ÁîüÊàêÊñ∞ÁöÑchatcreatedtime
					chatDataCopy.chatlasttime = this.formatDateYYYYMMDDHHmmss(new Date(),':'); //Áé∞Âú®ÁöÑÊó∂Èó¥
					chatDataCopy.chatid += this.settingsLanguage == 'cn' ? ' ÂâØÊú¨' : ' Copy' ;
				  
					//Êñ∞Â¢ûÂà∞List
					this.chatDataList.unshift(chatDataCopy);
							
					//ËØªÂèñ ËØªÂèñÂØπËØùÊï∞ÊçÆ ËøòÂéüËÅäÂ§©ËÆ∞ÂΩï ÊÅ¢Â§çËÅäÂ§©ËÆæÁΩÆ
					this.loadChatData(chatDataCopy);
				
					//ÂÖ∂‰ªñËØªÂèñÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
					this.$nextTick(() => {
						// 1 2 3 4 5
						this.todoList_ChatDataRestored('hasdata');
					});
					
					// 3) ‰øùÂ≠òÔºö ÂâØÊú¨
					this.saveChatData_Single(chatDataCopy); //Âçï‰∏ÄÁöÑ‰øùÂ≠òÔºå‰∏çÂΩ±ÂìçÁïåÈù¢‰ªª‰ΩïÊï∞ÊçÆ
					//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
					if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
						//ÂâçÈù¢Â∑≤ÁªèÊúâÊñ∞Â¢ûÂà∞ListÁöÑ‰ª£Á†Å  this.saveChatData_NoLocalStorage(chatDataCopy);
					}
	
					this.chatDataList_Sort();// ChatDataListÊéíÂ∫è
				
					const notif = this.settingsLanguage == 'cn' ? 'ÊàêÂäüÂàõÂª∫ { #' + chatDataCopy.chatid + ' }ÔºåÂΩìÂâçÂØπËØù‰∏∫ { #' + chat_Data.chatid + ' } ÁöÑÂâØÊú¨' : 'Copy of chat { #' + chatDataCopy.chatid + ' } created successfully. It is a replica of chat { #' + chat_Data.chatid + ' } .' ;
					this.showNotification(notif, 'bottom', '',5500);
					
					//ÂõûÂà∞È°∂ÈÉ®
					this.gotoTop_List();

				//Âª∂Êó∂0.15Áßí
				}, 150);
					
				}else if(optionsStr === 'ClearPrevious'){ 
				// 3) Ê∏ÖÁ©∫ËÆ∞ÂΩïÔºà‰øùÁïôÊúÄËøëÂçïËΩÆÂØπËØùÔºâ Clear the history (Keep the latest round)
					//1 ÂÖà‰øùÂ≠òÂΩìÂâçdata  Âà∑Êñ∞ChatDataList
					this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
					//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
					if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
						this.saveChatData_NoLocalStorage(null);
					}
				
				//Âª∂Êó∂0.15Áßí  *ÂêåÊ≠• ÁºìÂÜ≤
				setTimeout(() => {
					//chatdata
					let chat_Data = this.chatDataList.find(c => c.chatcreatedtime === chatdata.chatcreatedtime);//Á°Æ‰øùchatdataÊï∞ÊçÆÊúÄÊñ∞Ôºå‰∏ªË¶ÅÈíàÂØπÂΩìÂâçÂØπËØùÁöÑÊÉÖÂÜµ
					chat_Data.chatlasttime = this.formatDateYYYYMMDDHHmmss(new Date(),':'); //Áé∞Âú®ÁöÑÊó∂Èó¥
					
					// Â§ÑÁêÜmsgList
					const numLastMsgs = chat_Data.msgContentForMsgList_SingleRound.length - 1; //ÊúÄÂêé‰∏ÄËΩÆÂØπËØùlistÁöÑÈïøÂ∫¶Ôºå-1 ÂéªÊéâÈ¶ñÊù°Ê¨¢ËøéËØ≠ÔºåÂâ©‰∏ãÂ∞±ÊòØmsgÁöÑÊï∞ÈáèÔºåÂåÖÂê´Â§±Ë¥•ÁöÑmsg
					if(chat_Data.msgList.length > 1){
						if(numLastMsgs == 0){
							chat_Data.msgList = [chat_Data.msgList[0]];
						}else{
							const lastMsgs = chat_Data.msgList.slice(-numLastMsgs); //Êà™ÂèñÊúÄÂêé‰∏ÄËΩÆ *numLastMsgs‰∏çËÉΩ‰∏∫0Ôºå‰∏∫0Êó∂‰ºöËøîÂõûÊï¥‰∏™chat_Data.msgList
							chat_Data.msgList = [chat_Data.msgList[0]].concat(lastMsgs); //ÊãºÊé•: È¶ñÊù° + ÊúÄÂêé‰∏ÄËΩÆ
						}
					}

					//ÈùûÂΩìÂâçÂØπËØù
					//ÂèòÈáè‰øùÊåÅ‰∏çÂèòÔºå‰ªÖchathistoryÈúÄË¶ÅÂçïÁã¨Â§ÑÁêÜ
					//Â§ÑÁêÜchathistory
					let history = chat_Data.chatVariables.chathistory;
					const historyhead = this.settingsLanguage == 'cn' ? '# GPTËÅäÂ§©ËÆ∞ÂΩï / Chat History  \r\n\r\n' : '# Chat History  \r\n\r\n' ;
					const dividerLineTxt1 = this.settingsLanguage == 'cn' ? '#### #Êó†ËÆ∞ÂøÜÁä∂ÊÄÅÔºåÊñ∞ÂØπËØùÂºÄÂßã\r\n***\r\n\r\n' : '#### #The context was emptied. New Chat begins.\r\n***\r\n\r\n' ;
					const dividerLineTxt2 = this.settingsLanguage == 'cn' ? '#### #Êó†ËÆ∞ÂøÜÁä∂ÊÄÅÔºåÊñ∞ÂØπËØùÂºÄÂßã\r\n***\r\n\r\n' : '#### #The context was emptied. New Chat begins.\r\n***\r\n\r\n' ;
					let lastHeadIndex = history.lastIndexOf(dividerLineTxt1); //ÊâæÊ≠£Â∏∏ËØ≠Ë®Ä...
					let dividerLineTxtLength = dividerLineTxt1.length ; 
					if (lastHeadIndex === -1) {
						lastHeadIndex = history.lastIndexOf(dividerLineTxt2); //Êâæ‰∏çÂà∞ÔºåÂ∞±ÊâæÂè¶‰∏ÄÁßç...
						dividerLineTxtLength = dividerLineTxt2.length ; 
					}
					if (lastHeadIndex !== -1) {
						chat_Data.chatVariables.chathistory = history.substring(lastHeadIndex + dividerLineTxtLength);//‰ªéÂéÜÂè≤ËÆ∞ÂΩï‰∏≠ÊúÄÂêé‰∏ÄÊ¨°ÂàÜÂâ≤Á∫øÊú´Â∞æÂºÄÂßãÊà™Âèñ
						chat_Data.chatVariables.chathistory = historyhead + chat_Data.chatVariables.chathistory ;//Âä†‰∏ähead
					}else{ //‰∏§Ê¨°ÈÉΩÊ≤°ÂåπÈÖçÂà∞
						//chat_Data.chatVariables.chathistoryÂ∞±ÊòØÊúÄÂêé‰∏ÄËΩÆÔºåÊó†ÈúÄÊîπÂèò
					}
					
					//Â¶ÇÊûúÊòØÂΩìÂâçÂØπËØù
					if(iscurrentdata){
						//ËØªÂèñ Âà∑Êñ∞
						this.loadChatData(chat_Data);
						//‰øùÂ≠òÂΩìÂâçdata *‰ºöËé∑ÂèñÊúÄÊñ∞List
						this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
						//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
						if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
							this.saveChatData_NoLocalStorage(null);
						}
						//ÂÖ∂‰ªñËØªÂèñÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
						this.$nextTick(() => {
							// 1 2 3 4 5 6
							this.todoList_ChatDataRestored('hasdata', 50);	
						});
						
						//ÂõûÂà∞È°∂ÈÉ®
						this.gotoTop_List();
					}else{
						
						this.saveChatData_Single(chat_Data); //Âçï‰∏ÄÁöÑ‰øùÂ≠òÔºå‰∏çÂΩ±ÂìçÁïåÈù¢‰ªª‰ΩïÊï∞ÊçÆ
						//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
						if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
							this.saveChatData_NoLocalStorage(chat_Data);
						}
						this.chatDataList_Sort();// ChatDataListÊéíÂ∫è
					}
				//Âª∂Êó∂0.15Áßí
				}, 150);
				
				}else if(optionsStr === 'ClearAll'){ 
				// 4) Ê∏ÖÁ©∫ÊâÄÊúâËÆ∞ÂΩï Clear the history
					//1 ÂÖà‰øùÂ≠òÂΩìÂâçdata  Âà∑Êñ∞ChatDataList
					this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
					//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
					if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
						this.saveChatData_NoLocalStorage(null);
					}
				
				//Âª∂Êó∂0.15Áßí  *ÂêåÊ≠• ÁºìÂÜ≤
				setTimeout(() => {
					//chatdata
					let chat_Data = this.chatDataList.find(c => c.chatcreatedtime === chatdata.chatcreatedtime);//Á°Æ‰øùchatdataÊï∞ÊçÆÊúÄÊñ∞Ôºå‰∏ªË¶ÅÈíàÂØπÂΩìÂâçÂØπËØùÁöÑÊÉÖÂÜµ
					
					// chatVariables
					const temp_hasSystemPromptBeenSaved = chat_Data.chatVariables.hasSystemPromptBeenSaved;//ÊòØÂê¶‰øùÂ≠òËøáÊèêÁ§∫ËØç ‰øùÊåÅÁé∞Áä∂
					const temp_gptSystemPromptReadOnly = chat_Data.chatVariables.gptSystemPromptReadOnly;//ÊèêÁ§∫ËØçÂÜÖÂÆπ(Âè™ËØª)  ‰øùÊåÅÁé∞Áä∂
					
					chat_Data.chatVariables = JSON.parse(JSON.stringify(this.chatVariables_default));//ÊÅ¢Â§çÈªòËÆ§
					chat_Data.chatVariables.hasSystemPromptBeenSaved = temp_hasSystemPromptBeenSaved; //ÊòØÂê¶‰øùÂ≠òËøáÊèêÁ§∫ËØç  ÊÅ¢Â§ç
					chat_Data.chatVariables.gptSystemPromptReadOnly = temp_gptSystemPromptReadOnly; //ÊèêÁ§∫ËØçÂÜÖÂÆπ(Âè™ËØª)  ÊÅ¢Â§ç
				
					if(this.settingsLanguage != 'cn'){
						chat_Data.chatVariables.chathistory = '# Chat History  \r\n\r\n' ;
					}
				
					//ÊâãÂä®Â∞Ü‚ÄúÈ¶ñÊù°ÊèêÁ§∫ËØç‰ø°ÊÅØ‚ÄùËøΩÂä†Âà∞chat_Data.chatVariables.chathistory‰∏≠
					if(this.gptSystemPrompt_hidden.trim() == ''){ //‰∏çÂ≠òÂú®ÈöêÂΩ¢ÊèêÁ§∫ËØç
						const sys_prompt = chat_Data.chatVariables.gptSystemPromptReadOnly ;
						//‰ª•‰∏ã‰ª£Á†ÅÊ≥®Èáä ËØ¶ËßÅaddSystemPromptToChatHistory 
						let hasMultipleLines = /\r?\n\r?\n/.test(sys_prompt); 
						let backticks = this.findMaxBackticks(sys_prompt); 
						hasMultipleLines = backticks != '' ? true : hasMultipleLines ;
						backticks = backticks == '' ? '````' : backticks ;
	
						let addMarkdownSyntaxStart = hasMultipleLines ? ( '\r\n' + backticks + '\r\n' ) : '\r\n> ' ;  // (> ÂêéÈù¢Êúâ‰∏™Á©∫Ê†º)
						let addMarkdownSyntaxEnd = hasMultipleLines ? ( '\r\n' + backticks + '\r\n\r\n' ) : '\r\n\r\n' ; 
						let nullprompt = '';  //ÊèêÁ§∫ËØç‰∏∫Á©∫ÁöÑÊÉÖÂÜµ
						if( sys_prompt == '' ){
							nullprompt = this.settingsLanguage == 'cn' ? ': Á©∫' : ': None' ; 
							addMarkdownSyntaxStart = '\r\n'; 
							addMarkdownSyntaxEnd = '\r\n' ;
						}
		
						const head = this.settingsLanguage == 'cn' ? '### #Á≥ªÁªüÊèêÁ§∫ËØç system prompt ' : '### #System Prompt ' ;
						chat_Data.chatVariables.chathistory += ( head + nullprompt + addMarkdownSyntaxStart + sys_prompt + addMarkdownSyntaxEnd );
					}
				
					// chatdata 
					chat_Data.chatlasttime = this.formatDateYYYYMMDDHHmmss(new Date(),':'); //Áé∞Âú®ÁöÑÊó∂Èó¥
					chat_Data.msgList = [chat_Data.msgList[0]];
					chat_Data.msgContent = [chat_Data.msgContent[0]];
					chat_Data.msgTokens = [chat_Data.msgTokens[0]];
					chat_Data.msgContentForMsgList_SingleRound = [chat_Data.msgContentForMsgList_SingleRound[0]];
					
					if(iscurrentdata){
					
						//ËØªÂèñ Âà∑Êñ∞
						this.loadChatData(chat_Data);
						//‰øùÂ≠òÂΩìÂâçdata *‰ºöËé∑ÂèñÊúÄÊñ∞List
						this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
						//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
						if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
							this.saveChatData_NoLocalStorage(null);
						}
						//ÂÖ∂‰ªñËØªÂèñÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
						this.$nextTick(() => {
							// 1 3 4 5
							this.todoList_ChatDataRestored('ClearAll');	
						});
						
						//ÂõûÂà∞È°∂ÈÉ®
						this.gotoTop_List();
					}else{
						
						this.saveChatData_Single(chat_Data); //Âçï‰∏ÄÁöÑ‰øùÂ≠òÔºå‰∏çÂΩ±ÂìçÁïåÈù¢‰ªª‰ΩïÊï∞ÊçÆ
						//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
						if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
							this.saveChatData_NoLocalStorage(chat_Data);
						}
						this.chatDataList_Sort();// ChatDataListÊéíÂ∫è
					}
				//Âª∂Êó∂0.15Áßí
				}, 150);
				}else if(optionsStr === 'ExportChatData'){ 
				// 1) ÂØºÂá∫Âçï‰∏™ÂØπËØù Export Chat Data
					//1 ÂÖà‰øùÂ≠òÂΩìÂâçdata  Âà∑Êñ∞ChatDataList
					this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
					//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
					if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
						this.saveChatData_NoLocalStorage(null);
					}
				
				//Âª∂Êó∂0.15Áßí  *ÂêåÊ≠• ÁºìÂÜ≤
				setTimeout(() => {
					let fileName = this.exportJSONFileName ;
					let id_fileName = chatdata.chatid == null ? '' : chatdata.chatid.toString();
					const temp = '(#' + id_fileName + ')';
					notif = this.settingsLanguage == 'cn' ? 'Ê≠£Âú®ÂØºÂá∫JSONÊñá‰ª∂ - Âçï‰∏™ÂØπËØùÊï∞ÊçÆ' : 'Exporting JSON file - Single Chat Data' ;
					notif += temp;
					
					const newChatDataList = this.chatDataList.filter(c => c.chatcreatedtime === chatdata.chatcreatedtime);//‰ªÖ‰øùÁïô1‰∏™ÂØπËØù
					let dataObject = {};
					dataObject['chatDataList'] = newChatDataList; 
					const dataString = JSON.stringify(dataObject);
					fileName += 'SingleChatData'; //Êñá‰ª∂Âêç
					 // ID & ËøáÊª§ÈùûÊ≥ïÂ≠óÁ¨¶(Êñá‰ª∂Âêç)
					id_fileName = id_fileName.replace(/[\\/:\*\?"<>\|]/g, '');
					id_fileName = id_fileName.replace(/[\/\?<>\\:\*\|":]/g, '');
					id_fileName = id_fileName.trim() === '' ? '' : id_fileName;
					id_fileName = '(ID ' + id_fileName + ')';
					fileName += id_fileName;
  
					this.showNotification(notif, 'bottom','',2800);
					//ÂØºÂá∫
					this.ExportData_JSON(dataString, fileName);
				//Âª∂Êó∂0.15Áßí
				}, 150);
				}else if(optionsStr === 'EraseLogs'){ 
				// 5) ÊäπÊéâÊó•Âøó Erase Logs
					//1 ÂÖà‰øùÂ≠òÂΩìÂâçdata  Âà∑Êñ∞ChatDataList
					this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
					//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
					if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
						this.saveChatData_NoLocalStorage(null);
					}
				
				//Âª∂Êó∂0.15Áßí  *ÂêåÊ≠• ÁºìÂÜ≤
				setTimeout(() => {
					//chatdata
					let chat_Data = this.chatDataList.find(c => c.chatcreatedtime === chatdata.chatcreatedtime);//Á°Æ‰øùchatdataÊï∞ÊçÆÊúÄÊñ∞Ôºå‰∏ªË¶ÅÈíàÂØπÂΩìÂâçÂØπËØùÁöÑÊÉÖÂÜµ
					chat_Data.chatlasttime = this.formatDateYYYYMMDDHHmmss(new Date(),':'); //Áé∞Âú®ÁöÑÊó∂Èó¥
					
					// chatVariables   logs <=> chathistory
					const historyhead = this.settingsLanguage == 'cn' ? '# GPTËÅäÂ§©ËÆ∞ÂΩï / Chat History  \r\n\r\n' : '# Chat History  \r\n\r\n' ;
					const eraseLogsStr = this.settingsLanguage == 'cn' ? '### #‰∫é ' + chat_Data.chatlasttime + ' ÊâãÂä®ÊäπÊéâÊó•Âøó\r\n***\r\n\r\n' : '### #Manually erase logs on ' + chat_Data.chatlasttime + '\r\n***\r\n\r\n' ;
				 	chat_Data.chatVariables.chathistory = historyhead + eraseLogsStr; //Ê∏ÖÁ©∫ÔºåÈáçÁΩÆLogs(chathistory)
					
					if(iscurrentdata){
						//ËØªÂèñ Âà∑Êñ∞
						this.loadChatData(chat_Data);
						//‰øùÂ≠òÂΩìÂâçdata *‰ºöËé∑ÂèñÊúÄÊñ∞List
						this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
						//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
						if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
							this.saveChatData_NoLocalStorage(null);
						}
						//ÂÖ∂‰ªñËØªÂèñÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
						this.$nextTick(() => {
							// 1 3 4 5
							this.todoList_ChatDataRestored('ClearAll');	
						});
						
						//ÂõûÂà∞È°∂ÈÉ®
						this.gotoTop_List();
					}else{
						
						this.saveChatData_Single(chat_Data); //Âçï‰∏ÄÁöÑ‰øùÂ≠òÔºå‰∏çÂΩ±ÂìçÁïåÈù¢‰ªª‰ΩïÊï∞ÊçÆ
						//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
						if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
							this.saveChatData_NoLocalStorage(chat_Data);
						}
						this.chatDataList_Sort();// ChatDataListÊéíÂ∫è
					}
					
					const notif = this.settingsLanguage == 'cn' ? 'Â∑≤ÊäπÊéâÂØπËØù { #' + chat_Data.chatid + ' } ÁöÑÊó•Âøó' : 'The logs for chat { #' + chat_Data.chatid + ' } have been erased';
					this.showNotification(notif, 'bottom', '',3500);
				//Âª∂Êó∂0.15Áßí
				}, 150);
				}
				
				if(optionsStr == 'ClearPrevious' || optionsStr == 'ClearAll' ){
					const chat_id = chatdata.chatid.toString().trim() != '' ? ('#' + chatdata.chatid.toString() + ' ') : ''; //chatdata.chatid.toString().trim() Ëã•‰∏çÂä†.toString()ÔºåÂú®iphone-safari‰∏≠‰ºöÊä•ÈîôÔºåmac-safari‰∏ç‰ºöÊä•Èîô„ÄÇ
					const typestr = optionsStr == 'ClearAll' ? '' : ( this.settingsLanguage == 'cn' ? ' (‰øùÁïôÊúÄËøëÂçïËΩÆÂØπËØù)' : ' (Keep the latest round)' );
					const notif = this.settingsLanguage == 'cn' ? chat_id + 'ÂØπËØùÂ∑≤Ê∏ÖÁ©∫' + typestr : chat_id + 'Chat has been cleared' + typestr ;
					this.showNotification(notif, 'bottom', '',2700); 
				}
				
				// ÁßªÈô§ÁÑ¶ÁÇπ
				event.target.blur(); 
			},
					
			// ÂØπËØùÂàóË°®Á™óÂè£ - ChatList goto TOP
			gotoTop_List(){
				setTimeout(() => {
					const positioningDiv = document.querySelector('#dialog-ChatList .dialog-content');
					positioningDiv.scrollIntoView({behavior: 'smooth',block: 'start'});
				}, 160); //Âú®Ê≠§‰πãÂâçÂèØËÉΩÊúâËÅäÂ§©È°µÈù¢ÁöÑÊªöÂä®ÔºàtodoList_ChatDataRestored‰∏≠ÁöÑÊªöÂä®Ôºå‰∏ÄËà¨ÊòØ50msÔºâÔºåÂ¶ÇÊûú‰∏çÂª∂Ëøü‰ºöÂÜ≤Á™Å/Â§±Ë¥•Ôºå100ms‰πüÂèØËÉΩÂ§±Ë¥•ÔºåËøôÈáåËÆæ‰∏∫160ms
			},
			// ÂØπËØùÂàóË°®Á™óÂè£ - goto TOP
			gotoTop(){
				event.stopPropagation();
				const positioningDiv = document.getElementById('app');
				this.$nextTick(() => {
					positioningDiv.scrollIntoView({behavior: 'smooth',block: 'start'});
  				});
				const notif = this.settingsLanguage == 'cn' ? 'Â∑≤ÂÆö‰ΩçÂà∞ÊúÄÊó©ÁöÑÊ∂àÊÅØ' : 'Reached earliest message' ;
				this.showNotification(notif, 'bottom'); 
			},					
			// ÂØπËØùÂàóË°®Á™óÂè£ - goto Bottom
			gotoBottom(){
				event.stopPropagation();
				this.scrollToBottomView();
				const notif = this.settingsLanguage == 'cn' ? 'Â∑≤ÂÆö‰ΩçÂà∞ÊúÄÊñ∞Ê∂àÊÅØ' : 'Reached latest message' ;
				this.showNotification(notif, 'bottom'); 
			},
					
			// ÂØπËØùÂàóË°®Á™óÂè£ - ÂØπËØù Âà†Èô§
			deleteChatData(chatdata){
				event.stopPropagation();
				const iscurrentdata = ( this.chatcreatedtime === chatdata.chatcreatedtime );//this.selectedChatData.chatcreatedtime 
				if (this.checkBusyStatus('ForChat')) {
					//Â∫ïÈÉ®‰ºöÂá∫Áé∞ÈÄöÁü•tooltips„ÄÇ Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅ Êàñ Ê≠£Âú®È™åËØÅ Êàñ Ê≠£Âú®Ê†áÁ≠æÈ°µÈó¥ÂêåÊ≠•Êï∞ÊçÆ
					return;
				}
				
				//1 ÂÖà‰øùÂ≠òÂΩìÂâçdata *‰ºöËé∑ÂèñÊúÄÊñ∞ÁöÑList (this.chatDataList)
				this.localStorage_SaveData(null,'chatDataList');//‰øùÂ≠ò
				//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
				if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
					this.saveChatData_NoLocalStorage(null);
				}
				
		//ÂºπÁ™óÂâç Âª∂Êó∂0.1Áßí  *ÂêåÊ≠•ÁºìÂÜ≤
		setTimeout(() => {	
				let notif = this.settingsLanguage == 'cn' ? 'ÊÇ®Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™ÂØπËØùÂêóÔºüÊ≠§Êìç‰ΩúÊó†Ê≥ïÊí§ÈîÄ„ÄÇ' : 'Are you sure you want to delete this chat? This action cannot be undone.' ;
				if (chatdata.chatcreatedtime !== null){
					notif += this.settingsLanguage == 'cn' ? '\r\n\r\#' : '\r\n\r\n#' ;
					notif += chatdata.chatid;
					if(chatdata.chattitle != ''){
						notif += this.settingsLanguage == 'cn' ? '\r\n#' : '\r\n#' ;
						notif += chatdata.chattitle;
					}
					notif += this.settingsLanguage == 'cn' ? '\r\n‰∏äÊ¨°Ê¥ªÂä®Êó∂Èó¥Ôºö' : '\r\nLast Activity Time: ' ;
					notif += chatdata.chatlasttime;
					notif += this.settingsLanguage == 'cn' ? '\r\nÂØπËØùÂàõÂª∫Êó∂Èó¥Ôºö' : '\r\nChat Creation Time: ' ;
					notif += chatdata.chatcreatedtime;
				}
				this.is_Alert_Confirm_Prompt_Open = true;
				const confirmed = confirm(notif); //Áî®Êà∑ÈÄâÊã©ÊòØÂê¶ÁªßÁª≠ÔºåÁªßÁª≠‰ºöÂà†Èô§ÂØπËØù
				if (!confirmed) {
					setTimeout(() => {
						this.is_Alert_Confirm_Prompt_Open = false;
					}, 100);
					return;//ÂèñÊ∂à Â∞ÜËøîÂõû
				}
				setTimeout(() => {
					this.is_Alert_Confirm_Prompt_Open = false;
				}, 100);
				
			//ÂºπÁ™óÂêé Âª∂Êó∂0.1Áßí	
			setTimeout(() => {	
	
				//**ÂºπÁ™óÊúüÈó¥Êï∞ÊçÆÂæàÂ§ßÊ¶ÇÁéá‰ºöÊîπÂèòÔºåÈúÄË¶ÅÈáçÊñ∞Ëé∑Âèñ‰∏ÄÊ¨°List (this.chatDataList) 
				//Â¶ÇÊûúÂΩìÂâç‰∏çÊòØÊñ∞ÂØπËØùÔºå‰ΩÜÊòØÂ≠òÂú®Êñ∞ÂØπËØù/Á©∫ÂØπËØùÔºåÈúÄË¶ÅÂú®Âà∑Êñ∞ListÂêéÁªôË°•‰∏ä
				const chatdata_null = this.chatDataList.find(c => c.chatcreatedtime === null);
				//Ëé∑ÂèñÊúÄÊñ∞chatDataList
				let localStorage_chatDataList = this.localStorage_GetDataByKey('chatDataList');
				localStorage_chatDataList = localStorage_chatDataList == null ? [] : localStorage_chatDataList;
				//‰øùÂ≠òÂêéÔºåËøòÂéüÂèØËÉΩÂ≠òÂú®ÁöÑÊñ∞ÂØπËØù/Á©∫ÂØπËØù
				if(chatdata_null != null){
					localStorage_chatDataList.unshift(chatdata_null);//ËøòÂéüÂΩìÂâçÊ†áÁ≠æÈ°µÁöÑÊñ∞ÂØπËØù
				}
				if(this.isLocalStorageAllowed && this.isLocalStorageSupported){
					//ÂêåÊ≠•this.chatDataList
					this.chatDataList = localStorage_chatDataList;
				}
				this.chatDataList_Sort();// ChatDataListÊéíÂ∫è
				let index = this.chatDataList.findIndex((c) => c.chatcreatedtime === chatdata.chatcreatedtime);//ÊâæÂá∫Â∫èÂè∑
				
				this.chatDataList = this.chatDataList.filter(c => c.chatcreatedtime !== chatdata.chatcreatedtime); //Âà†Èô§ÁõÆÊ†áÂØπËØùÔºå‰øùÁïôÂÖ∂‰ªñÂØπËØùÔºåÈ°∫Â∫è‰∏ç‰ºöÊîπÂèò
				notif = this.settingsLanguage == 'cn' ? 'ÂØπËØùÂ∑≤Âà†Èô§' : 'Chat has been deleted' ;
				this.showNotification(notif, 'bottom'); 
				try{
					if(iscurrentdata){
						if(this.chatDataList == [] || this.chatDataList.length == 0){
							//Â∞ÜÊúÄÊñ∞ÁöÑthis.chatDataList‰øùÂ≠òÂà∞localStorage
							if(this.isLocalStorageAllowed && this.isLocalStorageSupported){
								localStorage.setItem('chatDataList', JSON.stringify(this.chatDataList));
							}
						
							//Âª∂Ëøü1ÁßíÂºπÊ∂àÊÅØ
							setTimeout(() => {
								notif = this.settingsLanguage == 'cn' ? 'ÂàóË°®Á©∫ÔºåÂ∑≤Ëá™Âä®Ê∑ªÂä†‰∏Ä‰∏™Êñ∞ÁöÑÂØπËØù' : 'The list is empty. A new chat has been automatically added.' ;
								this.showNotification(notif, 'bottom', '',2900); 
							}, 1400);
							//Ê∑ªÂä†Êñ∞ÂØπËØù
							this.chatList_addNewChatData(true);
						}else{
							//Â∞ÜÊúÄÊñ∞ÁöÑthis.chatDataListÔºàÈúÄË¶ÅÂéªnullÔºâ‰øùÂ≠òÂà∞localStorage
							const newChatDataList =  this.chatDataList.filter(c => c.chatcreatedtime !== null);
							if(this.isLocalStorageAllowed && this.isLocalStorageSupported){
								localStorage.setItem('chatDataList', JSON.stringify(newChatDataList));
							}
						
							index = index - 1; //Ë¢´Âà†ÁöÑÂâç‰∏Ä‰Ωç
							index = index < 0 ? 0 : index;
							index = index < this.chatDataList.length ? index : 0; // <=(this.chatDataList.length - 1)
							//7 ËØªÂèñ ËØªÂèñÂØπËØùÊï∞ÊçÆ ËøòÂéüËÅäÂ§©ËÆ∞ÂΩï ÊÅ¢Â§çËÅäÂ§©ËÆæÁΩÆ
							this.loadChatData(this.chatDataList[index]);
				
							//ÂÖ∂‰ªñËØªÂèñÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑ
							this.$nextTick(() => {
								// 1 2 3 4 5 6
								this.todoList_ChatDataRestored('hasdata', 100);		
							});
						}	
					}else{
						//Â∞ÜÊúÄÊñ∞ÁöÑthis.chatDataListÔºàÈúÄË¶ÅÂéªnullÔºâ‰øùÂ≠òÂà∞localStorage
						const newChatDataList =  this.chatDataList.filter(c => c.chatcreatedtime !== null);
						if(this.isLocalStorageAllowed && this.isLocalStorageSupported){
							localStorage.setItem('chatDataList', JSON.stringify(newChatDataList));
						}
					}
					this.chatDataList_Sort();// ChatDataListÊéíÂ∫è
				}catch(e){
					const e_message = e.message ? e.message : '';
					const e_name = e.name ? e.name : '';
					this.localStorageExceedsMaximum(e_message,e_name);
				}
			//Âª∂Êó∂0.1Áßí
			}, 100);
		//Âª∂Êó∂0.1Áßí
		}, 100);		
			},
			
			// ÂØπËØùÂàóË°®Á™óÂè£ - ÊîπÂèòÊúÄÂ§ßÂÆΩÂ∫¶ *ÁßªÂä®Á´ØÂèØËÉΩ‰ºöÈúÄË¶Å
			changeChatListMaxWidth() {
				let chatListDiv = document.querySelector("#dialog-ChatList .dialog");
				let	notif = this.settingsLanguage == 'cn' ? 'ÊúÄÂ§ßÂÆΩÂ∫¶Â∑≤ÊÅ¢Â§ç' : 'Max-Width restored' ;

				if (chatListDiv == null) { return; }
	  
				let maxWidth = chatListDiv.style.maxWidth;
				if (maxWidth == '430px') {
					chatListDiv.style.maxWidth = '800px';
					chatListDiv.style.width = '87%';
					notif = this.settingsLanguage == 'cn' ? 'ÊúÄÂ§ßÂÆΩÂ∫¶Â∑≤Ë∞ÉËá≥ÊúÄÂ§ß' : 'Max-Width adjusted to maximum' ;
				}else if (maxWidth == '800px'){
					chatListDiv.style.maxWidth = '430px';
					chatListDiv.style.width = '95%';
				}else {
					chatListDiv.style.maxWidth = '430px'; 
					chatListDiv.style.width = '95%';
				}

				this.showNotification(notif, 'bottom', '', 2300);
			},
			
			// ÂØπËØùÂàóË°®Á™óÂè£ - ÊîπÂèòÈÄèÊòéÂ∫¶ 
			changeChatListTransparent() {
				let chatListDiv = document.querySelector("#dialog-ChatList .dialog");
				let dialogbottomDiv = document.querySelector("#dialog-ChatList .dialog-bottom");
				
				let	notif = this.settingsLanguage == 'cn' ? 'Â∑≤ÊÅ¢Â§ç‰∏∫‰∏çÈÄèÊòé' : 'Restored to opacity' ;

				if (chatListDiv == null) { return; }
	  
				let color = chatListDiv.style.backgroundColor;
				if (color == 'rgb(237, 237, 237)') {
					this.isChatListTransparent = true;
					chatListDiv.style.backgroundColor = 'rgba(237, 237, 237, 0.03)';
					dialogbottomDiv.style.backgroundColor = 'rgba(237, 237, 237, 0.05)';
					notif = this.settingsLanguage == 'cn' ? 'Â∑≤ÂèòÊõ¥‰∏∫ÈÄèÊòé' : 'Changed to transparent' ;
				}else if (color == 'rgba(237, 237, 237, 0.03)'){
					this.isChatListTransparent = false;
					chatListDiv.style.backgroundColor = 'rgb(237, 237, 237)';
					dialogbottomDiv.style.backgroundColor = 'rgba(237, 237, 237)';
				}else {
					this.isChatListTransparent = false;
					chatListDiv.style.backgroundColor = 'rgb(237, 237, 237)'; 
					dialogbottomDiv.style.backgroundColor = 'rgba(237, 237, 237)';
				}

				this.showNotification(notif, 'bottom');
			},


			// ÊèêÁ§∫ËØçÁ™óÂè£ - Â§çÂà∂Á≥ªÁªüÊèêÁ§∫ËØçÂà∞ÁºñËæëÂå∫
			copySystemPromptToEditor(){
				let sys_prompt = this.gptSystemPromptReadOnly.trim();
				let notif = '';
				if(sys_prompt == ''){
					notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÁöÑÁ≥ªÁªüÊèêÁ§∫ËØç‰∏∫Á©∫' : 'The current system prompt is empty' ;
					this.showNotification(notif, 'bottom'); 
					return;
				}
	
				if(this.gptSystemPrompt.trim() != '' ){
					notif = this.settingsLanguage == 'cn' ? 'ÊèêÁ§∫ËØçÁºñËæëÊ°Ü‰∏≠Â∑≤Â≠òÂú®ÂÜÖÂÆπÔºåÁ°ÆËÆ§Ë¶ÜÁõñÂêóÔºü' : 'Content exists in Prompt Editor, confirm overwrite?' ;
					if (!confirm(notif)) {
						return; // Áî®Êà∑ÁÇπÂáª‰∫Ü‚ÄúÂèñÊ∂à‚ÄùÊåâÈíÆ
					}
				}
	
				this.gptSystemPrompt = sys_prompt;
				this.btnDisabledState_SetSystemPrompt = true;
				notif = this.settingsLanguage == 'cn' ? 'Â∑≤Â§çÂà∂Âà∞ÁºñËæëÂå∫' : 'Copied to the Prompt Editor' ;
				this.showNotification(notif, 'bottom', '', 2000);
			},
			// ÊèêÁ§∫ËØçÁ™óÂè£ - ÊîπÂèòÊúÄÂ§ßÂÆΩÂ∫¶
			changePromptGeneratorMaxWidth() {
				let promptsDiv = document.querySelector("#dialog-promptgenerator .dialog");
				let	notif = this.settingsLanguage == 'cn' ? 'ÈÄÇÂêàÁßªÂä®ËÆæÂ§áÁöÑÂÆΩÂ∫¶' : 'Optimized for mobile devices' ;

				if (promptsDiv == null) { return; }
	  
				let width = promptsDiv.style.width;
				if (width == '95%') {
					promptsDiv.style.width = '75%';
					promptsDiv.style.maxWidth = '75%';
					notif = this.settingsLanguage == 'cn' ? 'ÈÄÇÂêàÊõ¥Â§ßÂàÜËæ®ÁéáÁöÑÂÆΩÂ∫¶' : 'Optimized to support larger screens' ;
				}else if (width == '75%'){
					promptsDiv.style.width = '95%';
					promptsDiv.style.maxWidth = '800px';
				}else {
					promptsDiv.style.width = '95%';
					promptsDiv.style.maxWidth = '800px';
				}

				this.showNotification(notif, 'bottom', '', 2300);
			},
			// ÊèêÁ§∫ËØçÁ™óÂè£ - ÊîπÂèòÂ∏ÉÂ±Ä *ÁßªÂä®Á´ØÂèØËÉΩ‰ºöÈúÄË¶Å
			changePromptGeneratorLayout() {
				let notif = this.settingsLanguage == 'cn' ? 'Â∏ÉÂ±ÄÂàáÊç¢ÊàêÂäü' : 'Layout changed' ;
					if (this.styleDialogLayout.padding == '20px 20px 20px 20px') {
					this.styleDialogLayout.padding = '20px 20px 20px 45px';
				} else if (this.styleDialogLayout.padding == '20px 20px 20px 45px') {
					this.styleDialogLayout.padding = '20px 45px 20px 20px';
				} else {
					this.styleDialogLayout.padding = '20px 20px 20px 20px';
				}
	  
				this.showNotification(notif, 'bottom');
			},
			// ÊèêÁ§∫ËØçÁ™óÂè£ - ÊîπÂèòÊåáÂÆöÂÖÉÁ¥†ÁöÑÈ´òÂ∫¶
			changeElementHeight(classname) {
				let notif = this.settingsLanguage == 'cn' ? 'È´òÂ∫¶Â∑≤Ë∞ÉÊï¥' : 'Height adjusted' ;
				let input = document.querySelector('.' + classname);
				if (input == null) { return; }
	  
				let h = input.style.height;
				if (h == '100px') {
					input.style.height = '250px';
				}else if (h == '250px'){
					input.style.height = '500px';
					notif = this.settingsLanguage == 'cn' ? 'È´òÂ∫¶Â∑≤Ë∞ÉËá≥ÊúÄÂ§ß' : 'Height adjusted to maximum' ;
				}else {
					input.style.height = '100px'; 
					notif = this.settingsLanguage == 'cn' ? 'È´òÂ∫¶Â∑≤ÊÅ¢Â§ç' : 'Height restored' ;
				}
	
				this.showNotification(notif, 'bottom'); 
			},
			// ÊèêÁ§∫ËØçÁ™óÂè£ - ÊîπÂèòÊåáÂÆöÂÖÉÁ¥†ËßÜÂõæÔºàÊòØÂê¶Ëá™Âä®Êç¢Ë°åÔºâ
			changeElementLineBreak(classname) {
				let notif = this.settingsLanguage == 'cn' ? 'ÂàáÊç¢‰∏∫ ‰∏çËá™Âä®Êç¢Ë°å' : 'Changed to no-wrap' ;
				let input = document.querySelector('.' + classname);
				if (input == null) { return; }
				
				let whiteSpace =  input.style.whiteSpace;
				if (whiteSpace != 'pre' && whiteSpace != 'pre-wrap') {
					input.style.whiteSpace = 'pre';
				} else if (whiteSpace == 'pre') {
					input.style.whiteSpace = 'pre-wrap';
					notif = this.settingsLanguage == 'cn' ? 'ÂàáÊç¢‰∏∫ Ëá™Âä®Êç¢Ë°å' : 'Changed to auto-wrap' ;
				} else {
					input.style.whiteSpace = 'pre';
				} 
				this.showNotification(notif, 'bottom');
			},
					
			// ÊèêÁ§∫ËØçÁ™óÂè£ - ÊåâÈíÆÔºö‰øùÂ≠ò‰∏∫Á≥ªÁªüÊèêÁ§∫ËØç Êõ¥Êñ∞Á≥ªÁªüÊèêÁ§∫ËØç Save system prompt
			setSystemPrompt(){
			
				let notif = this.settingsLanguage == 'cn' ? '‰øùÂ≠òÊàêÂäü' : 'Saved successfully' ;
				let notiftime = 1450;
				
				if (this.checkBusyStatus()) {
				  // Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ
				  return;
				} 
			
				//ÈöêÂΩ¢ÊèêÁ§∫ËØç ÂΩìgptSystemPrompt_hiddenÈöêËóèÊèêÁ§∫ËØçÂ≠òÂú®Êó∂Ôºå‰∏çÂÖÅËÆ∏Êèê‰∫§‰øÆÊîπ„ÄÇ Â∑≤Á¶ÅÁî®ÊèêÁ§∫ËØçÂºπÁ™óÔºåÂÖ∂ÂÆûËøôÈáåÂèØ‰ª•‰∏çÂÜô„ÄÇ
				if(this.gptSystemPrompt_hidden.trim() != ''){
					notif = this.settingsLanguage == 'cn' ? '‰øùÂ≠òÂ§±Ë¥•Ôºå‰ª£Á†Å‰∏≠Â≠òÂú®ÈöêËóèÊèêÁ§∫ËØç' : 'Save failed, there is a hidden "system prompt" in the code.' ;
					notiftime = 4000;
					this.showNotification(notif, 'bottom', '',notiftime);
					return;
				}
								
				// v6.12 ÂÖÅËÆ∏‰øùÂ≠òÁ©∫ÁöÑÊèêÁ§∫ËØç
				
			
				this.btnDisabledState_SetSystemPrompt = true;
				this.msgContent[0] =  {"role": "system", "content": this.gptSystemPrompt.trim() };
				this.msgContentForMsgList_SingleRound[0] =  {"role": "system", "content": this.gptSystemPrompt.trim() };
				this.gptSystemPromptReadOnly = this.gptSystemPrompt.trim();
				if (this.gptSystemPrompt.trim() === ''){
					notif = this.settingsLanguage == 'cn' ? '‰øùÂ≠òÊàêÂäüÔºåÂ∑≤ÂèñÊ∂àÁ≥ªÁªüÊèêÁ§∫ËØç' : 'Save successful. System Prompt has been cancelled' ;
					notiftime = 3500;
				}
				
				//‰∏∫falseÔºåË°®Á§∫Êñ∞Á™óÂè£‰ªéÊú™ÂÜôÂÖ•ËøáÊåá‰ª§[ÊòØÂê¶ËÆæÁΩÆ‰∫ÜÈªòËÆ§system prompt]
				if(!this.hasSystemPromptBeenSaved){
					this.hasSystemPromptBeenSaved = true;
					this.addSystemPromptToChatHistory('### #ÈªòËÆ§ÁöÑÁ≥ªÁªüÊèêÁ§∫ËØç system prompt ', '### #Default System Prompt ' ); //this.chathistory
				}
				else {
					this.addSystemPromptToChatHistory('### #Êñ∞ÁöÑÁ≥ªÁªüÊèêÁ§∫ËØç system prompt ', '### #New System Prompt ' ); //this.chathistory
				}
				
				//Êõ¥Êñ∞ ‰øùÂ≠ò ËÅäÂ§©Êï∞ÊçÆ chatData chatDataList
				//Êõ¥Êñ∞ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥
				this.updateChatLastTime(this.formatDateYYYYMMDDHHmmss(new Date(),':'));//ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥
				
				this.showNotification(notif, 'bottom', '', notiftime);
				
			}, 
			  
			// ËÆæÁΩÆ‰∏≠ÁÇπÂáªÊâìÂºÄ Ëá™Âä®ËΩÆÊç¢API KeyÁ™óÂè£ Auto Key Rotation
			clickOpenAutoKeyRotation(){
				let input = document.querySelector('.textareabulkaddapikey');
				
				//ÊòæÁ§∫ÂºπÁ™óÂâç
				if(this.apiCheckedData.length < 1){ //Êó†ÂèØÁî®KeyÊó∂ÔºåËá™Âä®ÊòæÁ§∫ÊâπÈáèÊ∑ªÂä†
					const notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÊó†ÂèØÁî®ÁöÑ API Key' : 'No available API Keys currently' ;
					this.showNotification(notif, 'bottom', '',1800); 
				}
				if(!this.isThirdPartyAPIKeyEnabled && this.apiCheckedData.filter(data => data.vpn !== 'third-party').length < 1){
					this.isShowBulkAddPanel_AutoKeyRotation = true;//ÊòæÁ§∫ÊâπÈáè
				}else if (!this.isThirdPartyAPIKeyEnabled && input != null && input.value.trim() === '' ) { //ÊúâÂèØÁî®Key && input && ÊâπÈáèÊ∑ªÂä†Êó†ÂÜÖÂÆπÊó∂
					this.isShowBulkAddPanel_AutoKeyRotation = false;//‰∏çÊòæÁ§∫ÊâπÈáè
				}
				
				//ÊòæÁ§∫ÂºπÁ™ó
				this.isShowDialog_AutoKeyRotation = true;
			},
			
			// Ëá™Âä®ËΩÆÊç¢API KeyÁ™óÂè£ Auto Key Rotation - ÂàáÊç¢ÊéíÂ∫è Sort 
			changeAutoKeyRotationSorted() {
				if (this.checkBusyStatus()) {
					// Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ
					return;
				} 
			
				this.changeAutoKeyRotationSorted_Mode ++ ; // 0 1 2 
				this.changeAutoKeyRotationSorted_Mode = this.changeAutoKeyRotationSorted_Mode > 2 ? 0 : this.changeAutoKeyRotationSorted_Mode;
				let notif;

				if( this.changeAutoKeyRotationSorted_Mode === 1){
					this.apiCheckedData.sort((a, b) => {
					 	if (a.level !== b.level) {
							if (a.level === null) {
								return -1;
							} else if (b.level === null) {
								return 1;
							} else {
					 			return a.level - b.level; //Á∫ßÂà´ÂçáÂ∫è
							}
					 	} else {
					 		return a.nexttime - b.nexttime; //Á∫ßÂà´Áõ∏ÂêåÔºåÂàôÊåâÈ¢Ñ‰º∞ÂèØÁî®Êó∂Èó¥ÂçáÂ∫è
					 	}
					});
					notif = this.settingsLanguage == 'cn' ? 'ÊåâÁ∫ßÂà´ÊéíÂ∫è„ÄÇ *ÊéíÂ∫èÂØπËá™Âä®ËΩÆÊç¢ÂäüËÉΩÊ≤°ÊúâÂΩ±Âìç' : 'Sort by level.  * Sorting has no impact on auto-rotation.' ;
				}else if( this.changeAutoKeyRotationSorted_Mode === 2){
					this.apiCheckedData.sort((a, b) => {
						if (b.succrate !== a.succrate) {
							return b.succrate - a.succrate; //ÊàêÂäüÁéá ÈôçÂ∫è
						} else if (a.level !== b.level) { //ÊàêÂäüÁéáÁõ∏ÂêåÔºåÂàôÊåâÁ∫ßÂà´ÂçáÂ∫è
							if (a.level === null) {
								return -1;
							} else if (b.level === null) {
								return 1;
							} else {
					 			return a.level - b.level; 
							}
						} else {
							return a.nexttime - b.nexttime; //Á∫ßÂà´‰πüÁõ∏ÂêåÔºåÂàôÊåâÈ¢Ñ‰º∞ÂèØÁî®Êó∂Èó¥ÂçáÂ∫è
						}
					});
					notif = this.settingsLanguage == 'cn' ? 'ÊåâÊàêÂäüÁéáÊéíÂ∫è„ÄÇ *ÊéíÂ∫èÂØπËá™Âä®ËΩÆÊç¢ÂäüËÉΩÊ≤°ÊúâÂΩ±Âìç' : 'Sort by success rate.  * Sorting has no impact on auto-rotation.' ;
				
				}else if( this.changeAutoKeyRotationSorted_Mode === 0){
					this.apiCheckedData.sort((a, b) => b.updatetime - a.updatetime);//ÊúÄÂêéÊõ¥Êñ∞Êó∂Èó¥ ÈôçÂ∫è
					notif = this.settingsLanguage == 'cn' ? 'ÊåâÊõ¥Êñ∞Êó∂Èó¥ÊéíÂ∫è„ÄÇ *ÊéíÂ∫èÂØπËá™Âä®ËΩÆÊç¢ÂäüËÉΩÊ≤°ÊúâÂΩ±Âìç' : 'Sort by update time.  * Sorting has no impact on auto-rotation.' ;
				}else{
					this.changeAutoKeyRotationSorted_Mode = 1;
					notif = this.settingsLanguage == 'cn' ? 'ÊåâÁ∫ßÂà´ÊéíÂ∫è„ÄÇ *ÊéíÂ∫èÂØπËá™Âä®ËΩÆÊç¢ÂäüËÉΩÊ≤°ÊúâÂΩ±Âìç' : 'Sort by level.  * Sorting has no impact on auto-rotation.' ;
				}
				
				this.showNotification(notif, 'bottom', '',3300);
			},	
					  
			// Use OpenAI API Keys  or  Use Third-Party Key
			changeIsThirdPartyAPIKeyEnabled(){
				let notif_time = 3500;
				const temp_1 = (this.apiURL.toLowerCase() !== this.OpenAI_API_URL && this.apiURL.toLowerCase() !== this.OpenaiProxyCom_API_URL) ? (this.settingsLanguage == 'cn' ? '„ÄÇ ÊèêÈÜí: ÂΩìÂâç‰ΩøÁî®ÁöÑÊòØÁ¨¨‰∏âÊñπÊé•Âè£ÔºåËØ∑Á°Æ‰øùÂÖ∂ÊîØÊåÅÂÆòÊñπKey' : ' Tip: Currently using a Third-party API, please ensure that it supports OpenAI Keys.') : '' ;
				let notif = this.settingsLanguage == 'cn' ? '‰ΩøÁî® OpenAI ÂÆòÊñπKeyÔºåÂ∞ÜËá™Âä®ËΩÆÊç¢ API Key' + temp_1 : 'Use OpenAI API Keys will automatically rotate the API Keys.' + temp_1 ;
				notif_time = temp_1 === '' ? 4500 : 6500;
				
				if(this.isThirdPartyAPIKeyEnabled){ //Á¨¨‰∏âÊñπÂçïKeyÊ®°Âºè Third-party Key mode
					const temp_2 = (this.apiURL.toLowerCase() === this.OpenAI_API_URL || this.apiURL.toLowerCase() === this.OpenaiProxyCom_API_URL) ? (this.settingsLanguage == 'cn' ? '„ÄÇ ÊèêÈÜí: ÂΩìÂâçÊé•Âè£‰∏çÊîØÊåÅÁ¨¨‰∏âÊñπKey' : ' Tip: The current API URL does not support Third-party Keys.') : '' ;
					notif = this.settingsLanguage == 'cn' ? '‰ΩøÁî®Á¨¨‰∏âÊñπ‰∏ìÁî®KeyÔºåÂ∑≤ÂÅúÊ≠¢"Ëá™Âä®ËΩÆÊç¢API Key"' + temp_2 : 'Use Third-party Key, the "Auto Key Rotation" has been stopped.' + temp_2 ;
					notif_time = temp_2 === '' ? 4500 : 7000;
					if(!this.defaultSelectedOneKey_ThirdParty()){ //ÈªòËÆ§ÈÄâ‰∏Ä‰∏™Á¨¨‰∏âÊñπKey
						if( this.btnDisabledState_CheckAPI ){ //ÈùûÁºñËæëÁä∂ÊÄÅÔºå‰∏çÂèØÁî®ÁöÑÁä∂ÊÄÅ
							this.api = '';
							this.changeButtonDisabledState(true);//ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
						}
					}
				}else{ // OpenAI Key
				
					//ÂêåÊ≠•this.restoreApiKeyInput‰∏≠ÁöÑ‰ª£Á†ÅÔºå‰Ωú‰∏∫restoreApiKeyInputÁöÑË°•ÂÖÖÔºöÊó†ÂèØÁî®KeyÊó∂ÔºåÊ∏ÖÁ©∫ËæìÂÖ•Ê°Ü
					if(this.lastAPIKeyInputText_Available === '' && this.apiCheckedData.filter(data => data.vpn !== 'third-party').length < 1 && ( this.defaultAPIKey === '' || !this.defaultAPIKey.startsWith('sk-') ) &&  this.default_apiKeyArray_WrittenInTheCode.length === 0 ){ 
					//ÂàáÊç¢ÂêéÔºåÊó†ÂèØÁî®ÁöÑOpenAI KeyÊó∂Ôºåthis.restoreApiKeyInput(false,false) Èáå‰ºöËøîÂõûÔºå‰ªÄ‰πà‰πü‰∏çÂÅö„ÄÇÊ≠§Êó∂Â¶ÇÊûúthis.apiÁïôÊúâÁ¨¨‰∏âÊñπÁöÑKeyÔºåÈúÄË¶ÅÊ∏ÖÁ©∫„ÄÇ Â¶ÇÊûúÊòØÁºñËæëÁä∂ÊÄÅÂàô‰∏çÊ∏ÖÁ©∫„ÄÇ
						if( this.btnDisabledState_CheckAPI ){ //ÈùûÁºñËæëÁä∂ÊÄÅÔºå‰∏çÂèØÁî®ÁöÑÁä∂ÊÄÅ
							this.api = '';
							this.changeButtonDisabledState(true);//ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
						}
					}
					//ÊÅ¢Â§çapikeyÂà∞ËæìÂÖ•Ê°ÜÔºåÂπ∂ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
					this.restoreApiKeyInput(false,false);
				}
				
				this.showNotification(notif, 'bottom', '', notif_time);
			},
			
			// Á°ÆËÆ§‰ΩøÁî®‰∏Ä‰∏™Á¨¨‰∏âÊñπKey   Select a third-party API key and use it.
			useThirdPartyApiKey(apidata){
				if (this.checkBusyStatus()) {
					// Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ
					return;
				} 
				
			 	this.api = apidata.apikey; 
				this.inputapichange(false);
				
				
				if (apidata.apiurl === "") {
					return;
				}
				if( apidata.apiurl.toLowerCase() === this.apiURL.toLowerCase() ){
					return;
				}
				
				let notif_cn = 'ËØ• API Key ‰∏äÊ¨°‰ΩøÁî®ÁöÑÊé•Âè£‰∏éÂΩìÂâçÊé•Âè£‰∏ç‰∏ÄËá¥„ÄÇ\r\n\r\nÁÇπÂáª [Á°ÆÂÆö (Â•Ω)] ÂèØÂø´ÈÄüÊõ¥Êç¢‰∏∫‰∏äÊ¨°‰ΩøÁî®ÁöÑÊé•Âè£ÁΩëÂùÄÔºåÁÇπÂáª [ÂèñÊ∂à] Âàô‰øùÊåÅÂΩìÂâçÊé•Âè£ÁΩëÂùÄ‰∏çÂèòÔºåËØ∑ÈÄâÊã©...';
				let notif_en = 'The API URL used with this API Key last time differs from the current API URL. \r\n\r\nClick [Confirm (OK)] to quickly change it to the API URL used last time, or click [Cancel] to keep the current API URL unchanged. Please choose...';
				notif_cn = notif_cn + '\r\n\r\n‰∏äÊ¨°Êé•Âè£: ' + apidata.apiurl + '\r\nÂΩìÂâçÊé•Âè£: ' + this.apiURL ;
				notif_en = notif_en + '\r\n\r\nLast API URL: ' + apidata.apiurl + '\r\nCurrent API URL: ' + this.apiURL ;
				let notif = this.settingsLanguage == 'cn' ? notif_cn : notif_en ;
	
				this.is_Alert_Confirm_Prompt_Open = true;
				const confirmed = confirm(notif); //Áî®Êà∑ÈÄâÊã©ÊòØÂê¶ÁªßÁª≠ÔºåÁªßÁª≠‰ºöËá™Âä®Êõ¥Êç¢Êé•Âè£URL
				if (!confirmed) {
					setTimeout(() => {
						this.is_Alert_Confirm_Prompt_Open = false;
					}, 100);
					return;//ÂèñÊ∂à Â∞ÜËøîÂõû
				}
				setTimeout(() => {
					this.is_Alert_Confirm_Prompt_Open = false;
				}, 100);
				
				
				//Êõ¥Êç¢Êé•Âè£ÁΩëÂùÄ Change API URL
				this.apiURL = apidata.apiurl;
				this.inputApiURL = apidata.apiurl;
				this.btnDisabledState_SaveApiURL = true;
				
				//API URLÔºö ‰∏ãÊãâÊ°ÜÂåπÈÖç
				let isExist = false;
				if(this.settingsLanguage === 'cn'){
					isExist = this.apiURLOptions_cn.some(item => item.url === this.inputApiURL.toLowerCase());
					if( !isExist && this.isLoadThirdPartyPaidAPIs){
						isExist = this.apiURLOptions_LoadThirdPartyPaidAPIs.some(item => item.url === this.inputApiURL.toLowerCase());
					}
				}else{
					isExist = this.apiURLOptions_en.some(item => item.url === this.inputApiURL.toLowerCase());
				}
				if(isExist){
					this.selectedApiURL = this.inputApiURL.toLowerCase();
				}else{
					this.selectedApiURL = "";
				}
				
				notif = this.settingsLanguage == 'cn' ? 'Êé•Âè£ÁΩëÂùÄÂ∑≤ÂèòÊõ¥' : 'API URL has been changed' ;
				this.showNotification(notif, 'bottom', '',1600);
			},
			
			// ÈªòËÆ§ÈÄâ‰∏≠‰∏Ä‰∏™Á¨¨‰∏âÊñπKey
			defaultSelectedOneKey_ThirdParty(){
			 	const temp_apidataArray = this.apiCheckedData.filter(apidata => apidata.vpn === 'third-party' && apidata.apiurl.toLowerCase() === this.apiURL.toLowerCase());
				if(temp_apidataArray.length > 0){ //Â≠òÂú®ÂåπÈÖçÂΩìÂâçÊé•Âè£ÁöÑÁ¨¨‰∏âÊñπKey
					temp_apidataArray.sort((a, b) => b.updatetime - a.updatetime);//ÊúÄÂêéÊõ¥Êñ∞Êó∂Èó¥ ÈôçÂ∫è
					this.api = temp_apidataArray[0].apikey; //ÈªòËÆ§ÂÖàÈÄâ‰∏≠Á¨¨‰∏Ä‰∏™
					this.inputapichange(false);
					return true;
				}else{
					return false;
				}
			},
			
			//ÈÄöËøáÊé•Âè£URLÂà§Êñ≠KeyÊ®°ÂºèÔºåÁî®‰∫éËØ∑Ê±Ç„ÄÇ  ‰ªÖÈÄöËøáÊé•Âè£urlÂà§Êñ≠Ôºå‰∏çÂà§Êñ≠keyÊòØÂê¶Â±û‰∫éopenai„ÄÇÊó†Ê≥ïÂà§Êñ≠Êó∂ÔºåÂ∞±‰∏çÊîπÂèòÔºåÂÖÅËÆ∏Âá∫ÈîôÔºåËøô‰∏™ÂäüËÉΩÂè™ËÉΩÊòØËæÖÂä©„ÄÇ
			check_KeyMode_byURL(){
				const keymode_thirdPartyAPIKeyEnabled = this.isThirdPartyAPIKeyEnabled;
				//1. Â∑≤Áü•2Áßç+1Áßç  =OpenAI Key
				const temp_next_web_ApiUrl = 'https://chatgpt1.nextweb.fun/api/proxy/v1/chat/completions';
				if(this.apiURL.toLowerCase() === this.OpenAI_API_URL || this.apiURL.toLowerCase() === this.OpenaiProxyCom_API_URL || this.apiURL.toLowerCase() === temp_next_web_ApiUrl ){
					this.isThirdPartyAPIKeyEnabled = false;
					return false;
				}
				
				//2. Â≠òÂú®ÂåπÈÖçÂΩìÂâçÊé•Âè£ÁöÑÁ¨¨‰∏âÊñπKey  =Third-party Key
				const temp_apidataArray = this.apiCheckedData.filter(apidata => apidata.vpn === 'third-party' && apidata.apiurl.toLowerCase() === this.apiURL.toLowerCase());
				if(temp_apidataArray.length > 0){ 
					this.isThirdPartyAPIKeyEnabled = true;
					return true;
				}
				
				//3. ‰ªÖÊîØÊåÅÁ¨¨‰∏âÊñπKeyÁöÑÁ¨¨‰∏âÊñπÊé•Âè£  =Third-party Key
				if( this.list_OnlyUseThirdPartyKey_DomainKeyword.some(char => this.apiURL.toLowerCase().includes(char)) ){
					this.isThirdPartyAPIKeyEnabled = true;
					return true;
				}
				return keymode_thirdPartyAPIKeyEnabled;
			},
					
			//ÈÄöËøáKeyÂà§Êñ≠KeyÊ®°ÂºèÔºåÁî®‰∫éËøîÂõûËØ∑Ê±ÇÁªìÊûúÊó∂„ÄÇ *ËøôÈáå‰∏ªË¶ÅÂΩ±ÂìçKeyÁöÑÂàÜÁ±ª„ÄÇ
			//ÁâπÊÆäÊÉÖÂÜµÔºöËØ∑Ê±ÇÂâçÈÄöËøáURL‰øÆÊ≠£ÔºåÂíåËØ∑Ê±ÇÂêéÈÄöËøáKey‰øÆÊ≠£ÂêéÁöÑÁªìÊûúÂèØËÉΩ‰∏çÂêå„ÄÇÊú™Áü•ÁöÑÁ¨¨‰∏âÊñπurl+skÂºÄÂ§¥ÁöÑkeyÔºåËØ∑Ê±ÇÂâçËá™Âä®‰øÆÊ≠£‰∏∫"Á¨¨‰∏âÊñπkeyÊ®°Âºè",‰ΩÜËØ∑Ê±ÇÂêéÂèà‰ºöË¢´Ëá™Âä®‰øÆÊ≠£‰∏∫"OpenAI keyÊ®°Âºè"„ÄÇÂ§ÑÁêÜÔºö1) Â¶ÇÊûúËØ•skÂºÄÂ§¥ÁöÑKeyÊòØÁ¨¨‰∏âÊñπKeyÔºåÂèØ‰ª•ÊâãÂä®‰øÆÊîπ„ÄÇ 2) Â¶ÇÊûúÊòØOpenAI KeyÔºå‰ªÄ‰πàÈÉΩ‰∏çÂÅö‰πüÊòØÂèØ‰ª•ÁöÑ„ÄÇ 3) ‰πüÂèØÊîπ‰ª£Á†ÅÔºåÊ∑ªÂä†urlÂÖ≥ÈîÆËØçÂà∞list_OnlyUseThirdPartyKey_DomainKeywordÂíåexcludeList_ThirdPartyKeyStartWithSK_DomainKeyword„ÄÇ
			check_KeyMode_byKey(){
			
				//1. ÂÖàÂà§Êñ≠ÊòØÂê¶Â∑≤ÁªèËÆæ‰∏∫Á¨¨‰∏âÊñπKeyÔºåÂ¶ÇÊûúÂ≠òÂú®Ôºå‰ºòÂÖàÁ∫ßÊúÄÈ´òÔºå‰∏çÂÜç‰øÆÊ≠£„ÄÇ
				const isExist = this.apiCheckedData.filter(data => data.vpn === 'third-party').some(item => item.apikey.trim() == this.api.trim());
				if(isExist){
					this.isThirdPartyAPIKeyEnabled = true; //Á°ÆÂÆö‰∏∫Á¨¨‰∏âÊñπ
					return;
				}
				
				//2. sk- && ÊéíÈô§Â∑≤Áü•‰ºöÊ∑∑Ê∑ÜÁöÑÁ¨¨‰∏âÊñπKey
				if( this.api.startsWith('sk-') ){
					if( !this.excludeList_ThirdPartyKeyStartWithSK_DomainKeyword.some(char => this.apiURL.toLowerCase().includes(char)) ){
						this.isThirdPartyAPIKeyEnabled = false; //1) OpenAI Key; 2) Êú™Áü•ÁöÑsk-ÂºÄÂ§¥ÁöÑÁ¨¨‰∏âÊñπKey‰ºöË¢´ÈªòËÆ§‰∏∫‚ÄúOpenAI KeyÊ®°Âºè‚Äù (ÂèØÊâãÂä®Êîπ‰∏∫Á¨¨‰∏âÊñπ)
					}else{
						this.isThirdPartyAPIKeyEnabled = true; //Á°ÆÂÆö‰∏∫Â∑≤Áü•ÁöÑÁ¨¨‰∏âÊñπ
					}
				}else{
					this.isThirdPartyAPIKeyEnabled = true; //Á°ÆÂÆö‰∏∫Á¨¨‰∏âÊñπ
				}
			},		

			//ÈÄöËøáÊé•Âè£URLÂà§Êñ≠KeyÊ®°ÂºèÔºåÂπ∂Ëé∑Âèñ‰∏™ÂèØÁî®Key„ÄÇ
			check_KeyMode_byURL_ChangeKey(keymodeold, keymodenow){
				const keymode_old = keymodeold != null ? keymodeold : this.isThirdPartyAPIKeyEnabled;
				const keymode_now = keymodenow != null ? keymodenow : this.check_KeyMode_byURL(); //Ëá™Âä®ÊîπÂèòKeyÊ®°Âºè
				let temp_return = true; // true=ok
				
				if( keymode_old && !keymode_now ){
				//‰ªéÁ¨¨‰∏âÊñπKeyÊ®°ÂºèÔºåÂàáÊç¢‰∏∫OpenAI APIÂêéÔºåÊîπÂõûOpenAI KeyËΩÆÊç¢Ê®°Âºè(‰∏äÈù¢this.check_KeyMode_byURLÁöÑ‰ª£Á†Å)
					//ÂêåÊ≠•this.restoreApiKeyInput‰∏≠ÁöÑ‰ª£Á†ÅÔºå‰Ωú‰∏∫restoreApiKeyInputÁöÑË°•ÂÖÖÔºöÊó†ÂèØÁî®KeyÊó∂ÔºåÊ∏ÖÁ©∫ËæìÂÖ•Ê°Ü
					if(this.lastAPIKeyInputText_Available === '' && this.apiCheckedData.filter(data => data.vpn !== 'third-party').length < 1 && ( this.defaultAPIKey === '' || !this.defaultAPIKey.startsWith('sk-') ) &&  this.default_apiKeyArray_WrittenInTheCode.length === 0 ){ 
					//ÂàáÊç¢ÂêéÔºåÊó†ÂèØÁî®ÁöÑOpenAI KeyÊó∂Ôºåthis.restoreApiKeyInput(false,false) Èáå‰ºöËøîÂõûÔºå‰ªÄ‰πà‰πü‰∏çÂÅö„ÄÇÊ≠§Êó∂Â¶ÇÊûúthis.apiÁïôÊúâÁ¨¨‰∏âÊñπÁöÑKeyÔºåÈúÄË¶ÅÊ∏ÖÁ©∫„ÄÇ Â¶ÇÊûúÊòØÁºñËæëÁä∂ÊÄÅÂàô‰∏çÊ∏ÖÁ©∫„ÄÇ
						if( this.btnDisabledState_CheckAPI ){ //ÈùûÁºñËæëÁä∂ÊÄÅÔºàÂ∑≤È™åËØÅÁöÑÁä∂ÊÄÅÔºâ
							this.api = '';
							this.changeButtonDisabledState(true);//ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
						}
						temp_return = false;// OpenAI KeyÊ®°Âºè‰∏ãÊó†ÂèØÁî®key
					}
					this.restoreApiKeyInput(false,false); // ÁÑ∂ÂêéËá™Âä®ÊÅ¢Â§ç‰∏™OpenAI Key„ÄÇ 
					return temp_return;
				}else if( !keymode_old && keymode_now){
				//‰ªéOpenAI APIÊ®°Âºè ÂàáÊç¢Âà∞Á¨¨‰∏âÊñπKeyÊ®°ÂºèÂêé
					let delaytime = 0;
					const temp_apidataArray = this.apiCheckedData.filter(apidata => apidata.vpn === 'third-party' && apidata.apiurl.toLowerCase() === this.apiURL.toLowerCase());
					if(temp_apidataArray.length < 1){ //‰∏çÂ≠òÂú®ÂåπÈÖçÂΩìÂâçÊé•Âè£ÁöÑÁ¨¨‰∏âÊñπKey
						temp_return = false;// Á¨¨‰∏âÊñπKeyÊ®°Âºè‰∏ãÊó†ÂèØÁî®key
						if( this.btnDisabledState_CheckAPI ){ //ÈùûÁºñËæëÁä∂ÊÄÅÔºå‰∏çÂèØÁî®ÁöÑÁä∂ÊÄÅ
							this.api = '';//
							this.changeButtonDisabledState(true);//ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
						}
					}
					this.restoreApiKeyInput(false, false); //ÊÅ¢Â§çÂèØÁî®ÁöÑÁ¨¨‰∏âÊñπKey„ÄÇ  
					return temp_return;
				}
				return temp_return;
				
			},	
			
			// *Send and Retry 
			check_KeyMode_Sending(){
				if(!this.check_KeyMode_byURL_ChangeKey()){ //ÂàùÊ≠•‰øÆÊ≠£KeyÊ®°Âºè„ÄÇ *‰øÆÊ≠£ÂêéÔºågetFirstAvailableAPIKeyÊâç‰ºöÂáÜÁ°Æ„ÄÇ
					//false = KeyÊ®°ÂºèË¢´‰øÆÊ≠£Ôºå‰ΩÜ‰øÆÊ≠£ÂêéÊ≤°ÊúâÂèØ‰ª•‰ΩøÁî®ÁöÑKeyÔºåÈúÄË¶Å‰∏≠Ê≠¢ + ÂºπÁ™ó
					let notif_noKey, notif_noKey_cn, notif_noKey_en;
					let keyModeText;
					let delaytime = 0;
					if( !this.isThirdPartyAPIKeyEnabled ){ //ÂΩìÂâçOpenAI KeyÊ®°ÂºèÔºå‰ΩÜÊòØÊó†ÂèØÁî®ÁöÑOpenAI Key
						keyModeText = this.settingsLanguage == 'cn' ? '‰ΩøÁî® OpenAI ÂÆòÊñπKey (Ëá™Âä®ËΩÆÊç¢API Key)' : 'Use OpenAI API Keys (Auto Key Rotation)' ;
						notif_noKey_cn = 'ÂΩìÂâçÊé•Âè£Âú∞ÂùÄ‰ªÖÊîØÊåÅ OpenAI ÂÆòÊñπKeyÔºåÂ∑≤‰∏∫ÊÇ®Ëá™Âä®Êõ¥Êç¢ [KeyÊ®°Âºè] ‰∏∫: ' + keyModeText + '\r\n\r\n‰ΩÜÊòØÂΩìÂâçÊ≤°ÊúâÂèØÁî®ÁöÑ OpenAI ÂÆòÊñπKeyÔºåËØ∑Ê±ÇÂ∑≤Ë¢´‰∏≠Ê≠¢ÔºåËØ∑Ê∑ªÂä† OpenAI API Key„ÄÇÂ¶ÇÊûúÊÇ®Ë¶Å‰ΩøÁî®Á¨¨‰∏âÊñπ‰∏ìÁî®KeyÔºåËØ∑Êõ¥Êîπ [Êé•Âè£ÁΩëÂùÄ] ‰∏∫Á¨¨‰∏âÊñπÊé•Âè£„ÄÇ' ;
						notif_noKey_en = 'The current API URL (API Endpoint) only supports OpenAI API Key, and it has automatically changed the [Key Mode] to "' + keyModeText + '" for you. \r\n\r\nHowever, there is currently no available OpenAI API Key, and the request has been aborted. Please add an OpenAI API Key. If you want to use a Third-party API Key, please change the [API URL] to the Third-party API.';
						notif_noKey = this.settingsLanguage == 'cn' ? notif_noKey_cn : notif_noKey_en;
					}else{ //ÂΩìÂâçÁ¨¨‰∏âÊñπKeyÊ®°ÂºèÔºåÈúÄË¶ÅÈÄâKey
						keyModeText = this.settingsLanguage == 'cn' ? '‰ΩøÁî®Á¨¨‰∏âÊñπ‰ª£ÁêÜ‰∏ìÁî®Key (Á¨¨‰∏âÊñπÂçïKeyÊ®°Âºè)' : 'Use Third-party Key (3rd party Key Mode)' ;
						notif_noKey_cn = 'ÂΩìÂâçÊé•Âè£Âú∞ÂùÄ‰ªÖÊîØÊåÅÁ¨¨‰∏âÊñπ‰∏ìÁî®KeyÔºåÂ∑≤‰∏∫ÊÇ®Ëá™Âä®Êõ¥Êç¢ [KeyÊ®°Âºè] ‰∏∫: ' + keyModeText + '\r\n\r\nËØ∑ÊâãÂä®ÈÄâÊã©‰∏Ä‰∏™Á¨¨‰∏âÊñπ‰∏ìÁî®Key (ÊàñÊ∑ªÂä†‰∏Ä‰∏™) ÂêéÔºåÂÜçÈáçÂèëÊ∂àÊÅØ„ÄÇÂ¶ÇÊûúÊÇ®Ë¶Å‰ΩøÁî® OpenAI ÂÆòÊñπKeyÔºåËØ∑Êõ¥Êîπ [Êé•Âè£ÁΩëÂùÄ] ‰∏∫ÂÆòÊñπÊé•Âè£ (ÊàñÊîØÊåÅÂÆòÊñπKeyÁöÑÁ¨¨‰∏âÊñπÊé•Âè£)„ÄÇ' ;
						notif_noKey_en = 'The current API URL (API Endpoint) only supports Third-party API Keys. [Key Mode] has been automatically changed to "' + keyModeText + '" for you. \r\n\r\nPlease specify a Third-party API Key manually (or add a new one) before resending the request. If you want to use an OpenAI API Key, please change [API URL] to the OpenAI API Endpoint (or a Third-party API Endpoint that supports OpenAI API Keys).';
						notif_noKey = this.settingsLanguage == 'cn' ? notif_noKey_cn : notif_noKey_en;
						delaytime = 550; // check_KeyMode_byURL_ChangeKey > restoreApiKeyInput‰∏≠ Êúâ‰∏™Â∫ïÈÉ®ÈÄöÁü•Âª∂Ëøü‰∫Ü200msÔºå‰ºöË¶ÜÁõñËøôÈáåÈÄöÁü•
					}
					const notif_title_noKey = this.settingsLanguage == 'cn' ?  'ÊèêÈÜí - Â∑≤‰∏≠Ê≠¢ÂèëÈÄÅËØ∑Ê±Ç' : 'Reminder - Request has been suspended' ;
					setTimeout(() => {
						this.showNotification(notif_noKey, 'center', notif_title_noKey);
					}, delaytime);
					return false;
				}
				return true;
			},			
					
			// Ëá™Âä®ËΩÆÊç¢API KeyÁ™óÂè£ Auto Key Rotation - ÊòæÁ§∫  ÊâπÈáèÊ∑ªÂä†   Display  Bulk Add
			autoKeyRotation_BulkAdd() {
				let notif = this.settingsLanguage == 'cn' ? 'ÂºÄÂßãÊâπÈáèÊ∑ªÂä†API Key' : 'Start bulk adding API Keys' ;
				
				if(this.isShowBulkAddPanel_AutoKeyRotation){
					notif = this.settingsLanguage == 'cn' ? 'ÊâπÈáèÊ∑ªÂä†Â∑≤ÂáÜÂ§áÂ∞±Áª™' : 'Bulk adding is ready' ;
				}
				
				this.isShowBulkAddPanel_AutoKeyRotation = true;
				this.showNotification(notif, 'bottom', '',1800);
				
				setTimeout(() => { //ÊªöÂä®Âà∞Top  gotoTOP
					const positioningDiv = document.querySelector('#dialog-AutoKeyRotation .dialog-content');
					positioningDiv.scrollIntoView({behavior: 'smooth',block: 'start'});
				}, 0); 
			},
			
			// Ëá™Âä®ËΩÆÊç¢API KeyÁ™óÂè£ Auto Key Rotation - ÊâπÈáèÊ∑ªÂä† Bulk Add - 1ÔºâÊèê‰∫§ÊåâÈíÆ Submit Button  2ÔºâInitialize Default ApiKeysArray
			submitBulkApiKeys(isManuallySubmit, isshownotif, apiKeyArray) {
				if (this.checkBusyStatus()) {
					// Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ
					return;
				}
				isManuallySubmit = isManuallySubmit == null ? true : isManuallySubmit; //Á±ªÂà´ÔºöÊòØÂê¶ÊâãÂä®ÁÇπÂáªÊèê‰∫§
				isshownotif = isshownotif == null  ? true : isshownotif; //ÊòØÂê¶ÈÄöÁü•Ê∂àÊÅØ
				apiKeyArray = apiKeyArray == null ? [] : apiKeyArray; //Api KeyÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑ
				
				//‰øùÂ≠ò Ëé∑ÂèñÊúÄÊñ∞API KeyÊï∞ÊçÆ
				this.saveApikeyData();
				
				let notif = '';//ÈÄöÁü•ÂÜÖÂÆπ
				let input = document.querySelector('.textareabulkaddapikey');//ÊâπÈáèËæìÂÖ•Ê°Ü
				//1) ÊâãÂä®ÁÇπÂáªÊèê‰∫§ÊåâÈíÆ
				if(isManuallySubmit && input == null){ //bug
					console.error("submitBulkApiKeys() - document.querySelector('.textareabulkaddapikey') == null ");
					return;
				}
				//1) ÊâãÂä®ÁÇπÂáªÊèê‰∫§ÊåâÈíÆ
				if(isManuallySubmit && input.value.trim() === '' ){ //Êó†ÂÜÖÂÆπÊó∂
					notif = this.settingsLanguage == 'cn' ? 'ÂÜÖÂÆπ‰∏∫Á©∫' : 'Content is empty' ;
					this.showNotification(notif, 'bottom');
					return;
				}
				
 				
				//Ê£ÄÊµãÊòØÂê¶ÂåÖÂê´API Key
				const apiKeyPattern = /^sk-[a-zA-Z0-9]+$/; // sk- ÂºÄÂ§¥Ôºå‰∏çÊ£ÄÊµãÈïøÂ∫¶
				const apiKeyPattern_51 = /^sk-[a-zA-Z0-9]{48}$/; // sk- ÂêéÈù¢48‰∏™Â≠óÊØçÂíåÊï∞Â≠óÔºå‰∏ÄÂÖ±51
				let validApiKeys = [];//ÊàêÂäüÁöÑ
				const invalidApiKeys = [];//Â§±Ë¥•ÁöÑ
				let validApiKeys_Not51 = [];//ÊàêÂäüÁöÑ,Èùû51‰Ωç
      
	  			//1) ÊâãÂä®ÁÇπÂáªÊèê‰∫§ÊåâÈíÆ
	  			if(isManuallySubmit){
					//ÊãÜÂàÜ + ËøáÊª§Á©∫Ë°å + ÊØèË°åÂéªÁ©∫Ê†º
					apiKeyArray = input.value.trim().split('\n');
				}
				
				apiKeyArray = apiKeyArray.filter(apiKey => apiKey.trim() !== '').map(apiKey => apiKey.trim());
				
				apiKeyArray.forEach((apiKey) => { //
					//apiKey = apiKey.trim(); ‰∏äÈù¢ÁöÑ.mapÂ∑≤ÁªèÂéªÈô§ÂâçÂêéÁ©∫Ê†º
					if (apiKeyPattern.test(apiKey)) {
						validApiKeys.push(apiKey); //ÊàêÂäüÁöÑ
						//È¢ùÂ§ñÊ£ÄÊµãÈïøÂ∫¶ÊòØÂê¶‰∏∫51
						if(!apiKeyPattern_51.test(apiKey)){  //The length is not 51, the API Key may be incorrect.
							validApiKeys_Not51.push(apiKey); //Èùû51‰ΩçÔºåÂèØËÉΩÊòØÈîôÁöÑ„ÄÇv7.19 ÁõÆÂâçOpenAI API Key‰∏∫51‰Ωç„ÄÇ
						}
					} else {
						invalidApiKeys.push(apiKey); //Â§±Ë¥•ÁöÑ
					}
				});
				
				//1) ÊâãÂä®ÁÇπÂáªÊèê‰∫§ÊåâÈíÆ
	  			if(isManuallySubmit){
					//v7.20 Êñ∞Â¢ûÊñπÊ≥ïÔºå‰ªéjsonÁöÑÊñáÊú¨‰∏≠ÊèêÂèñ"Ê†áÂáÜÊ†ºÂºè"ÁöÑkeyÔºåÂÅö‰∏∫Ë°•ÂÖÖ„ÄÅÂ¢ûÂº∫„ÄÇ *Âè™ÊèêÂèñÈïøÂ∫¶‰∏∫51‰ΩçÁöÑkey
					const regex_json = /"sk-[a-zA-Z0-9]{48}"/g; //Ê≠£ÂàôÔºö Âê´keyÂèå‰æßÁöÑÂèåÂºïÂè∑ + Âõ∫ÂÆö51‰ΩçÊ†áÂáÜÊ†ºÂºè
					const matches_json = input.value.trim().match(regex_json);
					if(matches_json != null && matches_json.length > 0 ){
						const result_json = matches_json.map(match => match.replace(/"/g, '')); //ÊèêÂèñÂêéÔºåÂÜçÂéªÈô§Âèå‰æßÁöÑÂèåÂºïÂè∑
						validApiKeys = validApiKeys.concat(result_json);//ËøΩÂä†Âà∞validApiKeysÊï∞ÁªÑ‰∏≠
					}
				}
					
      
	  			let isSaveApiKeys = false; //ÊòØÂê¶ÈúÄË¶ÅÊèê‰∫§API Key
				
				if (validApiKeys.length === 0) { // Êó†API KeyÊï∞ÊçÆ
					notif = this.settingsLanguage == 'cn' ? 'ÈîôËØØÔºöÊú™ÂåÖÂê´ API Key' : 'Error: No API Key included' ;
				} else if (invalidApiKeys.length === 0) { // ÊâÄÊúâAPI KeyÈÉΩÊòØÊúâÊïàÁöÑ 
					isSaveApiKeys = true; //Êèê‰∫§
				} else {
					//1) ÊâãÂä®ÁÇπÂáªÊèê‰∫§ÊåâÈíÆ
	  				if(isManuallySubmit){
						notif = this.settingsLanguage == 'cn' ? 'ÊñáÊú¨ÂåÖÂê´ÊúâÈùû API Key ÁöÑÊï∞ÊçÆÔºåÂ∑≤ÊâæÂà∞ ' + validApiKeys.length + ' ‰∏™ API KeyÔºåÊòØÂê¶Áõ¥Êé•Êèê‰∫§Ôºü' : 'The text contains non-API Key data. Currently, ' + validApiKeys.length + ' API Keys have been found. Would you like to submit them directly?' ; 
						this.is_Alert_Confirm_Prompt_Open = true;
						if (confirm(notif)) { //ÂºπÁ™óËØ¢ÈóÆÊòØÂê¶ÁªßÁª≠Êèê‰∫§
							isSaveApiKeys = true; // ÈÄâÊã©Êèê‰∫§Â∑≤ËØÜÂà´Âà∞ÁöÑAPI Key
						} else {
							// ÈÄâÊã©ÂèñÊ∂à
							notif = this.settingsLanguage == 'cn' ? 'Êú™Êèê‰∫§ÔºåËØ∑Ê£ÄÊü•ÂêéÈáçÊñ∞Êèê‰∫§' : 'Not submitted, please check and resubmit' ;
						}
						setTimeout(() => {
							this.is_Alert_Confirm_Prompt_Open = false;
						}, 100);
					}else{
						isSaveApiKeys = true; // Êèê‰∫§
					}
				}
				
				let notif_type = 'bottom';
				let duplicate_found = false;
				
				//ÈúÄË¶ÅÊèê‰∫§‰øùÂ≠ò
				if(isSaveApiKeys){ 
					// ËøáÊª§ÈáçÂ§çÂÄº
					const uniqueApiKeys = validApiKeys.filter((key, index) => {
						return validApiKeys.indexOf(key) === index;//Âú®‰∏äËø∞‰ª£Á†Å‰∏≠ÔºåÊàë‰ª¨‰ΩøÁî®filter()ÊñπÊ≥ïÊù•ËøáÊª§validApiKeysÊï∞ÁªÑ‰∏≠ÁöÑÈáçÂ§çÂÄºÔºåÂè™‰øùÁïôÁ¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑÂÄº„ÄÇ
					});
					//Ê†áËÆ∞ÊâπÈáèÊ∑ªÂä†‰∏≠ÊòØÂê¶ÊúâÈáçÂ§çÈ°π(ÊúâÊïà ‰∏îÈáçÂ§çÁöÑ)
					duplicate_found = uniqueApiKeys.length === validApiKeys.length ? false : true;
					// ÂêåÁêÜ ËøáÊª§ÈáçÂ§çÂÄº
					validApiKeys_Not51 = validApiKeys_Not51.filter((key, index) => {
						return validApiKeys_Not51.indexOf(key) === index;
					});
					
					// ËΩ¨Êç¢‰∏∫ import_apicheckeddata_Array Êï∞ÁªÑ
					let import_apicheckeddata_Array = uniqueApiKeys.map((key) => {
						return { apikey: key }; //ÊúÄÂêéÔºå‰ΩøÁî®map()ÊñπÊ≥ïÂ∞ÜuniqueApiKeysÊï∞ÁªÑËΩ¨Êç¢‰∏∫import_apicheckeddata_ArrayÊï∞ÁªÑÔºåÊØè‰∏™ÂØπË±°ÈÉΩÂåÖÂê´apikeyÂ±ûÊÄß„ÄÇ
					});
					
					// Âæ™ÁéØ import_apicheckeddata_Array È™åËØÅÊï∞ÊçÆ & ÂÖºÂÆπÊÄßÂ§ÑÁêÜ
					//Âà§Êñ≠Â±ûÊÄßÊòØÂê¶Â≠òÂú®‰∏îÊï∞ÊçÆÊòØÂê¶ÂêàÊ≥ïÔºåÂ¶ÇÊûúÁº∫Â∞ëÂ±ûÊÄß Êàñ Â±ûÊÄßÊï∞ÊçÆ‰∏çÂêàÊ≥ïÔºåÂ∞±Ë°•‰∏äÂ±ûÊÄßÂíåÈªòËÆ§ÂÄº
					this.validateApiCheckedData(import_apicheckeddata_Array);
					
					// ÂêàÂπ∂Êõ¥Êñ∞Êï∞ÊçÆÂà∞this.apiCheckedData
					const newData = this.apiCheckedData.filter(apidata => apidata.apikey && apidata.apikey.trim() !== '');//ÊéíÈô§Á©∫È°π
					
					//Êï∞ÊçÆÁªüËÆ°
					let newApiCount = 0;//‰∏çÂ≠òÂú®-Êñ∞Â¢û
					let existingApiCount = 0;//Â∑≤Â≠òÂú®
					let newApiArray = [];//ÊâÄÊúâÊñ∞Â¢ûÁöÑkey
					
					//Êõ¥Êñ∞Êï∞ÊçÆÔºå Êñ∞Â¢û Êàñ Êõ¥Êñ∞
					import_apicheckeddata_Array.forEach(apidata => {
						const existingApiIndex = newData.findIndex(api => api.apikey === apidata.apikey);
						if (existingApiIndex !== -1) {//Â≠òÂú® - ‰ªÄ‰πà‰πü‰∏çÂÅö
							existingApiCount++;//Â≠òÂú® ÁªüËÆ°
						} else {//‰∏çÂ≠òÂú® - Êñ∞Â¢û
							newData.push(apidata);
							newApiArray.push(apidata.apikey);//ËÆ∞ÂΩïÊñ∞Â¢û
							newApiCount++;//Êñ∞Â¢û ÁªüËÆ°
						}
					});
					this.apiCheckedData = newData;
									
					const apikeyData = this.getVariablesFromThis(this.apikeyData_default);
					//ÊâãÂä®Â¢ûÂä†ÁâàÊú¨
					apikeyData.version = this.apikeyData_Version; 
					//‰øùÂ≠ò
					try{
						localStorage.setItem('apikeyData', JSON.stringify(apikeyData)); 
					}catch(e){
						const e_message = e.message ? e.message : '';
						const e_name = e.name ? e.name : '';
						this.localStorageExceedsMaximum(e_message,e_name);
					}
									
					if(!this.btnDisabledState_CheckAPI){ //Â¶ÇÊûúÂΩìÂâçÊòØ‚ÄúÊú™ÈÄöËøáÈ™åËØÅ‚ÄùÁöÑÁä∂ÊÄÅ
						//ÊÅ¢Â§çapikeyÂà∞ËæìÂÖ•Ê°ÜÔºåÂπ∂ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
						this.restoreApiKeyInput(false,false);
					}
					
					let apikey_notif_cn = '';
					let apikey_notif_en = '';
					const duplicate_found_string = duplicate_found ? (this.settingsLanguage == 'cn' ? 'ÂéªÈáçÂêéÔºå' : 'After removing duplicates, ') : '' ;
					//1) ÊâãÂä®ÁÇπÂáªÊèê‰∫§ÊåâÈíÆ
	  				if(isManuallySubmit){
						apikey_notif_cn = 'OKÔºåÊâπÈáèÊ∑ªÂä†ÂÆåÊàê„ÄÇ';
						apikey_notif_en = 'OK, Bulk addition successful. '
					}else{
						apikey_notif_cn = 'OKÔºåÂÆåÊàê„ÄÇ';
						apikey_notif_en = 'OK, Successful. '
					}
					apikey_notif_cn = apikey_notif_cn + 'ÊÄªÂÖ±Ê£ÄÊµãÂà∞ ' + import_apicheckeddata_Array.length + ' ‰∏™ API KeyÔºåÂÖ∂‰∏≠ÔºöÊñ∞ÁöÑ ' + newApiCount + ' ‰∏™ÔºõÂ∑≤Â≠òÂú®ÁöÑ ' + existingApiCount + ' ‰∏™„ÄÇ';
					apikey_notif_en = apikey_notif_en + 'Detected a total of ' + import_apicheckeddata_Array.length + ' API Keys: ' + newApiCount + ' new keys; ' + existingApiCount + ' existing keys.';
					
					//Êñ∞Â¢ûÁöÑÊ∏ÖÂçï
					if(newApiArray.length > 0){
						let newApi = this.settingsLanguage == 'cn' ? '\r\n\r\n‰ª•‰∏ã‰∏∫Êñ∞Â¢û API Key ÁöÑÊ∏ÖÂçï:' : '\r\n\r\nThe following are the newly added API Keys :';
						newApi = newApi + "\r\n" + newApiArray.join("\r\n");
						apikey_notif_cn = apikey_notif_cn + newApi;
						apikey_notif_en = apikey_notif_en + newApi;
					}
					
					//Èùû51‰ΩçÁöÑÊ∏ÖÂçï
					validApiKeys_Not51 = validApiKeys_Not51.filter(key => newApiArray.includes(key));//Âè™‰øùÁïônewApiArray‰∏≠Â≠òÂú®ÁöÑÊï∞ÊçÆ„ÄÇ *validApiKeys_Not51‰πãÂâçÊ≤°ÊúâÊéíÈô§"Â∑≤Â≠òÂú®ÁöÑKey(this.apiCheckedData / newData ‰∏≠Â≠òÂú®ÁöÑ)"ÔºåÂÄüÁî®newApiArrayÊéíÈô§„ÄÇ
					if(validApiKeys_Not51.length > 0){
						let not51 = this.settingsLanguage == 'cn' ? '\r\n\r\nÂÖ∂‰∏≠ÈÉ®ÂàÜ API Key ÁöÑ‰ΩçÊï∞‰∏çÊ≠£Á°ÆÔºåÁñë‰ººÈîôËØØ Key ÁöÑÊ∏ÖÂçïÔºö' : '\r\n\r\nSome of the API Keys have incorrect lengths :';
						not51 = not51 + "\r\n" + validApiKeys_Not51.join("\r\n");
						apikey_notif_cn = apikey_notif_cn + not51;
						apikey_notif_en = apikey_notif_en + not51;
					}
					
					notif = this.settingsLanguage == 'cn' ? apikey_notif_cn : apikey_notif_en;
					notif_type = 'center';
					
					//1) ÊâãÂä®ÁÇπÂáªÊèê‰∫§ÊåâÈíÆ
	  				if(isManuallySubmit){
						input.value = ''; //Ê∏ÖÁ©∫ËæìÂÖ•Ê°Ü
						this.isShowBulkAddPanel_AutoKeyRotation = false;//ÊâπÈáèÊ∑ªÂä†ÁªìÊùüÔºåÈöêËóèÊâπÈáèÊ∑ªÂä†
					}
				}
				
				//1) ÊâãÂä®ÁÇπÂáªÊèê‰∫§ÊåâÈíÆ
  				if(isManuallySubmit || isshownotif){
					//‰∏≠ÂøÉ Êàñ Â∫ïÈÉ®
					this.showNotification(notif, notif_type, '',1800);
				}
			},
			
			// Ëá™Âä®ËΩÆÊç¢API KeyÁ™óÂè£ Auto Key Rotation - ÁÇπÂáª‰øÆÊîπLevel   Edit Level
			autoKeyRotation_EditLevel(apidata) {
				event.stopPropagation();
				//0 Ê≠£ÂøôÔºåÁ®çÂêéÂÜçÊìç‰Ωú
				if (this.checkBusyStatus()) {
					// Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ
					return;
				}
				
				//‰øùÂ≠ò Ëé∑ÂèñÊúÄÊñ∞API KeyÊï∞ÊçÆ
				this.saveApikeyData();
				
				const api_Data = this.apiCheckedData.find(data => data.apikey === apidata.apikey);
				if (api_Data == null) {
					return;
				}
				
				// ÊòæÁ§∫ÂºπÁ™óÔºåÂÖÅËÆ∏Áî®Êà∑ËæìÂÖ•Êñ∞ÁöÑLevel
				let newLevel = null;
				//const regex =  /^[01234589]?$/; // ÂåπÈÖçÊï∞Â≠ó 0, 1, 2, 3, 4, 5 Âíå 8, 9 ÁöÑÊ≠£ÂàôË°®ËææÂºè
				const regex =  /^([01234589]|333)?$/; // ÂåπÈÖçÊï∞Â≠ó 0, 1, 2, 3, 4, 5 Âíå 8, 9 ÁöÑÊ≠£ÂàôË°®ËææÂºè + ÂåπÈÖç 333
				const notif_cn = 'ÊâÄÊúâ[Á∫ßÂà´]ÈÉΩÊòØÂÖ®Ëá™Âä®Ë∞ÉËäÇÁöÑÔºå‰ºöËá™Êàë‰øÆÂ§çÔºåÈÄöÂ∏∏Êó†ÈúÄ‰øÆÊîπ„ÄÇ\r\nÂ¶ÇÈúÄ‰øÆÊîπËØ∑ËæìÂÖ• 1 ‰ΩçÊï∞Â≠óÂπ∂Á°ÆËÆ§Ôºö[0]ÂåπÈÖç‰ªòË¥πË¥¶Âè∑Ôºõ[1ÔΩû5]ÂåπÈÖçÈùû‰ªòË¥πË¥¶Âè∑Ôºõ[8]Êó†ÊïàÁöÑÂØÜÈí•Ôºõ[9]ÈÖçÈ¢ù‰∏çË∂≥(Âê´ËøáÊúü)„ÄÇ\r\n\r\nËæìÂÖ•[333]Âπ∂Á°ÆËÆ§ÔºåÂèØÂ∞Ü Key Êîπ‰∏∫"Á¨¨‰∏âÊñπ‰ª£ÁêÜ‰∏ìÁî®Key"„ÄÇ';
				const notif_en = '[Level] is intelligently adjusted and automatically repaired, usually requiring no modification.\r\nTo make changes, please enter a single digit and confirm: [0] for matching paid accounts; [1-5] for matching non-paid accounts; [8] for invalid API Key; [9] for insufficient quota (including expiration, etc.).\r\n\r\nOther: Enter [333] and confirm to change the Key to "Third-party Key".';
				let text = this.settingsLanguage == 'cn' ?  notif_cn : notif_en;
				let err = false;
				this.is_Alert_Confirm_Prompt_Open = true;
				while (newLevel === null || !regex.test(newLevel)) {
					newLevel = newLevel === null ? (api_Data.level == null ? '' : api_Data.level ): newLevel;
					if (err){
						text = this.settingsLanguage == 'cn' ? 'ÊâÄÊúâ[Á∫ßÂà´]ÈÉΩÊòØÂÖ®Ëá™Âä®Ë∞ÉËäÇÁöÑÔºåÈÄöÂ∏∏Êó†ÈúÄ‰øÆÊîπ„ÄÇ\r\nÂ¶ÇÊûú‰∏çÁ°ÆÂÆöÔºåÂèØÂèñÊ∂à‰øÆÊîπÔºåÊàñÁõ¥Êé•Êîπ‰∏∫[0~5]ÁöÑ 1 ‰ΩçÊï∞Â≠óÔºåÂÄºË∂äÂ∞èÔºå‰ºòÂÖàÁ∫ßË∂äÈ´òÔºå‰ºöÊèêÂâçË¢´Ë∞ÉÁî®Âπ∂Ê†πÊçÆÂÆûÈôÖ‰ΩøÁî®ÊÉÖÂÜµÂä®ÊÄÅË∞ÉËäÇ„ÄÇ\r\n\r\nËæìÂÖ•[333]Âπ∂Á°ÆËÆ§ÔºåÂèØÂ∞Ü Key Êîπ‰∏∫"Á¨¨‰∏âÊñπ‰ª£ÁêÜ‰∏ìÁî®Key"„ÄÇ' : '[Level] is intelligently adjusted and usually do not require modification.\r\nIf unsure, you can cancel the modification or directly change it to a single digit from [0-5]. The smaller the value, the higher the priority. It will be called in advance and dynamically adjusted based on actual usage.\r\n\r\nOther: Enter [333] and confirm to change the Key to "Third-party Key".';
					}
					newLevel = window.prompt(text, newLevel);
					if (newLevel === null) {
						break; // Áî®Êà∑ÁÇπÂáª‰∫ÜÂèñÊ∂àÊåâÈíÆÔºåÁªìÊùüÂæ™ÁéØ
					}
					err = true;
				}
				setTimeout(() => {
					this.is_Alert_Confirm_Prompt_Open = false;
				}, 100);
				
				if(newLevel === null){ //ÁÇπÂáª‰∫ÜÂèñÊ∂à
					return;
				}
				if(newLevel === ''){ //ÁïôÁ©∫„ÄÇÂÖ∂ÂÆûÁïôÁ©∫ÂèØ‰ª•Â∞ÜlevelËÆæ‰∏∫null„ÄÇ‰ΩÜÁõÆÂâçÊ≤°ÊúâÈááÁî®Ê≠§ÈÄªËæëÔºåÁÆÄÂçïÁÇπÔºåÁïôÁ©∫Ë°®Á§∫‰∏çÂèò„ÄÇ
					return;
				} 
				newLevel = parseInt(newLevel); // ËΩ¨‰∏∫Êï∞ÂÄºÂûãÂπ∂ÂèñÊï¥Êï∞
				if (newLevel === 333) { //Á¨¨‰∏âÊñπ
					api_Data.level = 0;
					api_Data.vpn = 'third-party'; // ‚Äúvpn‚ÄùÊîπÁî®ÈÄîÔºåÊîπ‰∏∫Â≠òÂÇ®‚Äútag‚Äù „ÄÇ"vpn" has been repurposed to store "tag"
				}else if (newLevel < 0 || newLevel > 9 || newLevel === 6 || newLevel === 7) {
					return; //‰∏çÂ±û‰∫é 0 1 2 3 4 5 Âíå 8 9 ÔºåÊÑèÂ§ñÈîôËØØÔºåËøîÂõû
				}else {
					api_Data.level = newLevel; //0 1 2 3 4 5 Âíå 8 9
				}
				
				const apikeyData = this.getVariablesFromThis(this.apikeyData_default);
				//ÊâãÂä®Â¢ûÂä†ÁâàÊú¨
				apikeyData.version = this.apikeyData_Version; 
				try{
					//‰øùÂ≠òÂà∞localStorage	
					localStorage.setItem('apikeyData', JSON.stringify(apikeyData)); 
				}catch(e){
					const e_message = e.message ? e.message : '';
					const e_name = e.name ? e.name : '';
					this.localStorageExceedsMaximum(e_message,e_name);
				}
						
				const notif = this.settingsLanguage == 'cn' ? '‰øÆÊîπÊàêÂäü' : 'Modification successful' ;
				this.showNotification(notif, 'bottom');
			},
			
			// Ëá™Âä®ËΩÆÊç¢API KeyÁ™óÂè£ Auto Key Rotation - Delete Key ÁÇπÂáªÂà†Èô§API Key
			deleteApiData(apidata) {
				event.stopPropagation();
				if (this.checkBusyStatus()) {
					// Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ
					return;
				}
				
				//‰øùÂ≠ò Ëé∑ÂèñÊúÄÊñ∞API KeyÊï∞ÊçÆ
				this.saveApikeyData();
					
				let notif = this.settingsLanguage == 'cn' ? 'ÊÇ®Á°ÆÂÆöË¶ÅÂà†Èô§‰∏ãÈù¢Ëøô‰∏™ API Key ÂêóÔºü' : 'Are you sure you want to delete this API Key below?' ;
				notif = notif + '\r\n\r\n' + apidata.apikey;
	
				this.is_Alert_Confirm_Prompt_Open = true;
				const confirmed = confirm(notif); //Áî®Êà∑ÈÄâÊã©ÊòØÂê¶ÁªßÁª≠ÔºåÁªßÁª≠‰ºöÂà†Èô§
				if (!confirmed) {
					setTimeout(() => {
						this.is_Alert_Confirm_Prompt_Open = false;
					}, 100);
					return;//ÂèñÊ∂à Â∞ÜËøîÂõû
				}
				setTimeout(() => {
					this.is_Alert_Confirm_Prompt_Open = false;
				}, 100);
				
				const iscurrentkey = ( this.api === apidata.apikey );
				
				this.apiCheckedData = this.apiCheckedData.filter(data => data.apikey !== apidata.apikey); //Âà†Èô§ÁõÆÊ†áKeyÔºå‰øùÁïôÂÖ∂‰ªñ
				notif = this.settingsLanguage == 'cn' ? 'API Key Â∑≤Âà†Èô§' : 'API Key has been deleted' ;
				this.showNotification(notif, 'bottom'); 
				
				
				const apikeyData = this.getVariablesFromThis(this.apikeyData_default);
				//ÊâãÂä®Â¢ûÂä†ÁâàÊú¨
				apikeyData.version = this.apikeyData_Version; 
				try{
					//‰øùÂ≠òÂà∞localStorage	
					localStorage.setItem('apikeyData', JSON.stringify(apikeyData)); 
				}catch(e){
					const e_message = e.message ? e.message : '';
					const e_name = e.name ? e.name : '';
					this.localStorageExceedsMaximum(e_message,e_name);
				}
			
			
				//‰∏äÊ¨°ÂèØÁî®ÁöÑÔºåÂ¶ÇÊûúÊòØÊú¨Ê¨°Ë¢´Âà†ÁöÑkeyÔºåËøôÈáåÈúÄË¶ÅÊ∏ÖÈô§
				if(this.lastAPIKeyInputText_Available === apidata.apikey){ 
					this.lastAPIKeyInputText_Available = '';
				}
				//Â¶ÇÊûúÂà†Èô§ÁöÑÊòØÂΩìÂâçËæìÂÖ•Ê°ÜÂÜÖÁöÑkey *Ëøô‰∏™‰ª£Á†ÅÂøÖÈ°ªÊîæÂú®ÊúÄÂêéÔºåÂõ†‰∏∫restoreApiKeyInputÈáåÂèØËÉΩ‰ºö‰øùÂ≠òkeyÔºåËÄå‰øùÂ≠òÊñπÊ≥ï‰∏ç‰ºöÂêåÊ≠•Âà†Èô§Ôºå‰πãÂêéÊõ¥Êñ∞ÊàñÊñ∞Â¢û„ÄÇ
				if(iscurrentkey){
					if(!this.isThirdPartyAPIKeyEnabled){ //OpenAI Key
						//ÊÅ¢Â§çapikeyÂà∞ËæìÂÖ•Ê°ÜÔºåÂπ∂ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
						this.restoreApiKeyInput(false,false); //* Ê≠§‰ª£Á†ÅÂøÖÈ°ªÊîæÂú®ÊúÄÂêéÔºåÂõ†‰∏∫Âê´Êúâ‰øùÂ≠òkeyÁöÑ‰ª£Á†Å
					}else{
						this.api = '';
						this.changeButtonDisabledState(true);//ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
					}
				}
				
				//Âà†ÂÆå Êó†Key
				if(this.apiCheckedData.length < 1){
					if(this.btnDisabledState_CheckAPI){
						this.api = '';//Ê∏ÖÁ©∫ËæìÂÖ•Ê°Ü(ÊúÄÂêé‰∏Ä‰∏™Key)
					}
					this.changeButtonDisabledState(true);//ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
				}
			},
			
			
			// ËΩÆËØ¢ ËΩÆÊç¢ (Auto Key Rotation) ÊéíÂ∫èÂπ∂ËøîÂõûÁ¨¨‰∏Ä‰∏™API KeyÂØπË±°„ÄÇ ËøîÂõûÁöÑÊòØapidataÔºå‰∏çÊòØÁõ¥Êé•ËøîÂõûapikey  
			// excludeListÔºàÊéíÈô§ÂàóË°®ÔºåÈùû‰∏•Ê†ºÊâßË°åÔºâÔºöÊï∞ÁªÑÔºåÊîØÊåÅ‰∏§ÁßçÁ±ªÂûãÔºö1.‰øùÊåÅ‰∏éthis.autoRetry_apiKeyExcludeListÁõ∏ÂêåÁöÑÁªìÊûÑ  2.Â≠óÁ¨¶‰∏≤Êï∞ÁªÑ
			getFirstAvailableAPIKey(excludeList) {
				//ÂØπthis.apiCheckedDataËøõË°åÊéíÂ∫èÔºåÂÖàÊåâlevelÊéíÂ∫èÂçáÂ∫èÔºåÁÑ∂ÂêéÂÜçÂØπnexttimeÊéíÂ∫èÂçáÂ∫èÔºåÊúÄÂêéÂèñÂá∫Á¨¨‰∏Ä‰∏™apikeyÊï∞ÊçÆ
				//levelÊï∞ÂÄºÂûã Á∫ßÂà´ÔºåÁ≠âÁ∫ß„ÄÇÂèØ‰∏∫null ÁõÆÂâçÊúâ 0„ÄÅ1„ÄÅÂíå 2„ÄÅ3„ÄÅ4„ÄÅ5 Âíå 8„ÄÅ9 „ÄÇ  0‰ª£Ë°®‰ªòË¥πkeyÔºå1‰ª£Ë°®ÊØèÂàÜÈíü‰øùËØÅÊúâ3ÔΩû5Ê¨°ÁöÑÁã¨‰∫´ÁöÑÂÖçË¥πkeyÔºå2„ÄÅ3„ÄÅ4„ÄÅ5‰ª£Ë°®‰∏çÁ®≥ÂÆöÁöÑÂ§ö‰∫∫ÂÖ±Áî®ÁöÑÂÖçË¥πkeyÔºå8‰ª£Ë°®Êó†ÊïàÔºå9‰ª£Ë°®ÈÖçÈ¢ù‰∏çË∂≥/ËøáÊúüÁöÑkey
				//nexttime È¢Ñ‰º∞ÁöÑ‰∏ãÊ¨°ÂèØÁî®ÁöÑÊó∂Èó¥ Êó∂Èó¥Êà≥   ‰∏çÂ≠òÂú®Êó∂=0
				
				//‰øùÂ≠ò Ëé∑ÂèñÊúÄÊñ∞API KeyÊï∞ÊçÆ
				this.saveApikeyData();
				
				//Á¨¨‰∏âÊñπKeyÊ®°ÂºèÔºå‰∏∫ÂçïKeyÊ®°Âºè„ÄÇ
				if(this.isThirdPartyAPIKeyEnabled){
					let thirdParty_apidata = this.apiCheckedData.find(apidata => apidata.vpn === 'third-party' && apidata.apikey === this.api.trim());
					if(thirdParty_apidata == null){ //ÂèØËÉΩÁöÑÂéüÂõ†ÔºökeyË¢´Âà†Èô§‰∫ÜÔºåÂú®ÂÖ∂‰ªñÊ†áÁ≠æÈ°µ‰∏≠Ë¢´Âà†Èô§ÔºåÊâæ‰∏çÂà∞Key
						console.log('getFirstAvailableAPIKey() Ëé∑ÂèñÁ¨¨‰∏âÊñπkeyÂá∫ÈîôÔºö', thirdParty_apidata);
						console.log('this.api.trim()Ôºö', this.api.trim());
						console.log('this.apiCheckedDataÔºö', this.apiCheckedData);
						thirdParty_apidata = { // ‰∏¥Êó∂Áî®‰∏ÄÊ¨°this.api(Â∑≤Ë¢´Âà†)ÔºåËÆ©Êú¨Ê¨°‚ÄúÂèëÈÄÅ‚ÄùÊµÅÁ®ãËµ∞ÂÆåÔºåÈÅøÂÖçÂºïÂèëbug
							apikey: this.api.trim()
						};
						this.changeButtonDisabledState(true);//ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
					}
					return thirdParty_apidata;// ÁªìÊùüÔºåËøîÂõû
				}
				
				
				//‰ª•‰∏ã‰∏∫OpenAI KeyÊ®°Âºè
				
				// Á≠õÈÄâÂá∫‰∏çÂú®ÊéíÈô§ÂàóË°®‰∏≠ÁöÑAPI KeyÂØπË±°
				let availableKeys;
				if(excludeList != null && excludeList[0] != null){
					if( typeof excludeList[0] === 'string'){
						//ÊôÆÈÄöÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑ
						availableKeys = this.apiCheckedData.filter(apidata => !excludeList.includes(apidata.apikey));
					}else{
						//this.autoRetry_apiKeyExcludeListÁöÑÁªìÊûÑ
						availableKeys = this.apiCheckedData.filter(apidata => !excludeList.some(item => item.apikey === apidata.apikey));
					}
					
					availableKeys = availableKeys.filter(apidata => apidata.vpn !== 'third-party'); //*v8.05  ‚Äúvpn‚ÄùÊîπÁî®ÈÄîÔºåÊîπ‰∏∫Â≠òÂÇ®‚Äútag‚Äù „ÄÇ"vpn" has been repurposed to store "tag"
					const data_temp = availableKeys.filter(item => item.level !== 8 && item.level !== 9 );
					if (data_temp.length < 1) { //Â¶ÇÊûúÂè™Ââ©‰∏ã8 Âíå 9ÔºåÈÇ£‰πàÂ∞±‰∏çÊéíÈô§
						availableKeys = this.apiCheckedData;
					}
				}else{
					availableKeys = this.apiCheckedData.filter(apidata => apidata.vpn !== 'third-party'); //*v8.05  ‚Äúvpn‚ÄùÊîπÁî®ÈÄîÔºåÊîπ‰∏∫Â≠òÂÇ®‚Äútag‚Äù „ÄÇ"vpn" has been repurposed to store "tag"
				}

				// ÊóßÁÆóÊ≥ï - Â§áÁî®ÊñπÊ°àÔºåÂá∫ÈîôÊó∂Êâç‰ºöÁî®Âà∞„ÄÇ Â§áÁî®ÊñπÊ°à‰∏çÊéíÈô§excludeList
				// ÊåâÁ∫ßÂà´ÂíåÊó∂Èó¥ÊéíÂ∫èÁ≠õÈÄâÂêéÁöÑAPI KeyÂØπË±°Êï∞ÁªÑ
				let sortedData = this.apiCheckedData.filter(apidata => apidata.vpn !== 'third-party').sort((a, b) => { //*v8.05  ‚Äúvpn‚ÄùÊîπÁî®ÈÄîÔºåÊîπ‰∏∫Â≠òÂÇ®‚Äútag‚Äù „ÄÇ"vpn" has been repurposed to store "tag"
				 	if (a.level !== b.level) {
						if (a.level === null) {
							return -1;
						} else if (b.level === null) {
							return 1;
						} else {
				 			return a.level - b.level; //Á∫ßÂà´ÂçáÂ∫è
						}
				 	} else {
				 		return a.nexttime - b.nexttime;
				 	}
				});
				// ÊóßÁÆóÊ≥ï - ËøáÊª§Ôºö‰øùÁïôÂÖ®ÈÉ®level0 && ÊéíÈô§ÂÖ®ÈÉ®level8Âíålevel9 && ‰øùÁïôÂÖ∂‰ªñÁöÑnexttimeÈ¢Ñ‰º∞Êó∂Èó¥Â∑≤ÁªèÂà∞‰∫ÜÁöÑ  *?? ‰øùÁïôlevel 0Â•ΩÂÉèÊòØÂ§ö‰ΩôÁöÑÔºå‰∏çÂÜô‰πü‰ºö‰øùÁïô„ÄÇ
				const sortedData_temp = sortedData.filter(item => item.level === 0 || (item.level !== 8 && item.level !== 9 && item.nexttime <= new Date().getTime()));
				if (sortedData_temp.length > 0) {
					sortedData = sortedData_temp;
				}
				// GPT-4 
				let sortedData_gpt4 = sortedData; //È¢ÑËÆæ
				// ÊóßÁÆóÊ≥ï - GPT-4 
				if (this.apiGPTModel.includes('gpt-4')){
					const sortedData_gpt4_temp = sortedData.filter(apidata => apidata.vpn === 'GPT-4');
					if (sortedData_gpt4_temp.length > 0) {
						sortedData_gpt4 = sortedData_gpt4_temp; //Â≠òÂú®gpt4 key
					}
				}
				// ÊóßÁÆóÊ≥ï - Â§áÁî®
				const sortedData_copy = sortedData.slice();//Â§á‰ªΩ
				const sortedData_gpt4_copy = sortedData_gpt4.slice();//Â§á‰ªΩ
				
				
				//???1111 ÂèØËÄÉËôëÂ¢ûÂä†ÊéíÈô§Êù°‰ª∂ÔºönexttimeËøáÊª§Â§ß‰∫é1ÔΩû7ÂàÜÈíüÔºàÂÖçË¥πË¥¶Âè∑ËææÂà∞ÊØèÊó•200Ê¨°ÁöÑ‰∏äÈôêÔºâ„ÄÇÂ•ΩÂÉè‰πüÊ≤°ÂøÖË¶ÅÊéíÈô§„ÄÇ„ÄÇ„ÄÇÂÖ±‰∫´keyÔºå‰ΩøÁî®ÈáèÂ§ßÁöÑÂèØ‰ª•ËÄÉËôëÔºåËøáÊª§Êù°‰ª∂ÈúÄË¶ÅÁ†îÁ©∂
				
				
				// Êñ∞ÁöÑÁÆóÊ≥ï/Á≠ñÁï•
				try{
					const randomNumber_1 = Math.random(); // ÁîüÊàê‰∏Ä‰∏™0Âà∞1‰πãÈó¥ÁöÑÈöèÊú∫Êï∞
					const randomNumber_2 = Math.random(); // ÁîüÊàê‰∏Ä‰∏™0Âà∞1‰πãÈó¥ÁöÑÈöèÊú∫Êï∞
					const randomNumber_3 = Math.random(); // ÁîüÊàê‰∏Ä‰∏™0Âà∞1‰πãÈó¥ÁöÑÈöèÊú∫Êï∞
					
					// v8.08 GPT-4  80%Áõ¥Êé•‰ΩøÁî®GPT-4 KeyÔºå 20%ÊµãËØïÂÖ∂‰ªñlevel= null Êàñ 0 ÁöÑKey
					if(this.apiGPTModel.includes('gpt-4')){
						let availableKeys_gpt4_temp;
						if(Math.random() <= 0.8){ // 80% Áõ¥Êé•‰ΩøÁî®Ê†áËÆ∞ÊîØÊåÅ GPT-4 ÁöÑKey
							availableKeys_gpt4_temp = availableKeys.filter(apidata => apidata.vpn === 'GPT-4');
							if (availableKeys_gpt4_temp.length > 0) {
								availableKeys = availableKeys_gpt4_temp; //Â≠òÂú®gpt4 key
							}else {
								availableKeys_gpt4_temp = availableKeys.filter(apidata => apidata.level === null || apidata.level === 0);
								if (availableKeys_gpt4_temp.length > 0) { 
									availableKeys = availableKeys_gpt4_temp; //‰∏çÂ≠òÂú®gpt4Ôºå‰ΩÜÂ≠òÂú®levelÁ≠â‰∫énullÊàñ0
								}else{
									//ÈÉΩ‰∏çÂ≠òÂú®ÔºåÂàô‰øùÊåÅ‰∏çÂèò
								}
							}
						}else{ // 20% ÊµãËØïÂÖ∂‰ªñlevel= null Êàñ 0 ÁöÑKey
							availableKeys_gpt4_temp = availableKeys.filter(apidata => apidata.level === null || apidata.level === 0);
							if (availableKeys_gpt4_temp.length > 0) { 
								availableKeys = availableKeys_gpt4_temp; //Â≠òÂú®levelÁ≠â‰∫énullÊàñ0
							}else{
								availableKeys_gpt4_temp = availableKeys.filter(apidata => apidata.vpn === 'GPT-4');
								if (availableKeys_gpt4_temp.length > 0) {
									availableKeys = availableKeys_gpt4_temp; //‰∏çÂ≠òÂú®levelÁ≠â‰∫énullÊàñ0Ôºå‰ΩÜÂ≠òÂú®Êúâgpt4 key
								}else{
									//ÈÉΩ‰∏çÂ≠òÂú®ÔºåÂàô‰øùÊåÅ‰∏çÂèò
								}
							}
						}
					}
					// v8.08 add ‰ª•‰∏ä‰ΩøÁî®GPT-4Ê®°ÂûãÁöÑÊÉÖÂÜµÔºå‰ªÖÊîπÂèòavailableKeys  *Â§áÂøòÔºöÊ≠§Â§Ñ‰ª£Á†ÅÊ≤°ÊúâÊéíÈô§level=8/9ÁöÑÊÉÖÂÜµÔºå‰ΩÜÂú®autoRetry‰∏≠ÔºåÊúâÈÄöËøáremainingKeysCountÈôêÂà∂ÈáçÈóÆÊ¨°Êï∞ÔºåÊâÄ‰ª•Âü∫Êú¨‰∏äÈÄâ‰∏çÂà∞8/9„ÄÇ
					
					
					if (randomNumber_1 <= 0.8) { // AÊéíÂ∫èÊñπÊ°à
					// 80%ÈááÁî®AÊéíÂ∫èÊñπÊ°à
						sortedData = availableKeys.sort((a, b) => {
							if (a.level !== b.level) {
								if (a.level === null) {
									return -1;
								} else if (b.level === null) {
									return 1;
								} else {
						 			return a.level - b.level; // Ê†πÊçÆ level ËøõË°åÂçáÂ∫èÊéíÂ∫è
								}
							} else {
								if (randomNumber_2 <= 0.65) {
									// 65%‰∏∫Á¨¨‰∏ÄÁßçÊÉÖÂÜµÔºånexttime ÊåâÂçáÂ∫èÊéíÂ∫è
									return a.nexttime - b.nexttime;
								} else {
									// 35%‰∏∫Á¨¨‰∫åÁßçÊÉÖÂÜµÔºåËøáÊª§Êéâ nexttime ‰∏∫ 0 ÁöÑÈ°π  *Â¶ÇÊûúÊúâÊâπÈáèÊ∑ªÂä†ÁöÑÂäüËÉΩÔºånexttimeÂàùÂßã‰∏∫0ÔºåÁ¨¨‰∫åÁßçÊÉÖÂÜµÔºö35%‰ªéÂ∑≤‰ΩøÁî®ËøáÁöÑkey‰∏≠ÈÄâÂèñÔºåÈÅøÂÖçÊØèÊ¨°ÈÉΩÈÄâÊñ∞ÁöÑkey„ÄÇ
									const filteredData = availableKeys.filter(item => item.nexttime !== 0);
									if (filteredData.length === 0) {
										// Â¶ÇÊûúËøáÊª§ÂêéÊï∞Èáè‰∏∫0ÔºåÂàôÁõ¥Êé•Êåâ nexttime ÂçáÂ∫èÊéíÂ∫è
										return a.nexttime - b.nexttime;
									} else {
										// ËøáÊª§Êéâ nexttime ‰∏∫ 0 ÂêéÁöÑ availableKeys Êåâ nexttime ÂçáÂ∫èÊéíÂ∫è
										const sortedByNextTime = filteredData.sort((a, b) => a.nexttime - b.nexttime);
										return sortedByNextTime.indexOf(a) - sortedByNextTime.indexOf(b);
									}
								}
							}
						});
						
						const randomNumber_4 = Math.random(); // ÁîüÊàê‰∏Ä‰∏™0Âà∞1‰πãÈó¥ÁöÑÈöèÊú∫Êï∞
						if (randomNumber_4 <= 0.85) { //85%ËøáÊª§„ÄÇÁïô15%Êú∫‰ºöÂú®ËΩÆÊç¢‰∏≠Â∞ùËØïÊõ¥Â§öÁöÑkey
							// ËøáÊª§Ôºö‰øùÁïôÂÖ®ÈÉ®level0 && ÊéíÈô§ÂÖ®ÈÉ®level8Âíålevel9 && ‰øùÁïôÂÖ∂‰ªñÁöÑnexttimeÈ¢Ñ‰º∞Êó∂Èó¥Â∑≤ÁªèÂà∞‰∫ÜÁöÑ  *?? ‰øùÁïôlevel 0Â•ΩÂÉèÊòØÂ§ö‰ΩôÁöÑÔºå‰∏çÂÜô‰πü‰ºö‰øùÁïô„ÄÇ
							const temp_sortedData = sortedData.filter(item => item.level === 0 || (item.level !== 8 && item.level !== 9 && item.nexttime <= new Date().getTime()));
							if (temp_sortedData.length > 0) {
								sortedData = temp_sortedData;
							}
						}

						//ÊµãËØï console.log('A 80% ',sortedData); 
						
					}else { // BÊéíÂ∫èÊñπÊ°à
					// 20%ÈááÁî®BÊéíÂ∫èÊñπÊ°à
						let filteredData0 = availableKeys.slice(); // Â§çÂà∂‰∏Ä‰ªΩÂéüÂßãÊï∞ÊçÆ

						// ÊéíÈô§Â±ûÊÄß level ‰∏∫ 8 Âíå 9 ÁöÑÈ°π *ÂÖàÊéíÈô§
						const filteredData3 = filteredData0.filter(item => item.level !== 8 && item.level !== 9); //ÊéíÈô§Êó†ÊïàÂíå ÈÖçÈ¢ù‰∏çË∂≥/ËøáÊúüÁöÑ
						if (filteredData3.length > 0) {
							filteredData0 = filteredData3;
						}
						
						// ÊéíÈô§Â±ûÊÄß nexttime Â§ß‰∫éÂΩìÂâçÊó∂Èó¥ÁöÑÈ°π
						const filteredData2 = filteredData0.filter(item => item.nexttime <= new Date().getTime()); //Âè™‰øùÁïônexttimeÂ∑≤ÁªèÂà∞‰∫ÜÈ¢Ñ‰º∞Êó∂Èó¥ÁöÑ
						if (filteredData2.length > 5) { //Ëá≥Â∞ëÂâ©5‰∏™
							filteredData0 = filteredData2;
						}
						
						// ÊéíÈô§Â±ûÊÄß updatetime ‰∏∫ËøáÂéª20Áßí‰ª•ÂÜÖÁöÑÈ°π
						const filteredData1 = filteredData0.filter(item => item.updatetime < new Date().getTime() - 20000); //Âè™‰øùÁïôÊõ¥Êñ∞Êó∂Èó¥‰∏∫20Áßí‰πãÂâçÁöÑ
						if (filteredData1.length > 3) { //Ëá≥Â∞ëÂâ©3‰∏™
							filteredData0 = filteredData1;
						}

						// ÊéíÈô§Â±ûÊÄß level ‰∏∫ 0 ÁöÑÈ°π
						const filteredData4 = filteredData0.filter(item => item.level !== 0); //ÊéíÈô§‰ªòË¥πÁöÑ/Êó†Èôê‰ΩøÁî®ÁöÑkeyÔºåÁªôÊú∫‰ºöÂ∞ùËØï‰ΩøÁî®ÂÖ∂‰ªñÁöÑkey
						if (filteredData4.length > 0) {
							filteredData0 = filteredData4;
						}

						// 80%‰∏∫ÊñπÊ°à‰∏Ä
						if (randomNumber_3 <= 0.8) {
							// ÊéíÈô§ÈÄâ succrate ‰∏∫ 0 ÁöÑÈ°π
							const filteredData5 = filteredData0.filter(item => item.succrate !== 0);

							if (filteredData5.length === 0) {
								// Â¶ÇÊûúËøáÊª§ÂêéÊï∞Èáè‰∏∫0ÔºåÂàôÁõ¥Êé•Êåâ nexttime ËøõË°åÂçáÂ∫èÊéíÂ∫è
								sortedData = filteredData0.sort((a, b) => a.nexttime - b.nexttime);
							} else {
								// ÂØπÂ±ûÊÄß succrate ËøõË°åÈôçÂ∫èÊéíÂ∫è
								const sortedBySuccrate = filteredData5.sort((a, b) => b.succrate - a.succrate);

								// ÂèñÂâç5‰∏™Ôºà‰∏çÂ§ü5‰∏™Âàô‰øùÁïôÂÖ®ÈÉ®Ôºâ
								const finalData = sortedBySuccrate.slice(0, 5); //ÊàêÂäüÁéáÂâç5

								// Êåâ nexttime ËøõË°åÂçáÂ∫èÊéíÂ∫è
								sortedData = finalData.sort((a, b) => a.nexttime - b.nexttime);
							}	
					
						} else {
						// 20%‰∏∫ÊñπÊ°à‰∫å
							// ÊéíÈô§ succrate ‰∏ç‰∏∫ 0 ÁöÑÈ°π
							const zeroSuccrateFilteredData = filteredData0.filter(item => item.succrate === 0); //Â∞ùËØï‰ΩøÁî®ÊàêÂäüÁéá‰∏∫0ÁöÑ
							
							// ÂÖàÂà§Êñ≠ÊòØÂê¶Êúâ‰∏∫ 0 ÁöÑÈ°π
							if (zeroSuccrateFilteredData.length > 0) {
								// Â¶ÇÊûúÊúâÔºåÂàôÊåâÁÖßÂçáÂ∫èÊéíÂ∫è succrate=0
								sortedData = zeroSuccrateFilteredData.sort((a, b) => a.nexttime - b.nexttime);
							} else {
								// Â¶ÇÊûúÊ≤°ÊúâÔºåÂàôÊåâÁÖßÈôçÂ∫èÊéíÂ∫è
								sortedData = filteredData0.sort((a, b) => a.nexttime - b.nexttime);
							}
							
						}
							
						//ÊµãËØï console.log('B 20% ',sortedData); 
					}
				}catch(e){
					console.error(e);
					console.error('getFirstAvailableAPIKey() Ëé∑ÂèñkeyÁÆóÊ≥ïÂá∫ÈîôÔºö', e.message);
					//Âá∫ÈîôËøòÂéü
					if(this.apiGPTModel.includes('gpt-4')){
						sortedData = Math.random() <= 0.75 ? sortedData_gpt4_copy : sortedData; //25% ÊµãËØïÂÖ∂‰ªñ(vpn !== 'GPT-4')ÁöÑKey
					}else{
						sortedData = sortedData_copy;
					}
				}

				// ËøîÂõûÊéíÂ∫èÂêéÁöÑÁ¨¨‰∏Ä‰∏™API KeyÂØπË±°„ÄÇ *‰∏çÊòØÁõ¥Êé•ËøîÂõûapikey
				return sortedData[0]; 
			},
			
			// (‰∏Ä‰∏™ÊåâÈíÆ‰∏§ÁßçÁä∂ÊÄÅ/‰∏§ÁßçÁî®ÈÄî) Btn: window.sendRequest() or this.restoreApiKeyInput()
			sendRequest_or_restoreApiKeyInput() {
				if(this.btnDisabledState_CheckAPI){ //ÈÄöËøáÊåâÈíÆÁä∂ÊÄÅÂà§Êñ≠
					let apidata = this.apiCheckedData.find(data => data.apikey === this.api.trim());
					let notif = '';
					let notif_time = 4000;
					let delaytime = 0;
					
					//v8.06
					const notif_cn = 'ÁõÆÂâçÊó†Ê≥ïÈÄöËøá API Key Êü•ËØ¢ OpenAI API ‰ΩôÈ¢ùÔºåÁÇπÂáª [ÂèñÊ∂à] ÂèØ‰ª•‰∏≠Ê≠¢Êü•ËØ¢ÔºåÁÇπÂáª [Á°ÆËÆ§ / Â•Ω] ÂèØ‰ª•ÈÄöËøá  Session Key Êù•Êü•ËØ¢‰ΩôÈ¢ù„ÄÇ\r\n\r\n ‚Ä¢ 7Êúà22Êó•ÔΩû26Êó•ÔºåOpenAI ÈôÜÁª≠ÂÅúÊ≠¢‰∫Ü‰ΩøÁî® API Key Êù•Êü•ËØ¢‰ΩôÈ¢ùÂíåÂÖ∂‰ªñË¥¶Âè∑‰ø°ÊÅØÁöÑÈÄöÈÅì„ÄÇÁé∞Âú®ÈúÄË¶Å‰ΩøÁî® Session Key Êù•ËøõË°åÊü•ËØ¢Ôºå‰ΩÜ Session Key ÊòØÂä®ÊÄÅÂèòÂåñÁöÑÔºåÈúÄË¶ÅÁôªÂΩï OpenAI ÂêéËé∑ÂèñÔºå‰∏ÄÊÆµÊó∂Èó¥ÂêéÊàñËÄÖÈÄÄÂá∫ÁôªÂΩïÂêé Session Key ‰ºöËá™Âä®Êç¢Êñ∞ÔºåÈúÄË¶ÅÈáçÊñ∞Ëé∑Âèñ„ÄÇ';
					const notif_en = 'Currently, unable to query OpenAI API balance using API Key. Click [Cancel] to abort, or click [Confirm / OK] to use the Session Key for balance inquiry.\r\n\r\n ‚Ä¢ From July 22nd to 26th, OpenAI suspended the ability to query balances and other account information using the API Key. Currently, to check the balance, a Session Key needs to be used. However, the Session Key is dynamically changing and needs to be obtained after logging into OpenAI. After a certain period of time or logging out, the Session Key will automatically refresh, requiring obtaining again.';
					notif = this.settingsLanguage == 'cn' ? notif_cn : notif_en ;
					this.is_Alert_Confirm_Prompt_Open = true;
					if (confirm(notif)) {//ÂºπÁ™óËØ¢ÈóÆ
						this.sendRequest_usingSessionKey();
					}
					setTimeout(() => {
						this.is_Alert_Confirm_Prompt_Open = false;
					}, 100);
					return;//ËøîÂõû 
				
				
				
					//‰ª•‰∏ãÔºå‰πãÂâçÁöÑ‰ª£Á†ÅÔºå sk- 
					
					if(apidata.level === 8){
						notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÊü•ËØ¢ÁöÑ API Key Êó†ÊïàÔºåÊó†Ê≥ïÊü•ËØ¢‰ΩôÈ¢ù' : 'The current API Key being queried is invalid, and the balance inquiry cannot be completed.' ;
						notif_time = this.settingsLanguage == 'cn' ? 4000 : 5500;
						this.showNotification(notif, 'bottom', '', notif_time); 
						return;
					}
					if(apidata.vpn === 'third-party'){
						notif = this.settingsLanguage == 'cn' ? '‰ªÖÊîØÊåÅÊü•ËØ¢ OpenAI API KeyÔºåÁ¨¨‰∏âÊñπ Key Êó†Ê≥ïÊü•ËØ¢‰ΩôÈ¢ù' : 'Only OpenAI API Keys are supported for balance inquiries. Third-party keys cannot query the balance.' ;
						notif_time = this.settingsLanguage == 'cn' ? 4500 : 6000;
						this.showNotification(notif, 'bottom', '', notif_time); 
						return;
					}
					if(apidata.level === null){
						notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÊü•ËØ¢ÁöÑ API Key Êú™ÊõæÈ™åËØÅËøáÔºåÂ¶ÇÊûúËØ•ÂØÜÈí•Êó†ÊïàÔºåÊü•ËØ¢‰ΩôÈ¢ù‰∏ç‰ºöÊàêÂäü' : 'The current API Key being queried has not been checked. If the key is invalid, the balance inquiry will fail.' ;
						notif_time = this.settingsLanguage == 'cn' ? 5000 : 6500;
						delaytime = 800;
						this.showNotification(notif, 'bottom', '', notif_time); 
					}
					setTimeout(() => {
						window.sendRequest(this.api.trim()); //‰ΩôÈ¢ùÊü•ËØ¢ - Êü•ËØ¢api key
					}, delaytime);
				}else{
					this.restoreApiKeyInput(false, true); //ÂèñÊ∂à‰øÆÊîπAPI KeyÔºåÊÅ¢Â§çAPI Key
				} 
			},			
			// 7Êúà22Êó•ÂºÄÂßãÔºåOpenAIÁöÑËßÑÂàôÊîπÂèòÔºåÈÄöËøáSessionKeyÊü•ËØ¢‰ΩôÈ¢ù 
			// Starting from July 22nd, OpenAI's rules have changed. Balance inquiries are now required to be done using a Session Key.
			// ‰ΩúÂ∫ü.....Session Key‰∏çÊòØÂõ∫ÂÆöÁöÑÔºåÊØèÊ¨°ÁôªÂΩïÈÄÄÂá∫ÈÉΩ‰ºöÂèòÂåñ„ÄÇ
			// Invalid... The Session Key is not static and changes with each login and logout.
			sendRequest_usingSessionKey() {
				
				let sess_key = null;
				const regex =  /^sess-[a-zA-Z0-9]{40}$/; // Ê≠£ÂàôË°®ËææÂºè sess- ÂºÄÂ§¥ + 40‰ΩçÂ§ßÂ∞èÂÜôËã±ÊñáÂíåÊï∞Â≠óÁöÑÁªÑÂêà
				const notif_cn = 'OpenAI API Ë¥¶Âè∑‰ΩôÈ¢ùÊü•ËØ¢ (via Session Key)\r\n\r\n ‚Ä¢ Session Key Ëé∑ÂèñÊñπÊ≥ï(ÂÖ∑‰ΩìËØ∑ÁΩëÁªúÊêúÁ¥¢)ÔºöÁôªÂΩï OpenAI ÂêéÔºåÈÄöËøáÊµèËßàÂô®ÁöÑÂºÄÂèëËÄÖÂ∑•ÂÖ∑ ÔºåÂú® [Headers/Ê†áÂ§¥] ‰∏≠ÊâæÂà∞ [Authorization]ÔºåÂèØËé∑Âæó‰ª•‚Äúsess-‚ÄùÂºÄÂ§¥ÁöÑÊÄªÈïøÂ∫¶‰∏∫45‰ΩçÁöÑ Session Key„ÄÇ\r\n\r\nËØ∑Â∞ÜÂÖ∂Á≤òË¥¥Âú®‰∏ãÊñπÔºåÊü•ËØ¢Â∞ÜËøîÂõûÂåÖÂê´‰ΩôÈ¢ùÂú®ÂÜÖÁöÑÂÆåÊï¥ÁöÑ‰ø°ÊÅØÔºö';
				const notif_en = 'OpenAI API Balance Query (via Session Key)\r\n\r\n ‚Ä¢ To obtain the Session Key (for specifics, please Google): After logging in to OpenAI, open DevTools in your browser and look for [Authorization] under [Headers]. There, you will find a 45-character Session Key starting with "sess-". \r\n\r\nPlease paste it here to check the balance:';
				let text = this.settingsLanguage == 'cn' ?  notif_cn : notif_en;
				let err = false;
				this.is_Alert_Confirm_Prompt_Open = true;
				while (sess_key === null || !regex.test(sess_key.trim())) {
					sess_key = sess_key === null ? '' : sess_key.trim();
					if (err){
						text = this.settingsLanguage == 'cn' ? 'Session Key Ê†ºÂºèÈîôËØØÔºÅ\r\n\r\nsessÁ†ÅÊòØ‰ª•‚Äúsess-‚ÄùÂºÄÂ§¥ÁöÑÊÄªÈïøÂ∫¶‰∏∫45‰ΩçÁöÑÂØÜÈí•ÔºåËØ∑Â∞ÜÂÖ∂Á≤òË¥¥Âú®‰∏ãÊñπÔºåÁ°ÆËÆ§Êü•ËØ¢ÂêéÂ∞ÜËøîÂõû OpenAI API ‰ΩôÈ¢ù‰ø°ÊÅØÔºö' : 'Invalid Session Key format! \r\n\r\nThe key should start with "sess-" and have a total length of 45 characters. Please paste it below and confirm. After the query, it will return the OpenAI API balance:';
					}
					sess_key = window.prompt(text, sess_key);
					if (sess_key === null) {
						break; // Áî®Êà∑ÁÇπÂáª‰∫ÜÂèñÊ∂àÊåâÈíÆÔºåÁªìÊùüÂæ™ÁéØ
					}
					err = true;
				}
				setTimeout(() => {
					this.is_Alert_Confirm_Prompt_Open = false;
				}, 100);
				
				if(sess_key === null){ //ÁÇπÂáª‰∫ÜÂèñÊ∂à
					return;
				}
				
				window.sendRequest(sess_key.trim()); //‰ΩôÈ¢ùÊü•ËØ¢ - Êü•ËØ¢Session Key
				
			},
			// ÊÅ¢Â§çAPIkeyËæìÂÖ•Ê°ÜÁöÑÂÜÖÂÆπ  isconfirm = true: ÂºπÁ™óËØ¢ÈóÆÊòØÂê¶ÊÅ¢Â§ç‰∏Ä‰∏™ÂèØÁî®Key
			restoreApiKeyInput(isconfirm, isshownotif) {
				if (this.checkBusyStatus()) {
					// Â¶ÇÊûúËøîÂõû trueÔºåÊ≠£Âú®ÂèëÈÄÅÊàñÊ≠£Âú®È™åËØÅ
					return;
				} 
				
				isconfirm = isconfirm === true ? true : false;
				isshownotif = isshownotif === true ? true : false;
				isshownotif = isconfirm ? true : isshownotif; //ÂºπÁ™óËØ¢ÈóÆÊó∂Ôºå‰∏ÄÂÆöÈúÄË¶ÅÈÄöÁü•
				let notif;
				//delaytime = delaytime === null ? 100 : delaytime; //Êú™Â°´ÂÜôÔºöÈªòËÆ§100ms  *ÂéüÂÖàÊúâ‰∏™‰º†ÂÖ•ÂèÇÊï∞delaytime
				
				//setTimeout(() => { Âøò‰∫Ü‰∏∫‰ªÄ‰πàË¶ÅÂä†100msÁöÑÂª∂ËøüÔºå Â¶ÇÊûúÈúÄË¶ÅÔºåÂàôÂØπÊØè‰∏™restoreApiKeyInputÂçïÁã¨Âä†Âª∂Ëøü„ÄÇ *‰∏çËÉΩÂä†Âú®ËøôÈáåÔºå0‰πü‰∏çË°åÔºåÂèëÈÄÅÂíåÈáçÂèëÊó∂>‰øÆÊ≠£Ê®°Âºè>Ëá™Âä®Ëé∑ÂèñÂèØÁî®KeyÔºåÂä†Âª∂Êó∂‰ºöÂØºËá¥ÂæàÊôöÊâßË°åÔºåÊôö‰∫égetFirstAvailableAPIKey
					
					let isNoAvailableKey = false;				
					if(this.isThirdPartyAPIKeyEnabled){ //Á¨¨‰∏âÊñπÂçïKeyÊ®°Âºè Third-party Key mode
						if(this.apiCheckedData.filter(data => data.vpn === 'third-party').length < 1 && ( this.defaultAPIKey === '' || this.defaultAPIKey.startsWith('sk-') ) ){ 
							isNoAvailableKey = true;
						}
					}else { // OpenAI Key
						if(this.lastAPIKeyInputText_Available === '' && this.apiCheckedData.filter(data => data.vpn !== 'third-party').length < 1 && ( this.defaultAPIKey === '' || !this.defaultAPIKey.startsWith('sk-') ) &&  this.default_apiKeyArray_WrittenInTheCode.length === 0 ){
							isNoAvailableKey = true;
						}
					}
					
					if(isNoAvailableKey){
						if(!isconfirm && isshownotif){ //ÂΩìÂâçÂä®‰Ωú‰∏∫ÈÄöËøá‚ÄúÁÇπÂáªÊåâÈíÆ‚ÄùÊù•ÊÅ¢Â§ç && ÂÖÅËÆ∏ÈÄöÁü•
							this.api = '';
							notif = this.settingsLanguage == 'cn' ? 'Êó†ÂèØÊÅ¢Â§çÁöÑ API KeyÔºåËØ∑ÁªßÁª≠ËæìÂÖ•Êñ∞ÁöÑKeyÂπ∂È™åËØÅ' : 'No available API Key to restore. Please enter a new Key and check it.' ;
							this.showNotification(notif, 'bottom', '',4500);
						}
						return;
					}
					
					if(this.isThirdPartyAPIKeyEnabled){ //Á¨¨‰∏âÊñπÂçïKeyÊ®°Âºè Third-party Key mode
						if(this.apiCheckedData.filter(data => data.vpn === 'third-party').length > 0){
							if(!this.defaultSelectedOneKey_ThirdParty()){ //ÈªòËÆ§ÈÄâ‰∏Ä‰∏™Á¨¨‰∏âÊñπKey
							//‰∏çÂ≠òÂú®ÔºåÂàôÂºπÁ™óÔºåÊâãÂä®ÈÄâ‰∏Ä‰∏™
							 	setTimeout(() => {
									this.isShowDialog_AutoKeyRotation = true;
									notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâç‰∏∫Á¨¨‰∏âÊñπ Key Ê®°ÂºèÔºåËØ∑ÊâãÂä®ÈÄâÊã©ÂØπÂ∫îÁöÑÁ¨¨‰∏âÊñπ Key' : 'Currently in Third-party Key Mode, please select the Third-party Key manually.' ;
									this.showNotification(notif, 'bottom', '',5000);
								}, 200);
							}
						}else{
							if(this.defaultAPIKey !== '' && !this.defaultAPIKey.startsWith('sk-')){
								this.api = this.defaultAPIKey;
								this.inputapichange(false);
							}
						}
						return;
					}
					
					
					// ‰ª•‰∏ãÈùûÁ¨¨‰∏âÊñπÂçïKeyÊ®°ÂºèÔºåÂè™ÊÅ¢Â§ç OpenAI Key
					
					if(isconfirm){ //ÂΩìÂâç‰∏∫ÂºπÁ™óËØ¢ÈóÆ
						notif = this.settingsLanguage == 'cn' ? 'ÊòØÂê¶ÈúÄË¶ÅÊÅ¢Â§ç‰∏Ä‰∏™ OpenAI ÂÆòÊñπÁöÑ API KeyÔºü' : 'Do you need to recover an OpenAI API Key?' ;
						if(this.apiURL.toLowerCase() !== this.OpenAI_API_URL && this.apiURL.toLowerCase() !== this.OpenaiProxyCom_API_URL){
							notif = notif + (this.settingsLanguage == 'cn' ? '\r\n\r\n ‚Ä¢ KeyÊ®°Âºè: ‰ΩøÁî®OpenAIÂÆòÊñπKey (Ëá™Âä®ËΩÆÊç¢API Key)' : '\r\n\r\n ‚Ä¢ Key Mode: Use OpenAI API Keys (Auto Key Rotation)' );
							notif = notif + (this.settingsLanguage == 'cn' ? '\r\n ‚Ä¢ APIÊé•Âè£: <Á¨¨‰∏âÊñπ> ' + this.apiURL : '\r\n ‚Ä¢ API URL: <Third-party> ' + this.apiURL );
							if(!this.isSimpleMode){
								notif = notif + (this.settingsLanguage == 'cn' ? '\r\n\r\nÊèêÈÜí: Â¶ÇÊûúÁ¨¨‰∏âÊñπÊé•Âè£‰∏çÊîØÊåÅOpenAIÂÆòÊñπKeyÔºåÂàôÈúÄË¶ÅÂú®[ËÆæÁΩÆ]>[Ëá™Âä®ËΩÆÊç¢API Key]‰∏≠Êõ¥ÊîπKeyÊ®°Âºè„ÄÇ' : '\r\n\r\nTip: If the third-party API does not support the OpenAI key, you will need to change the Key Mode in [Settings]>[Auto Key Rotation].' );
							}
						}
						this.is_Alert_Confirm_Prompt_Open = true;
						if (!confirm(notif)) {//ÂºπÁ™óËØ¢ÈóÆ
							setTimeout(() => {
								this.is_Alert_Confirm_Prompt_Open = false;
							}, 100);
							return;//ÁÇπÂáªÂèñÊ∂à
						}
						setTimeout(() => {
							this.is_Alert_Confirm_Prompt_Open = false;
						}, 100);
					}
					
					if(isshownotif){
						notif = this.settingsLanguage == 'cn' ? 'Â∑≤ÊÅ¢Â§ç API Key' : 'API Key has been restored' ;
						this.showNotification(notif, 'bottom', '',2000);
					}
					
					//‰∏äÊ¨°ÁöÑÊúâÊïàÁöÑOpenAI Key
					if(this.lastAPIKeyInputText_Available !== ''){
						this.api = this.lastAPIKeyInputText_Available;
						this.inputapichange(false);
						return;
					}
					//‰∏äÊ¨°ËæìÂÖ•Ê°Ü‰∏≠ÁöÑkey
					//if (this.lastAPIKeyInputText !== ''){
					//	if(this.apiCheckedData.some(item => item.apikey === this.lastAPIKeyInputText)){
					//		this.api = this.lastAPIKeyInputText;
					//		this.inputapichange(false);
					//		return;
					//	}
					//}
					
					//Â∑≤È™åËØÅkeyÁöÑÊï∞ÁªÑ‰∏≠Âèñkey *‰ª£Á†ÅÊâßË°åÂà∞ËøôÈáåÔºå‰∏ÄÂÆö‰∏çÊòØÁ¨¨‰∏âÊñπÂçïKeyÊ®°Âºè„ÄÇÈùûÁ¨¨‰∏âÊñπÂçïKeyÊ®°ÂºèÔºåÈÇ£‰πàgetFirstAvailableAPIKeyËøîÂõûÁöÑÂ∞±‰∏ÄÂÆöÊòØOpenAI Key
					const getkey = this.getFirstAvailableAPIKey();
					if(getkey != null && getkey.apikey != null){
						this.api = getkey.apikey;
						this.inputapichange(false);
						return;
					}
					//ÂÜôÂú®‰ª£Á†Å‰∏≠ÁöÑ OpenAI Key Êï∞ÁªÑ "default_apiKeyArray_WrittenInTheCode"
					if(this.default_apiKeyArray_WrittenInTheCode.length > 0){
						const foundElement = this.default_apiKeyArray_WrittenInTheCode.find(key => {
								return this.apiCheckedData.some(obj => obj.apikey === key);
							});//ÊâæÂá∫Â∑≤È™åËØÅËøáÁöÑ
						if (foundElement != null){ //Â¶ÇÊûúÂ≠òÂú®
							this.api = foundElement;
							this.inputapichange(false);
							return;
						}
					}
					//ÂÜôÂú®‰ª£Á†Å‰∏≠ÁöÑÂçï‰∏™key "api"
					if(this.defaultAPIKey !== '' && this.defaultAPIKey.startsWith('sk-')){
						if(this.apiCheckedData.some(item => item.apikey === this.defaultAPIKey)){
							this.api = this.defaultAPIKey;
							this.inputapichange(false);
							return;
						}
					}
					
					//‰ª•‰∏ãÔºöÂÖ∂‰ªñÊÉÖÂÜµÔºåÊú™È™åËØÅÁöÑkey
					let unverified_key = '';
					if(this.default_apiKeyArray_WrittenInTheCode.length > 0){
						unverified_key = this.default_apiKeyArray_WrittenInTheCode[0];
					}
					unverified_key = unverified_key !== '' ? unverified_key : (this.defaultAPIKey !== '' ?  this.defaultAPIKey : this.lastAPIKeyInputText);
					this.api = unverified_key;
					this.inputapichange(false);
				//}, delaytime); Âøò‰∫Ü‰∏∫‰ªÄ‰πàË¶ÅÂä†100msÁöÑÂª∂ËøüÔºå Â¶ÇÊûúÈúÄË¶ÅÔºåÂàôÂØπÊØè‰∏™restoreApiKeyInputÂçïÁã¨Âä†Âª∂Ëøü„ÄÇ *‰∏çËÉΩÂä†Âú®ËøôÈáåÔºå0‰πü‰∏çË°åÔºåÂèëÈÄÅÂíåÈáçÂèëÊó∂>‰øÆÊ≠£Ê®°Âºè>Ëá™Âä®Ëé∑ÂèñÂèØÁî®KeyÔºåÂä†Âª∂Êó∂‰ºöÂØºËá¥ÂæàÊôöÊâßË°åÔºåÊôö‰∫égetFirstAvailableAPIKey
			},
						
			// Êõ¥Êñ∞this.apiCheckedDataÊï∞ÁªÑÔºàÂ∑≤È™åËØÅÁöÑAPI Key‰ø°ÊÅØÔºâÔºåÊõ¥Êñ∞keyÊï∞ÊçÆÁöÑÁ≠ñÁï•(Algorithm/Strategy for updating API key data)  - ËΩÆËØ¢ / Ëá™Âä®ËΩÆÊç¢API Key / Auto Key Rotation
			updateApiCheckedData(api_key, requesttime, state) {
				if(api_key == null || api_key === '' || requesttime == null || requesttime === 0 || state == null ){
					console.error("updateApiCheckedData - Err - Null");
					return;
				}
				if(requesttime.toString().length !== 13 || isNaN(new Date(requesttime).getTime()) ){
					console.error("updateApiCheckedData - Err - not Timestamp");
					return;
				}
				if( state === '' ){
					return;
				}
				api_key = api_key.trim();
				
				//‰øùÂ≠ò Ëé∑ÂèñÊúÄÊñ∞API KeyÊï∞ÊçÆ
				this.saveApikeyData();
				
				let apidata = this.apiCheckedData.find(data => data.apikey === api_key);
				
				try{//ÊµãËØï
				//	console.log('updateApiCheckedData Ââç - apidata ',apidata);  
				//	console.log('updateApiCheckedData Ââç - apidata date1 ',new Date(apidata.date1).toLocaleString()); 
				//	console.log('updateApiCheckedData Ââç - apidata date2 ',new Date(apidata.date2).toLocaleString()); 
				//	console.log('updateApiCheckedData Ââç - apidata date3 ',new Date(apidata.date3).toLocaleString()); 
				//	console.log('updateApiCheckedData Ââç - apidata nexttime ',new Date(apidata.nexttime).toLocaleString()); 
				//	console.log('updateApiCheckedData Ââç - apidata level ',apidata.level); 
				}catch(e){}
			 
	// start - Â∑≤ÁªèÂ≠òÂú®ÁöÑkey
				if (apidata) {
					
					//ÂÖàÊõ¥Êñ∞ÊúÄÂêéÊìç‰ΩúÊó∂Èó¥
					apidata.updatetime = new Date().getTime();
					
					
					if(state === 'success'){ 
					//ÂèëÈÄÅÊàêÂäü
					//level: 0  1  2 3 4 5
					
						let isLevelChanged = false;
						// 1) Level Á¨¨1Ê¨°Êõ¥Êñ∞(Êõ¥Êñ∞Êó∂Èó¥Êï∞ÊçÆ‰πãÂâçÂà§Êñ≠Ôºåapidata.date123ÁöÑÊó∂Èó¥ÂèØËÉΩËøúË∂Ö1ÂàÜÈíü) 
						if (apidata.level >= 0 && apidata.level <= 5 ) { // 0  1  2 3 4 5
							if(apidata.date3 !== 0){ //Âç≥ÂΩìÂâçÂ≠òÂú®4‰∏™Êó∂Èó¥Êï∞ÊçÆ‰æõÂàÜÊûêÂà§Êñ≠Ôºö3‰∏™Êó∂Èó¥ËÆ∞ÂΩï + ÊúÄÊñ∞Êó∂Èó¥requesttime
								const date1_4 = requesttime - apidata.date1 ; //ÊúÄÊñ∞ÊàêÂäüÁöÑÊó∂Èó¥ - Á¨¨‰∏Ä‰∏™ÊàêÂäüÁöÑÊó∂Èó¥
								if( date1_4 < 19500 ){ // Èò≤Ê≠¢ËØØÂ∑ÆÔºå20ÁßíÂáè0.5Áßí
									//19.5ÁßíÂÜÖÊàêÂäüÂèëÈÄÅ4Ê¨°ÔºåË∂ÖÂá∫ÂÖçË¥πË¥¶Êà∑ÁöÑËåÉÂõ¥ÔºåËá™Âä®Ê†á‰∏∫‰ªòË¥πË¥¶Êà∑
									apidata.level = 0;
									isLevelChanged = true;
								}else if( date1_4 < 39500 ){
									//39.5ÁßíÂÜÖÊàêÂäüÂèëÈÄÅ4Ê¨°ÔºåÂÖçË¥πË¥¶Êà∑ ÊàñËÄÖ ‰ªòË¥πË¥¶Êà∑  *Êà™Ê≠¢2023.7.14ÔºåOpenAIËßÑÂàôÔºåÂÖçË¥πkeyË∂ÖËøá1ÂàÜÈíüÊú™‰ΩøÁî®Êó∂Ôºå20ÁßíÂÜÖÊúÄÂ§öÂèë3Ê¨°ÔºåÁÑ∂ÂêéÈôêÂà∂20ÁßíÂèë‰∏ÄÊù°ÔºåÂç≥ÂÖçË¥πË¥¶Âè∑40ÁßíÊúÄÈ´òËÆ∞ÂΩïÂèØÂèë4Êù°
									apidata.level = apidata.level === 0 ? 0 : 1 ; //‰øùÊåÅ0 ÊàñËÄÖ‰øùÊåÅ1 ÊàñËÄÖÊîπ‰∏∫1
									isLevelChanged = true;
								}else if( date1_4 < 59500 ){
									apidata.level = (apidata.level - 3) >= 1 ? (apidata.level - 3) : 1 ; //ÊèêÂçá3Á∫ß
									isLevelChanged = true;
								}
							}
						}
						
						// 2) ÁªüËÆ° 
						apidata.succcount ++; //ÊàêÂäüÊ¨°Êï∞+1
						//apidata.succrate = parseFloat((apidata.succcount / ).toFixed(4)); // ÊàêÂäüÁéá
						apidata.succrate = Math.round((apidata.succcount / (apidata.succcount + apidata.failcount)) * 10000) / 10000; // ÊàêÂäüÁéá
						//‰∏∫‰∫Ü‰øùËØÅÊàêÂäüÁéáÁöÑÂáÜÁ°ÆÂ∫¶ÂíåÂÆûÊïàÊÄßÔºåËææÂà∞Êù°‰ª∂Â∞±ÂéãÁº©Ê¨°Êï∞ÔºåÁº©Â∞è5ÂÄçÔºåÂπ∂Âêë‰∏äÂèñÊï¥Êï∞
						if (apidata.succcount > 100 || apidata.failcount > 100) {
							apidata.succcount = Math.ceil(apidata.succcount / 5);
							apidata.failcount = Math.ceil(apidata.failcount / 5);
						}

						// 3) date1 &2 &3
						// Ê£ÄÊü•ÊòØÂê¶Ë∂ÖËøá60.5ÁßíÔºåË∂ÖËøá60.5ÁßíËÆæ‰∏∫0
						if ( requesttime - apidata.date1 > 60500) {
							apidata.date1 = 0;
						}
						if ( requesttime - apidata.date2 > 60500) {
							apidata.date2 = 0;
						}
						if (requesttime - apidata.date3 > 60500) {
							apidata.date3 = 0;
						}
	
						//Áßª‰ΩçÔºåÈáçÊñ∞ÊéíÂ∫è
						if (apidata.date1 === 0) {
							apidata.date1 = apidata.date2;
							apidata.date2 = apidata.date3;
							apidata.date3 = 0;
						} 
						if (apidata.date1 === 0) {
							apidata.date1 = apidata.date2;
							apidata.date2 = 0;
						} 
  
						//ÂÜôÂÖ•Êú¨Ê¨°ÁöÑËØ∑Ê±ÇÊó∂Èó¥ requesttime
						if (apidata.date1 === 0) {
							apidata.date1 = requesttime;
						} else if (apidata.date2 === 0) {
							apidata.date2 = requesttime;
						} else if (apidata.date3 === 0) {
							apidata.date3 = requesttime;
						} else {
							apidata.date1 = apidata.date2;
							apidata.date2 = apidata.date3;
							apidata.date3 = requesttime;
						}

						// 4) nexttime
						if(apidata.date2 === 0 || apidata.date3 === 0){ // date2Êàñdate3‰∏∫0ÔºåÂèØÁªßÁª≠Â∞ùËØï *ÂΩìÂâç1ÂàÜÈíüÂÜÖËøûÁª≠ÊàêÂäü1ÔΩû2Ê¨°
							apidata.nexttime = requesttime; //ËÆæ‰∏∫ËØ∑Ê±ÇÊó∂ÁöÑÊó∂Èó¥Ôºå‰ºòÂÖàÁ∫ßËæÉÈ´ò
						}else if ( (apidata.date3 > (apidata.date2 + 20500)) || (apidata.date3 > (apidata.date1 + 20500)) ){ //Ë∂ÖËøá20.5ÁßíÔºåÂèØÁªßÁª≠ÂèëÈÄÅ„ÄÇ *ÂΩìÂâç1ÂàÜÈíüÂÜÖËøûÁª≠ÊàêÂäü3Ê¨°Ôºå‰∏îÊúâËæÉÂ§ßÊ¶ÇÁéáËÉΩÂèëÁ¨¨4Êù°
							apidata.nexttime = requesttime;  //ËÆæ‰∏∫ËØ∑Ê±ÇÊó∂ÁöÑÊó∂Èó¥Ôºå‰ºòÂÖàÁ∫ßËæÉÈ´ò
						}else { // +20.5Áßí
							apidata.nexttime = requesttime + 20500; //ÂÖ∂‰ªñÊÉÖÂÜµÔºåÈ¢Ñ‰º∞20.5ÁßíÂêéÂèØÁî®
						}
						
						// 1) Level Á¨¨2Ê¨°Êõ¥Êñ∞(Êõ¥Êñ∞Êó∂Èó¥Êï∞ÊçÆ‰πãÂêéÂà§Êñ≠Ôºåapidata.date123ÁöÑÊó∂Èó¥ÊòØ1ÂàÜÈíü‰ª•ÂÜÖÁöÑ)
						if (apidata.level === 8 || apidata.level === 9  || apidata.level === null) {
						// 8ÔºöÊó†Êïà Áñë‰ººÊó†Êïà  9ÔºöÊõæÁªèÈÖçÈ¢ù‰∏çË∂≥/ËøáÊúüÔºàÁé∞Âú®ÂèØËÉΩÊÅ¢Â§çÈÖçÈ¢ù‰∫ÜÔºâ nullÔºöÈ¶ñÊ¨°Ê†áÊ≥®level 
							apidata.level = 1; //ÂÖàÊ†á‰∏∫1ÔºåÂÖàÂçáÂêéÈôç
						}else if (isLevelChanged === false && apidata.level >= 0 && apidata.level <= 5 ) { // 012345
							if(apidata.date3 !== 0){ //1ÂàÜÈíüÂÜÖ3Ê¨°
								apidata.level = (apidata.level - 3) >= 1 ? (apidata.level - 3) : (apidata.level < 1 ? apidata.level : 1 ) ; //ÊèêÂçá3Á∫ßÔºåÊúÄÈ´òÂà∞1Á∫ßÔºàÊúâËæÉÈ´òÊ¶ÇÁéáÊòØ1Á∫ßÔºåÂÖàÊèêÂçáÔºâÔºå0Á∫ßÂàô‰øùÊåÅ‰∏çÂèò
							}else if(apidata.date2 !== 0){ //1ÂàÜÈíüÂÜÖ2Ê¨°
								apidata.level = (apidata.level - 2) >= 2 ? (apidata.level - 2) : (apidata.level < 2 ? apidata.level : 2 ); //Â¶ÇÊûúÂ§ß‰∫é2ÔºåÊèêÂçá2Á∫ßÔºåÊúÄÈ´òÂà∞2Á∫ßÔºàÊó†Ê≥ïËØÅÊòéÊòØ1Á∫ßÔºâ
							}else { //1ÂàÜÈíüÂÜÖ1Ê¨°
								apidata.level = (apidata.level - 1) >= 2 ? (apidata.level - 1) : (apidata.level < 2 ? apidata.level : 2 ); //Â¶ÇÊûúÂ§ß‰∫é2ÔºåÊèêÂçá1Á∫ßÔºåÊúÄÈ´òÂà∞2Á∫ßÔºàÊó†Ê≥ïËØÅÊòéÊòØ1Á∫ßÔºâ
							}
						}
						
						// 5) apiurl *ÊúÄÂêéÊàêÂäüÁöÑapiurl
						apidata.apiurl = this.apiURL.trim();
						
						// 6) vpn = tag   *v8.05  ‚Äúvpn‚ÄùÊîπÁî®ÈÄîÔºåÊîπ‰∏∫Â≠òÂÇ®‚Äútag‚Äù „ÄÇ"vpn" has been repurposed to store "tag"
						//‰ºòÂÖàÂà§Êñ≠„ÄÅÊ†áËÆ∞Á¨¨‰∏âÊñπKeyÔºåÊó†ËÆ∫ÊòØÂê¶ÊîØÊåÅgpt-4„ÄÇÁ°ÆÂÆö‰∏çÂ±û‰∫éÁ¨¨‰∏âÊñπÂêéÔºåÂÜçÂà§Êñ≠ÊòØÂê¶ÊîØÊåÅgpt-4
						if( !this.api.startsWith('sk-') || ( this.api.startsWith('sk-') && this.excludeList_ThirdPartyKeyStartWithSK_DomainKeyword.some(char => this.apiURL.toLowerCase().includes(char)) )  ){ 
						//1) "‰∏çÂåÖÂê´sk-"  Êàñ  2) "ÂåÖÂê´sk-"&&"Â±û‰∫éÈùûOpenAIÂÆòÊñπÁöÑsk-"
							apidata.vpn = 'third-party';
						}else if( apidata.vpn !== 'third-party' && (this.apiGPTModel.includes('gpt-4') || apidata.vpn === 'GPT-4') ){ // ÈùûÁ¨¨‰∏âÊñπ && (Â±û‰∫égpt-4Ê®°Âûã Êàñ Â∑≤Ê†áËÆ∞‰∏∫gpt4)
							apidata.vpn = 'GPT-4';
							apidata.level = 0;
						}
					
					}else if(state === '429-2' || state === '404' ){
					//ÂèëÈÄÅÂ§±Ë¥• Êó†È¢ùÂ∫¶ || Ê®°ÂûãÈîôËØØ/ Êó†Ê®°ÂûãÊùÉÈôê /Ë¥¶Âè∑Êó†ÁªÑÁªáÊú∫ÊûÑ
					//level: 9 and other 
					
						// 1) Level 
						if(state === '429-2'){
							apidata.level = 9; 
						}else if( state === '404' && !this.isThirdPartyAPIKeyEnabled){ // 404 && OpenAI Key
							if(this.apiGPTModel.includes('gpt-4')){ //Â¶ÇÊûúÊòØgpt-4Ê®°ÂûãÔºå404Â§ßÊ¶ÇÁéáÊòØÂõ†‰∏∫Êó†ÊùÉÈôê„ÄÇ
								//if(apidata.vpn !== 'GPT-4'){ // GPT4 Key‰øùÊåÅ‰∏çÂèòÔºåÂÖ∂‰ªñÈôçÁ∫ß  Ê≥®Èáä‰ª£Á†ÅÁöÑÂéüÂõ†ÔºöÈÅøÂÖçÈîôËØØÊ†áËÆ∞‰∏∫gpt4ÁöÑkeyÂπ≤Êâ∞ËΩÆËØ¢ÔºåGPT4 KeyÁöÑË∞ÉÁî®‰∏ç‰æùËµñlevelÔºåÂÖÅËÆ∏ÈôçÁ∫ß„ÄÇÂ∑≤Âà†Èô§ÂÖ∂‰ªñÂú∞ÊñπÁöÑif(apidata.vpn !== 'GPT-4')‰ª£Á†Å„ÄÇ
									if(apidata.level >= 1 && apidata.level <= 5){
										apidata.level = (apidata.level + 1) <= 5 ? (apidata.level + 1) : 5;
									}
								//}
							}
						}
						
						// 2) ÁªüËÆ° 
						apidata.failcount ++; //Â§±Ë¥•Ê¨°Êï∞+1
						apidata.succrate = Math.round((apidata.succcount / (apidata.succcount + apidata.failcount)) * 10000) / 10000; // ÊàêÂäüÁéá
						//‰∏∫‰∫Ü‰øùËØÅÊàêÂäüÁéáÁöÑÂáÜÁ°ÆÂ∫¶ÂíåÂÆûÊïàÊÄßÔºåËææÂà∞Êù°‰ª∂Â∞±ÂéãÁº©Ê¨°Êï∞ÔºåÁº©Â∞è5ÂÄçÔºåÂπ∂Âêë‰∏äÂèñÊï¥Êï∞
						if (apidata.succcount > 100 || apidata.failcount > 100) {
							apidata.succcount = Math.ceil(apidata.succcount / 5);
							apidata.failcount = Math.ceil(apidata.failcount / 5);
						}
						
						// 4) nexttime
						if(state === '429-2'){
							apidata.nexttime = requesttime; //ÂØπ‰∫élevel = 9 ÂÆûÈôÖ‰ΩúÁî®ÊòØËÆ∞ÂΩïÂ§±Ë¥•Êó∂Èó¥
						}else{ //404
							apidata.nexttime = requesttime + 20500; //Âª∂ÂêéÔºåÊéíÂ∫èÔºåÂà©‰∫éËΩÆËØ¢
						}
						
						// 6) vpn = tag *ÂØπ‰∫éGPT-4ÁöÑÊ®°ÂûãÔºå404Âè™ËÉΩËØ¥Ê®°Âûã‰∏çÂ≠òÂú®ÊàñËÄÖÊ≤°ÊúâÂΩìÂâçGPT-4Ê®°ÂûãÁöÑÊùÉÈôêÔºå‰∏ç‰ª£Ë°®Ê≤°ÊúâÂÖ∂‰ªñGPT-4Ê®°ÂûãÁöÑÊùÉÈôê
					
					}else if(state === '429-3' || state === '429-4' || state === '500' || state === '503'){
					//Ôºà‰∏çÂç†Áî®ËØ∑Ê±ÇÈ¢ùÂ∫¶ÔºâÂèØÁ´ãÂç≥ÈáçËØï
					//level: 0 1 2345 8  
					
						// 1) Level 
						if (apidata.level === 9) {
							apidata.level = null; //ËÆæ‰∏∫null
						}
					
					}else if(state === '429-1' || state === '429-1-day' || state === '429-5' || state === '400' ){
					//Ôºà‰∏çÂç†Áî®ËØ∑Ê±ÇÈ¢ùÂ∫¶ÔºâËØ∑Ê±ÇÊ¨°Êï∞ËøáÂø´ || Ôºà‰∏çÂç†Áî®ËØ∑Ê±ÇÈ¢ùÂ∫¶ÔºâÂÖçË¥πË¥¶Âè∑ËææÂà∞ÊØèÂ§©ÁöÑËØ∑Ê±Ç‰∏äÈôê ||Ôºà‰∏çÂç†Áî®ËØ∑Ê±ÇÈ¢ùÂ∫¶ÔºâËØ∑Ê±ÇËøáÂø´(tokensÊØèÂàÜÈíü) || ÔºàÂç†Áî®ËØ∑Ê±ÇÈ¢ùÂ∫¶ÔºâtokensË∂ÖÂá∫
					//level: 0 1 2345
					
						// 1) Level 
						if (state === '429-1' || state === '429-1-day'){
							if (apidata.level === 8 || apidata.level === 9) {
								apidata.level = null; //ËÆæ‰∏∫null
							}
							if( apidata.level === 0){
								apidata.level = 1; //Êó†ÈôêË¥¶Êà∑ Èôç‰∏∫ÂÖçË¥πË¥¶Êà∑
							}else if( apidata.level >= 1 && apidata.level <= 5 ){ //‰ª•‰∏ãÂà§Êñ≠Êù°‰ª∂ÊØîËæÉÂÆΩÊùæÔºå‰∏ç‰∏•Ë∞®ÔºåÂ§ßÂ§öÊï∞ÊÉÖÂÜµÈôçÁ∫ßÂ§ÑÁêÜÔºåÊúâÂà©‰∫éËá™Âä®ËΩÆÊç¢Â∞ùËØï‰∏çÂêåÁöÑkey
								if(apidata.date1 === 0){ //0‰∏™Êó∂Èó¥ËÆ∞ÂΩï
									apidata.level = (apidata.level + 2) <= 5 ? (apidata.level + 2) : 5;
								}else if(apidata.date2 === 0){ //1‰∏™Êó∂Èó¥ËÆ∞ÂΩï
									if( (requesttime - apidata.date1) > 20500){ 
										apidata.level = (apidata.level + 1) <= 5 ? (apidata.level + 1) : 5;
									}
								}else if(apidata.date3 === 0){ //2‰∏™Êó∂Èó¥ËÆ∞ÂΩï
									if((requesttime - apidata.date1) > 40500 || (requesttime - apidata.date2) > 20500){
										apidata.level = (apidata.level + 1) <= 5 ? (apidata.level + 1) : 5;
									}
								}else{
									apidata.level = (apidata.level + 1) <= 5 ? (apidata.level + 1) : 5;
								}
							}
						} else if (state === '400'){ //ÁÆóÊàêÂäü
							if (apidata.level === 8 || apidata.level === 9  || apidata.level === null) {
								apidata.level = 1; //ÂÖàÊ†á‰∏∫1ÔºåÂÖàÂçáÂêéÈôç
							}else if (apidata.level >= 0 && apidata.level <= 5 ) { // 0  1  2 3 4 5
								if(apidata.date3 !== 0){ //Âç≥ÂΩìÂâçÂ≠òÂú®4‰∏™Êó∂Èó¥Êï∞ÊçÆ‰æõÂàÜÊûêÂà§Êñ≠Ôºö3‰∏™Êó∂Èó¥ËÆ∞ÂΩï + ÊúÄÊñ∞Êó∂Èó¥requesttime
									const date1_4 = requesttime - apidata.date1 ; //ÊúÄÊñ∞ÊàêÂäüÁöÑÊó∂Èó¥ - Á¨¨‰∏Ä‰∏™ÊàêÂäüÁöÑÊó∂Èó¥
									if( date1_4 < 19500 ){ // Èò≤Ê≠¢ËØØÂ∑ÆÔºå20ÁßíÂáè0.5Áßí
										//19.5ÁßíÂÜÖÊàêÂäüÂèëÈÄÅ4Ê¨°ÔºåË∂ÖÂá∫ÂÖçË¥πË¥¶Êà∑ÁöÑËåÉÂõ¥ÔºåËá™Âä®Ê†á‰∏∫‰ªòË¥πË¥¶Êà∑
										apidata.level = 0;
										isLevelChanged = true;
									}else if( date1_4 < 39500 ){ //39.5Áßí
										//39.5ÁßíÂÜÖÊàêÂäüÂèëÈÄÅ4Ê¨°ÔºåÂÖçË¥πË¥¶Êà∑ ÊàñËÄÖ ‰ªòË¥πË¥¶Êà∑  *Êà™Ê≠¢2023.7.14ÔºåOpenAIËßÑÂàôÔºåÂÖçË¥πkeyË∂ÖËøá1ÂàÜÈíüÊú™‰ΩøÁî®Êó∂Ôºå20ÁßíÂÜÖÊúÄÂ§öÂèë3Ê¨°ÔºåÁÑ∂ÂêéÈôêÂà∂20ÁßíÂèë‰∏ÄÊù°ÔºåÂç≥ÂÖçË¥πË¥¶Âè∑40ÁßíÊúÄÈ´òËÆ∞ÂΩïÂèØÂèë4Êù°
										apidata.level = apidata.level === 0 ? 0 : 1 ; //‰øùÊåÅ0 ÊàñËÄÖ‰øùÊåÅ1 ÊàñËÄÖÊîπ‰∏∫1
										isLevelChanged = true;
									}else if( date1_4 < 59500 ){ //59.5Áßí
										apidata.level = (apidata.level - 3) >= 1 ? (apidata.level - 3) : 1 ; //ÊèêÂçá3Á∫ß
										isLevelChanged = true;
									}else{
										apidata.level = (apidata.level - 1) >= 2 ? (apidata.level - 1) : 2 ; //ÁÆÄÂçïÂ§ÑÁêÜÔºåÂÖàÊèêÂçá1Á∫ß
									}
								}else{
										apidata.level = (apidata.level - 1) >= 2 ? (apidata.level - 1) : 2 ; //ÁÆÄÂçïÂ§ÑÁêÜÔºåÂÖàÊèêÂçá1Á∫ß
								}
							}
						} else if (state === '429-5'){  //tokensËØ∑Ê±ÇËøáÂø´(ÊØèÂàÜÈíü) 
							if (apidata.level === 8 || apidata.level === 9) {
								apidata.level = null; //ËÆæ‰∏∫null
							}
							//ÂÖ∂‰ªñÊÉÖÂÜµÔºå‰øùÊåÅ‰∏çÂèò
						}
						
						// 2) ÁªüËÆ° 
						if (state === '429-1' || state === '429-1-day' || state === '429-5'){ //Â§±Ë¥•Ôºå
							apidata.failcount ++; //Â§±Ë¥•Ê¨°Êï∞+1
							apidata.succrate = Math.round((apidata.succcount / (apidata.succcount + apidata.failcount)) * 10000) / 10000; // ÊàêÂäüÁéá
						}else if (state === '400'){ //Ê†áËÆ∞‰∏∫ÊàêÂäüÔºåË°®Á§∫ÊúâÊú∫‰ºö„ÄÇ *Âè¶Â§ñÔºåÂèëÁîü400ÈîôËØØÁöÑÊ¨°Êï∞ËæÉÂ∞ëÔºåÊ†áËÆ∞‰∏∫ÊàêÂäüÂΩ±Âìç‰∏çÂ§ß„ÄÇ
							apidata.succcount ++; //ÊàêÂäüÊ¨°Êï∞+1
							apidata.succrate = Math.round((apidata.succcount / (apidata.succcount + apidata.failcount)) * 10000) / 10000; // ÊàêÂäüÁéá
						}
						//‰∏∫‰∫Ü‰øùËØÅÊàêÂäüÁéáÁöÑÂáÜÁ°ÆÂ∫¶ÂíåÂÆûÊïàÊÄßÔºåËææÂà∞Êù°‰ª∂Â∞±ÂéãÁº©Ê¨°Êï∞ÔºåÁº©Â∞è5ÂÄçÔºåÂπ∂Âêë‰∏äÂèñÊï¥Êï∞
						if (apidata.succcount > 100 || apidata.failcount > 100) {
							apidata.succcount = Math.ceil(apidata.succcount / 5);
							apidata.failcount = Math.ceil(apidata.failcount / 5);
						}
						
						// 4) nexttime  *Áªü‰∏ÄÂä†20.5ÁßíÔºå‰πãÂâçÂàÜÂ§ö‰∏™Ê°£‰ºö‰∫ßÁîüÂæàÂ§öÈóÆÈ¢ò
						if( state === '429-1-day'){ //429-1-day: ÂÖçË¥πË¥¶Âè∑ËææÂà∞ÊØèÂ§©ÁöÑ‰∏äÈôêÂêéÔºåÊØè7ÂàÜ12ÁßíËé∑Âæó1Ê¨°ËØ∑Ê±ÇÊú∫‰ºö„ÄÇ‰∏çÂÖ∑‰ΩìÂàÜÊûêÔºåÂè™Êåâ7ÂàÜ12ÁßíÂä†
							apidata.nexttime = requesttime + 432000; //7m12s = 432s  432Áßí=432000ÊØ´Áßí
						}else if (state === '429-5'){ //tokensËØ∑Ê±ÇËøáÂø´(ÊØèÂàÜÈíü) 
							apidata.nexttime = requesttime;
						}else{
							if(apidata.date1 === 0){ //0‰∏™Êó∂Èó¥ËÆ∞ÂΩï
								apidata.nexttime = requesttime + 20500;
							}else if(apidata.date2 === 0){ //1‰∏™Êó∂Èó¥ËÆ∞ÂΩï
								if (state === '429-1'){ 
									apidata.nexttime = apidata.date1 + 20500; //‰∏çÂç†Áî®ËØ∑Ê±ÇÈ¢ùÂ∫¶Ôºå‰ªédate1ÂºÄÂßãËÆ°ÁÆó
									apidata.nexttime = apidata.nexttime < requesttime ? requesttime : apidata.nexttime; //ÂéüÂõ†ÔºöÂ§öÂª∂ÁÇπÊó∂Èó¥ÔºåÂêåÁ∫ßÂà´ÁöÑÂÖ∂‰ªñkeyÊâç‰ºöÊúâÊú∫‰ºöËΩÆÊç¢Âà∞
								}else{
									apidata.nexttime = requesttime + 20500;
								}
							}else if(apidata.date3 === 0){ //2‰∏™Êó∂Èó¥ËÆ∞ÂΩï
								if (state === '429-1'){
									apidata.nexttime = apidata.date2 + 20500;
									apidata.nexttime = apidata.nexttime < requesttime ? requesttime : apidata.nexttime;
								}else{
									apidata.nexttime = requesttime + 20500;
								}
							}else{
								apidata.nexttime = requesttime + 20500; 
							}
						}
						
						// 5) apiurl *ÊúÄÂêéÊàêÂäüÁöÑapiurl
						if (state === '400'){ //ÁÆóÊàêÂäü
							//8.20 ‰∏çÊõ¥Êñ∞ apidata.apiurl = this.apiURL.trim();
						}
					
					}else if(state === '429-other' || state === 'error-other' ){
					//ÂÖ∂‰ªñÊÉÖÂÜµ +20.5s
					//level: ‰øùÊåÅ‰∏çÂèò
					 	
						// 1) Level 
						if(apidata.level >= 1 && apidata.level <= 5){
							apidata.level = (apidata.level + 1) <= 5 ? (apidata.level + 1) : 5;
						}
						
						// 2) ÁªüËÆ° 
						apidata.failcount ++; //Â§±Ë¥•Ê¨°Êï∞+1
						apidata.succrate = Math.round((apidata.succcount / (apidata.succcount + apidata.failcount)) * 10000) / 10000; // ÊàêÂäüÁéá
							
						// 4) nexttime  
						apidata.nexttime = requesttime + 20500;
					}else if(state === '401'){
					// Êó†ÊïàÁöÑkeyÔºå401 
					// KeyÊòØÈöèÊú∫ÁîüÊàêÁöÑÔºå401 Êó†ÊïàÁöÑkeyÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ã‰∏çÂèØËÉΩ‰ºöÊÅ¢Â§çÂèØÁî®
					// level: 8
					
						// 1) Level 
						apidata.level = 8; 
						
						// 2) ÁªüËÆ° 
						apidata.failcount ++; //Â§±Ë¥•Ê¨°Êï∞+1
						apidata.succrate = Math.round((apidata.succcount / (apidata.succcount + apidata.failcount)) * 10000) / 10000; // ÊàêÂäüÁéá
						
						// 4) nexttime
						apidata.nexttime = requesttime; //ÂØπ‰∫élevel = 8 ÂÆûÈôÖ‰ΩúÁî®ÊòØËÆ∞ÂΩïÂ§±Ë¥•Êó∂Èó¥
					}		
	// end - Â∑≤ÁªèÂ≠òÂú®ÁöÑkey
	
				}else{
	// start - ‰∏çÂ≠òÂú®ÁöÑkey È™åËØÅ/Ê∑ªÂä†Êñ∞KeyÊó∂
	
					let level = null;
					let succcount = 0;
					let failcount = 0;
					let succrate = 0;
					let date1 = 0;
					let nexttime = 0;
					let apiurl = '';
					let vpn = ''; //*v8.05  ‚Äúvpn‚ÄùÊîπÁî®ÈÄîÔºåÊîπ‰∏∫Â≠òÂÇ®‚Äútag‚Äù „ÄÇ"vpn" has been repurposed to store "tag"
					let manuallyConfirm_isThirdParty = false; //ÊâãÂä®Ê†áËÆ∞ÁöÑÊÉÖÂÜµ
					
					if(state === 'success'){  //‰∏çÂ≠òÂú®ÁöÑkey Ê≠£Â∏∏‰∏ç‰ºöÂá∫Áé∞ÂèëÈÄÅÊàêÂäüÊÉÖÂÜµ
					//ÂèëÈÄÅÊàêÂäü
					//level: 0 1 2345
					
						// 1) Level 
						level = 1; //ÂÖàÊ†á‰∏∫1
												
						// 2) ÁªüËÆ° 
						succcount = 1; //ÊàêÂäüÊ¨°Êï∞
						succrate = Math.round((succcount / (succcount + failcount)) * 10000) / 10000; // ÊàêÂäüÁéá:1
						
						// 3) date1 &2 &3
						date1 = requesttime;
							
						// 4) nexttime
						nexttime = requesttime; 
						
						// 5) apiurl *ÊúÄÂêéÊàêÂäüÁöÑapiurl  ÊöÇÊó∂Ê≤°‰ªÄ‰πàÁî®ÔºåÂÖàÁïôÁùÄ
						apiurl = this.apiURL.trim();
												
						// 6) vpn = tag   *v8.05  ‚Äúvpn‚ÄùÊîπÁî®ÈÄîÔºåÊîπ‰∏∫Â≠òÂÇ®‚Äútag‚Äù „ÄÇ"vpn" has been repurposed to store "tag"
						if( !this.api.startsWith('sk-') || ( this.api.startsWith('sk-') && this.excludeList_ThirdPartyKeyStartWithSK_DomainKeyword.some(char => this.apiURL.toLowerCase().includes(char)) ) ){ //‰ºòÂÖàÊ†áËÆ∞ Á¨¨‰∏âÊñπKey Êó†ËÆ∫ÊòØÂê¶ÊîØÊåÅgpt-4
						//1)"‰∏çÂåÖÂê´sk-"  Êàñ  2)"ÂåÖÂê´sk-"&&"Â±û‰∫éÈùûOpenAIÂÆòÊñπÁöÑsk-"
							vpn = 'third-party';
						}else if( this.api.startsWith('sk-') && this.list_OnlyUseThirdPartyKey_DomainKeyword.some(char => this.apiURL.toLowerCase().includes(char)) ){
						//3) "ÂåÖÂê´sk-" && "Êú¨Êù•‰∏çÂ∫îËØ•ÊîØÊåÅsk-ÁöÑÁ¨¨‰∏âÊñπÔºàÁé∞Âú®Á´üÁÑ∂ËØ∑Ê±ÇÊàêÂäü‰∫ÜÔºåÂ±û‰∫éÊÑèÂ§ñÊÉÖÂÜµÔºâ"  *ÂºπÁ™óÔºåÈúÄË¶ÅÊâãÂä®Á°ÆËÆ§
							const notif_cn = 'Êú¨Ê¨°ÈúÄË¶ÅÊÇ®ÊâãÂä®Ê†áËÆ∞ÂΩìÂâç API Key ÊòØÂê¶Â±û‰∫é OpenAI ÂÆòÊñπKey„ÄÇ\r\n\r\nÁÇπÂáª [Á°ÆÂÆö (Â•Ω)] Â∞ÜÊ†áËÆ∞‰∏∫ OpenAI ÂÆòÊñπKeyÔºåÁÇπÂáª [ÂèñÊ∂à] Â∞ÜÊ†áËÆ∞‰∏∫Á¨¨‰∏âÊñπÊé•Âè£ÁöÑ‰∏ìÁî®KeyÔºåËØ∑ÈÄâÊã©...\r\n\r\nAPI Key: ' + this.api + '\r\nÊé•Âè£ÁΩëÂùÄ: ' + this.apiURL ;
							const notif_en = 'Please manually confirm if the current API Key belongs to OpenAI API Key this time. \r\n\r\nClick [Confirm (OK)] to mark it as OpenAI API Key, or click [Cancel] to mark it as a Third-party API Key. Please choose...\r\n\r\nAPI Key: ' + this.api + '\r\nAPI URL (Endpoint): ' + this.apiURL ;
							const notif_isThirdParty = this.settingsLanguage == 'cn' ? notif_cn : notif_en ;
							if (confirm(notif_isThirdParty)) {//ÂºπÁ™óËØ¢ÈóÆ ÊâãÂä®ÈÄâÊã© Ê†áËÆ∞sk-ÂºÄÂ§¥ÁöÑkeyÊòØÂÆòÊñπKeyËøòÊòØÁ¨¨‰∏âÊñπKey
								// ÂÆòÊñπ && Â±û‰∫égpt-4Ê®°Âûã
								if( this.apiGPTModel.includes('gpt-4') ){ 
									vpn = 'GPT-4';
									level = 0; //‰ªòË¥π
								}
							}else{
								vpn = 'third-party'; // Á¨¨‰∏âÊñπ
								manuallyConfirm_isThirdParty = true;
								this.isThirdPartyAPIKeyEnabled = true; //Ê≠§Êó∂È™åËØÅÊàêÂäüÔºå‰øÆÊ≠£this.isThirdPartyAPIKeyEnabled
							}
						}else if( this.apiGPTModel.includes('gpt-4') ){ // Â±û‰∫égpt-4Ê®°Âûã
							vpn = 'GPT-4';
							level = 0; //‰ªòË¥π
						}
					
					}else if(state === '429-2' || state === '404' ){ // v8.08  ÊéíÈô§404Ôºå‰∏çÊñ∞Â¢û
					//ÂèëÈÄÅÂ§±Ë¥• Êó†È¢ùÂ∫¶ || Ë¥¶Âè∑Êó†ÁªÑÁªáÊú∫ÊûÑ
					//level: 9 
						// 1) Level 
						level = 9; 
						
						// 2) ÁªüËÆ° 
						failcount = 1; //Â§±Ë¥•Ê¨°Êï∞
						succrate = Math.round((succcount / (succcount + failcount)) * 10000) / 10000; // ÊàêÂäüÁéá:0
												
						// 3) date1 &2 &3  ÈªòËÆ§0
						
						// 4) nexttime
						nexttime = requesttime; //ÂØπ‰∫élevel = 9 ÂÆûÈôÖ‰ΩúÁî®ÊòØËÆ∞ÂΩïÂ§±Ë¥•Êó∂Èó¥
						
						// 5) apiurl ÈªòËÆ§''
					
					}else if(state === '429-3' || state === '429-4' || state === '500' || state === '503'){
					//Ôºà‰∏çÂç†Áî®ËØ∑Ê±ÇÈ¢ùÂ∫¶ÔºâÂèØÁ´ãÂç≥ÈáçËØï
					//level: 0 1 2345 8  
						
						// 1) Level ÈªòËÆ§null  È´ò‰ºòÂÖàÁ∫ß
						// 2) ÁªüËÆ° ÈªòËÆ§0
						// 3) date1 &2 &3 ÈªòËÆ§0
						// 4) nexttime ÈªòËÆ§0  È´ò‰ºòÂÖàÁ∫ß
						// 5) apiurl ÈªòËÆ§''
					
					}else if(state === '429-1' || state === '429-1-day'  || state === '400' ){
					//Ôºà‰∏çÂç†Áî®ËØ∑Ê±ÇÈ¢ùÂ∫¶ÔºâËØ∑Ê±ÇËøáÂø´  || Ôºà‰∏çÂç†Áî®ËØ∑Ê±ÇÈ¢ùÂ∫¶ÔºâÂÖçË¥πË¥¶Âè∑ËææÂà∞ÊØèÂ§©ÁöÑËØ∑Ê±Ç‰∏äÈôê || ÔºàÂç†Áî®ËØ∑Ê±ÇÈ¢ùÂ∫¶ÔºâtokensË∂ÖÂá∫
					//level: 0 1 2345
						
						// 1) Level
						level = 1; //ÂÖàÊ†á‰∏∫1
						
						// 2) ÁªüËÆ° 
						if(state === '429-1' || state === '429-1-day'){
							failcount = 1; //Â§±Ë¥•Ê¨°Êï∞
							succrate = Math.round((succcount / (succcount + failcount)) * 10000) / 10000; // ÊàêÂäüÁéá:0
						}else if (state === '400'){
							succcount = 1; //ÊàêÂäüÊ¨°Êï∞
							succrate = Math.round((succcount / (succcount + failcount)) * 10000) / 10000; // ÊàêÂäüÁéá:1
						}
						
						// 3) date1 &2 &3 ÈªòËÆ§0
						
						// 4) nexttime
						if( state === '429-1-day'){ //429-1-day: ÂÖçË¥πË¥¶Âè∑ËææÂà∞ÊØèÂ§©ÁöÑ‰∏äÈôêÂêéÔºåÊØè7ÂàÜ12ÁßíËé∑Âæó1Ê¨°ËØ∑Ê±ÇÊú∫‰ºö„ÄÇ‰∏çÂÖ∑‰ΩìÂàÜÊûêÔºåÂè™Êåâ7ÂàÜ12ÁßíÂä†
							nexttime = requesttime + 432000; //7m12s = 432s  432Áßí=432000ÊØ´Áßí
						}else{
							nexttime = state === '400' ? requesttime : requesttime + 20500;
						}
						
						// 5) apiurl
						if (state === '400'){ //ÁÆóÊàêÂäü
							//8.20 ‰∏çÊõ¥Êñ∞ apiurl = this.apiURL.trim();
						}
					
					}else if(state === '429-other' || state === 'error-other' ){
					//+20s
					//level: ‰øùÊåÅ‰∏çÂèò
					//**Ê≠§Â§ÑÂèØËÉΩËÄÉËôëÊéíÈô§'error-other'ÔºåÂéüÂõ†ÔºöÈ™åËØÅÊñ∞ÁöÑkeyÊó∂ÔºåÂá∫ÈîôÔºåÈîôËØØ‰ª£Á†Å'error-other'ÂèØËÉΩÂåÖÂê´‰∏çÂ∫îËØ•Êñ∞Â¢ûkeyÁöÑÊÉÖÂÜµ„ÄÇÂΩìÁÑ∂ÔºåÊñ∞Â¢û‰∫ÜÈóÆÈ¢ò‰πü‰∏çÂ§ßÔºåÂè¶Â§ñÂèØ‰ª•ÊâãÂä®Âà†Èô§„ÄÇ
						
						// 1) Level ÈªòËÆ§null  È´ò‰ºòÂÖàÁ∫ß
						
						// 2) ÁªüËÆ° 
						failcount = 1; //Â§±Ë¥•Ê¨°Êï∞
						succrate = Math.round((succcount / (succcount + failcount)) * 10000) / 10000; // ÊàêÂäüÁéá:0
						
						// 3) date1 &2 &3 ÈªòËÆ§0
						
						// 4) nexttime
						nexttime = requesttime + 20500;
						
						// 5) apiurl ÈªòËÆ§''
					}else if(state === '401'){
					// Êó†ÊïàÁöÑkeyÔºå401 
					// KeyÊòØÈöèÊú∫ÁîüÊàêÁöÑÔºå401 Êó†ÊïàÁöÑkeyÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ã‰∏çÂèØËÉΩ‰ºöÊÅ¢Â§çÂèØÁî®
					// level: Êñ∞Â¢û‰∏çÊ∑ªÂä†401ÁöÑKey
						// ‰∏çÊ∑ªÂä†
					}	
					
					// 401 ‰∏ÄÂÆöË¶ÅÊéíÈô§Ôºå‰∏çÊ∑ªÂä†„ÄÇ
					// Â§áÂøòÂΩïÔºö429-2 ‰∏çËÉΩÊéíÈô§Ôºå429-2 ÊòØÂèØ‰ª•Áª≠Ë¥πÁöÑÔºå‰∏ç‰∏ÄÂÆöÊòØÂÖçË¥πË¥¶Âè∑ÔºåÂè¶Â§ñÔºåcatchApiErrorCode‰∏≠ 429-2 ‰ºöÊèêÈÜíÁî®Êà∑Â∑≤‰øùÂ≠òKeyÔºå‰ΩÜÊòØË∂ÖÈÖçÈ¢ù‰∫Ü„ÄÇ
					// v7.20 Â¢ûÂä†ÊéíÈô§2ÁßçÊÉÖÂÜµ:'404'„ÄÅ'error-other'„ÄÇÂâçÈù¢ÁöÑ‰ª£Á†ÅÊ≤°ÊúâÊéíÈô§(‰ª£Á†Å‰øùÁïô)Ôºå‰ªÖÂú®ËøôÈáåÊéíÈô§„ÄÇÂ¶ÇÊûú‰∏çÈúÄË¶ÅÊéíÈô§ÔºåÂà†Èô§Âà§Êñ≠Âç≥ÂèØ„ÄÇ *‰∏çÊéíÈô§‰πüË°åÔºå‰∏çÂΩ±ÂìçÂÆûÈôÖ‰ΩøÁî®

					// ‰ª•sk-ÂºÄÂ§¥ÁöÑkey(ÂÆòÊñπÁöÑ)   ||   3ÁßçÁ¨¨‰∏âÊñπÁöÑÊÉÖÂÜµÔºöÊâãÂä®Á°ÆËÆ§Á¨¨‰∏âÊñπKey + Á¨¨‰∏âÊñπKey(Èùûsk-ÂºÄÂ§¥) + ‰ª•sk-ÂºÄÂ§¥ÁöÑkey(ÈùûÂÆòÊñπÁöÑ)
					if(  ( this.api.startsWith('sk-') && !this.excludeList_ThirdPartyKeyStartWithSK_DomainKeyword.some(char => this.apiURL.toLowerCase().includes(char)) && state !== '401' && state !== '404' && state !== 'error-other' ) 
					    || (   (  manuallyConfirm_isThirdParty || !this.api.startsWith('sk-') || ( this.api.startsWith('sk-') && this.excludeList_ThirdPartyKeyStartWithSK_DomainKeyword.some(char => this.apiURL.toLowerCase().includes(char)) )  ) && state === 'success'   ) ){ 
					//ËØ¶Ôºö Â¶ÇÊûúÊòØOpenAI Key(sk-),4Áßç‰∏çÈúÄË¶ÅÊ∑ªÂä†API KeyÁöÑÊÉÖÂÜµÔºöÊó†ÊïàÁöÑKey && Êó†È¢ùÂ∫¶ && Ë¥¶Âè∑Êó†ÁªÑÁªáÊú∫ÊûÑ && Êú™Áü•Á±ªÂûãÁöÑÈîôËØØ„ÄÇ  
					//ËØ¶Ôºö || Â¶ÇÊûúÊòØÁ¨¨‰∏âÊñπKeyÔºåÂè™ÊúâstateÁ≠â‰∫ésuccessÊó∂ÊâçÊ∑ªÂä†„ÄÇ(Á¨¨‰∏âÊñπÊé•Âè£ÁöÑÁä∂ÊÄÅÁ†ÅÂêÑ‰∏çÁõ∏Âêå)
						this.apiCheckedData.push({
							"apikey": api_key, 
							"apiurl": apiurl,
							"date1": date1, 
							"date2": 0,
							"date3": 0,
							"nexttime": nexttime,
							"level": level,
							"freq": 0,
							"vpn": vpn,
							"owner": 'me',  
							"succcount": succcount,
							"failcount": failcount,
							"succrate": succrate,
							"updatetime": new Date().getTime()
						})
					}
					
				}
	// end - ‰∏çÂ≠òÂú®ÁöÑkey
	
	
				try{//ÊµãËØï
				//	console.log('updateApiCheckedData ÁªìÂ∞æ  - this.apiCheckedData ',this.apiCheckedData); 
				//	console.log('updateApiCheckedData ÁªìÂ∞æ  - apidata ',apidata);  
				//	console.log('updateApiCheckedData ÁªìÂ∞æ  - apidata date1 ',new Date(apidata.date1).toLocaleString()); 
				//	console.log('updateApiCheckedData ÁªìÂ∞æ  - apidata date2 ',new Date(apidata.date2).toLocaleString()); 
				//	console.log('updateApiCheckedData ÁªìÂ∞æ  - apidata date3 ',new Date(apidata.date3).toLocaleString()); 
				//	console.log('updateApiCheckedData ÁªìÂ∞æ  - apidata nexttime ',new Date(apidata.nexttime).toLocaleString()); 
				//	console.log('updateApiCheckedData ÁªìÂ∞æ  - apidata level ',apidata.level); 
				}catch(e){}

				
				//ÂÜçÊ¨°‰øùÂ≠ò Ëé∑ÂèñÊúÄÊñ∞API KeyÊï∞ÊçÆ
				this.saveApikeyData();
			},
			
			
			
			
			//ÊåâÈíÆÔºöÊü•ÁúãÁä∂ÊÄÅ
			showStatus(){
				let notif = '';
				const api_is_openai = this.apiURL.toLowerCase() === this.OpenAI_API_URL ? '<OpenAI> ' : '' ;
				const api_string = this.btnDisabledState_CheckAPI ? this.api : '' ;
				const tip_blue_16k = (!this.isSimpleMode && this.apiGPTModel.includes('gpt-3.5') && this.apiGPTModel.includes('16k')) ? ( this.settingsLanguage == 'cn' ? '<Ëìù> ' : '<Blue> ' ) : '' ;
				const tip_blue_totaltokens = (!this.isSimpleMode && this.apiGPTModel.includes('gpt-3.5') && this.totaltokens > 9999) ? ( this.settingsLanguage == 'cn' ? '<Ëìù> ' : '<Blue> ' ) : '' ;
				const tip_orangered_32k = ( !this.isSimpleMode && !this.apiGPTModel.includes('gpt-3.5') && !(this.apiGPTModel.includes('32k') || this.openSmartMaxTokens || this.apiMaxTokens > 3999 || this.totaltokens > 3999) ) ? ( this.settingsLanguage == 'cn' ? '<Ê©ô> ' : '<Orange> ' ) : '' ;
				const tip_red_32k = ( !this.isSimpleMode && !this.apiGPTModel.includes('gpt-3.5') && this.apiGPTModel.includes('32k') ) ? ( this.settingsLanguage == 'cn' ? '<Á∫¢> ' : '<Red> ' ) : '' ;
				const tip_red_SmartMaxTokens = ( !this.isSimpleMode && !this.apiGPTModel.includes('gpt-3.5') && this.openSmartMaxTokens ) ? ( this.settingsLanguage == 'cn' ? '<Á∫¢> ' : '<Red> ' ) : '' ;
				const tip_red_apiMaxTokens = ( !this.isSimpleMode && !this.apiGPTModel.includes('gpt-3.5') && this.apiMaxTokens > 3999 ) ? ( this.settingsLanguage == 'cn' ? '<Á∫¢> ' : '<Red> ' ) : '' ;
				const tip_red_totaltokens = ( !this.isSimpleMode && !this.apiGPTModel.includes('gpt-3.5') && this.totaltokens > 3999 ) ? ( this.settingsLanguage == 'cn' ? '<Á∫¢> ' : '<Red> ' ) : '' ;
							
				notif += this.settingsLanguage == 'cn' ? '‚ë† Ê®°Âûã :  ' + tip_blue_16k + tip_orangered_32k + tip_red_32k + this.apiGPTModel : '‚ë† Model :  ' + tip_blue_16k + tip_orangered_32k + tip_red_32k + this.apiGPTModel ;
				notif += this.settingsLanguage == 'cn' ? '\r\n‚ë° TokenÁî®Èáè :  ' + tip_blue_totaltokens + tip_red_totaltokens + this.totaltokens + ' tokens' : '\r\n‚ë° Tokens of context :  ' + tip_blue_totaltokens + tip_red_totaltokens + this.totaltokens + ' tokens';
				notif += this.settingsLanguage == 'cn' ? '\r\n‚ë¢ max_tokensÂèÇÊï∞ :  ' + tip_red_apiMaxTokens + this.apiMaxTokens : '\r\n‚ë¢ max_tokens (completion) :  ' + tip_red_apiMaxTokens + this.apiMaxTokens;
				notif += this.settingsLanguage == 'cn' ? '\r\n‚ë£ Êô∫ËÉΩmax_tokens :  ' + tip_red_SmartMaxTokens + (this.openSmartMaxTokens ? 'Â∑≤ÂêØÁî®' : 'Â∑≤ÂÖ≥Èó≠' ) : '\r\n‚ë£ Smart max_tokens :  ' + tip_red_SmartMaxTokens + (this.openSmartMaxTokens ? 'Enabled' : 'Disabled' );
				notif += this.settingsLanguage == 'cn' ? '\r\n‚ë§ APIÊé•Âè£ :  ' + api_is_openai + this.apiURL : '\r\n‚ë§ API URL :  ' + api_is_openai + this.apiURL;
				if(this.isThirdPartyAPIKeyEnabled){ //Á¨¨‰∏âÊñπ
					notif += this.settingsLanguage == 'cn' ? '\r\n‚ë• KeyÊ®°Âºè :  Á¨¨‰∏âÊñπÂçïKeyÊ®°Âºè (‰ΩøÁî®Á¨¨‰∏âÊñπ‰ª£ÁêÜ‰∏ìÁî®Key)' : '\r\n‚ë• Key Mode :  3rd party Key Mode (Use Third-party Key)';
					notif += this.settingsLanguage == 'cn' ? '\r\n‚ë¶ API Key :  ' + api_string : '\r\n‚ë¶ API Key:  ' + api_string;
				}else{ //OpenAI
					notif += this.settingsLanguage == 'cn' ? '\r\n‚ë• KeyÊ®°Âºè :  Ëá™Âä®ËΩÆÊç¢API Key (‰ΩøÁî®OpenAIÂÆòÊñπKey)' : '\r\n‚ë• Key Mode :  Auto Key Rotation (Use OpenAI API Keys)';
					notif += this.settingsLanguage == 'cn' ? '\r\n‚ë¶ API Key :  <‰∏äÊ¨°> ' + api_string : '\r\n‚ë¶ API Key :  <Last> ' + api_string;
				}
				notif += this.settingsLanguage == 'cn' ? '\r\n‚ëß Á≥ªÁªüÊèêÁ§∫ËØç :  ' + (this.gptSystemPromptReadOnly.trim() == '' ? 'Êó†' : 'Êúâ') : '\r\n‚ëß System Prompt :  ' + (this.gptSystemPromptReadOnly.trim() == '' ? 'No' : 'Yes') ;
				// 9 ÔºöËÆ∞ÂøÜÊ®°Âºè ‰∏ä‰∏ãÊñáÊ®°Âºè Contextual Mode
				let contextualModeStr = '';
				if(!Number.isInteger(this.settingsContextualMode)){
					contextualModeStr = ''
				}else if(this.settingsContextualMode === 0){
					contextualModeStr = this.settingsLanguage == 'cn' ? '‰∏çÈôêÂà∂' : 'No Limit' ;
				}else if(this.settingsContextualMode < 100){
					contextualModeStr = this.settingsLanguage == 'cn' ? '‰∏äÈôê ' + this.settingsContextualMode + ' Êù°' : 'Limit: ' + this.settingsContextualMode;
				}else if(this.settingsContextualMode > 100){
					contextualModeStr = this.settingsLanguage == 'cn' ? 'ÂßãÁªà‰øùÁïôÊúÄÂêé ' + (this.settingsContextualMode - 100) + ' Êù°' : 'Keep Last: ' + (this.settingsContextualMode - 100);
				}
				notif += this.settingsLanguage == 'cn' ? '\r\n‚ë® ËÆ∞ÂøÜÊ®°Âºè :  ' + contextualModeStr : '\r\n‚ë® Contextual Mode :  ' + contextualModeStr;
				
				const delaytime = this.isShowNotification ? 1900 : 0;
				const notif_title = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçÁä∂ÊÄÅ' : 'Current status' ;
				setTimeout(() => {
					this.showNotification(notif, 'center', notif_title);	
				}, delaytime);
			},
			//ÊåâÈíÆÔºöÊ∏ÖÈô§ËÆ∞ÂøÜ Ê∏ÖÁ©∫ËÆ∞ÂøÜ Clear context *ÂêåÊó∂Ê∏ÖÁ©∫ÂèëÈÄÅÂ§±Ë¥•ÁöÑmsg
			clearContext(){
				this.btnDisabledState_Clear = true;
				this.btnDisabledState_Undo= true;
				this.totaltokens = 0; //int
				this.msgContent = [this.msgContent[0]];
				this.msgTokens = [this.msgTokens[0]];
				this.succQA_Count = 0; //int
				this.msgContentForMsgList_SingleRound = [this.msgContentForMsgList_SingleRound[0]];//Ê∏ÖÈõ∂Ôºå‰ªÖËÆ∞ÂΩïÂçïËΩÆËÆ∞ÂøÜÁöÑÂéüÊñá
				this.userMsgTokensForRetry = 0; //Ê∏ÖÈõ∂
				const txt_lang1 = this.settingsLanguage == 'cn' ? '### #Ê∏ÖÁ©∫‰∏ä‰∏ãÊñáËÆ∞ÂøÜ\r\n\r\n' : '### #Clear Context\r\n\r\n' ;
				this.chathistory  += txt_lang1;
				this.add_hr_newRoundContext(false); //Ê∑ªÂä†ËÆ∞ÂøÜÂàÜÂâ≤Á∫ø
				
				//Êõ¥Êñ∞ ‰øùÂ≠ò ËÅäÂ§©Êï∞ÊçÆ chatData chatDataList
				//Êõ¥Êñ∞ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥
				this.updateChatLastTime(this.formatDateYYYYMMDDHHmmss(new Date(),':'));//ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥
			}, 
			//ÊåâÈíÆÔºöËØ¥Êòé Help
			openDialog_Help(){
				let notif =  '';
				let title = this.settingsLanguage == 'cn' ? 'MCGPT v8.28 - Â∏ÆÂä©' : 'MCGPT v8.28 - Help' ;
				let notifcn = 'MCGPT - A ChatGPT (GPT-3.5 / GPT-4) Webpage with Just a Single HTML File ';
				notifcn += '\r\n\r\nMCGPT ÔºåÂè™Êúâ‰∏Ä‰∏™ html Êñá‰ª∂ÁöÑ ChatGPT (GPT-3.5 / GPT-4) ËÅäÂ§©ÁΩëÈ°µ„ÄÇ‰∏ãËΩΩÂà∞ÁîµËÑëÂç≥ÂèØ‰ΩøÁî®ÔºåÂÉèÊâìÂºÄ‰∏ÄÂº†ÂõæÁâá‰∏ÄÊ†∑ÁÆÄÂçï„ÄÇÊîØÊåÅ‰∏ä‰º†Ëá≥ÊâÄÊúâÂÖçË¥πÁöÑÈùôÊÄÅÁΩëÈ°µÊâòÁÆ°Âπ≥Âè∞ÔºåÈùûÂ∏∏ÊµÅÁïÖ„ÄÇ  1) Êé•Âè£: Ëá™ÂÆö‰πâÊé•Âè£ÔºåÊîØÊåÅ OpenAI ÂÆòÊñπAPI ÂíåÁ¨¨‰∏âÊñπÂπ≥Âè∞API (Âèç‰ª£)„ÄÇ  2) Ê®°Âûã: ÊîØÊåÅÊúÄÊñ∞ÁöÑ GPT-3.5 Âíå GPT-4 Ê®°Âûã„ÄÇ  3) ÂØÜÈí•: ÊîØÊåÅ OpenAI ÂÆòÊñπKey ÂíåÁ¨¨‰∏âÊñπÂπ≥Âè∞‰∏ìÁî®KeyÔºåÊîØÊåÅËΩÆËØ¢„ÄÇ  4) Êï∞ÊçÆÂÆâÂÖ®: Êï∞ÊçÆ‰ªÖÂ≠òÂÇ®Âú®ÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®‰∏≠ÔºåÊîØÊåÅÂØºÂá∫„ÄÅÂØºÂÖ•„ÄÅÂà†Èô§„ÄÇ‰ª£Á†ÅÂºÄÊ∫êÔºåÂÆâÂÖ®Êó†È£éÈô©„ÄÇ\r\n\r\n#ÂºÄÂßã‰ΩøÁî®\r\nÂ°´ÂÖ• API Key ÊàñÊâπÈáèÊ∑ªÂä†ÂêéÂç≥ÂèØÂºÄÂßãËÅäÂ§©„ÄÇ';
				notifcn += '\r\n\r\n#ÂØπËØù\r\n  ‚Ä¢ ÂäüËÉΩ: Â§öÂØπËØùÁÆ°ÁêÜ„ÄÅÂÖ®Ëá™Âä®‰øùÂ≠ò„ÄÅÊîØÊåÅÂàõÂª∫ÂâØÊú¨„ÄÅÂ§öÊ†áÁ≠æÈ°µÊï∞ÊçÆÂêåÊ≠•„ÄÅÂèØÂØºÂá∫ (Â§á‰ªΩ/ËøÅÁßª/ÂàÜ‰∫´)„ÄÅÂèØÂØºÂÖ• (ËøòÂéüÂØπËØù)„ÄÇ \r\n  ‚Ä¢ ËÅäÂ§©: 1) ÂÖ®Ëá™Âä®Êô∫ËÉΩË∞ÉËäÇ max_tokens„ÄÇ 2) ÊîØÊåÅËá™Âä®ÈáçÈóÆ (ÂèëÈÄÅÂ§±Ë¥•Êó∂Êô∫ËÉΩÂà§Êñ≠ÊòØÂê¶ÈáçËØï)„ÄÇ 3) ÊîØÊåÅ MarkdownÔºåÊñπÊ≥ï‰∏éÂÆòÁΩëÁõ∏Âêå„ÄÇ*ÂΩì GPT ÂõûÂ§çÊú™‰ΩøÁî® Markdown ËØ≠Ê≥ïÊó∂ÔºåÂèØË¶ÅÊ±ÇÂÖ∂‰ΩøÁî® Markdown Ê†ºÂºèÂõûÂ§çÔºà‰∏ªË¶ÅÂ∫îÁî®‰∫é‰ª£Á†Å„ÄÅË°®Ê†º„ÄÅÊñáÁ´†ÊéíÁâà„ÄÅÊòæÁ§∫ÁΩëÁªúÂõæÁâáÁ≠âÔºâ„ÄÇ 4) iPhone / iPad ‰∏≠ÔºåÊêúÁãóËæìÂÖ•Ê≥ïÂú®Êç¢Ë°åÊó∂ÂèØËÉΩÂ≠òÂú®ÂÖºÂÆπÊÄßÈóÆÈ¢ò„ÄÇ 5) ÁîµËÑëÁ´ØÊîØÊåÅ Shift + Enter „ÄÅCtrl + Enter „ÄÅCommand(‚åò) + Enter Êç¢Ë°å„ÄÇ 6) Â¶ÇÊûúÊÉ≥‰∏≠Êñ≠Ê≠£Âú®ÂèëÈÄÅÁöÑËØ∑Ê±ÇÔºåÂèØÈÄöËøáÂà∑Êñ∞ÁΩëÈ°µÊù•ÂÆûÁé∞„ÄÇ';
				notifcn += '\r\n\r\n#ÊèêÁ§∫ËØçÁ™óÂè£\r\nÊà™Ê≠¢ v8.28 ÁâàÊú¨ÔºåÊöÇÊó∂Âè™ÊúâËÆæÁΩÆÁ≥ªÁªüÊèêÁ§∫ËØçÁöÑÂäüËÉΩÔºåÂèØÂú®ÊèêÁ§∫ËØçÁ™óÂè£‰∏≠ÁÇπÂáªËìùËâ≤Â∞èÈóÆÂè∑ [?] ‰∫ÜËß£Êõ¥Â§ö„ÄÇ\r\n\r\n#ËÆæÁΩÆÁ™óÂè£\r\nÂ∏∏ËßÑËÆæÁΩÆ„ÄÅËÆ∞ÂøÜÊ®°Âºè (‰∏ä‰∏ãÊñáÊ®°Âºè)„ÄÅ API ËÆæÁΩÆ„ÄÅÊü•ËØ¢ API ‰ΩôÈ¢ùÂíåÊúâÊïàÊúü„ÄÅ API ‰∏ì‰∏öËÆæÁΩÆ„ÄÅ‰∏ä‰º†Â§¥ÂÉè„ÄÅÂØºÂá∫Á∫ØÊñáÊú¨ËÅäÂ§©ËÆ∞ÂΩï„ÄÅÊú¨Âú∞Êï∞ÊçÆÁÆ°ÁêÜÁ≠âÔºåÂèØÂú®ËÆæÁΩÆÁ™óÂè£‰∏≠ÁÇπÂáªËìùËâ≤Â∞èÈóÆÂè∑ [?] ‰∫ÜËß£Êõ¥Â§ö„ÄÇ';
				notifcn += '\r\n\r\n#ÂÖ∂‰ªñ\r\n  ‚Ä¢ [Ê∏ÖÈô§ËÆ∞ÂøÜ] ÊåâÈíÆÈ¢úËâ≤: Â¶ÇÊûúÂΩìÂâçÂØπËØùÁöÑ [ËÆ∞ÂøÜÊ®°Âºè] ËÆæÁΩÆ‰∫Ü‰∏äÈôêÔºåÈÇ£‰πàÂΩìËÆ∞ÂøÜ (‰∏ä‰∏ãÊñá) Êé•Ëøë‰∏äÈôêÊó∂ÔºåÈ¢úËâ≤‰ºöÂèò‰∏∫Ê©òÁ∫¢Ëâ≤ÔºåÂΩìËÆ∞ÂøÜËææÂà∞‰∏äÈôêÊó∂Ôºå‰ºöÂèò‰∏∫Á∫¢Ëâ≤ (È¢úËâ≤ÂèòÂåñÂè™ÊòØÊèêÈÜí‰ΩúÁî®ÔºåÊó†ÈúÄÁî®Êà∑Êìç‰Ωú)„ÄÇ';
				notifcn += '\r\n  ‚Ä¢ [TokenÁî®Èáè] ÊñáÂ≠óÈ¢úËâ≤: 1) ÂΩì‰∏ä‰∏ãÊñá tokens Â∑≤ËææÂà∞ 2000 ÔºåÈ¢úËâ≤‰∏∫Ê©òÁ∫¢Ëâ≤„ÄÇ2) ËææÂà∞ÂΩìÂâçÊ®°Âûãtokens‰∏äÈôêÁöÑ 90% Êó∂ÔºåÈ¢úËâ≤Âèò‰∏∫Á∫¢Ëâ≤Âπ∂Âä†Á≤ó„ÄÇ';
				notifcn += '\r\n  ‚Ä¢ [Áä∂ÊÄÅ] ÊåâÈíÆÈ¢úËâ≤: ÈÄöËøáÈ¢úËâ≤Âå∫ÂàÜ‰∏çÂêåÊ®°Âûã‰∏é‰∏çÂêåËÆæÁΩÆÁöÑË¥πÁî®Â∑ÆÂºÇ„ÄÇ1) gpt-3.5 Ê®°ÂûãÔºåÊåâÈíÆ‰∏∫ÁªøËâ≤„ÄÇÈÄâ 16k ÁâàÊú¨Êó∂ÔºåÈ¢úËâ≤‰ºöÂèò‰∏∫ËìùËâ≤„ÄÇ 2) gpt-4 Ê®°ÂûãÔºåÊåâÈíÆ‰∏∫Ê©òÁ∫¢Ëâ≤„ÄÇÂΩìÊª°Ë∂≥‰ª•‰∏ã‰ªª‰∏ÄÊù°‰ª∂Êó∂ÔºåÈ¢úËâ≤‰ºöÂèò‰∏∫Á∫¢Ëâ≤ÔºöÈÄâÁî® 32k ÁâàÊú¨ / ÂºÄÂêØ"smart max_tokens" / max_tokens ÂèÇÊï∞ÁöÑËÆæÁΩÆÈ´ò‰∫é4000 / ‰∏ä‰∏ãÊñá tokens Â∑≤ËææÂà∞4000 „ÄÇ';
				//ÊúâÂçïÂºïÂè∑
				let notifen = "MCGPT - A ChatGPT (GPT-3.5 / GPT-4) Webpage with Just a Single HTML File \r\n\r\nMCGPT is a lightweight single-page chat application that can be deployed statically, with no need for a server. It can be uploaded to any static website hosting platform like GitHub and provides a very smooth browsing experience.  1) API: Supports OpenAI API and third-party API (reverse proxy). 2) Model: Supports the latest GPT-3.5 and GPT-4 models. 3) API Key: Supports both OpenAI API Key and third-party proxy website keys. Supports fully automatic intelligent rotation of API keys. 4) User Data Security: Supports browser local storage. All data is stored solely in the browser cache and supports export, import, and deletion. ";
				notifen += "\r\n\r\n#Getting Started \r\nEnter API Key or add them in bulk, and start chatting. ";
				notifen += '\r\n\r\n#Chat\r\n  ‚Ä¢ Features: Multiple chat management, automatic saving, support for creating copies, data synchronization across multiple tab pages, export capability (backup/migration/sharing), import capability (restore chats). \r\n  ‚Ä¢ Chatting:  1) Fully automatic intelligent adjustment of max_tokens.  2) Supports automatic retry (intelligently determines whether to retry when a request fails).  3) Markdown is supported, same as the official website. *When GPT replies without using Markdown syntax, you can ask it to reply in Markdown format (mainly used for code, tables, article formatting, displaying web images, etc.).  4) Line Breaks on Computer: Supports Shift + Enter, Ctrl + Enter line breaks, and Mac also support Command(‚åò) + Enter line breaks.  5) There is no stop request function. If you want to interrupt a request that is being sent, you can do so by refreshing the web page.';
				notifen += "\r\n\r\n#Prompt Generator \r\nv8.28, only the function of setting system prompt is available. Click the blue question mark [?] in the prompt generator window to learn more. \r\n\r\n#Settings \r\nFeatures: General settings, Contextual Mode, API settings, checking API balance and validity period, API professional settings, uploading avatars, exporting chat history as plain text, local data management, etc. Learn more by clicking the blue question mark [?] in the settings window.";
				notifen += "\r\n\r\n#Other\r\n  ‚Ä¢ [Clear Context] Button Color: If the [Contextual Mode] of the current chat has set a limit, the color will turn orange-red when the context is approaching the limit, and turn red when the context reaches the limit (the color change is only a reminder and does not require user action).";
				notifen += "\r\n  ‚Ä¢ [Tokens Usage] Text Color:  1) When the context tokens reach 2000, the color will turn orange-red. 2) When the token usage reaches 90% of the current model's limit, the color will turn red and bold.";
				notifen += '\r\n  ‚Ä¢ [Status] Button Color:  By using different colors, distinguish cost variations based on different models and settings.  1) For the gpt-3.5 model, the button color is green. When selecting the 16k version, the color will turn blue. 2) For the gpt-4 model, the button color is orange-red. It will turn red when any of the following conditions are met: selecting the 32k version, enabling "smart max_tokens", setting the max_tokens parameter above 4000, or reaching 4000 context tokens.';
				
				notif = this.settingsLanguage == 'cn' ? notifcn : notifen ;
				this.showNotification(notif, 'center', title);		
			}, 
			//Ê∑ªÂä†ËÆ∞ÂøÜÂàÜÂâ≤Á∫ø Add <hr> for a new round of context.
			add_hr_newRoundContext(isUndo){
				let lastInfoElem;
				let infoElems; // class = "aiinfo" or "userinfo"

				//ÁïåÈù¢‰∏äËá≥Â∞ëÂ≠òÂú®3Êù°ËÆ∞ÂΩïÔºàÂç≥Ê¨¢ËøéËØ≠ + ‰∏ÄÊ¨°ÈóÆÁ≠îÔºâÔºåÊâçÂèØËÉΩÊ∑ªÂä†ÂàÜÂâ≤Á∫ø
				if (this.msgList.length > 2 ){
					//Âà§Êñ≠ÊúÄÂêé‰∏ÄÊù°ËÆ∞ÂΩïÂ±û‰∫éÂì™Ëæπ
					if(this.msgList[this.msgList.length - 1]["my"]){
						infoElems = document.querySelectorAll('.userinfo'); // Ëé∑Âèñclass=userinfo
					}else{
						infoElems = document.querySelectorAll('.aiinfo'); // Ëé∑Âèñclass=aiinfo
					}
		
					if(isUndo){
						//ÂΩìÂâçÊìç‰ΩúÊòØÔºöÊí§ÈîÄ Undo
						// Âè™ÊúâÂçïËΩÆËÆ∞ÂøÜ‰∏∫0 ÔºåÂêåÊó∂‰∏çÂ≠òÂú®ÂèëÈÄÅÂ§±Ë¥•ËÆ∞ÂΩïÊó∂ÔºåÊâçËÉΩÊ∑ªÂä†Ê®™Á∫ø<hr>, Âê¶Âàô‰∏çÊ∑ªÂä†
						if (this.msgContentForMsgList_SingleRound.length > 1 ){ //ËÆ∞ÂøÜ‰∏ç‰∏∫0
							return;
						}
					}else{
						//ÂΩìÂâçÊìç‰ΩúÊòØÔºöÊ∏ÖÈô§ËÆ∞ÂøÜ Ê∏ÖÁ©∫‰∏ä‰∏ãÊñá Clear context
						// Do nothing.
					}

					// Ëé∑ÂèñÊúÄÂêé‰∏Ä‰∏™info„ÄÇ  psÔºöÂ¶ÇÊûúÊòØÊí§ÈîÄÔºåclass‰∏ÄÂÆöÊòØaiinfo„ÄÇÂ¶ÇÊûúÊòØÊ∏ÖÈô§ËÆ∞ÂøÜÔºåclassÊúâ‰∏§ÁßçÂèØËÉΩ„ÄÇ
					lastInfoElem = infoElems[infoElems.length - 1];
						
					// Â¶ÇÊûúÂΩìÂâç‰∏çÂ≠òÂú®Êúâ<hr>ÂàÜÂâ≤Á∫øÔºåÊâçÂÖÅËÆ∏Ê∑ªÂä†ÔºåÈÅøÂÖçÈáçÂ§çÊ∑ªÂä†
					// aiinfo/userinfoÊòØÂ≠êÂÖÉÁ¥†ÔºåÈúÄË¶ÅÊìç‰ΩúÁöÑÊòØÂÖ∂Áà∂ÂÖÉÁ¥†<div>„ÄÇ <div>‰∏é<hr>Â±û‰∫éÂêå‰∏ÄÂ±ÇÁ∫ß
					if (lastInfoElem.parentElement.nextElementSibling.tagName != 'HR') {
						//Âú®this.msgList‰∏≠ËÆ∞ÂΩïÂàÜÂâ≤Á∫øÔºåÊÅ¢Â§çÊï∞ÊçÆÊó∂ÈúÄË¶ÅÁî®
						this.msgList[this.msgList.length - 1]["hr"] = true;
						//ÂºÄÂßãÊ∑ªÂä†ÂàÜÂâ≤Á∫ø
						let newHr = document.createElement('hr');
						newHr.classList.add('newcontext-hr');
						newHr.style.marginBottom = this.settingsTime_WechatStyle ? '20px' : '33px'; //ÂΩìÂâçÊòØÂê¶Â≠òÂú®ÂæÆ‰ø°Ê†∑ÂºèÊó∂Èó¥
						newHr.style.display = this.settingsDividerLine ? 'block' : 'none'; //ÊòØÂê¶ÊòæÁ§∫ÂàÜÂâ≤Á∫ø
						lastInfoElem.parentElement.insertAdjacentElement('afterend', newHr);
						this.scrollToBottomView(); //Ê∑ªÂä†ÂêéÔºåÊªöÂä®Âà∞ÊúÄ‰∏ãÊñπ
					}
						
					let txt_lang1 = this.settingsLanguage == 'cn' ? '#### #Êó†ËÆ∞ÂøÜÁä∂ÊÄÅÔºåÊñ∞ÂØπËØùÂºÄÂßã\r\n***\r\n\r\n' : '#### #The context was emptied. New Chat begins.\r\n***\r\n\r\n' ;  //changeSelectedChatListMoreOptions(chatdata)‰∏≠ÊúâÁî®Âà∞Ôºå‰øÆÊîπÈúÄË¶ÅÂêåÊ≠•
					this.chathistory  += (txt_lang1); 
						
					//ÈöêÂΩ¢ÊèêÁ§∫ËØç Â¶ÇÊûúÂú®‰ª£Á†Å‰∏≠ÂÜô‰∫ÜgptSystemPrompt_hiddenÈöêËóèÊèêÁ§∫ËØçÔºåÂàô‰∏çÂÜôÂÖ•ÊèêÁ§∫ËØç„ÄÇ
					if(this.gptSystemPrompt_hidden.trim() != ''){
						// this.chathistory  += 
					} else {
						this.addSystemPromptToChatHistory('#### #ÂΩìÂâçÁ≥ªÁªüÊèêÁ§∫ËØç system prompt ', '#### #Current System Prompt ' ); //this.chathistory
					}
						
				}
			}, 
			//ÊÅ¢Â§çÂØπËØùÊï∞ÊçÆÊó∂ÔºåÊ∑ªÂä†ÊâÄÊúâÁöÑËÆ∞ÂøÜÂàÜÂâ≤Á∫ø When restoring Chat Data, add all <hr>
			add_hr_For_ChatDataRestored(){
				// Ëé∑ÂèñÊâÄÊúâclassÁ≠â‰∫émsgdatetimedivÁöÑ<div>ÂÖÉÁ¥†
				const datetimeDIV = document.querySelectorAll('div.msgdatetimediv');

				// ÈÅçÂéÜ<div>ÂÖÉÁ¥†
				datetimeDIV.forEach(timediv => {
					// Ëé∑Âèñdata-hrÂ±ûÊÄßÁöÑÂÄº
					const hrValue = timediv.getAttribute('data-hr');
					// Â∞ÜÂ≠óÁ¨¶‰∏≤Á±ªÂûãÁöÑÂ∏ÉÂ∞îÂÄºËΩ¨Êç¢ÊàêÁúüÊ≠£ÁöÑÂ∏ÉÂ∞îÂÄº
					if (hrValue === 'true'){
						let newHr = document.createElement('hr');
						newHr.classList.add('newcontext-hr');
						newHr.style.marginBottom = this.settingsTime_WechatStyle ? '20px' : '33px'; //ÂΩìÂâçÊòØÂê¶Â≠òÂú®ÂæÆ‰ø°Ê†∑ÂºèÊó∂Èó¥
						newHr.style.display = this.settingsDividerLine ? 'block' : 'none'; //ÊòØÂê¶ÊòæÁ§∫ÂàÜÂâ≤Á∫ø
						timediv.parentElement.insertAdjacentElement('afterend', newHr);
					}
				});
			
			},
			
			//ÊåâÈíÆÔºöÊí§ÈîÄ Undo
			undo(){
			
				this.scrollToBottomView();
				//v5,11 ‰øÆÂ§çÈÄªËæëÈîôËØØ„ÄÅbug„ÄÇÂÖ®Êñ∞ÈÄªËæëÔºåÊ∂âÂèäÔºöÊí§ÈîÄ+ÈáçÈóÆ+ÂèëÈÄÅÂ§±Ë¥•+TokensÁ≠â„ÄÇ  v5,11 Fix bugs. Fix logic errors. Brand new logic. Regarding: undo, retry, send failed, tokens...
				if (this.msgContentForMsgList_SingleRound.length > 1){
					const txt_lang1 = this.settingsLanguage == 'cn' ? '### #Êí§ÈîÄ\r\n\r\n' : '### #Undo\r\n\r\n';
					this.chathistory  += (txt_lang1);
					this.userMsgTokensForRetry = 0; //Ê∏ÖÈõ∂
					
					let templastmsgHtml = this.msgList.pop(); //HTML
					this.msgContentForMsgList_SingleRound.pop(); 
					
					// 'my'ÔºöÊúÄÂêé‰∏ÄÊù°‰∏∫userÔºå‰∏ÄÂÆöÊòØÂèëÈÄÅÂ§±Ë¥•ÁöÑmsg„ÄÇmsgContentÂíåmsgTokens‰∏ç‰ºöÂåÖÂê´Â§±Ë¥•ÁöÑmsgÔºåÊó†ÈúÄÂ§ÑÁêÜ„ÄÇmsgListÂíåmsgContentForMsgList_SingleRound ÂàöÂàöpop()ËøáÔºåÂêåÊ†∑Êó†ÈúÄÂ§ÑÁêÜ„ÄÇ
					//If the last msg is 'my', it must be a failed message. msgContent and msgTokens do not contain failed msg, so there is no need to handle them.  msgList and msgContentForMsgList_SingleRound have already been deleted and do not need to be processed again.
				
					// GPT / AI
					if (!templastmsgHtml['my']){
						//Â§ÑÁêÜmsgContentÂíåmsgTokens‰∏≠ÁöÑAI msg
						this.msgContent.pop(); 
						this.msgTokens.pop();
						//Â§ÑÁêÜuser msg
						this.msgList.pop();
						this.msgContentForMsgList_SingleRound.pop(); 
						this.msgContent.pop(); 
						this.msgTokens.pop();
						
						this.succQA_Count = this.msgContent.length - 1; //int. Êõ¥Êñ∞
					}
					
					if (this.msgContentForMsgList_SingleRound.length < 2){
						//msgContentForMsgList_SingleRound.length == 1 ( msgList.length== 1)Êó∂ÔºåÊí§ÈîÄ&ÈáçÈóÆÊåâÈíÆ-‰∏çÂèØÁî®ÔºåÊ∏ÖÈô§ËÆ∞ÂøÜÊåâÈíÆ-‰∏çÂèØÁî®
					  	this.btnDisabledState_Undo = true;
						this.btnDisabledState_Clear = true;
						if ( this.sentext == 'ËØ∑ÈáçÂèë'|| this.sentext == 'Please Retry'  ) {
							this.sentext = this.settingsLanguage == 'cn' ? 'ÂèëÈÄÅ' : 'Send';
						}
					}else if (this.msgContent.length < 2){
						//Âè™Ë¶ÅÊú¨ËΩÆËÆ∞ÂøÜÁïåÈù¢‰∏äËøòÂ≠òÂú®Êúâmsg(ÂåÖÂê´Â§±Ë¥•ÁöÑmsg)ÔºåÊí§ÈîÄ&ÈáçÈóÆ Â∞±‰øùÊåÅÂèØÁî®Áä∂ÊÄÅ
						//‰ΩÜËÆ∞ÂøÜÂèØËÉΩÊèêÂâç‰∏∫Á©∫ msgContent.length == 1ÔºåÊ≠§Êó∂Ê∏ÖÈô§ËÆ∞ÂøÜÊåâÈíÆ‰∏çÂèØÁî®„ÄÇÂç≥ÔºåÂè™Ââ©ÊúâÂ§±Ë¥•ÁöÑmsgÊó∂ÔºåÊ∏ÖÈô§ËÆ∞ÂøÜÊåâÈíÆ‰∏çÂèØÁî®„ÄÇ
						this.btnDisabledState_Clear = true;
						this.btnDisabledState_Undo = false; //‰øùÊåÅÂèØÁî®
					}
					
					// length-1 ÊòØÊúÄÂêé‰∏ÄÊù°AIÂõûÂ§çÁöÑÊï∞ÊçÆ(Êó†ËÆ∫ÈöîÁùÄÂ§öÂ∞ëÊù°ÂèëÈÄÅÂ§±Ë¥•ÁöÑËÆ∞ÂΩï)ÔºåÊàñÊòØmsgTokens[0]ÁöÑÊï∞ÊçÆ(Êó†ËÆ∞ÂøÜ)
					this.totaltokens = this.msgTokens[this.msgTokens.length - 1]["total_tokens"]; // int
					
					this.$nextTick(() => {
						this.add_hr_newRoundContext(true); //Ê∑ªÂä†ËÆ∞ÂøÜÂàÜÂâ≤Á∫ø
					});
					
					//Êõ¥Êñ∞ ‰øùÂ≠ò ËÅäÂ§©Êï∞ÊçÆ chatData chatDataList
					//Êõ¥Êñ∞ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥
					this.updateChatLastTime(this.formatDateYYYYMMDDHHmmss(new Date(),':'));//ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥
					
					if (this.msgContent.length == 0  || this.msgContentForMsgList_SingleRound.length == 0){
						console.error("undo(). length == 0. [Undo] ÊÑèÂ§ñÈîôËØØ Error bug");
					}
				}
				else{
					//err  If the code has reached here, it means there is an error.
					console.error("undo(). length <= 1 && Undo is available. [Retry] ÊÑèÂ§ñÈîôËØØ Error bug");
					this.btnDisabledState_Undo = true;
					this.btnDisabledState_Clear = true;
				}
	  		},   
			//ÊåâÈíÆÔºöÈáçÈóÆ Retry *Undo and resend
			retry(){
				if(this.isTotaltokens_Exceeds_Maxtokens()){
					return;//ÂΩìÂâçtotaltokens Â∑≤ÁªèË∂ÖËøáÊ®°ÂûãÁöÑÊúÄÂ§ßmax_tokensÊï∞, ÂºπÁ™óË≠¶Âëä + ËøîÂõû
				}
				
				// check_KeyMode_byURL_ChangeKey ÂàùÊ≠•‰øÆÊ≠£KeyÊ®°Âºè„ÄÇ *‰øÆÊ≠£ÂêéÔºågetFirstAvailableAPIKeyÊâç‰ºöÂáÜÁ°Æ„ÄÇ
				if ( !this.check_KeyMode_Sending()){
					return;
				}
				
				try{  //‰∏ä‰∏ãÊñáÊ®°Âºè  Contextual Mode
					const returned_str = this.sendMsg_ContextualMode("retry");
					if( typeof returned_str !== 'string'){
						//nothing
					}else if( returned_str === 'no clear context and abort operation'){ // ËÆ∞ÂøÜÊ®°ÂºèÔºöËÆ∞ÂøÜ‰∏äÈôê / Limit  *‰∏≠Ê≠¢Êìç‰Ωú
						const notif =  this.settingsLanguage == 'cn' ?  'Â∑≤‰∏≠Ê≠¢[ÈáçÈóÆ]' : 'Aborted [Retry]';
						this.showNotification(notif, 'bottom', '', 1800);
						return;
					}else if( returned_str === 'clear context and cancel retry'){ // ËÆ∞ÂøÜÊ®°ÂºèÔºöËÆ∞ÂøÜ‰∏äÈôê / Limit  *ÈáçÈóÆ‰∏ìÂ±û  *Ê∏ÖÈô§ËÆ∞ÂøÜ(clear context) and ÂèñÊ∂àÈáçÈóÆ
						const notif =  this.settingsLanguage == 'cn' ?  'Â∑≤Ê∏ÖÈô§ËÆ∞ÂøÜÔºåÂπ∂ÂèñÊ∂à‰∫Ü [ÈáçÈóÆ]' : 'Context cleared and [Retry] canceled';
						this.showNotification(notif, 'bottom', '', 3100);
						return;
					}
					
				}catch(e){
					console.error('sendMsg_ContextualMode("retry") - ÈáçÈóÆËøáÁ®ã‰∏≠Ôºå"‰∏ä‰∏ãÊñáÊ®°Âºè"ÊâßË°åÊó∂Âá∫Èîô‰∫Ü',e);
				}
				
				
				
				this.isRetry_RetryMessage = ''; //ÂÖàÈáçÁΩÆ
				
				//v5,11 ‰øÆÂ§çÈÄªËæëÈîôËØØ„ÄÅbug„ÄÇÂÖ®Êñ∞ÈÄªËæëÔºåÊ∂âÂèäÔºöÊí§ÈîÄ+ÈáçÈóÆ+ÂèëÈÄÅÂ§±Ë¥•+TokensÁ≠â„ÄÇ  v5,11 Fix bugs. Fix logic errors. Brand new logic. Regarding: undo, retry, send failed, tokens...
				if (this.msgContentForMsgList_SingleRound.length > 1){
					const txt_lang1 = this.settingsLanguage == 'cn' ? '### #ÈáçÈóÆ\r\n\r\n' : '### #Retry\r\n\r\n';
					this.chathistory  += (txt_lang1);
					let templastmsgHtml = this.msgList.pop(); //HTML. last msg - AI or ME/my/user
					let templastmsgContent = this.msgContentForMsgList_SingleRound.pop(); 
					let totaltokens_temp = 0;
					
					if (!templastmsgHtml['my']){
						//templastmsgHtml is AI, then...
							this.msgContent.pop(); //Context. del last msg - AI
							this.msgTokens.pop(); //msgTokens. del last msg - AI
							this.msgList.pop(); //HTML. del ME
							this.msgContentForMsgList_SingleRound.pop(); //msgContentForMsgList_SingleRound
							templastmsgContent = this.msgContent.pop(); //Context. del last msg - Me
							this.succQA_Count = this.msgContent.length - 1; //int. Êõ¥Êñ∞
							
							//user. Âú®msgTokens.pop()ÂâçÔºåÂÖàËé∑ÂèñuserÁöÑtokenÊÄªÊï∞„ÄÇÊ≠§Êó∂totaltokens‰∏ÄÂÆö‰∏çÁ≠â‰∫é0
							//Â∑≤Ëé∑ÂæóAIÂõûÂ§çËøáÁöÑÈáçÈóÆÔºåtokensÊÄªÊï∞ÂåÖÂê´ÊèêÈóÆÁöÑÂÜÖÂÆπÔºàÂ¶ÇÊûúÊåá‰ª§Ê≤°ÊúâÊîπÂä®ÁöÑËØùÊòØÂáÜÁ°ÆÁöÑÔºåÊåá‰ª§ÊîπÂä®ËøáÂ∞±‰∏çÂáÜÔºâ
							totaltokens_temp = this.msgTokens[this.msgTokens.length - 1]["total_tokens"];  // int
							this.userMsgTokensForRetry = totaltokens_temp; //‰∏¥Êó∂ËÆ∞ÂΩïtokens„ÄÇÊú¨Ê¨°ÈáçÈóÆÂ§±Ë¥•ÂêéÔºåÂÜçÊ¨°ÈáçÈóÆÊó∂‰ºöÁî®Âà∞
							this.msgTokens.pop(); //msgTokens. del last msg - Me
							if(this.msgContent.length == 0 || this.msgTokens.length == 0){ alert(" ÊâæÂà∞‰∏Ä‰∏™bug\r\nA new bug has appeared.\r\n\r\nÂ∑≤ÂõûÂ§çÂêéÁöÑÈáçÈóÆÔºåÂú®‰∏§Ê¨°pop()Âêé this.msgContent.length Âíå this.msgTokens.length ÈÉΩ‰∏çËØ•‰∏∫0 ÔºåÊ≠§Êó∂Â∫îËØ•Ëá≥Â∞ëÊúâ1Êù°Êï∞ÊçÆÔºå([0] = System Prompt Á≥ªÁªüÊåá‰ª§)„ÄÇ \r\n\r\nthis.msgContent.length: " +  this.msgContent.length  + "\r\n\r\nthis.msgTokens.length: " + this.msgTokens.length  ); }
							
					}else{
						//templastmsgHtml is Me, it must be a failed message. ÊúÄÂêé‰∏ÄÊù°‰∏∫ÂèëÈÄÅÂ§±Ë¥•ÁöÑmsg
						 
							// length-1 ÊòØÊúÄÂêé‰∏ÄÊù°AIÂõûÂ§çÁöÑÊï∞ÊçÆ(Êó†ËÆ∫ÈöîÁùÄÂ§öÂ∞ëÊù°ÂèëÈÄÅÂ§±Ë¥•ÁöÑËÆ∞ÂΩï)ÔºåÊàñÊòØmsgTokens[0]ÁöÑÊï∞ÊçÆ(Êó†ËÆ∞ÂøÜ)
							totaltokens_temp = this.msgTokens[this.msgTokens.length - 1]["total_tokens"];  // int
							if( this.userMsgTokensForRetry != 0 ){
								// != 0Ôºö ËØ¥ÊòéÊòØÊõæÁªèAIÂõûÂ§çËøáÔºå‰∏îÂ∑≤ÁªèÈáçËØïËøáÔºå‰ΩÜÈáçËØïÂ§±Ë¥•‰∫Ü„ÄÇÔºàÈáçÈóÆÊàêÂäüÔºåuserMsgTokensForRetry‰ºöË¢´Ê∏ÖÈõ∂Ôºâ
								// != 0Ôºö AI replied before and has already been retried, but the retry failed. (If the retry succeeds, userMsgTokensForRetry will be reset to zero.)
								totaltokens_temp = this.userMsgTokensForRetry;
							}
					}
				
				 	this.totaltokens = totaltokens_temp;


					if (this.msgContent.length == 0  || this.msgContentForMsgList_SingleRound.length == 0){
						console.error("retry(). length == 0. [Retry] ÊÑèÂ§ñÈîôËØØ Error bug");
					}
				  	
					//'templastmsgContent' Last sent question. (Not processed by marked.js + highlight.js.)
					this.isRetry_RetryMessage = templastmsgContent['content']; //Êñ∞ÁöÑÊñπÊ≥ï(new version)Ôºå‰ΩúÁî®Ôºö[ÈáçÈóÆ]‰ºöÊõøÊç¢ÂíåÊ∏ÖÁ©∫ËÅäÂ§©ËæìÂÖ•Ê°ÜÔºåÊñ∞ÁâàÂèØÈÅøÂÖçËøôÁßçÊΩúÂú®ÁöÑ‰∏¢Â§±Êï∞ÊçÆÁöÑÈ£éÈô©„ÄÇ
					
					//ÂøÖÈ°ªÁî®$nextTick(()„ÄÇ TipsÔºöÊ∏ÖÁ©∫ËÆ∞ÂøÜÂêéÔºå‰ºö‰∫ßÁîüÂàÜÂâ≤Á∫øÔºåÊ≠§Êó∂ÈóÆÈ¢òÂèëÂá∫ÂêéÔºå‰∏≠Èó¥‰ºöÊòæÁ§∫Êó∂Èó¥ÔºåÊ≠§Êó∂ÁÇπÂáªÈáçÈóÆÔºåÂ±Ö‰∏≠ÁöÑWeChatStyleDatetime‰∏ç‰ºöÈöèÁùÄpop()Ê∂àÂ§±„ÄÇÂä†‰∏ä$nextTickÂêéÔºåÁ≠âÂæÖpop()ÊâßË°å/‰øÆÊîπDOM/Ê∏≤Êüì...ÂΩªÂ∫ïÂÆåÊàêÂêéÔºåÂ±Ö‰∏≠ÁöÑÊó∂Èó¥‰ºöË¢´È°∫Âà©Âà†Èô§ÔºåÊ≠§Êó∂ÂÜçÈáçÈóÆ„ÄÇ
					this.$nextTick(() => {
						this.sendMsg(); 
					});
				}
				else{
					//err  If the code has reached here, it means there is an error.
					console.error("retry(). length <= 1 && Retry is available. [Retry] ÊÑèÂ§ñÈîôËØØ Error bug");
					this.btnDisabledState_Undo = true;  
					this.btnDisabledState_Clear = true;
				}
 			}, 
			//ÊåâÈíÆÔºöÁÇπÂáªÈ™åËØÅAPI Key  Check API Key
			checkAPIbtn(){
				let notif = '';
				this.api = this.api.trim();

				this.check_KeyMode_byURL();//ÂàùÊ≠•‰øÆÊ≠£KeyÊ®°Âºè„ÄÇ *È™åËØÅkeyÊó∂Ôºåcheck_KeyMode_byURLÁöÑÊÑè‰πâ‰∏çÂ§ß
				
				if (this.api == ""){
					this.sentext = this.settingsLanguage == 'cn' ? 'ÂÖàÈ™åËØÅAPI' : 'Check API First';
					notif =  this.settingsLanguage == 'cn' ?  'ËØ∑Â°´ÂÖ• API Key' : 'Please enter the API Key';
					this.showNotification(notif, 'bottom');
					if(!this.isThirdPartyAPIKeyEnabled){ //OpenAI Key
						this.restoreApiKeyInput(true, true);//ËØ¢ÈóÆÊòØÂê¶ÊÅ¢Â§çkey
					}
					return;
				}
				
				//ÊòØÂê¶Ê≠£Âú®ÂèëÈÄÅ
				if(this.isSendingNow) {
					return;
				}
				
				//‰øùÂ≠ò Ëé∑ÂèñÊúÄÊñ∞API KeyÊï∞ÊçÆ Âø´ÈÄüÈ™åËØÅ
				this.saveApikeyData();
				const isExist = this.apiCheckedData.some(item => item.apikey.trim() == this.api);
				if( isExist ) {//Â¶ÇÊûúÂ∑≤ÁªèÂ≠òÂú®
					this.inputapichange(true);
					return;
				}
				
				const currentTime = new Date().getTime(); // Ëé∑ÂèñÂΩìÂâçÊó∂Èó¥
				if (currentTime - this.lastCheckApiTime < 4000) { 
					// ‰∏é‰∏ä‰∏ÄÊ¨°ÁÇπÂáªÊó∂Èó¥ÊØîËæÉÔºåÂ∞è‰∫é4ÁßíÂàôËøîÂõû
					notif =  this.settingsLanguage == 'cn' ?  'ËØ∑ÂãøÈ¢ëÁπÅÂèëÈÄÅËØ∑Ê±ÇÔºåÈúÄÈó¥Èöî4Áßí' : 'Requests too fast, please wait 4 seconds between each one.';
					this.showNotification(notif, 'bottom','',2600);
					return;
				}
				// 4ÁßíÂÜÖÂè™ËÉΩÊèê‰∫§‰∏ÄÊ¨°È™åËØÅÔºåÈò≤Ê≠¢ËøáÂø´ÈáçÂ§çÁÇπÂáª
				this.lastCheckApiTime = currentTime; // Êõ¥Êñ∞‰∏ä‰∏ÄÊ¨°ÁÇπÂáªÊó∂Èó¥
	  
				this.isCheckingApiKeyNow = true; //Ê≠£Âú®È™åËØÅ‰∏≠Ôºå‰πãÂêé‰∏çËÉΩÂÜçÊúâ"return"‰ª£Á†Å
				this.btnDisabledState_ApiURL = true;
				this.btnDisabledState_Language = true;
				this.btnDisabledState_ContextualMode = true;
				this.btnDisabledState_KeyMode = true;
				
				this.beginLoadingAnimation();
				document.querySelector('.inputapikey').readOnly = true; //È™åËØÅ‰∏≠ÔºåapikeyÁ¶ÅÊ≠¢ÊîπÂä®
				notif =  this.settingsLanguage == 'cn' ?  'È™åËØÅ‰∏≠...' : 'Checking...';
				this.lastAPIKeyInputText = this.api;//Êõ¥Êñ∞ÊúÄÂêé‰∏ÄÊ¨°ËæìÂÖ•Ê°Ü‰∏≠ÁöÑkeyÔºåÊó†ËÆ∫ÊòØÂê¶ÊàêÂäü
	  		//ÊµãËØï console.log('È™åËØÅ - ÂΩìÂâçapi ',this.lastAPIKeyInputText);
			
				//‰∏∫falseÔºåË°®Á§∫Êñ∞Á™óÂè£‰ªéÊú™ÂÜôÂÖ•ËøáÊåá‰ª§ÔºåÊèêÈÜí‰∏ÄÊ¨°„ÄÇ
				if(!this.hasSystemPromptBeenSaved){
					if(this.gptSystemPrompt.trim() != "" && this.gptSystemPromptReadOnly.trim() == ""){
						//ÂΩìgptSystemPrompt(ÁºñËæëÊ°Ü)ÊúâÂÜÖÂÆπ + gptSystemPromptReadOnly‰∏∫Á©∫ÔºàÂΩìÂâçÁ≥ªÁªüÊèêÁ§∫ËØç‰∏∫Á©∫ÔºâÔºåÊèêÈÜíÁî®Êà∑ÊúâÊú™‰øùÂ≠òÁöÑÊèêÁ§∫ËØç„ÄÇ
						//ÈöêÂΩ¢ÊèêÁ§∫ËØç ‰ªÖÂΩìgptSystemPrompt_hiddenÈöêËóèÊèêÁ§∫ËØç‰∏çÂ≠òÂú®Êó∂
						if(this.gptSystemPrompt_hidden.trim() == ''){
							notif +=  this.settingsLanguage == 'cn' ?  '    ÊèêÁ§∫: [Á≥ªÁªüÊèêÁ§∫ËØç]ÈúÄË¶Å‰øùÂ≠òÂêéÊâç‰ºöÁîüÊïà' : '    Tip: [System Prompt] will only take effect after being saved.';
						}
						this.hasSystemPromptBeenSaved = true;
					}
					else{
						this.hasSystemPromptBeenSaved = true;
					}
				}
				
				//ÂºπÂá∫ÈÄöÁü•
				this.showNotification(notif, 'bottom','',60000);
				
				//Áî®ÈöèÊú∫Â≠óÁ¨¶‰∏≤È™åËØÅapiÔºåËÄÉËôë: ‰ΩøÁî®‰∫∫Êï∞Â§öÊó∂ÔºåÈáçÂ§çÂèëÂçï‰∏ÄÂÜÖÂÆπÁªôOpanAIÊúçÂä°Âô®Ôºå‰ºöÂèóÊÉ©ÁΩö
				let arrayStr = ["hi~", "Hey ChatGPT", "hi", "hello", "Hi, how are you?", "What's up?", "Hello there!", "How are you", "Hey!", "Sup?", "Yo!", "Howdy!", "Hey?", "Yo~", "Hiya", "Hello GPT, what's up?", "Hey GPT"] ; 
				let randomString = 'hi' ;
				if (arrayStr.length > 0) {
					randomString  = arrayStr[Math.floor(Math.random()*arrayStr.length)];
				}
				if (typeof randomString !== 'string') {
					randomString = 'hi' ;
				}
				
				// ËÆæÁΩÆaxiosÁöÑË∂ÖÊó∂Êó∂Èó¥ÔºåÈªòËÆ§ÊòØ0ÔºàÊ∞∏‰∏çË∂ÖÊó∂ÔºåÂÆûÈôÖ‰∏ä60ÁßíÂ∞±‰ºöÊä•Ë∂ÖÊó∂Ôºâ„ÄÇÈ™åËØÅAPIÊó∂ÔºåËØ∑Ê±ÇÁöÑÈóÆÈ¢òÂæàÁÆÄÂçïÔºåË∂ÖÊó∂Êó∂Èó¥ÂèØ‰ª•Áü≠ÁÇπ„ÄÇ
				// To set a timeout for axios, the default is 0 . For simple request issues when checking the API, the timeout can be set to 35 seconds or less.
				// *Default is 0 (Never timeout,In actuality, it will report a timeout error in around 60 seconds.)
				axios.defaults.timeout = 21000; //21000ÊØ´Áßí=21Áßí„ÄÇ  21000ms = 21s  //v8.23 ‰ªé35ÁßíÊîπ‰∏∫21Áßí„ÄÇ v8.23 Previously set to 35 seconds, it is now changed to 21 seconds. Usually, within 20 seconds is sufficient.
				
				// Check API Key, not chat
				//‰∏ãÈù¢ËøôË°åÊòØÈ™åËØÅAPI KeyÊó∂ÁöÑÂèÇÊï∞Ôºå‰∏çÊòØËÅäÂ§©ÁöÑÂèÇÊï∞Ôºå‰∏ÄËà¨‰∏çÈúÄË¶ÅÊîπÂä®
				axios.post( this.apiURL , {
					messages: [{"role": "user", "content": randomString }], max_tokens: 15, model: this.apiGPTModel
				}, {
					headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + this.api }
				}).then(res => {
								
					//v8.11 ÈÄÇÈÖçÊûÅÂ∞ëÊï∞Á¨¨‰∏âÊñπÊé•Âè£ ÈÉ®ÂàÜÈîôËØØ‰ø°ÊÅØ‰ª•res.dataÁöÑÊñπÂºèËøîÂõû„ÄÇ *ChatGPT Next Web   nextweb.fun 
					//v8.11 - Start 
					if ( !res.data || !res.data.hasOwnProperty('choices') ) { // Êú™ÂåÖÂê´choicesÔºåËØ¥ÊòéÊòØÂ§±Ë¥•‰∫ÜÔºåËøîÂõûÁöÑÊòØÈîôËØØÁöÑÁªìÊûú
					
						//Ëé∑ÂèñÈîôËØØ‰ø°ÊÅØÔºåËøîÂõûÁªôresponseObj
						const responseObj = this.thirdPartyAPI_ErrorOccurred_ButResponseWasNormal(res);
						
						const error_nextweb = new Error(''); //ÊâãÂä®Ê®°ÊãüerrorÈîôËØØ  error.message = ''
						error_nextweb.code = '';
						error_nextweb.request = { //Ê∑ªÂä† request.responseText
							responseText: JSON.stringify(responseObj)
						};
						throw error_nextweb; //ÊäõÂá∫ÈîôËØØÔºåË∑≥ËΩ¨Âà∞catch
					}
					//v8.11 - End 
					
					//console.log('suss',res);
					this.isCheckingApiKeyNow = false; //Êõ¥Êñ∞È™åËØÅÁöÑÁä∂ÊÄÅ
					this.endLoadingAnimation();
					this.lastAPIKeyInputText_Available = ( this.api.startsWith('sk-') && !this.excludeList_ThirdPartyKeyStartWithSK_DomainKeyword.some(char => this.apiURL.toLowerCase().includes(char)) ) ? this.api : '';//Êõ¥Êñ∞ÊúÄÂêé‰∏ÄÊ¨°ËæìÂÖ•Ê°Ü‰∏≠ÁöÑkeyÔºàOpenAI KeyÔºâÔºåÊàêÂäüÁöÑ
					document.querySelector('.inputapikey').readOnly = false; //È™åËØÅÁªìÊùüÔºåapikeyÊÅ¢Â§çÂèØÊîπ
					
					
					
					this.changeButtonDisabledState(false);//ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
					
					this.btnDisabledState_ApiURL = false;
					this.btnDisabledState_Language = false;
					this.btnDisabledState_ContextualMode = false;
					this.btnDisabledState_KeyMode = false;
					
					this.check_KeyMode_byKey();//‰øÆÊ≠£Key Mode„ÄÇ *‰øÆÊ≠£ÂêéÔºåupdateApiCheckedDataÊâç‰ºöÂáÜÁ°Æ
					
					notif =  this.settingsLanguage == 'cn' ?  'È™åËØÅÊàêÂäüÔºåAPI Key ÂèØÁî®' : 'Successful, API Key is valid.';
					this.showNotification(notif, 'bottom', '',1800 );
					
					

					//Êõ¥Êñ∞this.apiCheckedData  ËÆ∞ÂΩïÂ∑≤È™åËØÅÁöÑAPI Key‰ø°ÊÅØ
					this.updateApiCheckedData(this.api, currentTime, 'success');
					
					
					//‰ª•‰∏äÔºöÊØèÊ¨°È™åËØÅÊàêÂäü/Â§±Ë¥•ÈÉΩ‰ºöÊîπÂèòÁöÑÁä∂ÊÄÅ
					//‰ª•‰∏ãÔºöÈ¶ñÊ¨°È™åËØÅÊàêÂäüÂêéÂ∞±‰∏çÂÜçÊîπÂèòÁöÑÁä∂ÊÄÅÔºåÁõ∏ÂΩì‰∫éÂàùÂßãÂåñ
					
					// none
					
				}).catch(error =>{
					console.log('error',error);
					this.isCheckingApiKeyNow = false; //Êõ¥Êñ∞È™åËØÅÁöÑÁä∂ÊÄÅ
					this.endLoadingAnimation();
					document.querySelector('.inputapikey').readOnly = false; //È™åËØÅÁªìÊùüÔºåapikeyÊÅ¢Â§çÂèØÊîπ
					
					//API KeyÂèØÈáçÂ§çÈ™åËØÅÔºåËôΩÈôêÂà∂4ÁßíÊâçËÉΩÂèëÈÄÅ‰∏ÄÊ¨°ËØ∑Ê±ÇÔºå‰ΩÜ‰ªçÁÑ∂‰ºöÂá∫Áé∞ËøôÁßçÊÉÖÂÜµÔºöÊúçÂä°Âô®ÊÖ¢ÔºåÂêåÊó∂Â≠òÂú®Â§öÊ¨°ËØ∑Ê±ÇÔºåÂΩì1‰∏™ËØ∑Ê±ÇÈÄöËøáÈ™åËØÅÂêéÔºåÁ¨¨2Ê¨°Êàñ‰πãÂêéÁöÑÂèØËÉΩÂõ†‰∏∫‚ÄúÁü≠Êó∂Èó¥ËØ∑Ê±ÇËøáÂø´‚ÄùËÄåÊú™ÈÄöËøáÔºåÈÄ†ÊàêÂ§ö‰∏™Êéß‰ª∂ÂèàÂèòÊàê‰∏çÂèØÁî®ÁöÑÁä∂ÊÄÅ„ÄÇ
					//ÈÄöËøá‰ª•‰∏ãÈÄªËæëÂèØ‰ª•Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºöÂΩìÊä•ÈîôÊó∂Ôºå‰ª£Á†ÅÊâßË°åÂà∞Ê≠§Â§ÑÔºåthis.btnDisabledState_Sending==false  Êàñ this.btnDisabledState_CheckAPI==true ÈÉΩÂèØ‰ª•ËØ¥ÊòéÂàöÈÄöËøá‰∫ÜÈ™åËØÅ					
					if (!this.btnDisabledState_Sending && this.btnDisabledState_CheckAPI){
						return;//Â∑≤Â≠òÂú®È™åËØÅÈÄöËøáÁöÑKeyÔºåÂøΩÁï•Êä•Èîô
					}
					
					//‰ª•‰∏äÊòØÂøÖÈ°ªÊâßË°åÁöÑ
					
					//‰ª•‰∏ã
					
					this.changeButtonDisabledState(true);//ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
						 
					this.btnDisabledState_ApiURL = false;
					this.btnDisabledState_Language = false;
					this.btnDisabledState_ContextualMode = false;
					this.btnDisabledState_KeyMode = false;
					
					this.check_KeyMode_byKey();//‰øÆÊ≠£Key Mode„ÄÇ *‰øÆÊ≠£ÂêéÔºåcatchApiErrorCode„ÄÅupdateApiCheckedData„ÄÅautoRetry Êâç‰ºöÂáÜÁ°Æ
						
					if( error.message &&  error.message.includes('Type error')){
						//ÂØÜÈí•Âê´ÈùûÊ≥ïÁ¨¶Âè∑„ÄÅÂÖ®ËßíÁ¨¶Âè∑Á≠â illegal symbols
						this.sentext = this.settingsLanguage == 'cn' ? 'API KeyÈîôËØØ' : 'API Key Error';
					}else if( error.message &&  error.message.includes('401')){
						// 401-1 & 401-2 ÂØÜÈí•Êó†Êïà API Key Error
						this.sentext = this.settingsLanguage == 'cn' ? 'API KeyÈîôËØØ' : 'API Key Error';
					}else {
						// ÂÖ∂‰ªñÊÉÖÂÜµ other
						this.sentext = this.settingsLanguage == 'cn' ? 'ÂÖàÈ™åËØÅAPI' : 'Check API First';
					}
					
					//ÈîôËØØ‰ª£Á†Å ÂºπÁ™ó
					this.catchApiErrorCode(error, currentTime);

				})
			},
			//È™åËØÅ&ÂèëÈÄÅÁöÑÈîôËØØ‰ª£Á†Å ÈîôËØØÂºπÁ™ó Check Send Err
			catchApiErrorCode(error, requesttime) {
				//Êú´Â∞æÊúâ‰ª£Á†Åthis.isSendingNow_ForSmartMaxTokens = false; Â¶ÇÊûú‰ª£Á†Å‰∏≠ÊúâÊ∑ªÂä†returnÔºåÈÇ£‰πàreturnÂâçÔºåÈúÄË¶ÅÂä†‰∏äËøôÂè•Êõ¥Êñ∞ÂèëÈÄÅÁä∂ÊÄÅÁöÑ‰ª£Á†Å„ÄÇ*‰∏ªË¶ÅÁî®‰∫éÂå∫Âà´‚ÄúÂèëÈÄÅ‚ÄùÂíå‚ÄúÈ™åËØÅ‚ÄùÔºåÈ™åËØÅ‰∏çÈúÄË¶ÅSmartMaxTokens
				
				const current_apidata = this.apiCheckedData.find(data => data.apikey === this.api);//ÂΩìÂâçapidata
				//current_apidata == nullËØ¥ÊòéÊòØ‚ÄúÁÇπÂáª[È™åËØÅ]ÊåâÈíÆÈ™åËØÅÁöÑÊñ∞key‚ÄùÔºå‰∏çÊòØ‚ÄúÂØºÂÖ•ÊàñÊâπÈáèÊ∑ªÂä†ÁöÑÊñ∞Key‚Äù„ÄÇ Âå∫Âà´ÔºöÂØºÂÖ•ÊàñÊâπÈáèÊ∑ªÂä†ÁöÑKeyÂ∑≤ÁªèË¢´Ê∑ªÂä†Âà∞this.apiCheckedDataÔºåËôΩÁÑ∂Êú™È™åËØÅËøá„ÄÇ 
				//Êõ¥Êñ∞Êó∂Èó¥updatetime == 0ÔºåËØ¥ÊòéÊòØÊú™Ê£ÄÊµãÁöÑÊñ∞Key„ÄÇ *Âè¶‰∏Ä‰∏™Â±ûÊÄßlevel‰∏çËÉΩÁî®‰∫éÂà§Êñ≠Êñ∞KeyÔºålevel==null ‰∏çËÉΩ‰ª£Ë°®ÊòØÊú™Ê£ÄÊµãËøáÁöÑ(‰ΩøÁî®ËøáÁ®ã‰∏≠ÔºåÊüê‰∫õÊÉÖÂÜµ‰∏ãlevel‰ºöË¢´Êîπ‰∏∫null)ÔºåÂè™Êúâ updatetime ÂèØ‰ª•Âà§Êñ≠„ÄÇ
				let isKeyNew_From_Import_or_BulkAdd = (current_apidata != null && current_apidata.updatetime === 0) ? true : false ; 
				if( this.list_OnlyUseThirdPartyKey_DomainKeyword.some(char => this.apiURL.toLowerCase().includes(char)) ){
					isKeyNew_From_Import_or_BulkAdd = false; //Â¶ÇÊûúÂΩìÂâçÊòØ"‰ªÖÊîØÊåÅÁ¨¨‰∏âÊñπKeyÁöÑÁ¨¨‰∏âÊñπÊé•Âè£"ÔºåÂàô‰∏∫falseÔºå‰∏ç"Ëá™Âä®ÈáçÂèë"Ôºà‰∏çËøõË°åÊâπÈáèÈ™åËØÅÔºâ
				}
				
				let delaytime = 450; //450ms Ôºå450ÊØ´Áßí
				let notif_cn ='';
				let notif_en ='';
				let title ='';
				let responseObject; //responseText
				let responseMessage = ''; //OpenAI Error Message or Third-party
				let responseType = ''; //OpenAI Error Type or Third-party
				let responseCode = '';//
				const timeoutRegExp = /timeout of \d+ms exceeded/; // ‚Äútimeout of 30000ms exceeded‚Äù , ‚Äútimeout of 60000ms exceeded‚Äù
				
					
				// OpenAIÂÆòÁΩëÂÖ≥‰∫éÈîôËØØ‰ª£Á†ÅÁöÑËß£ÈáäÔºö OpenAI - API Error Codes Explained:
				// https://help.openai.com/en/collections/3808446-api-error-codes-explained
				try{
					if (error.request && error.request.responseText) {
						responseObject = JSON.parse(error.request.responseText); // Â∞Ü JSON Â≠óÁ¨¶‰∏≤Ëß£Êûê‰∏∫ JavaScript ÂØπË±°
						if(responseObject.error && typeof responseObject.error === "object" && responseObject.error.message && responseObject.error.type && responseObject.error.code){// Á¨¶Âêà OpenAI ÁâπÂæÅ/Ê†ºÂºè
							responseMessage = responseObject.error.message ; // ËØªÂèñ message Â±ûÊÄßÁöÑÂÄº
							responseType = responseObject.error.type ; // ËØªÂèñ type Â±ûÊÄßÁöÑÂÄº
							responseCode = responseObject.error.code ; // string
						}else{ // Á¨¨‰∏âÊñπ Third-party
							// Ëé∑ÂèñÂØπË±°ÁöÑÊâÄÊúâÂ±ûÊÄßÂêçÁß∞
							let keys = Object.keys(responseObject);
							// ÈÅçÂéÜÂ±ûÊÄßÂêçÁß∞
							for (let key of keys) {
								if (typeof responseObject[key] === "object") { // Â±ûÊÄß‰∏∫ÂØπË±°Êó∂ÔºåÊ£ÄÊµãÂ≠êÂØπË±°ÁöÑÂ±ûÊÄß
									if(responseObject[key] !== null){
										let i_keys = Object.keys(responseObject[key]);
										// ÈÅçÂéÜÂ±ûÊÄßÂêçÁß∞
										for (let i_key of i_keys) {
											// Ê£ÄÊü•Â±ûÊÄßÂêç
											if (i_key.toLowerCase().includes("message") || i_key.toLowerCase().includes("msg") || i_key.toLowerCase().includes("err")) {
												const isError_Label = i_key.toLowerCase().includes("err") ? (i_key + ': ') : '' ;
												responseMessage = responseMessage + (responseMessage === '' ? '' : '\r\n') + isError_Label + ( typeof responseObject[key][i_key] === 'string' ?  responseObject[key][i_key] : JSON.stringify(responseObject[key][i_key]) );
											}else if (i_key.toLowerCase().includes("code")) {
												responseCode = responseObject[key][i_key] ? responseObject[key][i_key].toString() : '';
											}else if (i_key.toLowerCase().includes("type")) {
												responseType = responseObject[key][i_key] ? responseObject[key][i_key].toString() : '';
											}
										}
									}
								}else{
									// Ê£ÄÊü•Â±ûÊÄßÂêç
									if (key.toLowerCase().includes("message") || key.toLowerCase().includes("msg") || key.toLowerCase().includes("err")) {
										const isError_Label = key.toLowerCase().includes("err") ? (key + ': ') : '' ;
										responseMessage = responseMessage + (responseMessage === '' ? '' : '\r\n') + isError_Label + ( typeof responseObject[key] === 'string' ?  responseObject[key] : JSON.stringify(responseObject[key]) );
									}else if (key.toLowerCase().includes("code")) {
										responseCode = responseObject[key] ? responseObject[key].toString() : '';
									}else if (key.toLowerCase().includes("type")) {
										responseType = responseObject[key] ? responseObject[key].toString() : '';
									}
								}
							}
							//Âæ™ÁéØÁªìÊùü
							if(responseMessage === ''){
								responseMessage = error.request.responseText;
							}
						}
					}
				}catch(e){
					if(responseMessage === ''){
						if(error && error.request){
							if(error.request.responseText){
								if(typeof error.request.responseText === 'string'){
									responseMessage = error.request.responseText;
								}else{
									responseMessage = JSON.stringify(error.request.responseText);
								}
							}
							if(error.request.response && responseMessage === ''){
								if(typeof error.request.response === 'string'){
									responseMessage = error.request.response;
								}else{
									responseMessage = JSON.stringify(error.request.response);
								}
							}
						}
					}
					if(responseCode === ''){
						if(error && error.response && error.response.data){
							responseCode = JSON.stringify(error.response.data); //‰∏éresponseMessageÂ∫îËØ•ÊòØÈáçÂ§çÁöÑÔºåÂ§ö‰ªΩÊï∞ÊçÆ
						}
					}
				}
				
				let apidata_errorState = '';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
				let autoRetry_errortype = '';//Áî®‰∫éËá™Âä®ÈáçÈóÆ/Ëá™Âä®ÈáçËØï
				let autoRetry_bottomnotifCN = '';//Áî®‰∫éËá™Âä®ÈáçÈóÆ/Ëá™Âä®ÈáçËØï ÁÆÄÁü≠ÈÄöÁü•
				let autoRetry_bottomnotifEN = '';//Áî®‰∫éËá™Âä®ÈáçÈóÆ/Ëá™Âä®ÈáçËØï ÁÆÄÁü≠ÈÄöÁü•
				
				const model_data = this.gptModelList.find(model => model.modelname === this.apiGPTModel);
				this.isModelDataExist_In_gptModelList(model_data);
					
				//Âà§Êñ≠ÈîôËØØÁ±ªÂûã
				if( error.message &&  error.message.includes('Type error')){
				//ÂØÜÈí•Âê´ÈùûÊ≥ïÁ¨¶Âè∑„ÄÅÂÖ®ËßíÁ¨¶Âè∑Á≠â illegal symbols
					notif_cn = 'API Key Âê´ÊúâÈùûÊ≥ïÁ¨¶Âè∑„ÄÇÂØÜÈí•‰∏çÂÖÅËÆ∏Âê´ÊúâÊ±âÂ≠ó„ÄÅÂÖ®ËßíÁ¨¶Âè∑ÊàñÂÖ∂‰ªñÈùûÊ≥ïÁ¨¶Âè∑„ÄÇÂª∫ËÆÆÂ§çÂà∂Á≤òË¥¥ API KeyÔºåÈÅøÂÖçÊÑèÂ§ñËæìÂÖ•ÂÖ®ËßíÁ¨¶Âè∑ÊàñÂÖ∂‰ªñÈùûÊ≥ïÁ¨¶Âè∑„ÄÇ';
					notif_en = 'All API keys do not contain any full-width symbols or other illegal symbols. It is recommended to copy and paste the API Key to avoid entering illegal symbols.';
					notif_cn += '\r\n\r\n  ‚Ä¢ ÂΩìÂâç API Key : ' + this.api ;
					notif_en += '\r\n\r\n  ‚Ä¢ The current API Key : ' + this.api ;
					title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - API Key Ê†ºÂºèÈùûÊ≥ï' : 'Error - Invalid API Key Format';
					apidata_errorState ='';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
				}else if ( error.message &&  ( error.message == 'timeout exceeded' || timeoutRegExp.test(error.message) )){
				// ÁΩëÁªúË∂ÖÊó∂ Timeout exceeded
				// ifÂà§Êñ≠ÈúÄË¶ÅÂÖà‰∫é"OpenAIÈîôËØØ‰ª£Á†Å"ÔºåÂõ†‰∏∫Ë∂ÖÊó∂Êó∂Èó¥‰∏≠ÂèØËÉΩ‰ºöÂåÖÂê´Êúâ400„ÄÅ500Á≠âÊï∞Â≠ó„ÄÇ
				// The if statement needs to come before "OpenAI's error code" because the error codes for timeout may include numbers such as 400 or 500.
					const temp_isOpenAI = (this.apiURL.toLowerCase() === this.OpenAI_API_URL && this.api.startsWith('sk-'));
					notif_cn = 'ËøûÊé•Ë∂ÖÊó∂ÔºåÊúçÂä°Âô®ÁîüÊàêÂõûÂ§çÊâÄÁî®Êó∂Èó¥ËøáÈïøÔºåÊàñËÄÖÊòØÁΩëÁªúÈóÆÈ¢ò„ÄÇ';
					notif_en = "Connection timed out, the server took too long to generate a response, or there is a network issue.";
					if(temp_isOpenAI){
						notif_cn += '\r\n  ‚Ä¢ Â¶ÇÊûúÁΩëÁªúÊ≠£Â∏∏ÔºåÈúÄË¶ÅÁ°ÆËÆ§ÊÇ®ÁöÑIPÊâÄÂú®Âú∞ (ÂõΩÂÆ∂ÊàñÂú∞Âå∫) ÊòØÂê¶Â±û‰∫é OpenAI ÁöÑÊúçÂä°ËåÉÂõ¥„ÄÇ\r\n  ‚Ä¢ Â¶ÇÊûúÊÇ®Âú®ÂõΩÂÜÖ‰ΩøÁî® OpenAI ÂÆòÊñπÊé•Âè£ÔºåÂøÖÈ°ª‰ΩøÁî®"È≠îÊ≥ï"ÊâçËÉΩÂª∫Á´ãËøûÊé•„ÄÇ\r\n\r\n  ‚Ä¢ OpenAIÊîØÊåÅÁöÑÂõΩÂÆ∂ÊàñÂú∞Âå∫:(ÈúÄÈ≠îÊ≥ï) https://platform.openai.com/docs/supported-countries ';
						notif_en += "\r\n  ‚Ä¢ Please check your network and confirm whether your IP location is within OpenAI's service scope to decide whether V P N is required.\r\n\r\n  ‚Ä¢ Supported countries and territories:  https://platform.openai.com/docs/supported-countries ";
					}else{
						notif_cn += '\r\n  ‚Ä¢ Â¶ÇÊûúÊÇ®‰ΩøÁî®Á¨¨‰∏âÊñπÊé•Âè£ÔºåÈúÄË¶ÅÊòéÁ°ÆËØ•Êé•Âè£ÊòØÂê¶ÊîØÊåÅÂÖç"È≠îÊ≥ï"Ôºå‰ª•ÂèäËØ•Êé•Âè£ÁΩëÂùÄÂΩìÂâçÊòØÂê¶‰∏∫ÂèØÁî®Áä∂ÊÄÅ (ÊúçÂä°Âô®ÊòØÂê¶Á®≥ÂÆö)„ÄÇ\r\n';
						notif_en += "\r\n  ‚Ä¢ If using a third-party API, please ensure its validity and whether the server is currently running stable.\r\n";
					}
					notif_cn += '\r\n  ‚Ä¢ ‰ªÄ‰πàÊòØ"È≠îÊ≥ï"Ôºü‰∏ÄÁßçÂèØ‰ª•ËÆ©ÊÇ®ÁöÑÊâãÊú∫ÊàñÁîµËÑëÂá∫Ë∂üÂõΩÁöÑÊäÄÊúØÔºå‰ºòË¥®ÁöÑÈ≠îÊ≥ï‰ºöËÆ©OpenAIËÆ§‰∏∫ÊÇ®ÁöÑËÆæÂ§áÊòØÁúüÁöÑÂú®ÂõΩÂ§ñ„ÄÇ';
					
					if(timeoutRegExp.test(error.message)){
						const timeRegExp = /timeout of (\d+)ms exceeded/;
						const matchResult = error.message.match(timeRegExp);
						if (matchResult) {
							const timeoutSec = matchResult[1] / 1000;
							notif_cn += "\r\n  ‚Ä¢ ÂΩìÂâç‰ª£Á†Å‰∏≠ËÆæÁΩÆÁöÑË∂ÖÊó∂Êó∂Èó¥‰∏∫Ôºö" + timeoutSec + " Áßí";
							notif_en += "\r\n  ‚Ä¢ The timeout set in the code is: " + timeoutSec + " seconds";
						}
					}
					title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - ÁΩëÁªúËøûÊé•Ë∂ÖÊó∂' : 'Error - Timeout exceeded';
					apidata_errorState ='';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
					autoRetry_errortype = 'timeout exceeded';
					autoRetry_bottomnotifCN = 'ËøûÊé•Ë∂ÖÊó∂ÔºåËá™Âä®ÈáçÂèë‰∏≠...';
					autoRetry_bottomnotifEN = 'Connection timed out, automatically retrying...';
					//Ë∂ÖÊó∂ÁöÑÁ≠âÂæÖÊó∂Èó¥Â§™ÈïøÔºåÊèêÈÜí"‰∏≠Ê≠¢ËØ∑Ê±Ç"ÁöÑÊñπÊ≥ï The timeout for waiting is too long. Here is a reminder on how to "abort the request"
					setTimeout(() => {
						if(this.isSendingNow || this.isSendingNow_ForSmartMaxTokens){ //ÈáçÂèëÂêéÔºå‰ªçÁÑ∂Âú®ËØ∑Ê±ÇÔºåËØ∑Ê±ÇÊú™ÁªìÊùü
							if( !this.isShowNotification ){ //ÂΩìÂâç‰∏çÂ≠òÂú®ÈÄöÁü•
								const notif_temp = this.settingsLanguage == 'cn' ?  'Â∞èÊèêÁ§∫: MCGPT ‰∏çÊîØÊåÅ‰∏≠Ê≠¢ËØ∑Ê±Ç„ÄÇÂ¶ÇÊûúÊÉ≥‰∏≠Êñ≠ËØ∑Ê±ÇÔºåÂèØÈÄöËøáÂà∑Êñ∞ÁΩëÈ°µÊù•ÂÆûÁé∞„ÄÇÈÄöÂ∏∏ÔºåÂà∑Êñ∞‰∏ç‰ºöÂØºËá¥Êï∞ÊçÆ‰∏¢Â§±Ôºå‰ΩÜÊüê‰∫õÂà∑Êñ∞ÁΩëÈ°µÁöÑÊñπÂºèÂèØËÉΩÊó†Ê≥ïËß¶Âèë"Ëá™Âä®‰øùÂ≠ò"ÔºåËØ∑Ê†πÊçÆ‰ΩøÁî®ÁªèÈ™åÂÅöÂá∫Áõ∏Â∫îÁöÑÂà§Êñ≠„ÄÇ' : 'Tip: MCGPT does not support interrupting requests. If you want to interrupt a request, you can do so by refreshing the webpage. Usually, refreshing will not cause data loss, but some ways of refreshing the webpage may not trigger "auto-save". Please use your experience to judge accordingly.';
								this.showNotification(notif_temp, 'bottom', '', 18000);
							}
						}
					}, 5000);
				}else if ( error.message && error.message == 'Network Error' ){
				// ÁΩëÁªúÊïÖÈöú Network Error *Á¨¨‰∏âÊñπÊé•Âè£ÊØèÂàÜÈíüË∂Ö3Ê¨°‰πü‰ºöÂØºËá¥Ëøô‰∏™ÈîôËØØ(6ÊúàÁ¨¨‰∏âÊñπÊé•Âè£Â•ΩÂÉèÊúâÂçáÁ∫ßËøáÔºåËßÑÂàôÂèò‰∫Ü)
					notif_cn = 'ÁΩëÁªúÈîôËØØÔºåÂèØËÉΩÂè™ÊòØÊöÇÊó∂ÁöÑÔºåÂª∫ËÆÆÂÖàÈáçËØï‰∏ÄÊ¨°„ÄÇ';
					notif_en = 'Network error. The error may be temporary, so it is recommended to try again first. ';
					if(this.apiURL.toLowerCase() !== this.OpenAI_API_URL){
						notif_cn += '\r\n ‚òÖ ÂΩìÂâç‰ΩøÁî®ÁöÑÊòØÁ¨¨‰∏âÊñπAPIÔºåÂ¶ÇÊûúÊòØÁî±‰∫éÁ¨¨‰∏âÊñπÊé•Âè£ÁöÑÂéüÂõ†‰∏¥Êó∂Âá∫Áé∞ÁΩëÁªúÈîôËØØÔºåÂèØËÉΩÊòØÂõ†‰∏∫ÊúçÂä°Âô®ËøáËΩΩ„ÄÅÊ≠£Âú®ËøõË°åÁª¥Êä§ÔºåÊàñËÄÖÂõ† IP / DNSËß£ÊûêÈóÆÈ¢òÂØºËá¥ËøûÊé•‰∏çÁ®≥ÂÆö„ÄÇÂ¶ÇÊûúÈîôËØØÈ¢ëÁπÅÂèëÁîüÔºåÊÇ®ÂèØ‰ª•Â∞ùËØïÊõ¥ÊîπÁΩëÁªúÁéØÂ¢É (Êõ¥ÊîπIP„ÄÅÂàáÊç¢ÁßªÂä®ÊµÅÈáè/Wi-Fi„ÄÅÊâìÂºÄÊàñÂÖ≥Èó≠È≠îÊ≥ï„ÄÅÊõ¥Êç¢‰∏Ä‰∏™ÂÖ¨ÂÖ±DNS)„ÄÇ';
						notif_en += '\r\n ‚òÖ Currently using a third-party API. If there is a temporary network error, it may be due to server overload, maintenance, or unstable connection caused by issues such as IP/DNS resolution. If network errors occur frequently, you can try changing the network environment (change your IP, switch mobile network / Wi-Fi, open or disable VPN, or switch to a public DNS).';
					}
					
					// Á¨¨‰∏âÊñπAPI‰∏çÂÖºÂÆπÁöÑÊÉÖÂÜµÔºå‰∏é api2gptÁöÑapi ÂèØËÉΩ‰∏çÂÖºÂÆπ„ÄÇ  * api2gpt (Ê≥®ÊÑèÔºösafariÊâìÂºÄapi2gptÁΩëÁ´ô‰ºöÂá∫Áé∞Ê¨∫È™óÊÄßË≠¶ÂëäÔºåÊ≠§Âπ≥Âè∞Ë¢´ËÖæËÆØÂÆâÂÖ®Ê†áÊ≥®ÊúâÂÆâÂÖ®ÈóÆÈ¢ò) 
					if(this.apiURL.toLowerCase().includes('api2gpt')){ //‰∏çËÉΩÁî®
						notif_cn += '\r\n ‚òÖ ÊÇ®ÂΩìÂâç‰ΩøÁî®ÁöÑÊòØÁ¨¨‰∏âÊñπÂπ≥Âè∞ api2gptÔºåÂΩìÂâç Ê®°Âûã ‰∏é Key ÂèØËÉΩÈÉΩÊ≤°ÊúâÈóÆÈ¢òÔºå‰ΩÜÊòØÂ≠òÂú®‰∏Ä‰∏™"ÂêåÊ∫êË∑®Âüü"ÁöÑÈîôËØØ (‰∏çÂÖÅËÆ∏ÊúâÂ§ö‰∏™ ‚ÄùAccess-Control-Allow-Origin‚Äù CORS Â§¥)ÔºåÂØºËá¥Êó†Ê≥ïÂÖºÂÆπ api2gptÔºåÈóÆÈ¢òÂèØËÉΩ‰∏çÂ§ßÔºå‰ΩÜ‰ΩúËÄÖ‰∏çÊáÇÔºåÊêû‰∏çÂÆö„ÄÇÊÇ®ÂèØ‰ª•Âú®ÁîµËÑë‰∏äË∞ÉËØïÊü•ÁúãÈîôËØØÔºåÂ∞ùËØï‰øÆÂ§çÂÆÉ„ÄÇ(ÊÑøÊÑèÁöÑËØùÔºåÂèØ‰ª•Âú® github / gitee ‰∏äÂëäËØâÊàëËß£ÂÜ≥ÊñπÊ≥ïÔºåÊÑüË∞¢ÔΩû)';
						notif_en += '\r\n ‚òÖ ÊÇ®ÂΩìÂâç‰ΩøÁî®ÁöÑÊòØÁ¨¨‰∏âÊñπÂπ≥Âè∞ api2gptÔºåÂΩìÂâç Ê®°Âûã ‰∏é Key ÂèØËÉΩÈÉΩÊ≤°ÊúâÈóÆÈ¢òÔºå‰ΩÜÊòØÂ≠òÂú®‰∏Ä‰∏™"ÂêåÊ∫êË∑®Âüü"ÁöÑÈîôËØØ (‰∏çÂÖÅËÆ∏ÊúâÂ§ö‰∏™ ‚ÄùAccess-Control-Allow-Origin‚Äù CORS Â§¥)ÔºåÂØºËá¥Êó†Ê≥ïÂÖºÂÆπ api2gptÔºåÈóÆÈ¢òÂèØËÉΩ‰∏çÂ§ßÔºå‰ΩÜ‰ΩúËÄÖ‰∏çÊáÇÔºåÊêû‰∏çÂÆö„ÄÇÊÇ®ÂèØ‰ª•Âú®ÁîµËÑë‰∏äË∞ÉËØïÊü•ÁúãÈîôËØØÔºåÂ∞ùËØï‰øÆÂ§çÂÆÉ„ÄÇ(ÊÑøÊÑèÁöÑËØùÔºåÂèØ‰ª•Âú® github / gitee ‰∏äÂëäËØâÊàëËß£ÂÜ≥ÊñπÊ≥ïÔºåÊÑüË∞¢ÔΩû)';
					}
					
					
					notif_cn += '\r\n\r\nÁΩëÁªúÈîôËØØÂ≠òÂú®Â§öÁßçÂèØËÉΩÔºåËØ∑Ëá™Ë°åÊéíÊü•Ôºö\r\n  ‚Ä¢ Êó†Ê≥ï‰∏éÊé•Âè£ÁΩëÂùÄ (API URL) Âª∫Á´ãËøûÊé•ÔºåËØ•ÊúçÂä°Âô®‰∏çÂ≠òÂú®ÊàñÈÅáÊïÖÈöúÂΩìÂâçÊó†Ê≥ïËÆøÈóÆÔºõ\r\n  ‚Ä¢ Êú¨Êú∫ÂΩìÂâçÊó†ÁΩëÁªúÔºåÁΩëÁªúÂ∑≤Êñ≠ÂºÄÊàñÁΩëÁªú‰∏çÁ®≥ÂÆöÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúÁä∂ÊÄÅÂêéÈáçËØïÔºõ\r\n  ‚Ä¢ IPÈôêÂà∂ÔºåÂΩìÂâçIPÊàñÂÖ∂ÊâÄÂú®Âú∞Ë¢´ÈôêÂà∂ËÆøÈóÆ„ÄÇÂèØÂ∞ùËØï‰ΩøÁî®"È≠îÊ≥ï"ÔºåÂ¶ÇÊûúÊ≠£Âú®‰ΩøÁî®ÔºåËØ∑Ê£ÄÊü•"È≠îÊ≥ï"ÊòØÂê¶‰∏çÁ®≥ÂÆöÊàñÂ∑≤ÁªèÊñ≠ÂºÄÔºõ\r\n  ‚Ä¢ ÂÖ∂‰ªñÂéüÂõ†ÔºåËØ∑‰ª•ÂÆûÈôÖÊÉÖÂÜµ‰∏∫ÂáÜ„ÄÇ';
					notif_en += '\r\n\r\nPossible reasons:\r\n  ‚Ä¢ Unable to connect to the API Endpoint (API url). The server does not exist or is not accessible due to a malfunction.\r\n  ‚Ä¢ Your device is currently not connected to the network. The network may be disconnected or unstable. Please check the network status and try again.\r\n  ‚Ä¢ Due to limitations on this IP or its location, access may be restricted. You could try using a V P N. If you are already using a V P N, please check if it is unstable or has been disconnected.\r\n  ‚Ä¢ For any other reasons, please refer to the actual situation.';
					title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - ÁΩëÁªúÊïÖÈöú' : 'Error - Network error';
					apidata_errorState ='';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
					autoRetry_errortype = 'Network Error';
					autoRetry_bottomnotifCN = 'ÁΩëÁªúÈîôËØØÔºåËá™Âä®ÈáçÂèë‰∏≠...';
					autoRetry_bottomnotifEN = 'Network error, automatically retrying...';
				}else if( error.message &&  error.message.includes('401')){
				// OpenAI 401-1 & 401-2 ÂØÜÈí•Êó†Êïà API Key Error 
					const temp_2 = (this.apiURL.toLowerCase() === this.OpenAI_API_URL || this.apiURL.toLowerCase() === this.OpenaiProxyCom_API_URL) ? (this.settingsLanguage == 'cn' ? ' OpenAI ' : ' OpenAI ') : (this.settingsLanguage == 'cn' ? ' OpenAI Êàñ Á¨¨‰∏âÊñπÂπ≥Âè∞ ' : ' OpenAI or a Third-party platform ')  ;
					notif_cn = 'API Key Êó†Êïà„ÄÇÂª∫ËÆÆÂ§çÂà∂Á≤òË¥¥ API KeyÔºåÈÅøÂÖçËæìÈîô„ÄÇÂ¶ÇÊûú‰ªçÁÑ∂Âá∫ÈîôÔºåËØ¥ÊòéÊòØÊó†ÊïàÂØÜÈí•ÔºåÊàñÂØÜÈí•Â∑≤Ë¢´ÂÅúÁî®„ÄÅÂà†Èô§ÔºåÂª∫ËÆÆÁôªÂΩï' + temp_2 + 'Êü•Áúã API Key ÊòØÂê¶Âá∫Áé∞ÂèòÂä®„ÄÇ';
					notif_en = 'API Key is invalid. It is recommended to copy and paste the API Key to avoid input errors. If the error persists, it indicates an invalid API key or that the API key has been deactivated or deleted, please log in to' + temp_2 + 'to check the API Key.';
					title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 401 Êó†ÊïàÁöÑ API Key' : 'Error - 401 API Key is invalid';
					// OpenAI
					if( responseMessage.toLowerCase().includes("openai.com") || this.apiURL.toLowerCase() === this.OpenAI_API_URL || this.apiURL.toLowerCase() === this.OpenaiProxyCom_API_URL ){  // .includes("incorrect api key provided") | .includes("associated with a deactivated account") | other...
					//Âè™Êúâsk-ÂºÄÂ§¥ÁöÑOpenAI Key ÊâçÈúÄË¶ÅÊ†áËÆ∞401Êó†ÊïàÔºåÂÖ∂‰ªñÊÉÖÂÜµ‰∏çËÄÉËôë
						apidata_errorState ='401';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData *Â¶ÇÊûúÊòØÂèëÈÄÅÁä∂ÊÄÅ‰∏ãÁöÑ401ÔºåÊ†áËÆ∞key‰∏∫Êó†Êïà(level=8)
					}else{
						apidata_errorState ='error-other'; 
					}
					// OpenAI Key *This key is associated with a deactivated account.
					if ( responseMessage.toLowerCase().includes("associated with a deactivated account") && responseMessage.toLowerCase().includes("openai.com") ) {
						notif_cn += '\r\n ‚òÖ ËØ• API Key ÂØπÂ∫îÁöÑ OpenAI Ë¥¶Âè∑Â∑≤Ë¢´ÂÅúÁî®„ÄÇ';
						notif_en += '\r\n ‚òÖ The OpenAI account associated with this API Key has been deactivated.';
					}
					
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI * aiproxy.io
					if ( responseMessage.toLowerCase().includes("no permission to access") ) {
						notif_cn = 'ÊÇ®Ê≤°ÊúâÊ≠§Ê®°Âûã (model: ' + this.apiGPTModel + ') ÁöÑËÆøÈóÆÊùÉÈôêÔºåËØ∑Êõ¥Êç¢Ê®°Âûã (model) ÊàñÂú®Á¨¨‰∏âÊñπÁΩëÁ´ô‰∏≠‰øÆÊîπÊ®°ÂûãÁöÑÊùÉÈôê„ÄÇ';
						notif_en = "You do not have permission to access this model (model: " + this.apiGPTModel + "), Please switch to a different model or modify the model's permissions on the third-party website.";
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 401 Êó†ËÆøÈóÆÊùÉÈôê' : 'Error - 401 No access permission';
						apidata_errorState ='';
					}
					
					notif_cn += '\r\n\r\n  ‚Ä¢ ÂΩìÂâç API Key : ' + this.api ;
					notif_en += '\r\n\r\n  ‚Ä¢ The current API Key : ' + this.api ;
					if( this.apiURL.toLowerCase() !== this.OpenAI_API_URL && this.apiURL.toLowerCase() !== this.OpenaiProxyCom_API_URL ){
						notif_cn += '\r\n  ‚Ä¢ ËØ∑ÂèÇÈòÖ‰∏ãÊñπÁöÑ API ÈîôËØØ‰ø°ÊÅØ (Â¶ÇÊûúÈîôËØØÊèêÁ§∫ÊúâÂÜ≤Á™ÅÔºåËØ∑‰ª• [APIÈîôËØØ‰ø°ÊÅØ] ÁöÑÂÜÖÂÆπ‰∏∫ÂáÜ)„ÄÇ';
						notif_en += '\r\n  ‚Ä¢ Please refer to the API Error Message below (If there are any discrepancies, please refer to the [API error message] as it is correct).';
					}
					
					//Â¶ÇÊûúÊòØÂèëÈÄÅSendÔºåËÄåÈùûÈ™åËØÅCheck„ÄÇÂª∫ËÆÆÂà†Èô§Êó†ÊïàÁöÑKey
					if(this.isSendingNow_ForSmartMaxTokens === true && !this.isThirdPartyAPIKeyEnabled){
						const temp_1 = (this.apiURL.toLowerCase() === this.OpenAI_API_URL || this.apiURL.toLowerCase() === this.OpenaiProxyCom_API_URL) ? (this.settingsLanguage == 'cn' ? ' OpenAI ' : 'OpenAI') : (this.settingsLanguage == 'cn' ? 'ÁΩëÁ´ô' : 'website')  ;
						notif_cn = notif_cn + '\r\n  ‚Ä¢ Â¶ÇÊûúÊÇ®Âú®' + temp_1 + 'ÂêéÂè∞Á°ÆËÆ§Ê≠§ API Key Â∑≤Â§±ÊïàÊàñÂ∑≤Ë¢´Âà†Èô§ÔºåËØ∑ËÄÉËôëÂú® MCGPT ‰∏≠Âà†Èô§Ê≠§  API KeyÔºåÂõ†‰∏∫ÂÆÉÊó†Ê≥ïÊÅ¢Â§ç„ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ If you have confirmed in the ' + temp_1 + ' backend that this API Key is invalid or has been deleted, please consider removing this API Key from MCGPT as it cannot be recovered.';
						
						notif_cn += "\r\n  ‚Ä¢ ÂΩì‰ΩøÁî®ËøáÁöÑ API Key Â§±ÊïàÊó∂ÔºåÂ∞ÜÊöÇÂÅú [Ëá™Âä®ÈáçÈóÆ] Âπ∂ÊòæÁ§∫Êú¨ÈÄöÁü•„ÄÇÊÇ®ÂèØ‰ª•ÂÖ≥Èó≠Êú¨ÈÄöÁü•ÂêéÊâãÂä®ÈáçÂèëËØ∑Ê±Ç‰ª•ÁªßÁª≠ËÅäÂ§©„ÄÇ";
						notif_en += "\r\n  ‚Ä¢ When a previously used API Key becomes invalid, it will pause [Auto-Retry] and display this notification. ";
					}
					
					if(isKeyNew_From_Import_or_BulkAdd && !this.isThirdPartyAPIKeyEnabled){ //È¶ñÊ¨°Ê£ÄÊµãÔºåÂÖÅËÆ∏Ëá™Âä®ÈáçÈóÆ„ÄÇ*ÈùûÈ¶ñÊ¨°ÔºåÊòØ‰∏çÂÖÅËÆ∏ÈáçÈóÆÁöÑÔºåÂá∫ÈîôËØ¥ÊòékeyÂá∫ÈóÆÈ¢òÔºåÈúÄË¶ÅÂëäÁü•Áî®Êà∑keyÁä∂ÊÄÅÂá∫Áé∞ÂèòÂä®
						autoRetry_errortype = 'FirstCheckedKey_401';
						autoRetry_bottomnotifCN = 'ÂÖ®Êñ∞Key - ÂØÜÈí•Êó†ÊïàÔºåËá™Âä®ÈáçÂèë‰∏≠...';
						autoRetry_bottomnotifEN = 'New Key - API Key error, automatically retrying...';
					}
				}else if( error.message &&  error.message.includes('429')){
				// OpenAI 429 x 5   *v7.05 Êñ∞Â¢û‚Äú429-5‚Äù
					if ( responseMessage.includes('Rate limit reached for') && responseType == 'requests' ){
					// 429-1 ËØ∑Ê±ÇËøáÂø´(È¢ëÁéáËøáÂø´) Rate limit (requests)  *ÂÖçË¥π:3Ê¨°/ÂàÜÈíü 200Ê¨°/Â§©   ‰ªòË¥πÂºÄÈÄö48Â∞èÊó∂ÂÜÖ:60Ê¨°/ÂàÜÈíü 2000Ê¨°/Â§©  ‰ªòË¥πÂºÄÈÄö48Â∞èÊó∂Âêé:3500Ê¨°/ÂàÜÈíü
						notif_cn = 'ËØ∑Ê±ÇËøá‰∫éÈ¢ëÁπÅÔºåAPIÈÄüÁéáÈôêÂà∂Â∑≤Ëææ‰∏äÈôêÔºåÁü≠Êó∂Èó¥ÂÜÖÊèê‰∫§‰∫ÜËøáÂ§öÁöÑËØ∑Ê±ÇÔºåË∂ÖÂá∫ÂÖÅËÆ∏ÁöÑËØ∑Ê±ÇÊï∞Èáè„ÄÇ';
						notif_en = 'The API rate limit has been reached, possibly due to submitting too many requests in a short period of time, exceeding the allowed number of requests.';
						// https://platform.openai.com/docs/guides/rate-limits/overview
						if ( responseMessage.includes('Limit: 3 / min') ){ //ÂÖçË¥πÊØèÂàÜÈíü3Ê¨°
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ ÁõÆÂâçÔºåOpenAI ÂÖçË¥πË¥¶Âè∑ÁöÑ API Key ÈôêÂà∂ÊØèÂàÜÈíüÊúÄÂ§ö 3 Ê¨°ËØ∑Ê±Ç„ÄÇÂÆûÈôÖ‰ΩøÁî®Êó∂ÔºåAPI Key Ë∂ÖËøá 1 ÂàÜÈíüÊ≤°ÊúâÂèëËµ∑‰ªª‰ΩïËØ∑Ê±ÇÔºåÈÇ£‰πà‰∏ãÊ¨°‰ΩøÁî®Êó∂ÔºåËøûÂèë 3 Ê¨°ËØ∑Ê±ÇÂ∞Ü‰∏çÂèóÈôêÂà∂Ôºå3 Ê¨°ÂêéËøûÁª≠ÁöÑÂø´ÈÄüÁöÑËØ∑Ê±Ç‰ºöÊúâ 20 ÁßíÁöÑÈôêÂà∂„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇÂêåÁêÜÔºå‚ÄúË∂ÖËøá 1 ÂàÜÈíüÊ≤°ÊúâÂèëËµ∑‰ªª‰ΩïËØ∑Ê±Ç‚ÄùËøô‰∏™Êù°‰ª∂‰πüÊòØÊåáÂêå‰∏ÄË¥¶Âè∑ÁöÑÊâÄÊúâ API Key ÂùáÊú™ÂèëËøáËØ∑Ê±Ç„ÄÇ";
							notif_en = notif_en + "\r\n\r\n  ‚Ä¢ For free accounts, OpenAI allows a maximum of 3 API calls per minute (this limit is shared among multiple API keys under the same account). If an API key under the same account remains inactive for more than 1 minute, the next 3 consecutive requests will be unrestricted. However, after the 3rd request, there will be a 20-second limit on consecutive rapid requests.";
						} else if ( responseMessage.includes('Limit: 60 / min') ){ //‰ªòË¥πË¥¶Âè∑(48Â∞èÊó∂ÂÜÖ)ÊØèÂàÜÈíü60Ê¨°
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ ÁõÆÂâçÔºåOpenAI ‰ªòË¥πË¥¶Âè∑ (ÂºÄÈÄö48Â∞èÊó∂ÂÜÖ) ÁöÑ API Key ÈôêÂà∂ÊØèÂàÜÈíüÊúÄÂ§ö 60 Ê¨°ËØ∑Ê±ÇÔºàGPT3.5Ê®°ÂûãÔºâ„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 3500 / min') ){ //‰ªòË¥πË¥¶Âè∑(48Â∞èÊó∂‰πãÂêé)ÊØèÂàÜÈíü60Ê¨°
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ ÁõÆÂâçÔºåOpenAI ‰ªòË¥πË¥¶Âè∑ (ÂºÄÈÄö48Â∞èÊó∂Âêé) ÁöÑ API Key ÈôêÂà∂ÊØèÂàÜÈíüÊúÄÂ§ö 3500 Ê¨°ËØ∑Ê±ÇÔºàGPT3.5Ê®°ÂûãÔºâ„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 200 / min') ){
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ ÂΩìÂâç GPT-4 Ê®°ÂûãÈôêÂà∂ÊØèÂàÜÈíüÊúÄÂ§ö 200 Ê¨°ËØ∑Ê±Ç„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 400 / min') ){
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ ÂΩìÂâç GPT-4 Ê®°ÂûãÈôêÂà∂ÊØèÂàÜÈíüÊúÄÂ§ö 400 Ê¨°ËØ∑Ê±Ç„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 1000 / min') ){
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ ÂΩìÂâç GPT-4 Ê®°ÂûãÈôêÂà∂ÊØèÂàÜÈíüÊúÄÂ§ö 1000 Ê¨°ËØ∑Ê±Ç„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 200 / day') ){ //ÂÖçË¥πË¥¶Âè∑ ÊØèÂ§©200Ê¨°‰∏äÈôê
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ ÁõÆÂâçÔºåOpenAI ÁöÑÂÖçË¥πË¥¶Âè∑ÈôêÂà∂ API ÊØèÂ§©ÊúÄÂ§ö 200 Ê¨°ËØ∑Ê±ÇÔºàGPT3.5Ê®°ÂûãÔºâ,‰πãÂêéÊØèÈöî 7ÂàÜ12Áßí ÊÅ¢Â§ç 1 Ê¨°ËØ∑Ê±ÇÈ¢ùÂ∫¶„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ ÂÆòÊñπÁÆóÊ≥ïÔºö24Â∞èÊó∂ √∑ 200Ê¨° = 7ÂàÜ12Áßí/Ê¨°";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 2000 / day') ){ //‰ªòË¥πË¥¶Âè∑(ÂºÄÈÄö48Â∞èÊó∂ÂÜÖ) ÊØèÂ§©2000Ê¨°‰∏äÈôê„ÄÇ48Â∞èÊó∂ÂêéÔºåÂè™ÊúâÊØèÂàÜÈíüÁöÑ‰∏äÈôêÈôêÂà∂ÔºåÊ≤°ÊúâÊØèÂ§©ÁöÑ‰∏äÈôêÈôêÂà∂„ÄÇ
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ ÁõÆÂâçÔºåOpenAI ÁöÑ‰ªòË¥πË¥¶Âè∑ (ÂºÄÈÄö48Â∞èÊó∂ÂÜÖ) ÈôêÂà∂ API ÊØèÂ§©ÊúÄÂ§ö 2000 Ê¨°ËØ∑Ê±ÇÔºàGPT3.5Ê®°ÂûãÔºâ,‰πãÂêéÂ∫îËØ•ÊòØÊØèÈöîÁ∫¶ 43 ÁßíÊÅ¢Â§ç 1 Ê¨°ËØ∑Ê±ÇÈ¢ùÂ∫¶ÔºàÂÖ∑‰ΩìÊÉÖÂÜµËØ∑Êü•Áúã [APIÈîôËØØ‰ø°ÊÅØ]Ôºâ„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						}
						notif_cn += '\r\n  ‚Ä¢ ÂΩìÂâç API Key : ' + this.api ;
						notif_en += '\r\n  ‚Ä¢ The current API Key : ' + this.api ;
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 429 ËØ∑Ê±ÇÈÄüÂ∫¶ËøáÂø´' : 'Error - 429 Rate limit reached for requests';
						if(responseMessage.includes('Limit: 200 / day')){ //ÂÖçË¥πË¥¶Âè∑ËææÂà∞ÊØèÂ§©ÁöÑ‰∏äÈôêÂêéÔºånexttimeÈúÄË¶ÅÂä†7ÂàÜ12Áßí Ôºà‰∏çËÄÉËôëÂàöÂºÄÈÄö48Â∞èÊó∂ÁöÑ‰ªòË¥πË¥¶Âè∑Ôºâ
							apidata_errorState ='429-1-day';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
						}else{
							apidata_errorState ='429-1';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
						}
						if( !this.isThirdPartyAPIKeyEnabled){ //Á¨¨‰∏âÊñπ‰∏∫ÂçïKeyÊ®°ÂºèÔºåÊ≠§Êó∂‰∏çÈúÄË¶ÅÈáçÈóÆ
							autoRetry_errortype = '429-1'; //ÊâÄÊúâÊÉÖÂÜµÔºåÂùáÂÖÅËÆ∏Ëá™Âä®ËΩÆËØ¢ÈáçÈóÆ
							autoRetry_bottomnotifCN = 'ËØ∑Ê±ÇËøá‰∫éÈ¢ëÁπÅÔºåAPIÈÄüÁéáÈôêÂà∂Â∑≤Ëææ‰∏äÈôêÔºåËá™Âä®ÈáçÂèë‰∏≠...';
							autoRetry_bottomnotifEN = 'The API rate limit has been reached for requests, automatically retrying...';
						}
						//Smart max_tokens/Êô∫ËÉΩmax_tokensÂØºËá¥ÈîôËØØÊó∂ÔºåËá™Âä®‰øÆÂ§ç Âπ∂Ëá™Âä®ÈáçÈóÆÔºåÊ≠§Êó∂ËøûÁª≠‰∏§Ê¨°ËØ∑Ê±ÇÔºàÂá∫Èîô+Á´ãÈ©¨ÈáçÈóÆÔºâÂæàÂÆπÊòì429 ËØ∑Ê±ÇËøáÂø´ Rate limit„ÄÇÊâÄ‰ª•ÔºåËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÊúâ‰∏§‰∏™ÂºπÁ™óÔºå429ÂÅö‰∏∫Á¨¨‰∫å‰∏™ÂºπÁ™óÔºåÈúÄË¶ÅÂª∂ËøüÂºπÂá∫„ÄÇ
						//1 Âà§Êñ≠‰æùÊçÆÔºöthis.isFixingMaxTokens_SmartMaxTokens   2 Âè™Âª∂Ëøü‰∏ÄÊ¨°Ôºå‰πãÂêéÊâãÂä®ÁÇπÂáªÈáçÈóÆÔºåÂÜçÊ¨°429Êä•ÈîôÊó∂‰∏çÂª∂ËøüÔºö this.isFirstRetry_SmartMaxTokens
						delaytime = this.isFixingMaxTokens_SmartMaxTokens && this.isFirstRetry_SmartMaxTokens ? 5000 : delaytime; 
						this.isFirstRetry_SmartMaxTokens = false;
					} else if ( responseMessage.includes('You exceeded your current quota') || responseType == 'insufficient_quota' ){
					// 429-2 Ë∂ÖÂá∫ÈÖçÈ¢ù Insufficient quota 
						notif_cn = 'Ë∂ÖÂá∫ÈÖçÈ¢ùÔºåË¥¶Âè∑Â∑≤Êó†È¢ùÂ∫¶„ÄÇ‰æãÂ¶ÇÔºöÂÖçË¥πË¥¶Âè∑Ë∂ÖÈ¢ùÊàñÂà∞Êúü„ÄÅË¥¶Âè∑ËææÂà∞ÊúàÂ∫¶ÊúÄÂ§ßÊîØÂá∫ÈôêÂà∂„ÄÅË¥¶Âè∑ËææÂà∞ËÆæÂÆöÁöÑÂë®ÊúüÈôêÂà∂...';
						notif_en = 'Exceeding current quota, such as reaching maximum monthly spend, exceeding free plan limits, or reaching expiration.';
						notif_cn += '\r\n\r\n  ‚Ä¢ ÂΩìÂâç API Key : ' + this.api ;
						notif_en += '\r\n\r\n  ‚Ä¢ The current API Key : ' + this.api ;
						if(this.isSendingNow_ForSmartMaxTokens === true){ 
							notif_cn += "\r\n  ‚Ä¢ ÂΩì API Key È¶ñÊ¨°Âá∫Áé∞ÈÖçÈ¢ù‰∏çË∂≥Êó∂ÔºåÂ∞Ü‰∏≠Ê≠¢ [Ëá™Âä®ÈáçÈóÆ] Âπ∂ÊòæÁ§∫Êú¨ÈÄöÁü•„ÄÇÊÇ®ÂèØ‰ª•ÂÖ≥Èó≠Êú¨ÈÄöÁü•ÂêéÊâãÂä®ÈáçÂèëËØ∑Ê±Ç‰ª•ÁªßÁª≠ËÅäÂ§©„ÄÇ";
							notif_en += "\r\n  ‚Ä¢ When the API Key first encounters insufficient quota, it will abort [Auto-Retry] and display this notification. ";
						}else if(this.isSendingNow_ForSmartMaxTokens === false && !this.isThirdPartyAPIKeyEnabled){ //Â¶ÇÊûúÊòØÈ™åËØÅAPI key
						//ÂÄüÁî®isSendingNow_ForSmartMaxTokensÔºåÂ¶ÇÊûú‰∏∫falseÔºåË°®Á§∫ÂΩìÂâçÊòØ[È™åËØÅAPI Key]Êó∂Âá∫Èîô,ËÄå‰∏çÊòØ[ÂèëÈÄÅ]Êó∂Âá∫Èîô„ÄÇ [Check API Key]Âá∫ÈîôÊó∂ÈúÄË¶ÅÊèêÈÜí"ËøáÊúükey‰ºöË¢´‰øùÂ≠òÔºåÂèäÂà†Èô§ËøáÊúükeyÁöÑÊñπÂºè"„ÄÇ
							const temp_1 = (this.apiURL.toLowerCase() === this.OpenAI_API_URL || this.apiURL.toLowerCase() === this.OpenaiProxyCom_API_URL) ? (this.settingsLanguage == 'cn' ? ' OpenAI ÂÆòÁΩë' : ' in OpenAI') : '' ;
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Ê≠§ API Key Â∑≤‰øùÂ≠òÔºå‰ΩÜÁî±‰∫éË∂ÖÂá∫ÈÖçÈ¢ùÔºåÁõÆÂâçÊó†Ê≥ï‰ΩøÁî®„ÄÇÂú®" + temp_1 + "‰∏∫ÂÖ∂Áª≠Ë¥πÊàñÂºÄÈÄö‰ªòË¥πÂêéÔºåËØ∑Âú® MCGPT ‰∏≠ÊâãÂä®Êõ¥Êñ∞ÂÖ∂Áä∂ÊÄÅ‰ª•ÊÅ¢Â§çÂèØÁî®„ÄÇÂ¶ÇÊûú‰∏çÂÜç‰ΩøÁî®ËØ• API KeyÔºå‰πüÂèØ‰ª•ÊâãÂä®Âà†Èô§Ôºà‰∏çÂà†Èô§‰πü‰∏ç‰ºöÊúâÂΩ±ÂìçÔºâ„ÄÇ";
							notif_en = notif_en + "\r\n  ‚Ä¢ The API Key has been saved, but it cannot be used due to exceeding the current quota. If you have changed the plan or renewed it" + temp_1 + ", please manually mark it as available in the API key management feature of MCGPT. If you no longer use this API Key, you can also manually delete it (not deleting it will not have any impact).";
							
							//‰ª•‰∏ãÂèÇËÄÉ‚ÄúÈ™åËØÅÊàêÂäü‚ÄùÁöÑ‰ª£Á†ÅÔºåÊâãÂä®Ë∞ÉÊàê‚ÄúÈ™åËØÅÊàêÂäü‚ÄùÁöÑÁä∂ÊÄÅ
							//7.16 ÂéªÈô§‚ÄúÈ™åËØÅÊàêÂäü‚ÄùÂíå‚ÄúÈ™åËØÅÂ§±Ë¥•‚Äù‰∏≠ÁöÑÈáçÂ§ç‰ª£Á†ÅÔºåÂè™ÈúÄË¶Å‰∏§Ë°å‰ª£Á†ÅÂç≥ÂèØ
							if(this.lastAPIKeyInputText_Available === ''){ //Âä†‰∏™Âà§Êñ≠ÔºåÂ¶ÇÊûúÂ≠òÂú®Ôºå‰øùÊåÅ‰∏çÂèò„ÄÇ
								this.lastAPIKeyInputText_Available = ( this.api.startsWith('sk-') && !this.excludeList_ThirdPartyKeyStartWithSK_DomainKeyword.some(char => this.apiURL.toLowerCase().includes(char)) ) ? this.api : '';//Êõ¥Êñ∞ÊúÄÂêé‰∏ÄÊ¨°ËæìÂÖ•Ê°Ü‰∏≠ÁöÑkeyÔºåÊàêÂäüÁöÑ 
							}
							this.changeButtonDisabledState(false);//ÊîπÂèòÊåâÈíÆÁä∂ÊÄÅ
							
						}
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 429 ÈÖçÈ¢ù‰∏çË∂≥' : 'Error - 429 Insufficient quota';
						apidata_errorState ='429-2';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
						
						//ÂΩìÂâçÊòØÊñ∞KeyÔºåÈÅáÂà∞ÈîôËØØÂÖÅËÆ∏Ëá™Âä®ÈáçÈóÆÔºåËá™Âä®È™åËØÅ‰∏ã‰∏Ä‰∏™Êñ∞ÁöÑkey(Â¶ÇÊûúÂ≠òÂú®)
						if(isKeyNew_From_Import_or_BulkAdd && !this.isThirdPartyAPIKeyEnabled){ //È¶ñÊ¨°Ê£ÄÊµãÔºåÂÖÅËÆ∏Ëá™Âä®ÈáçÈóÆ„ÄÇ*ÈùûÈ¶ñÊ¨°ÔºåÊòØ‰∏çÂÖÅËÆ∏ÈáçÈóÆÁöÑÔºåÂá∫ÈîôËØ¥ÊòékeyÂá∫ÈóÆÈ¢òÔºåÈúÄË¶ÅÂëäÁü•Áî®Êà∑keyÁä∂ÊÄÅÂá∫Áé∞ÂèòÂä®
							autoRetry_errortype = 'FirstCheckedKey_429-2';
							autoRetry_bottomnotifCN = 'ÂÖ®Êñ∞Key - ÈÖçÈ¢ù‰∏çË∂≥ÔºåËá™Âä®ÈáçÂèë‰∏≠...';
							autoRetry_bottomnotifEN = 'New Key - Insufficient quota, automatically retrying...';
						}
					} else if ( responseMessage.includes('The engine is currently overloaded') ){
					// 429-3 ÊúçÂä°Âô®ËøáËΩΩ Servers overloaded 
						notif_cn = 'ÊúçÂä°Âô®Ê≠£Âú®Èù¢‰∏¥ÁùÄÈ´òÊµÅÈáèËÆøÈóÆÔºåÊàñÊ≠£Âú®Áª¥Êä§Êõ¥Êñ∞ÔºåÂΩìÂâçÁπÅÂøôÔºåÊó†Ê≥ïÂ§ÑÁêÜËØ∑Ê±Ç„ÄÇËØ∑Á®çÁ≠âÁâáÂàªÂêéÈáçËØï„ÄÇ';
						notif_en = 'Servers are experiencing high traffic and are unable to process your request at the moment. Please retry your requests after a brief wait.';
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 429 ÊúçÂä°Âô®ËøáËΩΩ' : 'Error - 429 Servers overloaded';
						apidata_errorState ='429-3';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
						autoRetry_errortype = '429-3';
						autoRetry_bottomnotifCN = 'ÊúçÂä°Âô®ËøáËΩΩÔºåËá™Âä®ÈáçÂèë‰∏≠...';
						autoRetry_bottomnotifEN = 'Servers overloadedÔºåautomatically retrying...';
					} else if ( responseMessage.includes('That model is currently overloaded with other requests') ){
					// 429-4 Ê®°ÂûãË∂ÖËΩΩ  Model overloaded  tips: responseType = server_error
						notif_cn = 'ËØ•Ê®°ÂûãÂΩìÂâçÂ∑≤ÁªèË∂ÖËΩΩÔºåËØ∑Á®çÁ≠âÁâáÂàªÂêéÈáçËØï„ÄÇ';
						notif_en = 'That model is currently overloaded with other requests. Please retry your requests after a brief wait.';
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 429 Ê®°ÂûãË∂ÖËΩΩ' : 'Error - 429 Model overloaded';
						apidata_errorState ='429-4';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
						autoRetry_errortype = '429-4';
						autoRetry_bottomnotifCN = 'Ê®°ÂûãË∂ÖËΩΩÔºåËá™Âä®ÈáçÂèë‰∏≠...';
						autoRetry_bottomnotifEN = 'Model overloadedÔºåautomatically retrying...';
					} else if ( responseMessage.includes('Rate limit reached for') && responseType == 'tokens' ){
					// 429-5 ËØ∑Ê±ÇËøáÂø´(‰ª§ÁâåtokensËøáÂø´ ÊØèÂàÜÈíü) Rate limit (tokens)   *v7.05 add
						notif_cn = '‰ª§ÁâåÔºàtokensÔºâËØ∑Ê±ÇËøá‰∫éÈ¢ëÁπÅÔºåAPIÈÄüÁéáÈôêÂà∂Â∑≤Ëææ‰∏äÈôêÔºåÁü≠Êó∂Èó¥ÂÜÖÊèê‰∫§‰∫ÜËøáÂ§öÁöÑ‰ª§ÁâåÔºàtokensÔºâÔºåË∂ÖÂá∫ÂÖÅËÆ∏ÁöÑËØ∑Ê±ÇÊï∞Èáè„ÄÇ';
						notif_en = 'The API rate limit has been reached, possibly due to submitting too many tokens in a short period of time, exceeding the allowed number of requests.';
						// https://platform.openai.com/docs/guides/rate-limits/overview
						if ( responseMessage.includes('Limit: 40000 / min') ){
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ OpenAI ÁöÑÂÖçË¥πË¥¶Âè∑ÈôêÂà∂ API ÊØèÂàÜÈíüÊúÄÂ§ö 40000 ‰ª§ÁâåÔºàGPT3.5Ê®°ÂûãÔºâÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 60000 / min') ){
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ OpenAI ÁöÑ‰ªòË¥πË¥¶Âè∑ (ÂºÄÈÄö48Â∞èÊó∂ÂÜÖ) ÈôêÂà∂ API ÊØèÂàÜÈíüÊúÄÂ§ö 60000 ‰ª§ÁâåÔºàÂΩìÂâçGPT3.5Ê®°ÂûãÔºâÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 90000 / min') ){
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ OpenAI ÁöÑ‰ªòË¥πË¥¶Âè∑ (ÂºÄÈÄö48Â∞èÊó∂Âêé) ÈôêÂà∂ API ÊØèÂàÜÈíüÊúÄÂ§ö 90000 ‰ª§ÁâåÔºàÂΩìÂâçGPT3.5Ê®°ÂûãÔºâÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 120000 / min') ){
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ OpenAI ÁöÑ‰ªòË¥πË¥¶Âè∑ (ÂºÄÈÄö48Â∞èÊó∂ÂÜÖ) ÈôêÂà∂ API ÊØèÂàÜÈíüÊúÄÂ§ö 120000 ‰ª§ÁâåÔºàÂΩìÂâçGPT3.5Ê®°ÂûãÔºâÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 180000 / min') ){
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ OpenAI ÁöÑ‰ªòË¥πË¥¶Âè∑ (ÂºÄÈÄö48Â∞èÊó∂Âêé) ÈôêÂà∂ API ÊØèÂàÜÈíüÊúÄÂ§ö 180000 ‰ª§ÁâåÔºàÂΩìÂâçGPT3.5Ê®°ÂûãÔºâÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 40000 / min') ){
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ ÂΩìÂâç GPT-4 Ê®°ÂûãÈôêÂà∂ API ÊØèÂàÜÈíüÊúÄÂ§ö 40000 ‰ª§ÁâåÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 80000 / min') ){
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ ÂΩìÂâç GPT-4 Ê®°ÂûãÈôêÂà∂ API ÊØèÂàÜÈíüÊúÄÂ§ö 80000 ‰ª§ÁâåÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						} else if ( responseMessage.includes('Limit: 150000 / min') ){
							notif_cn = notif_cn + "\r\n\r\n  ‚Ä¢ ÂΩìÂâç GPT-4 Ê®°ÂûãÈôêÂà∂ API ÊØèÂàÜÈíüÊúÄÂ§ö 150000 ‰ª§ÁâåÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇ";
							notif_cn = notif_cn + "\r\n  ‚Ä¢ Âêå‰∏ÄË¥¶Âè∑‰∏ãÁöÑÂ§ö‰∏™ API Key ‰ºöÂÖ±‰∫´ÈôêÂà∂„ÄÇ";
						}
						notif_cn += '\r\n  ‚Ä¢ ÂΩìÂâç API Key : ' + this.api ;
						notif_en += '\r\n\r\n  ‚Ä¢ The current API Key : ' + this.api ;
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 429 ‰ª§ÁâåÔºàtokensÔºâÁöÑËØ∑Ê±ÇÈÄüÂ∫¶ËøáÂø´' : 'Error - 429 Rate limit reached for tokens';
						apidata_errorState ='429-5';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
						if( !this.isThirdPartyAPIKeyEnabled){ //Á¨¨‰∏âÊñπ‰∏∫ÂçïKeyÊ®°ÂºèÔºåÊ≠§Êó∂‰∏çÈúÄË¶ÅÈáçÈóÆ
							autoRetry_errortype = '429-5';
							autoRetry_bottomnotifCN = 'ËØ∑Ê±ÇËøá‰∫éÈ¢ëÁπÅÔºå‰ª§Áâå (tokens) ÁöÑAPIÈÄüÁéáÈôêÂà∂Â∑≤Ëææ‰∏äÈôêÔºåËá™Âä®ÈáçÂèë‰∏≠...';
							autoRetry_bottomnotifEN = 'The API rate limit has been reached for tokens, automatically retrying...';
						}
						
						// 429-1‰∏≠Êô∫ËÉΩmax_tokensÁöÑ‰ª£Á†Å *‰∏çËÄÉËôëÔºåÂá†ÁéáÂ∞è
					} else {
					// 429-other ÂÖ∂‰ªñÊú™Áü• 
						notif_cn = 'HTTPËØ∑Ê±Ç - ÈîôËØØ‰ª£Á†Å:  ' + error.code + '\r\nHTTPËØ∑Ê±Ç - ÈîôËØØ‰ø°ÊÅØ:  ' + error.message;
						notif_en = 'HTTP Error Code:  ' + error.code + '\r\nHTTP Error Message:  ' + error.message;
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 429 ÂÖ∂‰ªñ' : 'Error - 429 Other';
						apidata_errorState ='429-other';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
					}
				}else if ( error.message &&  error.message.includes('404')){
				// OpenAI 404 ÈùûÁªÑÁªáÊàêÂëò Account is not part of an organization
					if(this.apiURL.toLowerCase() === this.OpenAI_API_URL || this.apiURL.toLowerCase() === this.OpenaiProxyCom_API_URL){ //OpenAI
						notif_cn = 'ÂøÖÈ°ªÊòØÁªÑÁªáÁöÑÊàêÂëòÊâçËÉΩ‰ΩøÁî®APIÔºåËÄåÂΩìÂâçË¥¶Âè∑‰∏çÂ±û‰∫é‰ªª‰ΩïÁªÑÁªá„ÄÇOpenAIÂÆòÊñπËß£ÈáäÔºöhttps://help.openai.com/en/articles/6891827-error-code-404-you-must-be-a-member-of-an-organization-to-use-the-api ';
						notif_en = 'To use the API, you must be a member of an organization, and your current account is not part of an organization. OpenAI API Error Codes Explained: https://help.openai.com/en/articles/6891827-error-code-404-you-must-be-a-member-of-an-organization-to-use-the-api ';
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 404 Ë¥¶Âè∑‰∏çÂ±û‰∫é‰ªª‰ΩïÁªÑÁªá' : 'Error - 404 Account is not part of an organization';
					}else{
						notif_cn = 'ËØ∑ÂèÇÈòÖ‰∏ãÊñπÁöÑ API ÈîôËØØ‰ø°ÊÅØ (‰ª• [APIÈîôËØØ‰ø°ÊÅØ] ÁöÑÂÜÖÂÆπ‰∏∫ÂáÜ)„ÄÇ';
						notif_en = 'Please refer to the API Error Message below.';
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 404 ÂÖ∂‰ªñ' : 'Error - 404 Other';
					}
					
					if ( responseMessage.includes('does not exist') || responseCode === 'model_not_found'  ){ //OpenAI
						notif_cn = 'Ê®°Âûã ' + this.apiGPTModel + ' ‰∏çÂ≠òÂú®ÊàñËÄÖÊÇ®Ê≤°ÊúâËÆøÈóÆÊùÉÈôêÔºåËØ∑Êõ¥Êç¢‰∏Ä‰∏™Êã•ÊúâÊùÉÈôêÁöÑ API KeyÔºåÊàñÊõ¥Êç¢Ê®°ÂûãÂêéÂÜçÊ¨°Â∞ùËØï„ÄÇ';
						notif_en = 'The model ' + this.apiGPTModel + ' does not exist or you do not have access to it. Please use an API Key with proper permissions or try switching to a different model and try again.';
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 404 Ê®°Âûã‰∏çÂ≠òÂú® / Êó†ËÆøÈóÆÊùÉÈôê' : 'Error - 404 Model Not Found / Access Denied';
						if(this.apiGPTModel.includes('gpt-4')){
							notif_cn += '\r\n\r\n  ‚Ä¢ GPT-4 Ê®°Âûã‰ªÖÂØπ‰ªòË¥πAPIÁî®Êà∑ÂºÄÊîæÔºåËØ∑‰ΩøÁî®ÂÖ∑Â§á GPT-4 ÊùÉÈôêÁöÑ API Key„ÄÇÂ¶ÇÊûúÊÇ®ÂΩìÂâçÁöÑ API Key Â∑≤ÁªèÂÖ∑Â§á GPT-4 ÊùÉÈôêÔºåËØ∑Â∞ùËØïÂàáÊç¢ÂÖ∂‰ªñ GPT-4 Ê®°Âûã„ÄÇ';
							if( !this.isThirdPartyAPIKeyEnabled ){ 
								notif_cn += '\r\n  ‚Ä¢ Â¶ÇÊûúÊÇ®Ê≤°ÊúâÊîØÊåÅ GPT-4 ÁöÑ API KeyÔºåËØ∑‰∏çË¶ÅÈÄâÊã© GPT-4 Ê®°ÂûãËøõË°åÂèçÂ§çËØ∑Ê±Ç„ÄÇMCGPT Ê≤°ÊúâÂØπÊ≠§ËøõË°åÈôêÂà∂Ôºå‰ΩÜ‰∏çÂª∫ËÆÆËøôÊ†∑ÂÅö„ÄÇ';
								notif_en += '\r\n\r\n  ‚Ä¢ If you do not have an API Key that supports GPT-4, please refrain from selecting the GPT-4 model for repetitive requests. MCGPT does not have restrictions on this, but it is not recommended to do so.';
							}
						}
						if( this.isThirdPartyAPIKeyEnabled){ // ÊîØÊåÅOpenAI KeyÁöÑÁ¨¨‰∏âÊñπ
							notif_cn += '\r\n  ‚Ä¢ Êúâ‰∫õÁ¨¨‰∏âÊñπÂπ≥Âè∞Âè™ÊîØÊåÅÈÉ®ÂàÜÊ®°ÂûãÔºåÂª∫ËÆÆÊü•ÈòÖÁ¨¨‰∏âÊñπÊé•Âè£Âπ≥Âè∞ÁöÑÊñáÊ°£„ÄÇ';
						}
					}
					notif_cn += '\r\n  ‚Ä¢ ÂΩìÂâç API Key : ' + this.api ;
					notif_en += '\r\n  ‚Ä¢ The current API Key : ' + this.api ;
					
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI ÈÄöÁî® *modelÊó†Êïà  
					if ( responseMessage.toLowerCase().includes("model is not available") ) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ÂΩìÂâçÊ®°Âûã (model: ' + this.apiGPTModel + ') ‰∏çÂèØÁî®ÔºåËØ∑Êõ¥Êç¢Ê®°Âûã (model) „ÄÇ';
						notif_en = 'Please refer to the API Error Message below.';
					}
					
					//v8.11 ÈÄÇÈÖçÊûÅÂ∞ëÊï∞Á¨¨‰∏âÊñπÊé•Âè£ 404 = API Key Êó†Êïà ÁöÑÊÉÖÂÜµ  *openaimax
					//v8.11 - Start  ÂåÖÂê´(key)&&(not found)  ||  ÂåÖÂê´(key|ÂØÜÈí•)&&(Êó†Êïà|‰∏çÂ≠òÂú®)
					const bool_temp = ( responseMessage.toLowerCase().includes("key") && responseMessage.toLowerCase().includes("not found") )   ||   ( (responseMessage.toLowerCase().includes("key") || responseMessage.includes("ÂØÜÈí•")) && (responseMessage.includes("Êó†Êïà") || responseMessage.includes("‰∏çÂ≠òÂú®")) ) ;
					if( bool_temp && this.apiURL.toLowerCase() !== this.OpenAI_API_URL && this.apiURL.toLowerCase() !== this.OpenaiProxyCom_API_URL ){
						const temp_2 = (this.apiURL.toLowerCase() === this.OpenAI_API_URL || this.apiURL.toLowerCase() === this.OpenaiProxyCom_API_URL) ? (this.settingsLanguage == 'cn' ? ' OpenAI ' : ' OpenAI ') : (this.settingsLanguage == 'cn' ? ' OpenAI Êàñ Á¨¨‰∏âÊñπÂπ≥Âè∞ ' : ' OpenAI or a Third-party platform ')  ;
						notif_cn = notif_cn + '\r\n\r\nAPI Key Êó†Êïà„ÄÇÂª∫ËÆÆÂ§çÂà∂Á≤òË¥¥ API KeyÔºåÈÅøÂÖçËæìÈîô„ÄÇÂ¶ÇÊûú‰ªçÁÑ∂Âá∫ÈîôÔºåËØ¥ÊòéÊòØÊó†ÊïàÂØÜÈí•ÔºåÊàñÂØÜÈí•Â∑≤Ë¢´ÂÅúÁî®„ÄÅÂà†Èô§ÔºåÂª∫ËÆÆÁôªÂΩï' + temp_2 + 'Êü•Áúã API Key ÊòØÂê¶Âá∫Áé∞ÂèòÂä®„ÄÇ';
						notif_en = notif_en + '\r\n\r\nAPI Key is invalid. It is recommended to copy and paste the API Key to avoid input errors. If the error persists, it indicates an invalid API key or that the API key has been deactivated or deleted, please log in to' + temp_2 + 'to check the API Key.'; 
						//Êõ¥Êñ∞‰ª£Á†Å‰∏∫401
						apidata_errorState ='error-other'; //ÈùûOpenAIÔºåÁ¨¨‰∏âÊñπKey‰∏çÊ†áËÆ∞401Êó†Êïà
					//v8.11 - End
					} else { // else ‰∏∫Ê≠£Â∏∏ÊÉÖÂÜµ‰∏ãÔºåÂéü‰ª£Á†ÅÔºöapidata_errorState ='404'
						apidata_errorState ='404';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
					}
									
					if(isKeyNew_From_Import_or_BulkAdd && !this.isThirdPartyAPIKeyEnabled){ //È¶ñÊ¨°Ê£ÄÊµãÔºåÂÖÅËÆ∏Ëá™Âä®ÈáçÈóÆ„ÄÇ*ÈùûÈ¶ñÊ¨°ÔºåÊòØ‰∏çÂÖÅËÆ∏ÈáçÈóÆÁöÑÔºåÂá∫ÈîôËØ¥ÊòékeyÂá∫ÈóÆÈ¢òÔºåÈúÄË¶ÅÂëäÁü•Áî®Êà∑keyÁä∂ÊÄÅÂá∫Áé∞ÂèòÂä®
						autoRetry_errortype = 'FirstCheckedKey_404';
						autoRetry_bottomnotifCN = 'ÂÖ®Êñ∞Key - KeyÈîôËØØÔºåÈùûÁªÑÁªáÊàêÂëòÔºåËá™Âä®ÈáçÂèë‰∏≠...';
						autoRetry_bottomnotifEN = 'New Key - Error, Account not in organization, automatically retrying...';
						if ( responseMessage.includes('does not exist') || responseCode === 'model_not_found'  ){
							autoRetry_bottomnotifCN = 'ÂÖ®Êñ∞Key - Ê®°Âûã‰∏çÂ≠òÂú®ÊàñÊó†‰ΩøÁî®ÊùÉÈôêÔºåËá™Âä®ÈáçÂèë‰∏≠...';
							autoRetry_bottomnotifEN = 'New Key - Model does not exist or access denied, automatically retrying...';
						}
					}else if (!this.isThirdPartyAPIKeyEnabled && ( responseMessage.includes('does not exist') || responseCode === 'model_not_found' ) ) {
						autoRetry_errortype = 'Model_404';
						autoRetry_bottomnotifCN = 'Ê®°Âûã‰∏çÂ≠òÂú®ÊàñÊó†‰ΩøÁî®ÊùÉÈôêÔºåËá™Âä®ÈáçÂèë‰∏≠...';
						autoRetry_bottomnotifEN = 'Model does not exist or access denied, automatically retrying...';
					}
				}else if( error.message &&  error.message.includes('500')){
				// OpenAI 500 ÊúçÂä°Âô®ÈóÆÈ¢ò Server error
					//v8.11 ÈÄÇÈÖçÊûÅÂ∞ëÊï∞Á¨¨‰∏âÊñπÊé•Âè£ 500 = API Key Êó†Êïà ÁöÑÊÉÖÂÜµ  *ChatGPT Next Web  nextweb.fun
					//v8.11 - Start 
					if( responseMessage.toLowerCase().includes("key") && responseMessage.toLowerCase().includes("ak-")){
						const temp_2 = (this.apiURL.toLowerCase() === this.OpenAI_API_URL || this.apiURL.toLowerCase() === this.OpenaiProxyCom_API_URL) ? (this.settingsLanguage == 'cn' ? ' OpenAI ' : ' OpenAI ') : (this.settingsLanguage == 'cn' ? ' OpenAI Êàñ Á¨¨‰∏âÊñπÂπ≥Âè∞ ' : ' OpenAI or a Third-party platform ')  ;
						notif_cn = 'API Key Êó†Êïà„ÄÇÂª∫ËÆÆÂ§çÂà∂Á≤òË¥¥ API KeyÔºåÈÅøÂÖçËæìÈîô„ÄÇÂ¶ÇÊûú‰ªçÁÑ∂Âá∫ÈîôÔºåËØ¥ÊòéÊòØÊó†ÊïàÂØÜÈí•ÔºåÊàñÂØÜÈí•Â∑≤Ë¢´ÂÅúÁî®„ÄÅÂà†Èô§ÔºåÂª∫ËÆÆÁôªÂΩï' + temp_2 + 'Êü•Áúã API Key ÊòØÂê¶Âá∫Áé∞ÂèòÂä®„ÄÇ';
						notif_en = 'API Key is invalid. It is recommended to copy and paste the API Key to avoid input errors. If the error persists, it indicates an invalid API key or that the API key has been deactivated or deleted, please log in to' + temp_2 + 'to check the API Key.'; 
						
						notif_cn += '\r\n\r\n  ‚Ä¢ ÂΩìÂâç API Key : ' + this.api ;
						notif_en += '\r\n\r\n  ‚Ä¢ The current API Key : ' + this.api ;
						
						notif_cn += '\r\n  ‚Ä¢ ËØ∑ÂèÇÈòÖ‰∏ãÊñπÁöÑ API ÈîôËØØ‰ø°ÊÅØ„ÄÇ';
						notif_en += '\r\n  ‚Ä¢ Please refer to the API Error Message below.';
						
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 500 ÂÖ∂‰ªñ' : 'Error - 500 Other';
						//Êõ¥Êñ∞‰ª£Á†Å‰∏∫401
						apidata_errorState ='error-other'; //ÈùûOpenAIÔºåÁ¨¨‰∏âÊñπKey‰∏çÊ†áËÆ∞401Êó†Êïà
					//v8.11 - End
					}else{
					// OpenAI 500 ÊúçÂä°Âô®ÈóÆÈ¢ò Server error Ê∫ê‰ª£Á†Å
						notif_cn = 'ÊúçÂä°Âô®Âú®Â§ÑÁêÜÊÇ®ÁöÑËØ∑Ê±ÇÊó∂Âá∫Áé∞ÈîôËØØÔºåÊòØÊúçÂä°Âô®ÁöÑÈóÆÈ¢òÔºåËØ∑Á®çÁ≠âÁâáÂàªÂêéÈáçËØï„ÄÇ';
						notif_en = 'The server had an error while processing your request. Issue on OpenAI servers, please retry your requests after a brief wait.';
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 500 ÊúçÂä°Âô®Âú®Â§ÑÁêÜËØ∑Ê±ÇÊó∂Âá∫Èîô' : 'Error - 500 Server error while processing request';
						apidata_errorState ='500';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
						autoRetry_errortype = '500';
						autoRetry_bottomnotifCN = 'ÊúçÂä°Âô®Âú®Â§ÑÁêÜËØ∑Ê±ÇÊó∂Âá∫ÈîôÔºåËá™Âä®ÈáçÂèë‰∏≠...';
						autoRetry_bottomnotifEN = 'Server error while processing requestÔºåautomatically retrying...';
					}
				}else if( error.message &&  error.message.includes('503') && responseMessage.includes('That model is currently overloaded with other requests')){
				// OpenAI 503 - 1 ÊúçÂä°Âô®ÈóÆÈ¢ò
					notif_cn = 'ËØ•Ê®°ÂûãÂΩìÂâçÂ∑≤ÁªèË∂ÖËΩΩÔºåÊÇ®ÂèØ‰ª•ÈáçÊñ∞Â∞ùËØï‰∏ãËØ∑Ê±Ç„ÄÇ';
					notif_en = 'That model is currently overloaded with other requests. You can retry your request.';
					title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 503 Ê®°ÂûãË∂ÖËΩΩ' : 'Error - 503 Model overloaded';
					apidata_errorState ='503';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
					autoRetry_errortype = '503';
					autoRetry_bottomnotifCN = 'Ê®°ÂûãË∂ÖËΩΩÔºåËá™Âä®ÈáçÂèë‰∏≠...';
					autoRetry_bottomnotifEN = 'Model overloadedÔºåautomatically retrying...';
				}else if( error.message &&  error.message.includes('503') && responseMessage.includes('The server had an error while processing your request')){
				// OpenAI 503 - 2 ÊúçÂä°Âô®ÈóÆÈ¢ò  //type: server_error
					notif_cn = 'ÊúçÂä°Âô®Âú®Â§ÑÁêÜÊÇ®ÁöÑËØ∑Ê±ÇÊó∂ÂèëÁîü‰∫ÜÈîôËØØÔºåÊÇ®ÂèØ‰ª•ÈáçÊñ∞Â∞ùËØï‰∏ãËØ∑Ê±Ç„ÄÇ';
					notif_en = 'The server had an error while processing your request. You can retry your request.';
					title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 503 ÊúçÂä°Âô®Âú®Â§ÑÁêÜËØ∑Ê±ÇÊó∂Âá∫Èîô' : 'Error - 503 Server error while processing request';
					apidata_errorState ='503';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
					autoRetry_errortype = '503';
					autoRetry_bottomnotifCN = 'ÊúçÂä°Âô®Âú®Â§ÑÁêÜËØ∑Ê±ÇÊó∂Âá∫ÈîôÔºåËá™Âä®ÈáçÂèë‰∏≠...';
					autoRetry_bottomnotifEN = 'Server error while processing requestÔºåautomatically retrying...';
				}else if ( error.message && error.message.includes('400') && responseMessage.includes('Please reduce the length of the messages' )){
				// OpenAI 400 
					//20230606 ÈÄÇÈÖçGPT3.5ÂÖçË¥πËÆ°ÂàíÔºåÂÖ∂‰ªñÁ±ª‰ººË¥¶Âè∑ÁöÑÊÉÖÂÜµÊú™Áü•„ÄÇ Adapted for the free plan account of GPT3.5, based on the GPT3.5 free plan.
				
					let tips_cn = '';
					let tips_en = '';
					
					const maxLengthRegex = /maximum context length is (\d+) tokens/;
					const maxLengthMatch = responseMessage.match(maxLengthRegex);
					const maxLength = maxLengthMatch ? maxLengthMatch[1] : null;

					const a_messagesRegex = /messages resulted in (\d+) tokens/;
					const a_messagesMatch = responseMessage.match(a_messagesRegex);
					const a_messagesLength = a_messagesMatch ? a_messagesMatch[1] : null;

					const b_requestedRegex = /requested (\d+) tokens \(/;
					const b_requestedMatch = responseMessage.match(b_requestedRegex);
					const b_requestedLength = b_requestedMatch ? b_requestedMatch[1] : null;

					const b_messagesRegex = /\((\d+) in the messages,/;
					const b_messagesMatch = responseMessage.match(b_messagesRegex);
					const b_messagesLength = b_messagesMatch ? b_messagesMatch[1] : null;

					const b_completionRegex = /, (\d+) in the completion/;
					const b_completionMatch = responseMessage.match(b_completionRegex);
					const b_completionLength = b_completionMatch ? b_completionMatch[1] : null;
						
					if ( maxLength != null && a_messagesLength != null ){
					//ÂèëÈÄÅÂá∫ÁöÑ‰∏ä‰∏ãÊñáË∂ÖÈôêÂà∂
						tips_cn += '\r\n\r\n' ;
						tips_cn += '#A = ÂΩìÂâçÊ®°ÂûãÊîØÊåÅÁöÑÊúÄÂ§ß‰∏ä‰∏ãÊñáÈïøÂ∫¶Ôºö' + maxLength + ' tokens\r\n' ;
						tips_cn += '#B = ÊÇ®ÂΩìÂâçÂèëÈÄÅÁöÑ‰∏ä‰∏ãÊñáÈïøÂ∫¶Ôºö' + a_messagesLength + ' tokens (GPTÁöÑËÆ∞ÂøÜÔºåÂåÖÂê´Êú¨Ê¨°ÂèëÈÄÅÂÜÖÂÆπ)\r\n' ;
						tips_cn += '#C = GPTÂ∞öÊú™ÂõûÂ§çÁöÑÂçïÊù°ÂÜÖÂÆπÈïøÂ∫¶ÔºöÊú™Áü• \r\n' ;
						tips_cn += 'ËßÑÂàôÔºö B + C  < A ( ' + maxLength + ' )\r\n' ;
						tips_cn += '‚òÖ ÂΩìÂâçÔºö‰ªÖ B Â∞±Â∑≤ÁªèË∂ÖËøá ' + maxLength + ' ÔºàË∂ÖÂá∫‰∫Ü ' + ( a_messagesLength - maxLength ) + ' Ôºâ' ;
						if ( !this.isSimpleMode ){
							tips_cn += '\r\n\r\n  ‚Ä¢ tokenÔºöÂçï‰ΩçÔºåÂç≥"‰ª§Áâå"' ;
							tips_cn += '\r\n  ‚Ä¢ ÂΩìÂâç GPT Ê®°Âûã (' + model_data.modelname + ') ÊúÄÈ´òÊîØÊåÅ ' + model_data.maxtokens + '/' + (model_data.maxtokens + 1) + ' tokens' ;
							//completion_tokens(Êú¨Ê¨°ÊèêÈóÆÂÜÖÂÆπÁöÑtokenÊï∞)ÈúÄË¶ÅÁ≠â‰∏ãÊ¨°ÂØπËØùÁªìÊùüÊâçËÉΩËÆ°ÁÆóÂæóÂá∫ÔºàÊèêÈóÆÁöÑtokenÊï∞‰ºöÊØîÂÆûÈôÖÁöÑÈ´òÔºåÁñë‰ººÂÆòÊñπ‰ºöÊ∑ªÂä†ÈöêËóèÁöÑÊèêÁ§∫ËØç„ÄÇÊÑè‰πâÂ§ß‰∏çÔºå‰ªÖÂÅöÂèÇËÄÉÔºâÁªèËøáÊµãËØïÔºå1„ÄÅÂΩìthis.msgContentÂåÖÂê´Á≥ªÁªüÊèêÁ§∫ËØçËøô‰∏ÄÈ°πÊó∂Ôºà[0]ÔºåÂç≥‰Ωø‰∏∫Á©∫ÔºâÔºåÈ¶ñÊù°‰ºöÈ¢ùÂ§ñÂç†Áî® 13 token Ôºõ 2„ÄÅ‰πãÂêéÊØèÊù°ÂèëÈÄÅÁöÑ‰ø°ÊÅØÈ¢ùÂ§ñÂç†Áî® 10 token „ÄÇ
							tips_cn += '\r\n  ‚Ä¢ ‰ª•‰∏ãÂ±û‰∫éÊ≠£Â∏∏Áé∞Ë±°ÔºöÈ¶ñÊù°Ê∂àÊÅØÈ¢ùÂ§ñÂç†Áî® 13 ‰∏™tokenÔºå‰πãÂêéÁöÑÊØèÊù°Ê∂àÊÅØÈÉΩ‰ºöÈ¢ùÂ§ñÂä† 10 ‰∏™token (ÂèëÈÄÅÂè™Êúâ 1 ‰∏™tokenÁöÑÂÜÖÂÆπÔºåÂÆûÈôÖ‰∏ä‰ºöÂç†Áî® 11 ‰∏™token)„ÄÇ(‰∏é‰ª£Á†ÅÂÜôÊ≥ïÊúâ‰∏ÄÂÆöÂÖ≥Á≥ª)' ;
						}
						notif_cn = 'ÂèëÈÄÅÂ§±Ë¥•ÔºåGPTËÆ∞ÂøÜÔºà‰∏ä‰∏ãÊñáÈïøÂ∫¶ÔºâË∂ÖËøá‰∏äÈôê„ÄÇÂÖ≥Èó≠ÈÄöÁü•ÂêéÔºåÊÇ®ÂèØ‰ª•ÈÄâÊã©Ôºö‰øÆÊîπÂèëÈÄÅÂÜÖÂÆπÈïøÂ∫¶„ÄÅÊí§ÈîÄËÅäÂ§©ËÆ∞ÂΩïÁ≠âÊìç‰ΩúÊù•ÁªßÁª≠‰πãÂâçÁöÑÂØπËØù„ÄÇ';
						const autoMaxTokens1_cn = '\r\n\r\n‚òÖ Â∑≤‰∏∫ÊÇ®ÂÖ≥Èó≠"Êô∫ËÉΩmax_tokens"ÂäüËÉΩÔºåËØ∑Ê†πÊçÆ‰∏ãÊñπÁöÑÈîôËØØÊèêÁ§∫‰ø°ÊÅØÊù•‰øÆÊîπÂèëÈÄÅÂÜÖÂÆπÁöÑÈïøÂ∫¶ (ÊàñÈÄöËøá [Êí§ÈîÄ]„ÄÅ[Ê∏ÖÈô§ËÆ∞ÂøÜ] Êù•ÈáäÊîætokens)ÔºåÁÑ∂ÂêéÊâãÂä®Ë∞ÉËäÇ [APIËÆæÁΩÆ] ‰∏≠ÁöÑ [max_tokens] „ÄÇÂæÖÈóÆÈ¢òËß£ÂÜ≥ÂêéÔºå‰∏ãÊ¨°ÂèØÂ∞ùËØïÈáçÊñ∞ÊâìÂºÄËØ•ÂäüËÉΩ„ÄÇ'
						const autoMaxTokens2_cn = '\r\n\r\n‚òÖ ËØ∑Ê†πÊçÆ‰∏ãÊñπÁöÑÈîôËØØÊèêÁ§∫‰ø°ÊÅØÊù•‰øÆÊîπÂèëÈÄÅÂÜÖÂÆπÁöÑÈïøÂ∫¶ (ÊàñÈÄöËøá [Êí§ÈîÄ]„ÄÅ[Ê∏ÖÈô§ËÆ∞ÂøÜ] Êù•ÈáäÊîætokens)ÔºåÁÑ∂ÂêéÊâãÂä®Ë∞ÉËäÇ [APIËÆæÁΩÆ] ‰∏≠ÁöÑ [max_tokens] „ÄÇÊ≥®ÊÑè: ÂΩìÂâçÊó†Ê≥ï‰ΩøÁî®"Êô∫ËÉΩmax_tokens"ÂäüËÉΩÔºåÂΩìÊÇ®Ëß£ÂÜ≥"ÂÜÖÂÆπË∂ÖÈáè"ÈóÆÈ¢òÂêéÔºåÂèØÂ∞ùËØïÈáçÊñ∞ÊâìÂºÄ"Êô∫ËÉΩmax_tokens"ÂäüËÉΩ„ÄÇ'
						notif_cn = this.openSmartMaxTokens ? notif_cn + autoMaxTokens1_cn : notif_cn + autoMaxTokens2_cn;
						notif_cn = notif_cn + tips_cn ;
						
						tips_en += '\r\n\r\n' ;
						tips_en += '  ‚Ä¢ "messages" :  The current length of the context (including the last message sent).' ;
						if ( !this.isSimpleMode ){
							// The tokens for sending messages are higher than the actual count, which is probably because OpenAI adds hidden prompt words. After testing, 1) when the "system prompt"  is included in the context of this.msgContent in the code (this.msgContent[0]), even if the system prompt is empty, the first message will have an extra 13 tokens; 2) each subsequent message will take up an additional 10 tokens.
							tips_en += '\r\n  ‚Ä¢ The following is a normal phenomenon: The first message will occupy an additional 13 tokens, and each subsequent message will add 10 additional tokens (sending content with 1 token will actually occupy 11 tokens). (It is related to the code writing style.)' ;
						}
						notif_en = "Sending failed. The length of the context exceeds the limit. After closing the notification, you can choose to modify the content, or undo to continue.";
						const autoMaxTokens1_en = '\r\n\r\n‚òÖ The "Smart max_tokens" feature has been turned off for you. Please make adjustments (such as modifying the content length) based on the [API Error Message] below, and then manually adjust [API Settings] > [max_tokens] for this request. Once the issue is resolved, you can re-enable this feature for the next request.'
						const autoMaxTokens2_en = '\r\n\r\n‚òÖ Please make adjustments (such as modifying the content length) based on the [API Error Message] below, and then manually adjust [API Settings] > [max_tokens] for this request. (The "Smart max_tokens" feature is currently unavailable. You can try re-enabling it once you have resolved the "content exceeds limit" issue).'
						notif_en = this.openSmartMaxTokens ? notif_en + autoMaxTokens1_en : notif_en + autoMaxTokens2_en;
						notif_en = notif_en + tips_en ;
						
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 400 ËÆ∞ÂøÜËææÂà∞‰∏äÈôê' : 'Error - 400 Context length exceeds the limit';
						
						//Smart max_tokens/Êô∫ËÉΩmax_tokensÂºÄÂêØÊó∂„ÄÇÂºπÁ™óÔºå‰∏§‰∏™ÔºåÂä†‰∏Ä‰∏™Â∫ïÈÉ®ÊèêÁ§∫ÔºåÂª∂ËøüÊòæÁ§∫Êä•ÈîôÂºπÁ™ó
						if (this.isSendingNow_ForSmartMaxTokens && this.openSmartMaxTokens ){
							delaytime = 1400 ; //ËÆæÁΩÆÊä•ÈîôÂºπÁ™óÂª∂Ëøü1.4ÁßíÂºπÂá∫
							const notif_bottom =  this.settingsLanguage == 'cn' ? 'Â∑≤ÂÖ≥Èó≠ Êô∫ËÉΩmax_tokens' : 'Smart max_tokens Disabled';
							this.showNotification(notif_bottom, 'bottom');
						}
						//ÂÖ≥Èó≠Smart max_tokens
						this.openSmartMaxTokens = false;
						this.isReminded_SmartMaxTokens = 2;//‰∏ã‰∏ãÊ¨°ÊèêÈÜí
						
					}else if ( maxLength != null && b_requestedLength != null  && b_messagesLength != null  && b_completionLength != null ) {
					//ÂèëÈÄÅÂá∫ÁöÑ‰∏ä‰∏ãÊñá  + max_tokens > Ë∂ÖÈôêÂà∂
						tips_cn += '\r\n\r\n' ;
						tips_cn += '#A = ÂΩìÂâçÊ®°ÂûãÊîØÊåÅÁöÑÊúÄÂ§ß‰∏ä‰∏ãÊñáÈïøÂ∫¶Ôºö' + maxLength + ' tokens\r\n' ;
						tips_cn += '#B = ÊÇ®ÂΩìÂâçÂèëÈÄÅÁöÑ‰∏ä‰∏ãÊñáÈïøÂ∫¶Ôºö' + b_messagesLength + ' tokens (GPTÁöÑËÆ∞ÂøÜÔºåÂê´Êú¨Ê¨°ÂèëÈÄÅÂÜÖÂÆπ)\r\n' ;
						tips_cn += '#C = ÂΩìÂâçËÆæÁΩÆÂÖÅËÆ∏GPTÂõûÂ§çÁöÑÊúÄÂ§ßÈïøÂ∫¶Ôºö' + b_completionLength + ' tokens (APIËÆæÁΩÆÔºömax_tokens)\r\n' ;
						tips_cn += '#D = B + C ÔºåÂΩìÂâç D = ' + b_requestedLength + ' tokens\r\n' ;
						tips_cn += 'ËßÑÂàôÔºöD < ' + maxLength + ' \r\n' ;
						tips_cn += 'ÂΩìÂâçÔºöD > ' + maxLength + ' \r\n' ;
						tips_cn += 'Ëß£ÈáäÔºöÊÄªÈáè A ÊúâÈôêÂà∂ÔºåÂΩìËÆ∞ÂøÜ B Â¢ûÂä†Âà∞Êüê‰∏™Á®ãÂ∫¶Êó∂Ôºå C (max_tokens) Â∞±ÈúÄË¶ÅÂä®ÊÄÅ‰∏ãË∞É\r\n';
						const diffC = parseInt(maxLength) - parseInt(b_messagesLength) ;
						tips_cn += '‚òÖ Ë∞ÉÊï¥ÔºöÂ¶ÇÊûú‰∏ç‰øÆÊîπÂèëÈÄÅÂÜÖÂÆπÔºåÂΩìÂâç A - B = ' + diffC + 'ÔºåÊâÄ‰ª•ÂøÖÈ°ªË∞ÉÊï¥APIËÆæÁΩÆ‰∏≠ÁöÑ"max_tokens"ÔºåÊúÄÂ§ß‰∏∫ ' + (diffC - 1) + 'ÔºåÁÑ∂ÂêéÈáçÈóÆÂç≥ÂèØ';
						if ( !this.isSimpleMode ){
							tips_cn += '\r\n\r\n  ‚Ä¢ tokenÔºöÂçï‰ΩçÔºåÂç≥"‰ª§Áâå"' ;
							tips_cn += '\r\n  ‚Ä¢ ÂΩìÂâç GPT Ê®°Âûã (' + model_data.modelname + ') ÊúÄÈ´òÊîØÊåÅ ' + model_data.maxtokens + '/' + (model_data.maxtokens + 1) + ' tokens' ;
							//completion_tokens(Êú¨Ê¨°ÊèêÈóÆÂÜÖÂÆπÁöÑtokenÊï∞)ÈúÄË¶ÅÁ≠â‰∏ãÊ¨°ÂØπËØùÁªìÊùüÊâçËÉΩËÆ°ÁÆóÂæóÂá∫ÔºàÊèêÈóÆÁöÑtokenÊï∞‰ºöÊØîÂÆûÈôÖÁöÑÈ´òÔºåÁñë‰ººÂÆòÊñπ‰ºöÊ∑ªÂä†ÈöêËóèÁöÑÊèêÁ§∫ËØç„ÄÇÊÑè‰πâÂ§ß‰∏çÔºå‰ªÖÂÅöÂèÇËÄÉÔºâÁªèËøáÊµãËØïÔºå1„ÄÅÂΩìthis.msgContentÂåÖÂê´Á≥ªÁªüÊèêÁ§∫ËØçËøô‰∏ÄÈ°πÊó∂Ôºà[0]ÔºåÂç≥‰Ωø‰∏∫Á©∫ÔºâÔºåÈ¶ñÊù°‰ºöÈ¢ùÂ§ñÂç†Áî® 13 token Ôºõ 2„ÄÅ‰πãÂêéÊØèÊù°ÂèëÈÄÅÁöÑ‰ø°ÊÅØÈ¢ùÂ§ñÂç†Áî® 10 token „ÄÇ
							tips_cn += '\r\n  ‚Ä¢ ‰ª•‰∏ãÂ±û‰∫éÊ≠£Â∏∏Áé∞Ë±°ÔºöÈ¶ñÊù°Ê∂àÊÅØÈ¢ùÂ§ñÂç†Áî® 13 ‰∏™tokenÔºå‰πãÂêéÁöÑÊØèÊù°Ê∂àÊÅØÈÉΩ‰ºöÈ¢ùÂ§ñÂä† 10 ‰∏™token (ÂèëÈÄÅÂè™Êúâ 1 ‰∏™tokenÁöÑÂÜÖÂÆπÔºåÂÆûÈôÖ‰∏ä‰ºöÂç†Áî® 11 ‰∏™token)„ÄÇ(‰∏é‰ª£Á†ÅÂÜôÊ≥ïÊúâ‰∏ÄÂÆöÂÖ≥Á≥ªÔºåÊú¨‰ª£Á†ÅÂ∞ÜÁ©∫ÁöÑÊèêÁ§∫ËØçËÆæ‰∏∫Á©∫ÁöÑÂ≠óÁ¨¶‰∏≤Êèê‰∫§)' ;
						}
						notif_cn = 'ÂèëÈÄÅÂ§±Ë¥•ÔºåGPTËÆ∞ÂøÜÔºà‰∏ä‰∏ãÊñáÈïøÂ∫¶ÔºâÂç≥Â∞ÜË∂ÖÈôê„ÄÇÂÖ≥Èó≠ÈÄöÁü•ÂêéÔºåÊÇ®ÂèØ‰ª•ÈÄâÊã©ÔºöË∞ÉÊï¥max_tokensÂêéÁÇπÂáªÈáçÈóÆ„ÄÅÊí§ÈîÄËÅäÂ§©ËÆ∞ÂΩï„ÄÅ‰øÆÊîπÂèëÈÄÅÂÜÖÂÆπÈïøÂ∫¶Á≠âÊìç‰ΩúÊù•ÁªßÁª≠‰πãÂâçÁöÑÂØπËØù„ÄÇ';
						const autoMaxTokens1_cn = '\r\n\r\n‚òÖ Â∑≤‰∏∫ÊÇ®ÂÖ≥Èó≠"Êô∫ËÉΩmax_tokens"ÂäüËÉΩÔºåÊú¨Ê¨°ËØ∑Ê†πÊçÆ‰∏ãÊñπÁöÑÈîôËØØÊèêÁ§∫‰ø°ÊÅØÊù•ÊâãÂä®Ë∞ÉËäÇ [APIËÆæÁΩÆ] ‰∏≠ÁöÑ [max_tokens] „ÄÇÂæÖÈóÆÈ¢òËß£ÂÜ≥ÂêéÔºå‰∏ãÊ¨°ÂèØÂ∞ùËØïÈáçÊñ∞ÊâìÂºÄËØ•ÂäüËÉΩ„ÄÇ'
						const autoMaxTokens2_cn = '\r\n\r\n‚òÖ ËØ∑Ê†πÊçÆ‰∏ãÊñπÁöÑÈîôËØØÊèêÁ§∫‰ø°ÊÅØÊù•ÊâãÂä®Ë∞ÉËäÇ [APIËÆæÁΩÆ] ‰∏≠ÁöÑ [max_tokens] „ÄÇ\r\n‚òÖ ÊèêÈÜí: ÂΩìÂâçÊú™ÂêØÁî®"Êô∫ËÉΩmax_tokens"ÂäüËÉΩÔºåÂª∫ËÆÆÊÇ®ÊâìÂºÄ"Êô∫ËÉΩmax_tokens"ÂäüËÉΩÔºåÂΩìÂÖ∂Êó†Ê≥ï‰ΩøÁî®ËÄåËá™Âä®ÂÖ≥Èó≠Êó∂ÔºåÂÜçÂ∞ùËØïÊâãÂä®Ë∞ÉËäÇ max_tokens„ÄÇ'
						notif_cn = this.openSmartMaxTokens ? notif_cn + autoMaxTokens1_cn : notif_cn + autoMaxTokens2_cn;
						notif_cn = notif_cn + tips_cn ;
						
						tips_en += '\r\n\r\n' ;
						tips_en += '  ‚Ä¢ "messages" :  The current length of the context (including the last message sent).\r\n' ;
						tips_en += '  ‚Ä¢ "completion" :  The API parameter "max_tokens" (adjustable in the API settings).\r\n' ;
						tips_en += "  ‚Ä¢  Tip:  Here's an example, if you don't want to modify the content being sent: Currently " + maxLength + ' - ' + b_messagesLength + ' = ' + diffC + ', so you need to adjust the "max_tokens" in [API Settings] to be less than ' + diffC + ' ( ‚òÖ maximum value is ' + (diffC - 1) + '), then click [Retry] to resend the request.' ;
						if ( !this.isSimpleMode ){
							// The tokens for sending messages are higher than the actual count, which is probably because OpenAI adds hidden prompt words. After testing, 1) when the "system prompt"  is included in the context of this.msgContent in the code (this.msgContent[0]), even if the system prompt is empty, the first message will have an extra 13 tokens; 2) each subsequent message will take up an additional 10 tokens.
							tips_en += '\r\n  ‚Ä¢ The following is a normal phenomenon: The first message will occupy an additional 13 tokens, and each subsequent message will add 10 additional tokens (sending content with 1 token will actually occupy 11 tokens). (It is related to the code writing style, when the system prompt is empty, this code submits an empty string to OpenAI.)' ;
						}
						notif_en = "Sending failed. The length of the context is about to exceed the limit. After closing the notification, you can choose to retry after modifying the max_tokens, undo, or modify the content to continue.";
						const autoMaxTokens1_en = '\r\n\r\n‚òÖ The "Smart max_tokens" feature has been turned off for you. Please manually adjust [API Settings] > [max_tokens] based on the [API Error Message] below. Once the issue is resolved, you can re-enable this feature for the next request.'
						const autoMaxTokens2_en = '\r\n\r\n‚òÖ Please manually adjust [API Settings] > [max_tokens] based on the [API Error Message] below. \r\n‚òÖ Reminder: The "Smart max_tokens" feature is currently disabled. It is recommended to enable the "Smart max_tokens" feature, and only manually adjust max_tokens when it stops automatically.'
						notif_en = this.openSmartMaxTokens ? notif_en + autoMaxTokens1_en : notif_en + autoMaxTokens2_en;
						notif_en = notif_en + tips_en ;
						
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 400 ËÆ∞ÂøÜÂç≥Â∞ÜËææÂà∞‰∏äÈôê' : 'Error - 400 Context length is about to exceed the limit';
						
						// Êô∫ËÉΩmax_tokensÔºàSmart max_tokensÔºâÂºÄÂêØÊó∂ÔºåÂõ†max_tokensËÆ°ÁÆóÈîôËØØËÄåÂØºËá¥Êä•ÈîôÂêéÔºåÂ∞ÜËá™Âä®‰øÆÊ≠£max_tokensÔºåÂπ∂Ëá™Âä®ÈáçÈóÆ(Retry) 
						// (ÈóÆÈ¢òÂ∑≤Ëß£ÂÜ≥ÔºåËΩÆËØ¢ / Ëá™Âä®ËΩÆÊç¢API Key / Auto Key Rotation ÂäüËÉΩÂ∑≤Âá∫)*ÂÖçË¥πGPTË¥¶Âè∑1ÂàÜÈíüÂè™ËÉΩÂèë3Ê¨°ËØ∑Ê±ÇÔºåÂá∫ÈîôÂêéËá™Âä®ÈáçÂèëÔºåÁ≠â‰∫éÊòØËøûÁª≠Âèë‰∫Ü2‰∏™ËØ∑Ê±ÇÔºåÊØîËæÉÂÆπÊòìÊä•ÈîôÔºàErrÔºö 429-1 ËØ∑Ê±ÇËøáÂø´ Rate limit ÔºâÔºåËøô‰∏™Êó†Ê≥ïËß£ÂÜ≥„ÄÇÔºàÈóÆÈ¢òÂ∑≤Ëß£ÂÜ≥Ôºâ
						if (this.isSendingNow_ForSmartMaxTokens && this.openSmartMaxTokens && (diffC - 1) > 0) { 	// Ê≠£Âú®ÂèëÈÄÅ && Â∑≤ÂºÄÂêØ"Smart max_tokens" && max_tokens >= 1Êó∂(‰πüÂèØ‰ª•Êõ¥È´ò)
							//Ëá™Âä®‰øÆÊ≠£max_tokensÂπ∂Ëá™Âä®ÈáçÈóÆÊó∂ÔºåÊó†ÈúÄÂÖ≥Èó≠this.openSmartMaxTokensÔºåÁªßÁª≠‰øùÊåÅÂêØÁî®Áä∂ÊÄÅ
							
							this.isFixingMaxTokens_SmartMaxTokens = true; //Ê†áËÆ∞‰∏∫‚ÄúÊ≠£Âú®‰øÆÂ§çMaxTokens‚ÄùÁöÑÁä∂ÊÄÅÔºåÊú¨Ê¨°Ëá™Âä®ÈáçÈóÆ(Retry)Êó∂Ôºå‰∏çÂÜçËá™Âä®Ë∞ÉËäÇmax_tokens„ÄÇ 
							//this.isFixingMaxTokens_SmartMaxTokens ‰ªÄ‰πàÊó∂ÂÄôÂèò‰∏∫falseÔºü 1„ÄÅÈáçÈóÆÔºàretryÔºâÊàêÂäüÔºåÂæóÂà∞ÂõûÂ§çÂêéÈúÄË¶ÅÂèò‰∏∫false„ÄÇ2„ÄÅËá™Âä®ÈáçÈóÆÂ§±Ë¥•ÂêéÔºåÁî®Êà∑‰∏çÂÜçÈÄâÊã©ÈáçÈóÆÔºåËÄåÊòØÈÄâÊã©ÂèëÈÄÅÊñ∞ÂÜÖÂÆπÊó∂ÔºåÈúÄË¶ÅÂèò‰∏∫false„ÄÇ(Ë¶ÜÁõñ ÂèëÈÄÅ„ÄÅÊ∏ÖÈô§ËÆ∞ÂøÜÂêéÂèëÈÄÅ„ÄÅÊí§ÈîÄÂêéÂèëÈÄÅ ‰∏âÁßçÊÉÖÂÜµ)
							
							this.apiMaxTokens = diffC - 1; //Á≤æÂáÜË∞ÉËäÇmax_tokensÁöÑÊúÄÂ§ßÂÄº
							
							const txt_lang1 = this.settingsLanguage == 'cn' ? '#### #Ëá™Âä®‰øÆÂ§çÈîôËØØ‰∏≠ÔºåÂç≥Â∞ÜËá™Âä®ÈáçÈóÆ\r\n\r\n' : '#### #Auto-correcting error, will automatically retry\r\n\r\n';
							this.chathistory  += (txt_lang1);
							
							this.isFirstRetry_SmartMaxTokens = true;
							this.retry(); // ÈáçÈóÆ Retry
							
							notif_cn = "max_tokensËøáÈ´òÔºåÂ∑≤Ëá™Âä®‰øÆÂ§çÔºåÂπ∂Ëá™Âä®ÈáçÈóÆ‰∏ÄÊ¨°";
							notif_en = "max_tokens was set too high, it has been automatically corrected and the request is now being automatically resent.";
							notif =  this.settingsLanguage == 'cn' ?  notif_cn : notif_en;
							const notiftime =  this.settingsLanguage == 'cn' ?  4500 : 6000;
							this.showNotification(notif, 'bottom','',notiftime);
							//ËøîÂõû * ËøôÈáåËøîÂõûÂâç‰∏çÁî®ÊîπÂèòisSendingNow_ForSmartMaxTokensÔºåÂõ†‰∏∫ÈáçÈóÆÂêéÔºåÊàêÂäüÊàñÂ§±Ë¥•ÈÉΩ‰ºöÊõ¥ÊîπÂÆÉÁöÑÂÄº
							return;
						}else{
							//Smart max_tokensÂºÄÂêØÊó∂„ÄÇÂºπÁ™óÔºå‰∏§‰∏™ÔºåÂä†‰∏Ä‰∏™Â∫ïÈÉ®ÊèêÁ§∫ÔºåÂª∂ËøüÊòæÁ§∫Êä•ÈîôÂºπÁ™ó
							if (this.isSendingNow_ForSmartMaxTokens && this.openSmartMaxTokens ){
								delaytime = 1400 ; //ËÆæÁΩÆÊä•ÈîôÂºπÁ™óÂª∂Ëøü1.4ÁßíÂºπÂá∫
								const notif_bottom =  this.settingsLanguage == 'cn' ? 'Â∑≤ÂÖ≥Èó≠ Êô∫ËÉΩmax_tokens' : 'Smart max_tokens Disabled';
								this.showNotification(notif_bottom, 'bottom');
							}
							
							//ÂÖ≥Èó≠Smart max_tokens
							this.openSmartMaxTokens = false;
							this.isReminded_SmartMaxTokens = 2;//‰∏ã‰∏ãÊ¨°ÊèêÈÜí
						}
						
					}else{
						notif_cn = 'ÂèëÈÄÅÂ§±Ë¥•ÔºåGPTËÆ∞ÂøÜÔºà‰∏ä‰∏ãÊñáÈïøÂ∫¶ÔºâËææ‰∏äÈôê„ÄÇ';
						notif_en = "Sending failed. The length of the context exceeds the limit. ";
						title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - 400 ÂÖ∂‰ªñ ' : 'Error - 400 Other ';
					}
					
					apidata_errorState ='400';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
					
				}else{
				//ÂÖ∂‰ªñ Êú™Áü•ÊÉÖÂÜµ Êú™ÂàÜÁ±ª  other Unknown Uncategorized 
					if (error.code !== '' || error.message !== ''){
						notif_cn = 'HTTPËØ∑Ê±Ç - ÈîôËØØ‰ª£Á†Å:  ' + error.code + '\r\nHTTPËØ∑Ê±Ç - ÈîôËØØ‰ø°ÊÅØ:  ' + error.message ;
						notif_en = 'HTTP Error Code:  ' + error.code + '\r\nHTTP Error Message:  ' + error.message ;
					}
					notif_cn = (notif_cn === '' ? '' : notif_cn + '\r\n\r\n') + '  ‚Ä¢ ÂΩìÂâç API Key : ' + this.api ;
					notif_en = (notif_en === '' ? '' : notif_en + '\r\n\r\n') + '  ‚Ä¢ The current API Key : ' + this.api ;
					
					if ( responseMessage !== '' || responseType !== '' || responseCode !== '') {
						notif_cn += '\r\n  ‚Ä¢ ËØ∑ÂèÇÈòÖ‰∏ãÊñπÁöÑ API ÈîôËØØ‰ø°ÊÅØ„ÄÇ';
						notif_en += '\r\n  ‚Ä¢ Please refer to the API Error Message below.';
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI ÈÄöÁî® *keyÊó†Êïà  *chatai.beauty„ÄÅ
					if (  responseMessage.toLowerCase().includes("invalid token") || ( responseMessage.toLowerCase().includes("invalid") && (responseMessage.toLowerCase().includes("token") || responseMessage.toLowerCase().includes("key")) )  ) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ÂØÜÈí•Êó†Êïà' + (responseMessage.toLowerCase().includes("token") ? ' (‰ª§ÁâåÊó†Êïà)' : '') + 'ÔºåËØ∑Ê†∏ÂØπÊé•Âè£ÁΩëÂùÄ (API URL) ‰∏éÂØÜÈí• (API Key) ÊòØÂê¶ÂåπÈÖç„ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ Invalid API Key' + (responseMessage.toLowerCase().includes("token") ? ' (Invalid API Token)' : '') + '. Please check if the API Endpoint (API URL) matches the API Key' + (responseMessage.toLowerCase().includes("token") ? ' (API Token).' : '.');
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI ÈÄöÁî® *modelÊó†Êïà  
					if ( responseMessage.toLowerCase().includes("not authorized") && responseMessage.toLowerCase().includes("this model") ) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ÊÇ®Êó†ÊùÉ‰ΩøÁî®Ê≠§Ê®°Âûã (model: ' + this.apiGPTModel + ')ÔºåËØ∑Êõ¥Êç¢Ê®°Âûã (model) ÊàñÂçáÁ∫ßÊùÉÈôê„ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ ÊÇ®Êó†ÊùÉ‰ΩøÁî®Ê≠§Ê®°Âûã (model: ' + this.apiGPTModel + ')ÔºåËØ∑Êõ¥Êç¢Ê®°Âûã (model) ÊàñÂçáÁ∫ßÊùÉÈôê„ÄÇ';
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI * chatai.beauty
					if ( responseMessage.toLowerCase().includes("not enough credit")) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ÊÇ®ÁöÑË¥¶Âè∑‰ø°Áî®/È¢ùÂ∫¶‰∏çË∂≥„ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ ÊÇ®ÁöÑË¥¶Âè∑‰ø°Áî®/È¢ùÂ∫¶‰∏çË∂≥„ÄÇ';
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI * (Use OpenAI API Key ‰ΩøÁî®ÂÆòÊñπKey) chatgpt1.nextweb.fun/api/proxy/  code:502
					if ( responseMessage.toLowerCase().includes("an error occurred with this application")) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ÊúçÂä°Âô®ÂèëÁîü‰∫ÜÈîôËØØÔºåÂèØËÉΩÂè™ÊòØÊöÇÊó∂ÁöÑÔºåÂª∫ËÆÆÂÖàÈáçËØï‰∏ÄÊ¨°„ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ An error occurred with the server. The error may be temporary, so it is recommended to try again first.';
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI *api2dÁÇπÊï∞‰∏çÂÖÅËÆ∏ËÆæÁΩÆËæÉÂ§ßÁöÑmax_tokens
					if ( responseMessage.toLowerCase().includes("reduce the max_tokens") && this.api.startsWith('fk') ) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ÊÇ®Ê≠£Âú®‰ΩøÁî®Á¨¨‰∏âÊñπÊé•Âè£ api2d ÔºåÂ¶ÇÊûúÊÇ®ÁöÑÁÇπÊï∞‰∏çÊòØÂæàÂ§öÔºåÂª∫ËÆÆÂÖ≥Èó≠ MCGPT ÁöÑ"Êô∫ËÉΩmax_tokens"ÂäüËÉΩÔºåÂπ∂Ê†πÊçÆÈîôËØØ‰ø°ÊÅØÂú®ËÆæÁΩÆ‰∏≠ÊâãÂä®Ë∞ÉËäÇ max_tokens„ÄÇÂõ†‰∏∫"Êô∫ËÉΩmax_tokens"ÂäüËÉΩ‰ºöÂ∞ΩÂèØËÉΩÊää max_tokens Ë∞ÉÈ´òÔºå‰ΩÜÊòØ api2d Âπ≥Âè∞‰ºöÈÄöËøáËÆæÁΩÆÁöÑ max_tokens Êù•È¢Ñ‰º∞ÂçïÊ¨°ÁöÑÊ∂àË¥πÈ¢ùÔºåmax_tokens Ë∂äÈ´òÔºå‰º∞ÁÆóÁöÑÊ∂àË¥πÂ∞±Ë∂äÈ´òÔºåËã•‰º∞ÁÆóÁöÑÊ∂àË¥πÁÇπÊï∞Ë∂ÖÂá∫Ë¥¶Âè∑ÁöÑÂèØÁî®ÁÇπÊï∞ÔºåÂàôËØ∑Ê±ÇÂ§±Ë¥• (Êó†ËÆ∫ GPT ÊúÄÁªàÂõûÂ§çÁöÑÈïøÂ∫¶ÊòØÂ§öÂ∞ë)„ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ ÊÇ®Ê≠£Âú®‰ΩøÁî®Á¨¨‰∏âÊñπÊé•Âè£ api2d ÔºåÂ¶ÇÊûúÊÇ®ÁöÑÁÇπÊï∞‰∏çÊòØÂæàÂ§öÔºåÂª∫ËÆÆÂÖ≥Èó≠ MCGPT ÁöÑ"Êô∫ËÉΩmax_tokens"ÂäüËÉΩÔºåÂπ∂Ê†πÊçÆÈîôËØØ‰ø°ÊÅØÂú®ËÆæÁΩÆ‰∏≠ÊâãÂä®Ë∞ÉËäÇ max_tokens„ÄÇÂõ†‰∏∫"Êô∫ËÉΩmax_tokens"ÂäüËÉΩ‰ºöÂ∞ΩÂèØËÉΩÊää max_tokens Ë∞ÉÈ´òÔºå‰ΩÜÊòØ api2d Âπ≥Âè∞‰ºöÈÄöËøáËÆæÁΩÆÁöÑ max_tokens Êù•È¢Ñ‰º∞ÂçïÊ¨°ÁöÑÊ∂àË¥πÈ¢ùÔºåmax_tokens Ë∂äÈ´òÔºå‰º∞ÁÆóÁöÑÊ∂àË¥πÂ∞±Ë∂äÈ´òÔºåËã•‰º∞ÁÆóÁöÑÊ∂àË¥πÁÇπÊï∞Ë∂ÖÂá∫Ë¥¶Âè∑ÁöÑÂèØÁî®ÁÇπÊï∞ÔºåÂàôËØ∑Ê±ÇÂ§±Ë¥• (Êó†ËÆ∫ GPT ÊúÄÁªàÂõûÂ§çÁöÑÈïøÂ∫¶ÊòØÂ§öÂ∞ë)„ÄÇ';
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI *AIGC2DÁÇπÊï∞‰∏çÂÖÅËÆ∏ËÆæÁΩÆËæÉÂ§ßÁöÑmax_tokens
					if ( responseMessage.toLowerCase().includes("reduce the max_tokens") && this.api.toLowerCase().startsWith('aigc') ) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ÊÇ®Ê≠£Âú®‰ΩøÁî®Á¨¨‰∏âÊñπÊé•Âè£ AIGC2D ÔºåÂ¶ÇÊûúÊÇ®ÁöÑÁÇπÊï∞‰∏çÊòØÂæàÂ§öÔºåÂª∫ËÆÆÂÖ≥Èó≠ MCGPT ÁöÑ"Êô∫ËÉΩmax_tokens"ÂäüËÉΩÔºåÂπ∂Ê†πÊçÆÈîôËØØ‰ø°ÊÅØÂú®ËÆæÁΩÆ‰∏≠ÊâãÂä®Ë∞ÉËäÇ max_tokens„ÄÇÂõ†‰∏∫"Êô∫ËÉΩmax_tokens"ÂäüËÉΩ‰ºöÂ∞ΩÂèØËÉΩÊää max_tokens Ë∞ÉÈ´òÔºå‰ΩÜÊòØ AIGC2D Âπ≥Âè∞‰ºöÈÄöËøáËÆæÁΩÆÁöÑ max_tokens Êù•È¢Ñ‰º∞ÂçïÊ¨°ÁöÑÊ∂àË¥πÈ¢ùÔºåmax_tokens Ë∂äÈ´òÔºå‰º∞ÁÆóÁöÑÊ∂àË¥πÂ∞±Ë∂äÈ´òÔºåËã•‰º∞ÁÆóÁöÑÊ∂àË¥πÁÇπÊï∞Ë∂ÖÂá∫Ë¥¶Âè∑ÁöÑÂèØÁî®ÁÇπÊï∞ÔºåÂàôËØ∑Ê±ÇÂ§±Ë¥• (Êó†ËÆ∫ GPT ÊúÄÁªàÂõûÂ§çÁöÑÈïøÂ∫¶ÊòØÂ§öÂ∞ë)„ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ ÊÇ®Ê≠£Âú®‰ΩøÁî®Á¨¨‰∏âÊñπÊé•Âè£ AIGC2D ÔºåÂ¶ÇÊûúÊÇ®ÁöÑÁÇπÊï∞‰∏çÊòØÂæàÂ§öÔºåÂª∫ËÆÆÂÖ≥Èó≠ MCGPT ÁöÑ"Êô∫ËÉΩmax_tokens"ÂäüËÉΩÔºåÂπ∂Ê†πÊçÆÈîôËØØ‰ø°ÊÅØÂú®ËÆæÁΩÆ‰∏≠ÊâãÂä®Ë∞ÉËäÇ max_tokens„ÄÇÂõ†‰∏∫"Êô∫ËÉΩmax_tokens"ÂäüËÉΩ‰ºöÂ∞ΩÂèØËÉΩÊää max_tokens Ë∞ÉÈ´òÔºå‰ΩÜÊòØ AIGC2D Âπ≥Âè∞‰ºöÈÄöËøáËÆæÁΩÆÁöÑ max_tokens Êù•È¢Ñ‰º∞ÂçïÊ¨°ÁöÑÊ∂àË¥πÈ¢ùÔºåmax_tokens Ë∂äÈ´òÔºå‰º∞ÁÆóÁöÑÊ∂àË¥πÂ∞±Ë∂äÈ´òÔºåËã•‰º∞ÁÆóÁöÑÊ∂àË¥πÁÇπÊï∞Ë∂ÖÂá∫Ë¥¶Âè∑ÁöÑÂèØÁî®ÁÇπÊï∞ÔºåÂàôËØ∑Ê±ÇÂ§±Ë¥• (Êó†ËÆ∫ GPT ÊúÄÁªàÂõûÂ§çÁöÑÈïøÂ∫¶ÊòØÂ§öÂ∞ë)„ÄÇ';
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI *closeai-asia‰∏çÂÖÅËÆ∏ËÆæÁΩÆËæÉÂ§ßÁöÑmax_tokens
					if ( responseMessage.toLowerCase().includes("ÈúÄË¶Å‰ΩôÈ¢ùÂ§ß‰∫é") && responseMessage.toLowerCase().includes("Êõ¥Â∞èÁöÑmax_tokensÂèÇÊï∞") ) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ÊÇ®Ê≠£Âú®‰ΩøÁî®Á¨¨‰∏âÊñπÊé•Âè£ closeai-asia ÔºåÂ¶ÇÊûúÊÇ®ÁöÑ‰ΩôÈ¢ù‰∏çÊòØÂæàÂ§öÔºåÂª∫ËÆÆÂÖ≥Èó≠ MCGPT ÁöÑ"Êô∫ËÉΩmax_tokens"ÂäüËÉΩÔºåÂπ∂Ê†πÊçÆÈîôËØØ‰ø°ÊÅØÂú®ËÆæÁΩÆ‰∏≠ÊâãÂä®Ë∞ÉËäÇ max_tokens„ÄÇÂõ†‰∏∫"Êô∫ËÉΩmax_tokens"ÂäüËÉΩ‰ºöÂ∞ΩÂèØËÉΩÊää max_tokens Ë∞ÉÈ´òÔºå‰ΩÜÊòØ closeai-asia Âπ≥Âè∞‰ºöÈÄöËøáËÆæÁΩÆÁöÑ max_tokens Êù•È¢Ñ‰º∞ÂçïÊ¨°ÁöÑÊ∂àË¥πÈ¢ùÔºåmax_tokens Ë∂äÈ´òÔºå‰º∞ÁÆóÁöÑÊ∂àË¥πÂ∞±Ë∂äÈ´òÔºåËã•‰º∞ÁÆóÁöÑÊ∂àË¥πÈáëÈ¢ùË∂ÖÂá∫Ë¥¶Âè∑ÁöÑÂèØÁî®‰ΩôÈ¢ùÔºåÂàôËØ∑Ê±ÇÂ§±Ë¥• (Êó†ËÆ∫ GPT ÊúÄÁªàÂõûÂ§çÁöÑÈïøÂ∫¶ÊòØÂ§öÂ∞ë)„ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ ÊÇ®Ê≠£Âú®‰ΩøÁî®Á¨¨‰∏âÊñπÊé•Âè£ closeai-asia ÔºåÂ¶ÇÊûúÊÇ®ÁöÑ‰ΩôÈ¢ù‰∏çÊòØÂæàÂ§öÔºåÂª∫ËÆÆÂÖ≥Èó≠ MCGPT ÁöÑ"Êô∫ËÉΩmax_tokens"ÂäüËÉΩÔºåÂπ∂Ê†πÊçÆÈîôËØØ‰ø°ÊÅØÂú®ËÆæÁΩÆ‰∏≠ÊâãÂä®Ë∞ÉËäÇ max_tokens„ÄÇÂõ†‰∏∫"Êô∫ËÉΩmax_tokens"ÂäüËÉΩ‰ºöÂ∞ΩÂèØËÉΩÊää max_tokens Ë∞ÉÈ´òÔºå‰ΩÜÊòØ closeai-asia Âπ≥Âè∞‰ºöÈÄöËøáËÆæÁΩÆÁöÑ max_tokens Êù•È¢Ñ‰º∞ÂçïÊ¨°ÁöÑÊ∂àË¥πÈ¢ùÔºåmax_tokens Ë∂äÈ´òÔºå‰º∞ÁÆóÁöÑÊ∂àË¥πÂ∞±Ë∂äÈ´òÔºåËã•‰º∞ÁÆóÁöÑÊ∂àË¥πÈáëÈ¢ùË∂ÖÂá∫Ë¥¶Âè∑ÁöÑÂèØÁî®‰ΩôÈ¢ùÔºåÂàôËØ∑Ê±ÇÂ§±Ë¥• (Êó†ËÆ∫ GPT ÊúÄÁªàÂõûÂ§çÁöÑÈïøÂ∫¶ÊòØÂ§öÂ∞ë)„ÄÇ';
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI *api2d modelÊó†Êïà / ‰∏çÊîØÊåÅ
					if ( responseMessage.toLowerCase().includes("allowed now, your model") && this.api.startsWith('fk') ) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ‰∏çÊîØÊåÅÊ≠§Ê®°Âûã (model: ' + this.apiGPTModel + ')ÔºåËØ∑Ê†πÊçÆ [API ÈîôËØØ‰ø°ÊÅØ] Êõ¥Êç¢ÂΩìÂâçÊîØÊåÅÁöÑÊ®°Âûã (model) „ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ ‰∏çÊîØÊåÅÊ≠§Ê®°Âûã (model: ' + this.apiGPTModel + ')ÔºåËØ∑Ê†πÊçÆ [API ÈîôËØØ‰ø°ÊÅØ] Êõ¥Êç¢ÂΩìÂâçÊîØÊåÅÁöÑÊ®°Âûã (model) „ÄÇ';
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI *AIGC2D modelÊó†Êïà / ‰∏çÊîØÊåÅ
					if ( responseMessage.toLowerCase().includes("model") && responseMessage.toLowerCase().includes("is not in acceptable range") ) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ‰∏çÊîØÊåÅÊ≠§Ê®°Âûã (model: ' + this.apiGPTModel + ')ÔºåËØ∑Ê†πÊçÆ [API ÈîôËØØ‰ø°ÊÅØ] Êõ¥Êç¢ÂΩìÂâçÊîØÊåÅÁöÑÊ®°Âûã (model) „ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ ‰∏çÊîØÊåÅÊ≠§Ê®°Âûã (model: ' + this.apiGPTModel + ')ÔºåËØ∑Ê†πÊçÆ [API ÈîôËØØ‰ø°ÊÅØ] Êõ¥Êç¢ÂΩìÂâçÊîØÊåÅÁöÑÊ®°Âûã (model) „ÄÇ';
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI *AIGC2D modelÊó†Êïà Á¨¨‰∫åÁßçÊÉÖÂÜµ
					if ( responseMessage.toLowerCase().includes("model not found") ) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ‰∏çÊîØÊåÅÊ≠§Ê®°Âûã (model: ' + this.apiGPTModel + ')ÔºåËØ∑Êõ¥Êç¢Ê®°Âûã (model)„ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ ‰∏çÊîØÊåÅÊ≠§Ê®°Âûã (model: ' + this.apiGPTModel + ')ÔºåËØ∑Êõ¥Êç¢Ê®°Âûã (model)„ÄÇ';
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI * One-apiÂºÄÊ∫êÈ°πÁõÆ modelÊó†Êïà / ‰∏çÊîØÊåÅ
					if ( responseMessage.toLowerCase().includes("Ê®°Âûã") && responseMessage.toLowerCase().includes("Êó†ÂèØÁî®Ê∏†ÈÅì") ) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ‰∏çÊîØÊåÅÊ≠§Ê®°Âûã (model: ' + this.apiGPTModel + ')ÔºåËØ∑Êõ¥Êç¢Ê®°Âûã (model) ÊàñÂçáÁ∫ßÊùÉÈôê„ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ ‰∏çÊîØÊåÅÊ≠§Ê®°Âûã (model: ' + this.apiGPTModel + ')ÔºåËØ∑Êõ¥Êç¢Ê®°Âûã (model) ÊàñÂçáÁ∫ßÊùÉÈôê„ÄÇ';
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI * -max
					if ( responseMessage.toLowerCase().includes("quota is not enough")) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ÊÇ®ÁöÑË¥¶Âè∑ Quota È¢ùÂ∫¶‰∏çË∂≥„ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ Quota is not enough.';
					}
					// ÈÄÇÈÖçÁ¨¨‰∏âÊñπAPI * -max 
					if ( responseMessage.toLowerCase().includes("bad request") && !responseMessage.toLowerCase().includes("quota is not enough")) {
						notif_cn = notif_cn + '\r\n  ‚Ä¢ ËØ∑Ê±ÇÈîôËØØÔºåËØ∑ÂèÇÁÖßÈîôËØØ‰ø°ÊÅØËá™Ë°åÊéíÊü•„ÄÇÂ¶ÇÊó†ÊòéÁªÜ‰ø°ÊÅØÔºåÂèØ‰ºòÂÖàÊéíÊü•"Ê®°Âûã"Âõ†Á¥†Ôºö1) ÊòØÂê¶ÈÄâ‰∫Ü GPT-4 Ê®°ÂûãÔºåËÄåËØ•Êé•Âè£‰∏çÊîØÊåÅ GPT-4 Ê®°Âûã (ÊàñË¥¶Âè∑Êó†  GPT-4 ÊùÉÈôê); 2) Â¶ÇÊûúÈÄâÁöÑÊòØ GPT-3.5 Ê®°ÂûãÔºåÂèØËÉΩÊòØËØ•Êé•Âè£‰ªÖÊîØÊåÅ‰∏Ä‰∏§Áßç GPT-3.5 Ê®°ÂûãÔºåÂèØÂàáÊç¢‰∏∫Âü∫Á°ÄÁöÑ gpt-3.5-turbo Ê®°ÂûãËØïËØï; 3) Ê®°ÂûãÊ≠£Á°ÆÂêéÔºåÊâç‰ºöËøõ‰∏ÄÊ≠•È™åËØÅ Key ÁöÑÊúâÊïàÊÄß„ÄÇ';
						notif_en = notif_en + '\r\n  ‚Ä¢ ËØ∑Ê±ÇÈîôËØØÔºåËØ∑ÂèÇÁÖßÈîôËØØ‰ø°ÊÅØËá™Ë°åÊéíÊü•„ÄÇÂ¶ÇÊó†ÊòéÁªÜ‰ø°ÊÅØÔºåÂèØ‰ºòÂÖàÊéíÊü•"Ê®°Âûã"Âõ†Á¥†Ôºö1) ÊòØÂê¶ÈÄâ‰∫Ü GPT-4 Ê®°ÂûãÔºåËÄåËØ•Êé•Âè£‰∏çÊîØÊåÅ GPT-4 Ê®°Âûã (ÊàñË¥¶Âè∑Êó†  GPT-4 ÊùÉÈôê); 2) Â¶ÇÊûúÈÄâÁöÑÊòØ GPT-3.5 Ê®°ÂûãÔºåÂèØËÉΩÊòØËØ•Êé•Âè£‰ªÖÊîØÊåÅ‰∏Ä‰∏§Áßç GPT-3.5 Ê®°ÂûãÔºåÂèØÂàáÊç¢‰∏∫Âü∫Á°ÄÁöÑ gpt-3.5-turbo Ê®°ÂûãËØïËØï; 3) Ê®°ÂûãÊ≠£Á°ÆÂêéÔºåÊâç‰ºöËøõ‰∏ÄÊ≠•È™åËØÅ Key ÁöÑÊúâÊïàÊÄß„ÄÇ';
					}
					
					title = this.settingsLanguage == 'cn' ?  'ÈîôËØØ - ÂÖ∂‰ªñ' : 'Error - Other';
					apidata_errorState ='error-other';//Áî®‰∫éÊõ¥Êñ∞this.apiCheckedData
				}
				
					
				if ( responseMessage !== '' || responseType !== '' || responseCode !== '') {
					if( !this.isThirdPartyAPIKeyEnabled && (this.apiURL.toLowerCase() === this.OpenAI_API_URL || this.apiURL.toLowerCase() === this.OpenaiProxyCom_API_URL) ){ //OpenAI key
						notif_cn = notif_cn + '\r\n\r\nOpenAI - APIÈîôËØØ‰ø°ÊÅØ:\r\n' + responseMessage + '\r\nOpenAI - APIÈîôËØØÁ±ªÂûã:\r\n' + responseType + ( responseCode === '' ? '' : ('\r\nOpenAI - APIÈîôËØØÁ†Å:\r\n' + responseCode) ) + '\r\nOpenAI - ÊúçÂä°Âô®Áä∂ÊÄÅ:\r\nhttps://status.openai.com/' + '\r\nOpenAI - Ë¥πÁéáÈôêÂà∂ËßÑÂàô (Âê´ÂÖçË¥π):\r\nhttps://platform.openai.com/docs/guides/rate-limits/overview' ;
						notif_en = notif_en + '\r\n\r\nOpenAI - API Error Message:\r\n' + responseMessage + '\r\nOpenAI - API Error Type:\r\n' + responseType +  ( responseCode === '' ? '' : ('\r\nOpenAI - API Error Code:\r\n' + responseCode) ) + '\r\nOpenAI - OpenAI Status:\r\nhttps://status.openai.com/' + '\r\nOpenAI - Rate limits:\r\nhttps://platform.openai.com/docs/guides/rate-limits/overview' ;
					}else{//Third-party API Key
						notif_cn = notif_cn + '\r\n\r\nAPIÈîôËØØ‰ø°ÊÅØ:\r\n' + responseMessage + ( responseType === '' ? '' : ('\r\nAPIÈîôËØØÁ±ªÂûã:\r\n' + responseType) ) + ( responseCode === '' ? '' : ('\r\nAPIÈîôËØØÁ†Å:\r\n' + responseCode) ) ;
						notif_en = notif_en + '\r\n\r\nAPI Error Message:\r\n' + responseMessage + ( responseType === '' ? '' : ('\r\nAPI Error Type:\r\n' + responseType) ) + ( responseCode === '' ? '' : ('\r\nAPI Error Code:\r\n' + responseCode) );
					}
				}
				notif =  this.settingsLanguage == 'cn' ?  notif_cn : notif_en;
				const autoRetry_bottomnotif =  this.settingsLanguage == 'cn' ? autoRetry_bottomnotifCN : autoRetry_bottomnotifEN;
								
				
				const temp_isSendingNow_ForSmartMaxTokens = this.isSendingNow_ForSmartMaxTokens; //‰∏¥Êó∂ËÆ∞ÂΩïÔºåÁõÆÁöÑÊòØ‰øùÊåÅthis.isSendingNow_ForSmartMaxTokensÁöÑ‰ΩçÁΩÆ‰∏çÂä®Ôºå‰∏çÈúÄË¶ÅÁßªÂä®Âà∞‰ª£Á†ÅÊú´Â∞æÔºàÂÖà‰∏çÁßªÂä®ÔºåÈÅøÂÖçÂá∫ÈîôÔºâ
				//Êõ¥Êñ∞ÂèëÈÄÅÁä∂ÊÄÅ
				this.isSendingNow_ForSmartMaxTokens = false;//ÊöÇÊó∂ÂÖà‰∏çÁßªÂä®Âà∞‚ÄúËá™Âä®ÈáçÈóÆ‰ª£Á†Å‚ÄùÁöÑÂêéÈù¢	
							
				//Êõ¥Êñ∞this.apiCheckedData  ËÆ∞ÂΩïÂ∑≤È™åËØÅÁöÑAPI Key‰ø°ÊÅØ
				this.updateApiCheckedData(this.api, requesttime, apidata_errorState);

				//Send(need auto-retry)  ÂèëÈÄÅÂ§±Ë¥•ÂêéÈúÄË¶ÅËá™Âä®ÈáçÈóÆ/ÈáçÂèëÊ∂àÊÅØÁöÑÊÉÖÂÜµ   Automatically Retry (resend messages)
				//ÂÄüÁî®isSendingNow_ForSmartMaxTokensÂà§Êñ≠ÔºöÂ¶ÇÊûú‰∏∫trueÔºåË°®Á§∫ÂΩìÂâçÊòØ[ÂèëÈÄÅ]Êó∂Âá∫Èîô,ËÄå‰∏çÊòØ[È™åËØÅAPI Key]Êó∂Âá∫Èîô„ÄÇ [Check API Key]Âá∫ÈîôÊó∂‰∏çÈúÄË¶ÅRetry„ÄÇ
				if(temp_isSendingNow_ForSmartMaxTokens && autoRetry_errortype !== ''){
					this.autoRetry(autoRetry_errortype, autoRetry_bottomnotif, notif, title);
				}else{
				//Send or Check  ÂèëÈÄÅÂ§±Ë¥•ÂêéÊó†ÈúÄÈáçÈóÆÁöÑÊÉÖÂÜµ ÊàñËÄÖ È™åËØÅÂ§±Ë¥•Âêé  
					//tipsÔºöÂª∂ËøüÁî®ÈÄî1ÔºöÈíàÂØπ'Type error'ÈîôËØØÔºåÊú¨Âú∞È™åËØÅÊä•ÈîôÈÄüÂ∫¶Âø´ÔºåÂ∫ïÈÉ®ÈÄöÁü•‚ÄúÈ™åËØÅ‰∏≠...‚ÄùÂàöÂºπÂá∫Â∞±Êä•ÈîôÔºå‰ºöÂØºËá¥Â∫ïÈÉ®ÈÄöÁü•ÁöÑËÆ°Êó∂Âô®Êù•‰∏çÂèäÂÖ≥Èó≠ÔºåËÆ°Êó∂Âô®‰ºöÁªßÁª≠ËøêË°åÔºå60ÁßíÁªìÊùüÂêé‰ºöÂÖ≥Èó≠ÈÄöÁü•ÔºàÊ≠§Êó∂Ëã•ÊúâÈÄöÁü•Ôºå‰ºöËé´ÂêçÂÖ∂Â¶ôË¢´ÂÖ≥Èó≠Ôºâ„ÄÇ
					//tipsÔºöÂª∂ËøüÁî®ÈÄî2Ôºö400Êó∂ÔºåSmart max_tokensÂ§±ÊïàÂá∫ÈîôÔºåÊ≠§Êó∂Â∫ïÈÉ®ÂºπÂá∫ÊèêÁ§∫‚ÄúÂ∑≤Ëá™Âä®‰øÆÂ§ç Âπ∂Ëá™Âä®ÈáçÈóÆ‚ÄùÔºåÊ≠§Êó∂ËøûÁª≠‰∏§Ê¨°ËØ∑Ê±ÇÔºàÂá∫Èîô+Á´ãÈ©¨ÈáçÈóÆÔºâÂæàÂÆπÊòìËß¶Âèë‚Äú429-1 ËØ∑Ê±ÇËøáÂø´ Rate limit ‚ÄùÂºπÂá∫Êä•Èîô‰ø°ÊÅØ„ÄÇ ÊâÄ‰ª•ÔºåËøôÁßçÊÉÖÂÜµ‰∏ãÔºå429ÈúÄË¶ÅÂª∂ËøüÂºπÂá∫„ÄÇ
					setTimeout(() => {
						this.showNotification(notif, 'center', title);
					}, delaytime);
				}
			},
			
			//Ëá™Âä®ÈáçÈóÆ/ÈáçÂèëÊ∂àÊÅØ  Automatically Retry (resend messages)  - ËΩÆËØ¢ / Ëá™Âä®ËΩÆÊç¢API Key / Auto Key Rotation Áõ∏ÂÖ≥
			autoRetry(errortype, bottomnotif, centernotif, centernotiftitle){
				//catchApiErrorCode()
				//Error Code  ErrorType
				//1 no  'Type error' *ÈùûÊ≥ïÊ†ºÂºèÁöÑkeyÔºå‰∏çÈáçÂèë
				//2 yes *1Ê¨° ÊèêÈÜíÊ£ÄÊü•ÁΩëÁªú 'timeout exceeded'
				//3 yes *1Ê¨° ÊèêÈÜíÊ£ÄÊü•ÁΩëÁªú 'Network Error' 
			  //4 no  '401' ÂØÜÈí•Êó†Êïà API Key Error   *Êó†Ê≠§keyÔºåÂåÖÊã¨keyÂ∑≤Ë¢´Âà†Á≠âÊÉÖÂÜµÔºå‰∏çÈáçÂèë
				//5 yes *3ÔΩû5Ê¨° 429-1 ËØ∑Ê±ÇËøáÂø´ Rate limit  *ÂåÖÊã¨ 429-1-day
			  //6 no  429-2 Ë∂ÖÂá∫ÈÖçÈ¢ù Insufficient quota   *keyÂá∫ÈóÆÈ¢òÔºåÂª∫ËÆÆ‰∏çÈáçÂèë
				//7 yes *2Ê¨° 429-3 ÊúçÂä°Âô®ËøáËΩΩ Servers overloaded 
				//8 yes *2Ê¨° 429-4 Ê®°ÂûãË∂ÖËΩΩ  Model overloaded  tips: responseType = server_error
				//9 no   429-other Êú™Áü•ÊÉÖÂÜµ *‰øùÁïôÈîôËØØ‰ø°ÊÅØ ‰∏çÈáçÂèë
			  //10 no  404 ÂΩìÂâçË¥¶Âè∑‰∏çÂ±û‰∫é‰ªª‰ΩïÁªÑÁªá   *keyÂá∫ÈóÆÈ¢òÔºåÊúÄÂ•Ω‰∏çÈáçÂèë
				//11 yes *2Ê¨° 500 ÊúçÂä°Âô®ÈóÆÈ¢ò Server error
				//12 yes *2Ê¨° 503 503-1 503-2 ÊúçÂä°Âô®ÈóÆÈ¢ò Ë∂ÖËΩΩÊàñÈîôËØØ
				//14 no  400 Ë∂ÖËøámax_tokens‰∏äÈôê  ‚ÄúÊô∫ËÉΩmax_tokens‚Äù‰ºöÂ§ÑÁêÜ&ÈáçÂèë
				//15 no  other ÂÖ∂‰ªñÊú™Áü•ÊÉÖÂÜµ   *‰øùÁïôÈîôËØØ‰ø°ÊÅØ ‰∏çÈáçÂèë
				//new 16 yes  429-5 tokensËØ∑Ê±ÇËøáÂø´(ÊØèÂàÜÈíü)  Rate limit reached for tokens(per min)
			  //new 17 yes 401 > FirstCheckedKey_401 ÂØÜÈí•Êó†Êïà API Key Error
			  //new 18 yes 429-2 > FirstCheckedKey_429-2  Ë∂ÖÂá∫ÈÖçÈ¢ù Insufficient quota
			  //new 19 yes 404 > FirstCheckedKey_404 ÂΩìÂâçË¥¶Âè∑‰∏çÂ±û‰∫é‰ªª‰ΩïÁªÑÁªá
			  //new 20 yes 404 > Model_404 Ê®°Âûã‰∏çÂ≠òÂú®ÊàñÊó†ËÆøÈóÆÊùÉÈôê
				
				//Need Auto RetryÔºö 2„ÄÅ3„ÄÅ5„ÄÅ7„ÄÅ8„ÄÅ11„ÄÅ12„ÄÅ16
				
				if ( this.autoRetry_FirstTime === 0 ){
					this.autoRetry_FirstTime = new Date().getTime();//È¶ñÊ¨°
				}
				const time_now = new Date().getTime();
				const time_interval = time_now - this.autoRetry_FirstTime;//Ë∑ùÈ¶ñÊ¨°Ëá™Âä®ÈáçÈóÆÁöÑÈó¥Èöî
				let notiftype = '';
				let delaytime = 0;//Âª∂ËøüÈáçÈóÆ
				
			//ÊµãËØï console.log('È¶ñÊ¨°Ëá™Âä®ÈáçÈóÆÁöÑÊó∂Èó¥Ôºö ' + new Date(this.autoRetry_FirstTime).toLocaleString()); 
			//ÊµãËØï console.log(time_interval); 
			//ÊµãËØï console.log('ÊéíÈô§ÂàóË°®: '); 
			//ÊµãËØï console.log(this.autoRetry_apiKeyExcludeList); 					
				// ÊéíÈô§ÂàóË°® - Â∞Üapi keyÊ∑ªÂä†Âà∞ÊéíÈô§ÂàóË°®‰∏≠  
				// *ÁõÆÂâç 2„ÄÅ3„ÄÅ5„ÄÅ7„ÄÅ8„ÄÅ11„ÄÅ12„ÄÅ16‰∏≠ÔºåÂ∫îËØ•Âè™ÊúâÁ¨¨5„ÄÅ16ÊòéÁ°ÆÊòØÊöÇÊó∂Êó†Ê≥ï‰ΩøÁî®ÁöÑkeyÔºåÈúÄË¶ÅÊéíÈô§„ÄÇ *Êó†ÈúÄÊéíÈô§ÁöÑkeyÔºåÂç≥ËôΩÁÑ∂Êú¨Ê¨°Âá∫Èîô‰∫ÜÔºå‰ΩÜÂèØÈ©¨‰∏äÈáçËØïÁöÑkey
				// * v7.20 Add 17„ÄÅ18„ÄÅ19ÔºåËøô3ÁßçÈÉΩÈúÄË¶ÅÊéíÈô§„ÄÇ v8.08 Add 20‰πüÈúÄË¶ÅÊéíÈô§
				if(errortype === '429-1' || errortype === '429-5' || errortype === 'FirstCheckedKey_401' || errortype === 'FirstCheckedKey_429-2' || errortype === 'FirstCheckedKey_404' || errortype === 'Model_404'){
					const existingItem = this.autoRetry_apiKeyExcludeList.find(item => item.apikey === this.api);
					if (!existingItem) {
						// Â¶ÇÊûú‰∏çÂ≠òÂú®ÔºåÂàôÊ∑ªÂä†Êñ∞ÂÜÖÂÆπ
						const newItem = {
							apikey: this.api,
							time: time_now
						};
						this.autoRetry_apiKeyExcludeList.push(newItem);
					} else {
						// Â¶ÇÊûúÂ≠òÂú®ÔºåÂàôÊõ¥Êñ∞Êó∂Èó¥
						existingItem.time = time_now;
					}
				}
				
				
				// ÊéíÈô§ÂàóË°® - ÊØèÊ¨°ÈÉΩÊ£ÄÊµãÊéíÈô§ÂàóË°®ÔºåÂè™‰øùÁïô20Áßí‰ª•ÂÜÖÁöÑÔºåË∂ÖÂá∫20ÁßíÂ∞±ÂÖÅËÆ∏Â∞ùËØï‰ΩøÁî®„ÄÇ 
				// *‰∏ªË¶ÅËÄÉËôëÂÆåÂñÑÈÄªËæëÊÄßÔºåËôΩÁÑ∂Êà™Ê≠¢7.13Ëá™Âä®ÈáçÈóÆÁöÑ"Ê¨°Êï∞ÂæàÂ∞ë"Âèä‚ÄúÊó∂Èó¥Èó¥ÈöîËæÉÁü≠‚Äù	
				this.autoRetry_apiKeyExcludeList = this.autoRetry_apiKeyExcludeList.filter(item => {
					return (time_now - item.time) <= 20000; // Âà§Êñ≠Êó∂Èó¥Êà≥ÊòØÂê¶Â∞è‰∫éÂΩìÂâçÊó∂Èó¥20Áßí
				});
				
						
				// Ââ©‰ΩôÂèØÂ∞ùËØïÁöÑKey(Ââ©‰ΩôÊúÄÂ§ßÈáçËØïÊ¨°Êï∞)ÔºåÂÖàËøáÊª§ÊéâÊéíÈô§ÂàóË°®‰∏≠ÁöÑkeyÔºåÂÜçÊéíÈô§level8Âíålevel9(ÈÖçÈ¢ù‰∏çË∂≥/ËøáÊúüÁöÑkey)„ÄÇ
				//*Âä®ÊÄÅÔºåautoRetry_apiKeyExcludeListÁöÑÊï∞ÈáèÂêåÊó∂Â≠òÂú®Â¢ûÂä† Âíå ÂáèÂ∞ëÁöÑÂèØËÉΩ„ÄÇ
				//*ÁõÆÂâç‰ª£Á†ÅÁöÑÈÄªËæëÔºàÂèØËÉΩ‰ºöÂá∫Áé∞ÂèòÂåñÔºâÔºöËΩÆÊç¢keyÊó∂ÔºàgetFirstAvailableAPIKeyÔºâÔºåÊòØÊúâÂ∞èÊ¶ÇÁéáËé∑ÂèñÂà∞8Êàñ9ÁöÑ„ÄÇ ËÄåËøôÈáåÂè™ÊòØÂú®Ê¨°Êï∞‰∏äËøõË°åÊéíÈô§„ÄÇ  tipÔºöÂ¶Ç‰ΩïÈáçÊñ∞Ê£ÄÊµãlevel8Âíålevel9 Ôºü 1)Ê≠£Â∏∏ÂèëÈÄÅÊó∂ÔºåËΩÆÊç¢Âà∞8Êàñ9  2)ÂºÄÂèëÁÆ°ÁêÜÂäüËÉΩ„ÄÅ‰∏ÄÈîÆÊ£ÄÊµãÂäüËÉΩ
				let temp_apiCheckedData = this.apiCheckedData.filter(apidata => !this.autoRetry_apiKeyExcludeList.some(obj => obj.apikey === apidata.apikey) && apidata.level !== 8 && apidata.level !== 9 && apidata.vpn !== 'third-party');
				if(!this.isThirdPartyAPIKeyEnabled && this.apiGPTModel.includes('gpt-4')){ //ÈùûÁ¨¨‰∏âÊñπÂçïKeyÊ®°Âºè Not Third-party Key mode
					const temp_data = temp_apiCheckedData.filter(apidata => apidata.vpn === 'GPT-4' || apidata.level === null || apidata.level === 0);
					////if(temp_data.length > 0){ 
						temp_apiCheckedData = temp_data;
					////}
				}	
				let remainingKeysCount = temp_apiCheckedData.length; 
				
			//ÊµãËØï console.log('Ââ©‰ΩôÂèØÂ∞ùËØïÁöÑKey(Ââ©‰ΩôÊúÄÂ§ßÈáçËØïÊ¨°Êï∞) remainingKeysCount: ' + remainingKeysCount); 
				
				if(errortype === 'timeout exceeded' || errortype === 'Network Error'){
				// A: 2„ÄÅ3
					if (this.autoRetry_log.includes('timeout exceeded') || this.autoRetry_log.includes('Network Error')) {
						//Âà§Êñ≠LogÔºöAÁ±ªÔºåÂ∑≤ÁªèÈáçËØïËøá1Ê¨°Ôºå‰∏çÂÜçÈáçËØï *AÁ±ªÈªòËÆ§ÊúÄÂ§ö1Ê¨°
						notiftype = 'center';
					}else if(time_interval > 6000){  //*Âà§Êñ≠Êó∂Èó¥Êúâ‰∫õÁâµÂº∫ÔºåÁÆÄÂçïÂú∞ÂΩì‰Ωú‰∏Ä‰∏™Êó∂Èó¥ÈôêÂà∂
						//Êó†ËÆ∫‰πãÂâçÂ§öÂ∞ëÊ¨°ÁöÑËá™Âä®ÈáçÈóÆÁªÑÂêàÔºåÂêàËÆ°Ëææ6Áßí *Ê≠§Á±ªÈîôËØØÔºöÂ§ßÊ¶ÇÁéáÊòØÈ¶ñÊ¨°Âá∫Áé∞ÔºåÂ¶ÇÊûúÊòØÂ§öÊ¨°Á±ªÂûãÈáçËØïÂêéÂá∫Áé∞ÁΩëÁªúÈóÆÈ¢òÔºåÂ∞±‰∏çÈáçËØï‰∫Ü 
						notiftype = 'center';
					}else{
						notiftype = 'bottom';
						delaytime = errortype === 'Network Error' ? 1200 : 0; //Network Error,Êä•ÈîôÈÄüÂ∫¶Â§™Âø´ÔºåÂ∫ïÈÉ®ÈÄöÁü•Êú™ÂºπÂá∫ÔºåÈáçÈóÆÂêéÊä•Èîô(center)Â∞±Â∑≤ÁªèÂÖàÂºπÂá∫Ôºå‰∏î‰ºöË¢´Â∫ïÈÉ®ÈÄöÁü•ÁöÑÂÆöÊó∂Âô®ÁªôÂÖ≥Èó≠„ÄÇ 100ÊØ´ÁßíÂç≥ÂèØ(Â∫ïÈÉ®ÈÄöÁü•Â∞öÊú™ÊòæÁ§∫)Ôºå‰ΩÜ‰∏∫‰∫ÜÂ∫ïÈÉ®ÈáçÈóÆÈÄöÁü•ÂèØ‰ª•ÊòæÁ§∫‰∏ÄÊÆµÊó∂Èó¥ÔºåÈúÄË¶ÅÂª∂Ëøü1200ÊØ´Áßí„ÄÇ
					}
					
				}else if(errortype === '429-1' || errortype === '429-5' || errortype === 'Model_404'){
				// B: 5 „ÄÅ16 „ÄÅ20
					const matchCount = (this.autoRetry_log.match(/429-1|429-5|Model_404/g) || []).length;
					if(matchCount >= 8 || remainingKeysCount < 1){ //BÁ±ªÈªòËÆ§ÊúÄÂ§ö8Ê¨°ÔºåÂ¶ÇÊûúÂèØÁî®key‰∏∫0(Ââ©‰ΩôÊúÄÂ§ßÈáçËØïÊ¨°Êï∞)ÔºåÊèêÂâçÁªìÊûú
						//Âà§Êñ≠LogÔºöBÁ±ªÔºåÂ∑≤ÁªèÈáçËØïËøá8Ê¨°Ôºå‰∏çÂÜçÈáçËØï
						notiftype = 'center';
					}else if(time_interval > 10000){//*Âà§Êñ≠Êó∂Èó¥Êúâ‰∫õÁâµÂº∫ÔºåÁÆÄÂçïÂú∞ÂΩì‰Ωú‰∏Ä‰∏™Êó∂Èó¥ÈôêÂà∂
						//Êó†ËÆ∫‰πãÂâçÂ§öÂ∞ëÊ¨°ÁöÑËá™Âä®ÈáçÈóÆÁªÑÂêàÔºåÂêàËÆ°Ëææ10Áßí *Ê≠§Á±ªÈîôËØØÔºöÂ§ßÊ¶ÇÁéáÁΩëÁªúÊ≤°ÈóÆÈ¢òÔºåÊúçÂä°Âô®ÈóÆÈ¢òÂèØ‰ª•ÂøΩÁï•ÔºåÂ§ßÊ¶ÇÁéáÈÉΩÊòØÈáçÂ§çÂêåÁ±ªÈîôËØØÔºåÊó∂Èó¥Áü≠ÁÇπÔºå‰∏ªË¶ÅÈíàÂØπkeyÊòØÂê¶ËÉΩÁî®Ôºå‰∏çËÉΩÁî®ËÄóÊó∂Â§™‰πÖÊó†ÊÑè‰πâ
						notiftype = 'center';
						
			//ÊµãËØï console.log('Êó†ËÆ∫‰πãÂâçÊúâËøáÂ§öÂ∞ëÊ¨°ÁöÑ‚ÄúËá™Âä®ÈáçÈóÆ‚ÄùÁöÑÁªÑÂêàÔºåÁõÆÂâçËææÂà∞‰∫Ü 10 Áßí„ÄÇÂÅúÊ≠¢Ëá™Âä®ÈáçÈóÆ - ' + errortype);  

					}else{
						notiftype = 'bottom';
					}
					
			//ÊµãËØï console.log('Êó•Âøó‰∏≠Âá∫Áé∞ÁöÑÊ¨°Êï∞ matchCount Ôºö ' + matchCount); 	
				
				}else if(errortype === '429-3' || errortype === '429-4' || errortype === '500' || errortype === '503'){
				// C: 7„ÄÅ8„ÄÅ11„ÄÅ12
					const regex = /(429-3|429-4|500|503)/g;
					const matchCount = (this.autoRetry_log.match(regex) || []).length;
					if (matchCount >= 3 || remainingKeysCount < 1) {  //CÁ±ªÈªòËÆ§ÊúÄÂ§ö3Ê¨°ÔºåÂ¶ÇÊûúÂèØÁî®key‰∏∫0(Ââ©‰ΩôÊúÄÂ§ßÈáçËØïÊ¨°Êï∞)ÔºåÊèêÂâçÁªìÊûú
					// Code to handle when any of the contents appeared at least 3 times
						//Âà§Êñ≠LogÔºöCÁ±ªÔºåÂ∑≤ÁªèÈáçËØïËøá3Ê¨°Ôºå‰∏çÂÜçÈáçËØï
						notiftype = 'center';
					}else if(time_interval > 30000){//*Âà§Êñ≠Êó∂Èó¥Êúâ‰∫õÁâµÂº∫ÔºåÁÆÄÂçïÂú∞ÂΩì‰Ωú‰∏Ä‰∏™Êó∂Èó¥ÈôêÂà∂
						//Êó†ËÆ∫‰πãÂâçÂ§öÂ∞ëÊ¨°ÁöÑËá™Âä®ÈáçÈóÆÁªÑÂêàÔºåÂêàËÆ°Ëææ30Áßí  *Ê≠§Á±ªÈîôËØØÔºöÂ§ßÊ¶ÇÁéáÁΩëÁªúÊ≤°ÈóÆÈ¢ò+keyÊ≤°ÈóÆÈ¢òÔºåÂ§ßÊ¶ÇÁéáÈáçÂ§çÈÅáÂà∞ÊúçÂä°Âô®ÈóÆÈ¢òÔºåÂçïÊ¨°Â§±Ë¥•ËØ∑Ê±ÇÁöÑËÄóÊó∂ÂèØËÉΩ‰ºöÂæà‰πÖÔºåÊâÄ‰ª•Èó¥ÈöîÈúÄË¶ÅÈïøÁÇπ„ÄÇ
						notiftype = 'center';
					}else{
						notiftype = 'bottom';
					}
				}else if(errortype === 'FirstCheckedKey_401' || errortype === 'FirstCheckedKey_429-2' || errortype === 'FirstCheckedKey_404'){
				// D: 17„ÄÅ18„ÄÅ19
					const regex = /(FirstCheckedKey_401|FirstCheckedKey_429-2|FirstCheckedKey_404)/g;
					const matchCount = (this.autoRetry_log.match(regex) || []).length;
					if (matchCount >= 20 || remainingKeysCount < 1) {  //DÁ±ªÈªòËÆ§ÊúÄÂ§ö20Ê¨°ÔºåÂ¶ÇÊûúÂèØÁî®key‰∏∫0(Ââ©‰ΩôÊúÄÂ§ßÈáçËØïÊ¨°Êï∞)ÔºåÊèêÂâçÁªìÊûú
						//Âà§Êñ≠LogÔºöDÁ±ªÔºåÂ∑≤ÁªèÈáçËØïËøá20Ê¨°Ôºå‰∏çÂÜçÈáçËØï
						notiftype = 'center';
					}else if(time_interval > 60000){//*Âà§Êñ≠Êó∂Èó¥Êúâ‰∫õÁâµÂº∫ÔºåÁÆÄÂçïÂú∞ÂΩì‰Ωú‰∏Ä‰∏™Êó∂Èó¥ÈôêÂà∂
						//Êó†ËÆ∫‰πãÂâçÂ§öÂ∞ëÊ¨°ÁöÑËá™Âä®ÈáçÈóÆÁªÑÂêàÔºåÂêàËÆ°Ëææ60Áßí  *Ê≠§Á±ªÈîôËØØÔºöÂØºÂÖ•ÂÖ®Êñ∞key Êàñ ÊâπÈáèÊ∑ªÂä†keyÊó∂ÔºåÂØπÊñ∞keyËøõË°åÈ¶ñÊ¨°È™åËØÅÔºåÂ¶ÇÊûúÂ§ßÈáèkeyÂ≠òÂú®ÈóÆÈ¢òÔºåÂêØÂä®Ëá™Âä®ÈáçÈóÆÔºåËøûÁª≠Ê£ÄÊµãÔºå20Ê¨°ÂÜÖ‰∏çÂÅú
						notiftype = 'center';
					}else{
						delaytime = 0;//ËøûÁª≠ËØ∑Ê±ÇÊúÄÂ§ö20Ê¨°ÔºåÈÅøÂÖçËØ∑Ê±ÇËøáÂø´Ë¢´ÂÆòÊñπÈôêÂà∂ÔºåËøôÈáåÂèØ‰ª•ËÆæÁΩÆÂª∂ËøüÈáçÈóÆ(ÊØîÂ¶Ç:30 *30ÊØ´Áßí) *Êú™ÂèëÁé∞ËØ∑Ê±ÇËøáÂø´‰ºöË¢´ÈôêÂà∂ÔºåÂ∑≤ÂèñÊ∂àÂª∂ËøüÔºåËÆæ‰∏∫0Ôºå‰∏çÂª∂Ëøüretry
						notiftype = 'bottom';
					}
				}else{
					notiftype = 'center';
				}
				
				
				if(notiftype === 'bottom'){ //Ëá™Âä®ÈáçÈóÆÔºåÊîπ‰∏∫Â∫ïÈÉ®ÈÄöÁü•
					const retryLog = errortype + ' ';//Êú¨Ê¨°ÁÆÄÂçïÁöÑÊó•ÂøóËÆ∞ÂΩï
					this.autoRetry_log += retryLog;//ÁªìÊùüÊó∂ËøΩÂä†Êó•ÂøóËÆ∞ÂΩï
					
			//ÊµãËØï console.log('ÊâßË°åÈáçÈóÆ‰πãÂâçÔºåÊéíÈô§ÂàóË°®‰∏≠keyÁöÑÊï∞ÈáèÔºö ' + this.autoRetry_apiKeyExcludeList.length); 

					setTimeout(() => {
						this.retry();//ÈáçÈóÆ  *ÊòØÂê¶Êúâ‰∏ÄÂÆöË¶ÅÂª∂Êó∂ÁöÑÂéüÂõ†ÔºüÔºö
					}, delaytime);//ÂèØ‰∏çÂª∂Êó∂ÔºåÂèØÂª∂Êó∂0ÔºåÂèØÂª∂Êó∂Âá†ÂçÅÊØ´ÁßíÔºåÂÜçÈ´ò‚ÄúÊåâÈíÆÂèØÁî®Áä∂ÊÄÅ‚ÄùÂ∞±‰ºöÈó™
				}else{ //notiftype = 'center' ÂÅúÊ≠¢ÈáçÈóÆÔºå‰∏≠ÂøÉÈÄöÁü•
					//‰∏ªË¶ÅÊúâ‰∏§‰∏™Âú∞ÊñπÈúÄË¶ÅÈáçÁΩÆautoRetryÁöÑÂèòÈáèÊï∞ÊçÆÔºö1.ÂèëÈÄÅÊàêÂäüÊó∂  2.Ëá™Âä®ÈáçÈóÆÂÅúÊ≠¢Êó∂(Âç≥ÊúÄÂêé‰∏ÄÊ¨°Ëá™Âä®ÈáçÈóÆÂ§±Ë¥•Êó∂)
					this.autoRetry_apiKeyExcludeList = []; //ÈáçÁΩÆautoRetryÊï∞ÊçÆ-1: Ê∏ÖÁ©∫"Ëá™Âä®ÈáçÈóÆ"ÁöÑ API KeyÊéíÈô§ÂàóË°®
					this.autoRetry_FirstTime = 0; //ÈáçÁΩÆautoRetryÊï∞ÊçÆ-2: Ê∏ÖÁ©∫È¶ñÊ¨°Ëá™Âä®ÈáçÈóÆÁöÑÊó∂Èó¥
					this.autoRetry_log = ''; //ÈáçÁΩÆautoRetryÊï∞ÊçÆ-3: Ê∏ÖÁ©∫‰∏¥Êó∂Êó•Âøó
					
			//ÊµãËØï console.log('ÊúÄÂêé‰∏ÄÊ¨°Ëá™Âä®ÈáçÈóÆÔºàÊúÄÂêé‰∏ÄÊ¨°-Â§±Ë¥•-ÂÅúÊ≠¢ÈáçÈóÆÔºâÔºåÊéíÈô§ÂàóË°®‰∏≠keyÁöÑÊï∞ÈáèÔºö ' + this.autoRetry_apiKeyExcludeList.length); 
				}
					
					
				//Â∫ïÈÉ®ÈÄöÁü• Êàñ ‰∏≠ÂøÉÈÄöÁü•
				setTimeout(() => {
					const notif = notiftype === 'center' ? centernotif : bottomnotif ;
					
					//ÂΩìÂâçÂ≠òÂú®ÈÄöÁü• & ÂΩìÂâçÈÄöÁü•Âú®Â∫ïÈÉ® & Êú¨Ê¨°ÈÄöÁü•Âú®Â∫ïÈÉ®
					const notif_state = (this.isShowNotification === true && this.setNotificationPosition === 'bottom' && notiftype === 'bottom');
					//ÂΩìÂâçÈÄöÁü•‰∏∫Ëá™Âä®ÈáçÈóÆÁöÑÈÄöÁü•  
					const notif_isAutoRetry = ( this.setNotificationContent.includes('Ëá™Âä®ÈáçÈóÆ') || this.setNotificationContent.includes('Ëá™Âä®ÈáçÂèë') || this.setNotificationContent.includes('Ëá™Âä®ÈáçËØï') || this.setNotificationContent.toLowerCase().includes('retry') || this.setNotificationContent.toLowerCase().includes('resend'))
					
					if(notif_state && notif_isAutoRetry ){
						//Áõ¥Êé•ÊõøÊç¢ÂÜÖÂÆπ
						this.setNotificationContent = notif;
					}else{
						//Â∫ïÈÉ®ÈÄöÁü• Êàñ ‰∏≠ÂøÉÈÄöÁü•
						this.showNotification(notif, notiftype, centernotiftitle, 2300);// ÊòæÁ§∫Êó∂Èó¥‰∏çË¶ÅÂ§™ÈïøÔºå‰∏çËÄÉËôë‚ÄúÂÅ∂Â∞îÈÅáÂà∞‰∏çÂêåÈîôËØØÔºåÈÄöÁü•ÊñáÂ≠óË¢´ÊõøÊç¢Êñ∞ÂÜÖÂÆπÂêéÔºåÊù•‰∏çÂèäÁúãÂ∞±Êó∂Èó¥Âà∞‰∫Ü (Èó™)‚ÄúÁöÑÊÉÖÂÜµ 
					}
				}, 80); //ËÄÉËôëshowNotificationÂºπÂá∫Êúâ50msÁöÑÂª∂ËøüÔºåÂÆûÈôÖËøôÈáå‰∏çÂª∂ËøüÂ•ΩÂÉè‰πüÊ≤°ÈóÆÈ¢ò
			},
				
			//ËÅäÂ§©ËÆ∞ÂΩïÊªöÂä®Ëá≥ÊúÄ‰∏ãÊñπ„ÄÇScroll to the bottom of the chat.
			scrollToBottomView() {
				//TipsÔºö body-Height ‰ª•‰∏ã3‰∏™ÈÉΩÂèØ‰ª•ËÉΩÁî®
				//document.body.offsetHeight
				//document.body.clientHeight
				//document.body.scrollHeight

				//TipsÔºö screen-Height
				//window.screen.height NO! xxxxxx
				//window.screen.availHeight NO! xxxxxx
				//window.outerheight  NO! xxxxx 
				//window.innerHeight  xx ÁßªÂä®Á´ØÔºö‰ºöË∑üÈöèÂèåÊåáÊîæÂ§ßÊîπÂèòÔºõËΩØÈîÆÁõòÂºπÂá∫Âêé‰ºöÊîπÂèò„ÄÇ
				//document.documentElement.clientHeight ‰∏éwindow.innerHeight‰∏ÄÊ†∑Ôºå‰ΩÜÊòØ‰∏ç‰ºöË∑üÈöèÂèåÊåáÊîæÂ§ßËÄåÊîπÂèòÔºåËΩØÈîÆÁõòÂºπÂá∫Âêé‰πü‰∏ç‰ºöÊîπÂèò„ÄÇ

				const positioningDiv = document.querySelector('.bottom-position');
				//Âä†ÂÖ•<!DOCTYPE html>Âêé  ÈóÆÈ¢òÂæóÂà∞Ëß£ÂÜ≥
				const bodyheight = document.body.offsetHeight + 8 + 8 ; //margin-top:8  margin-bottom:8
				const screenheight = document.documentElement.clientHeight;
				if (bodyheight > screenheight) { 
					this.$nextTick(() => {
						positioningDiv.scrollIntoView({behavior: 'smooth',block: 'start'});
	  				});
				}
			},
			//ÁßªÂä®Á´Ø - ÁÇπÂáªËæìÂÖ•Ê°Ü - ËÅäÂ§©ËÆ∞ÂΩïÊªöÂä®Ëá≥ÊúÄ‰∏ãÊñπ„ÄÇ For Mobile - Click on chat input box -  Scroll to the bottom of the chat. 
			scrollToBottomViewClick() {
				//Ê£ÄÊµãÊòØÂê¶‰∏∫ÁßªÂä®Á´Ø ‰∏îÊòØÂê¶‰∏∫È¶ñÊ¨°ÁÇπÂáª
				if ( this.isfirstclickonchatinputbox && navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)) {
					 	
						this.isfirstclickonchatinputbox = false;
						this.scrollToBottomView();
				}
			},
			//ÂÖ≥Èó≠ËΩØÈîÆÁõòÔºåÁßªÂä®Á´ØÂ§¥Âá†Êù°ÂÜÖÂÆπËæÉÁü≠ÁöÑ‰ø°ÊÅØ‰∏ç‰ºö‰∫ßÁîüÂ±èÂπïÊªöÂä®ÔºåËøôÈáåÂÅöÂÖ≥Èó≠ËΩØÈîÆÁõòÂ§ÑÁêÜÔºåÂèØ‰ª•ÁúãÂà∞Ê∂àÊÅØÔºå‰ΩìÈ™å‰ºöÊõ¥Â•Ω„ÄÇ close Software Keyboard For Mobile
			closeSoftwareKeyboard() {
			 	const bodyheight = document.body.offsetHeight - 95 + 8 ; //bottom-position:95   margin-top:8
				const screenheight = document.documentElement.clientHeight;
				let closeSoftwareKeyboard = false;
				if (navigator.userAgent.match(/(pad|iPad)/i)) {
					//(Âπ≥Êùø) ÊØèÊ¨°ÂèëÈÄÅÂêéÂÖ≥Èó≠ËΩØÈîÆÁõò
					if (bodyheight < screenheight*3/7) { 
			 			closeSoftwareKeyboard = true;
					}
				}else if (navigator.userAgent.match(/(phone|pod|iPhone|iPod|ios|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i) ) {
					//(ÊâãÊú∫) ÊØèÊ¨°ÂèëÈÄÅÂêéÂÖ≥Èó≠ËΩØÈîÆÁõò
					if (bodyheight < screenheight*5/7) { 
						closeSoftwareKeyboard = true;
					}
				}
				if(closeSoftwareKeyboard) {
					this.$nextTick(() => {
						if (document.activeElement && document.activeElement !== document.body) {
							document.activeElement.blur();
						}
	  				});
				}
				
			},	
			//ÂØπËØùÊ°Ü ÁîµËÑëÁ´ØÊîØÊåÅÁªÑÂêàÈîÆÊç¢Ë°å(Line break)  ÊîØÊåÅCtrl+Enter Âíå Commond+Enter Âíå Win+Enter Êç¢Ë°åÔºåÂè¶Êúâshift+enterÔºàÊó†ÈúÄËÆæÁΩÆÔºâ
			newLine(e) {
				//Ëß£ÂÜ≥safariÊØèÊ¨°ÈÉΩÊòØÊç¢‰∏§Ë°åÁöÑbugÔºåÂÖ∂‰ªñÊµèËßàÂô®Ê≠£Â∏∏   e=eeÔºü
				let ee = window.event || arguments[0];
				ee.returnValue = false;
				
				 // 1.Ëé∑ÂèñÂÖâÊ†á‰ΩçÁΩÆ
				const ele = e.target;
				const cursorIndex = ele.selectionStart;
				// 2.ÂÖâÊ†áÂêéÂä†ÂÖ•Êç¢Ë°åÁ¨¶
				let temp_text = this.msg.split('');
				temp_text.splice(cursorIndex, 0, '\n');
				this.msg = temp_text.join('');
				// 3.ÁßªÂä®ÂÖâÊ†á ÊëòÔºö‚ÄúÁßªÂä®ÂÖâÊ†áÊó∂Ë¶ÅÊ≥®ÊÑèÔºåÂõ†‰∏∫VueÂìçÂ∫îÂºèÔºåÂú®‰øÆÊîπ‰∫ÜtextÁöÑÂÄºÂêéÔºåÂ¶ÇÊûúÁ´ãÂàªÊâßË°åÁßªÂä®ÂÖâÊ†áÔºåÂàôÁ¥ßÊé•ÁùÄÂ∞±‰ºöÂõ†‰∏∫ÈáçÊñ∞ËÆæÁΩÆ‰∫ÜtextÁöÑÂÄºÔºåÂÖâÊ†á‰ºöÁßªÂä®Âà∞ÊúÄÂêéÔºåÊâÄ‰ª•Ë¶ÅÁ≠âdomÊìç‰ΩúÂÆåÊØïÂêéÔºåÂÜçËøõË°åÁßªÂä®ÂÖâÊ†áÁöÑÊìç‰Ωú„ÄÇ‚Äù
				Vue.nextTick(() => {
					ele.selectionStart = ele.selectionEnd = cursorIndex + 1;
					
					//Ëá™ÈÄÇÂ∫îÈ´òÂ∫¶
					let height6px = parseInt(ele.scrollHeight) + 6; // +
					ele.style.height = '38px'; //aboutÔºöËá™ÈÄÇÂ∫îÈ´òÂ∫¶ max-height maxHeight 
					//ele.style.maxHeight = ele.scrollHeight + 'px'; // -
					//ele.style.height = ele.scrollHeight + 'px'; // -
					ele.style.maxHeight = height6px.toString() + 'px'; // +
					ele.style.height = height6px.toString() + 'px';  // +
				}) 
			},
			//ÂØπËØùÊ°Ü ÊåâÂõûËΩ¶ÈîÆEnterÂèëÈÄÅ‰πãÂâçÈúÄË¶ÅÂà§Êñ≠ÊòØÂê¶‰∏∫‰∏≠ÊñáËæìÂÖ•Ê≥ï  The current input method is in Chinese or not.
			textareaEnter(e) {
				let ee = window.event || arguments[0];
				 
	 
	 			//ÁîµËÑëÁ´Ø‰∏≠ÊñáËæìÂÖ•Ê≥ïÊó∂ee.keyCode‰∏∫229ÔºåÂç≥‰∏≠ÊñáËæìÂÖ•Ê≥ï/‰∏≠Ëã±Ê∑∑Ëæì/ÊãºÈü≥Áä∂ÊÄÅ‰∏ãËæìÂÖ•Ëã±ÊñáÊó∂ÔºåÈÅøÂÖçÊåâÂõûËΩ¶ÈîÆÂêéÁõ¥Êé•ÂèëÈÄÅÂá∫Âéª
				if (ee.key == "Enter" && (ee.code == "Enter" || ee.code == "NumpadEnter") && ee.keyCode == 13) {
					//ÈòªÊ≠¢ÂéüÂßãÊéß‰ª∂ÂõûËΩ¶Êç¢Ë°åÁöÑÂä®‰Ωú
					ee.returnValue = false;
					
					//ÊâßË°åÂèëÈÄÅ
					this.sendMsg();
				}
			},
			//Ëß£ÂÜ≥ textarea (Enterkeyhint = send) ËæìÂÖ•Ê≥ï‰∏≠‚ÄúÊç¢Ë°å‚ÄùÁöÑÂÖºÂÆπÊÄßÈóÆÈ¢ò ÔºàÁßªÂä®Á´Ø) 
			//ÂΩìtextareaÊéß‰ª∂‰∏≠ÁöÑ"Enterkeyhint"ËÆæÁΩÆ‰∏∫"send"Êó∂ÔºåÊâãÊú∫‰∏äÁöÑËæìÂÖ•Ê≥ï‰ºöÂá∫Áé∞"ÂèëÈÄÅSend"ÊåâÈíÆÔºàÂäüËÉΩÊ≠£Â∏∏ÔºâÔºåÊ≠§Êó∂Â§öÊï∞"‰∏≠ÊñáËæìÂÖ•Ê≥ï"‰ºöÊèê‰æõ‚ÄúÊç¢Ë°å‚ÄùÂäüËÉΩÔºåËÄåËøô‰∏™Êç¢Ë°åÈîÆÂæàÂèØËÉΩÂ≠òÂú®ÂÖºÂÆπÊÄßÈóÆÈ¢ò„ÄÇ
			//*ÈíàÂØπÈÉ®ÂàÜÊú∫Âûã ÈÉ®ÂàÜËæìÂÖ•Ê≥ïÁâàÊú¨ *v7.21 ÁôæÂ∫¶ÁöÑÊç¢Ë°åÈóÆÈ¢òÂ∑≤Ëß£ÂÜ≥ÔºõÊêúÁãóÂè™ËÉΩÂãâÂº∫Êç¢Ë°åÔºà‰ºöÂ§öÂá∫‰∏ÄË°åÔºâÔºõ
			textareaMobileInputCompatibility(e) {
				//'\r'ÂõûËΩ¶Ôºå'\n'Êç¢Ë°å
				//Windows ÂõûËΩ¶Êç¢Ë°åÁ¨¶Ôºö\r\n  
				//Unix„ÄÅ Mac OS 9‰πãÂêé ÂõûËΩ¶Êç¢Ë°åÁ¨¶Ôºö\n  ‰πãÂâçÊòØÔºö\r
				//iphoneÔºöÁôæÂ∫¶ËæìÂÖ•Ê≥ïÁöÑ‚ÄúÊç¢Ë°åÈîÆ‚ÄùÊó†Ê≥ïÊç¢Ë°åÔºå‰∏î‰ºöÈÄÄÊ†ºÂà†Èô§ÔºõÊêúÁãóËæìÂÖ•Ê≥ïÁöÑ‚ÄúÊç¢Ë°åÈîÆ‚ÄùÊó†Ê≥ïÊç¢Ë°åÔºå‰∏î‰ºöÊ∑ªÂä†ÈöêÂΩ¢ÂõûËΩ¶Á¨¶Âè∑Ôºõ ÂæÆ‰ø°ËæìÂÖ•Ê≥ï ‰∏é ËÆØÈ£ûËæìÂÖ•Ê≥ï ÂàôÂèØ‰ª•ÊàêÂäüÊç¢Ë°å„ÄÇ
				//Êµãe.keyÁªìÊûúÔºöÁôæÂ∫¶Êç¢Ë°å‰ºöÊâßË°å"\n\u007" + 1Ê¨°Backspace(ÈÄÄÊ†ºÈîÆ)ÔºõÊêúÁãóÊç¢Ë°å‰ºöÊâßË°å"\r\r" + 1Ê¨°Backspace(ÈÄÄÊ†ºÈîÆ) + ÊêúÁãó‰ºöÂä®ÊÄÅËÆ°ÁÆóÊõøÊç¢Â§ö‰∏™\rÊàñ\nÔºõ
				//Êµãe.keyÁªìÊûúÔºöÂæÆ‰ø°ËæìÂÖ•Ê≥ïÊç¢Ë°å‰ºöÊâßË°å"\n "(ËøòÊúâ‰∏™Êç¢Ë°åÁ¨¶) + 1Ê¨°Backspace(ÈÄÄÊ†ºÈîÆ)ÔºõËÆØÈ£ûÊç¢Ë°å‰ºöÊâßË°å"\n\r" + 1Ê¨°Backspace(ÈÄÄÊ†ºÈîÆ)Ôºõ
				
				// *‰ªÖÂú®iPhone‰∏≠ÊµãËØï
				try{
					//ÊµãËØïtest this.gptSystemPrompt += '\r\n--------------'; //test
					//ÊµãËØïtest this.gptSystemPrompt += ('\r\nStart - e.key:' + JSON.stringify(e.key) + '_  e.code:' + e.code + '_  e.keyCode:' + e.keyCode );
					
					if(e.key === "\n\u0007" && e.code === 'Unidentified' &&  e.keyCode === 0 ){
					//ÁôæÂ∫¶ËæìÂÖ•Ê≥ï Êç¢Ë°åÈîÆkeydown‰∫ã‰ª∂ÁöÑÁâπÂÆöÁâπÂæÅÔºà3Êù°‰ª∂ÂêåÊó∂ÊàêÁ´ãÔºâ
						e.preventDefault();// ÈòªÊ≠¢ ÈªòËÆ§ÁöÑ "\n\u0007" ËæìÂá∫Ë°å‰∏∫
						//ÁôæÂ∫¶‚ÄúÊç¢Ë°å‚ÄùÂÆûÈôÖ‰∏äÊòØËøûÁª≠‰∏§Ê¨°ÈîÆÂÖ•ÔºåÁ¨¨1Ê¨°ÊòØÈîÆÂÖ•"\n\u0007" ÔºåÁ¨¨2Ê¨°ÊòØÈîÆÂÖ•‚ÄúBackspace‚ÄùÔºàÂà†Èô§ÈîÆÔºâ„ÄÇ "\n\u0007"Âπ∂Ê≤°ÊúâÂÆûÈôÖÂç†Áî®Â≠óÁ¨¶(‰∏§‰∏™Â≠óÁ¨¶?)ÔºåÊâÄ‰ª•Á¨¨2Ê¨°Ëá™Âä®ÊâßË°å‚ÄúBackspace‚ÄùÊó∂‰ºöÂà†Èô§Áî®Êà∑ËæìÂÖ•ÁöÑÂÜÖÂÆπ
						this.newLine(e); //ÂÄüÁî®newLineÔºåÂàöÂ•ΩÂèØ‰ª•ÈÄÇÁî®ÔºåÂÆûÁé∞Êç¢Ë°å
						this.bugfixing_BaiduInput_NewLine_timestamp = new Date().getTime();//ÂΩìÂâçÊó∂Èó¥
						//ËøòÈúÄË¶ÅÈòªÊ≠¢Á¨¨2Ê¨°Ëá™Âä®ÈîÆÂÖ•‚ÄúBackspace‚Äù
						//ÊµãËØïtest this.gptSystemPrompt += ('\r\nÁôæÂ∫¶ - e.key:' + JSON.stringify(e.key) + '_  e.code:' + e.code + '_  e.keyCode:' + e.keyCode );
						
					}else if(e.key === "\r\r" && e.code === 'Unidentified' &&  e.keyCode === 229 ){
					//ÊêúÁãóËæìÂÖ•Ê≥ï Êç¢Ë°åÈîÆkeydown‰∫ã‰ª∂ÁöÑÁâπÂÆöÁâπÂæÅÔºà3Êù°‰ª∂ÂêåÊó∂ÊàêÁ´ãÔºâ
						e.preventDefault();// ÈòªÊ≠¢ ÈªòËÆ§ÁöÑ "\r\r" ËæìÂá∫Ë°å‰∏∫
						//ÊêúÁãó‚ÄúÊç¢Ë°å‚ÄùÂÆûÈôÖ‰∏äÊòØËøûÁª≠‰∏§Ê¨°ÈîÆÂÖ•ÔºåÁ¨¨1Ê¨°ÊòØÈîÆÂÖ•"\r\r" ÔºåÁ¨¨2Ê¨°ÊòØÈîÆÂÖ•‚ÄúBackspace‚ÄùÔºàÂà†Èô§ÈîÆÔºâ„ÄÇ "\r\r"Ê≤°ÊúâÂÆûÈôÖ‰ΩúÁî®Ôºå‰∏îÊòØÈöêËóèÁöÑÔºåÂπ∂Âç†‰ΩçÔºàÊç¢Ë°åÂá†Ê¨°Â∞±Âç†‰ΩçÂá†Ê¨°ÔºåÂÖâÊ†á‰∏çÂèòÔºâÔºåÊêúÁãóÁ¨¨2Ê¨°Ëá™Âä®ÊâßË°å‚ÄúBackspace‚ÄùÊó∂Ê≤°Êúâ‰ªª‰ΩïÂèòÂåñ
						//ÊµãËØïtest this.gptSystemPrompt += ('\r\n1...' + JSON.stringify(this.msg) );
						this.newLine(e);
						//‰∏çÈúÄË¶ÅÈòªÊ≠¢Á¨¨2Ê¨°Ëá™Âä®ÈîÆÂÖ•‚ÄúBackspace‚Äù //‰∏éÁôæÂ∫¶‰∏çÂêåÁöÑÂéüÂõ†ÊòØÔºåÊêúÁãóÊòØÂä®ÊÄÅÂ§ÑÁêÜÔºåÊâæ‰∏çÂà∞ËßÑÂæãÔºåÊêû‰∏çÂÆö...
						//ÊµãËØïtest this.gptSystemPrompt += ('\r\nÊêúÁãó - e.key:' + JSON.stringify(e.key) + '_  e.code:' + e.code + '_  e.keyCode:' + e.keyCode );
						//ÊµãËØïtest this.gptSystemPrompt += ('\r\n2...' + JSON.stringify(this.msg) );
						
					}else if(e.key === "Backspace" || e.code === 'Backspace'){
						//Âà§Êñ≠BackspaceÊòØÂê¶Áî±ÁôæÂ∫¶ËæìÂÖ•Ê≥ïËá™Âä®ÂèëÂá∫ÁöÑ
						const time_diff = new Date().getTime() - this.bugfixing_BaiduInput_NewLine_timestamp ;
						//ÊµãËØïtest this.gptSystemPrompt += ('\r\ndiff...' + time_diff );
						//Â¶ÇÊûúÊó∂Èó¥Â∑ÆÂú®100ÊØ´Áßí‰ª•ÂÜÖÔºåÂàôÂà§ÂÆö‰∏∫ÁôæÂ∫¶Ëá™Âä®ÂèëÂá∫ÁöÑÂà†Èô§ÈîÆÔºåÈúÄË¶ÅÂøΩÁï•ÊéâÔºå‰∏çÊâßË°å„ÄÇ
						if( time_diff < 100 ){
							e.preventDefault();
						}
						//ÊµãËØïtest this.gptSystemPrompt += ('\r\nÂà†Èô§ÈîÆ - e.key:' + JSON.stringify(e.key) + '_  e.code:' + e.code + '_  e.keyCode:' + e.keyCode );
						//ÊµãËØïtest this.gptSystemPrompt += ('\r\n3...' + JSON.stringify(this.msg) );
					}
					
				}catch(err){}
				
			},
			
			
			//ÊåâÈíÆÔºöÂèëÈÄÅ  Send
			sendMsg() {
			
				//ÊòØÂê¶Ê≠£Âú®È™åËØÅAPI Key
				if(this.isCheckingApiKeyNow) {
					return;
				}
				if (this.btnDisabledState_Sending){
					//‰∏ÄËà¨‰∏ç‰ºöÈÅáÂà∞ËøôÁßçÊÉÖÂÜµ
					return;
				}
				if (this.api.trim() == ""){
					//‰∏ÄËà¨‰∏ç‰ºöÈÅáÂà∞ËøôÁßçÊÉÖÂÜµ
					this.sentext = this.settingsLanguage == 'cn' ? 'ÂÖàÈ™åËØÅAPI' : 'Check API First';
					return;
				}
				if (!this.btnDisabledState_CheckAPI){
					//‰∏ÄËà¨‰∏ç‰ºöÈÅáÂà∞ËøôÁßçÊÉÖÂÜµ
					this.sentext = this.settingsLanguage == 'cn' ? 'ÈáçÊñ∞È™åËØÅAPI' : 'Recheck API';
					this.apibtntext =  this.settingsLanguage == 'cn' ? '<< È™åËØÅ' : '<< Check';
					return;
				}
				//‰ª•‰∏ä‰ª£Á†ÅÊúâ‰∫õÈáçÂ§ç„ÄÅÂ§ö‰Ωô
				
				if ( window.marked == null ){
					alert("marked.jsÔºàMarkdownÊèí‰ª∂ÔºâÂ∞öÊú™Âä†ËΩΩÊàêÂäüÔºåËØ∑Êï∞ÁßíÂêéÂÜçÂ∞ùËØï...\r\nmarked.js (Markdown Plugin) has not been loaded successfully, please try again in a few seconds...");
					return;
				}
				
				if(this.isTotaltokens_Exceeds_Maxtokens()){
					return;//ÂΩìÂâçtotaltokens Â∑≤ÁªèË∂ÖËøáÊ®°ÂûãÁöÑÊúÄÂ§ßmax_tokensÊï∞, ÂºπÁ™óË≠¶Âëä + ËøîÂõû
				}
				
				let isRetry = false; //**ÊòØÂê¶ÈáçÈóÆÔºåÈªòËÆ§false - Ê≠£Â∏∏ÂèëÈóÆ
				let sendMessage = ''; //**ÈúÄË¶ÅÂèëÈÄÅÁöÑÈóÆÈ¢òÔºåÂàùÂßãÂÄº‰∏∫Á©∫
				if(this.isRetry_RetryMessage != ""){
					isRetry = true; //ÂΩìÂâçÊòØÈáçÈóÆÁä∂ÊÄÅ
					sendMessage = this.isRetry_RetryMessage; //Êï∞ÊçÆËΩ¨Áßª 
					
					//ÈáçÈóÆÊó∂ÔºåËá™Âä®Ë∞ÉËäÇmax_tokens 
					this.autoAdjustMaxTokens(sendMessage);
				}
				this.isRetry_RetryMessage = ''; //**ÈáçÁΩÆÔºå‰∏çÂÜç‰ΩøÁî®isRetry_RetryMessageÔºåÂáèÂ∞ëÂá∫ÈîôÈ£éÈô©„ÄÇ Reset, stop using isRetry_RetryMessage to reduce the risk of errors.
				
												
				// **Â¶ÇÊûú‰∏çÊòØ[ÈáçÈóÆ]ÔºåËÄåÊòØ[Ê≠£Â∏∏ÂèëÈÄÅ] - ÈÇ£‰πàÈúÄË¶ÅÂà§Êñ≠this.msgÊòØÂê¶‰∏∫Á©∫ 
				if ( !isRetry && this.msg.trim() == ""){
					let notif =  this.settingsLanguage == 'cn' ?  'Êó†Ê≥ïÂèëÈÄÅÁ©∫ÁôΩÊ∂àÊÅØ' : 'Unable to send blank messages' ;
					let notiftime = 1500;
					if( this.btnDisabledState_Undo === false && (this.sentext == 'ËØ∑ÈáçÂèë' || this.sentext == 'Please Retry') ){
						notif =  this.settingsLanguage == 'cn' ?  'Êó†Ê≥ïÂèëÈÄÅÁ©∫ÁôΩÊ∂àÊÅØ„ÄÇÂ¶ÇÊûúÊÉ≥ÈáçÊñ∞ÂèëÈÄÅÔºåËØ∑ÁÇπÂáª [ÈáçÈóÆ] ÊåâÈíÆ' : 'Unable to send blank messages. If you want to resend, click the [Retry] button.' ;
						notiftime = 2900;
					}
					this.showNotification(notif, 'bottom', '', notiftime);
					return;
				}
				
				//**Â¶ÇÊûú‰∏çÊòØ[ÈáçÈóÆ]ÔºåËÄåÊòØ[Ê≠£Â∏∏ÂèëÈÄÅ] - check_KeyMode_byURL_ChangeKey ÂàùÊ≠•‰øÆÊ≠£KeyÊ®°Âºè„ÄÇ *‰øÆÊ≠£ÂêéÔºågetFirstAvailableAPIKeyÊâç‰ºöÂáÜÁ°Æ„ÄÇ
				if ( !isRetry && !this.check_KeyMode_Sending()){
					return;
				}
				
				//**Â¶ÇÊûú‰∏çÊòØ[ÈáçÈóÆ]ÔºåËÄåÊòØ[Ê≠£Â∏∏ÂèëÈÄÅ]
				if ( !isRetry ){
					try{ //‰∏ä‰∏ãÊñáÊ®°Âºè  Contextual Mode
						const returned_str = this.sendMsg_ContextualMode("send");
						if( typeof returned_str !== 'string'){
							//nothing
						}else if( returned_str === 'no clear context and abort operation'){ // ËÆ∞ÂøÜÊ®°ÂºèÔºöËÆ∞ÂøÜ‰∏äÈôê / Limit  *‰∏≠Ê≠¢Êìç‰Ωú
							const notif =  this.settingsLanguage == 'cn' ?  'Â∑≤‰∏≠Ê≠¢[ÂèëÈÄÅ]' : 'Aborted [Send]';
							this.showNotification(notif, 'bottom');
							return;
						}
					}catch(e){
						console.error('sendMsg_ContextualMode("send") - ÂèëÈÄÅËøáÁ®ã‰∏≠Ôºå"‰∏ä‰∏ãÊñáÊ®°Âºè"ÊâßË°åÊó∂Âá∫Èîô‰∫Ü',e);
					}
				}
				
				//ÊèêÈÜí‰∏ÄÊ¨°ÔºöÊèêÈÜíÊâìÂºÄÊô∫ËÉΩmax_tokens  Smart max_tokens 
				this.isReminded_SmartMaxTokens = this.isReminded_SmartMaxTokens >= 0 ? ( this.isReminded_SmartMaxTokens - 1 ) : this.isReminded_SmartMaxTokens ;
				if( !this.openSmartMaxTokens && this.isReminded_SmartMaxTokens === 0){ //Êô∫ËÉΩmax_tokensÂÅúÁî®Áä∂ÊÄÅ && ÈúÄË¶ÅÊèêÈÜí‰∏ÄÊ¨°
					const notif_SmartMaxTokens = this.settingsLanguage == 'cn' ? 'ÊèêÈÜí: ÂΩìÂâçÊú™ÂêØÁî®"Êô∫ËÉΩmax_tokens"ÔºåÂª∫ËÆÆÂú® [ËÆæÁΩÆ] ‰∏≠ÂêØÁî®ËØ•ÂäüËÉΩ' : 'Tip: Enabling the [Settings] > [Smart max_tokens] can reduce errors. Currently, it is disabled.' ;
					this.showNotification(notif_SmartMaxTokens, 'bottom', '',4500);
				}
				
				this.isSendingNow = true; //Êõ¥Êñ∞ÂèëÈÄÅÁöÑÁä∂ÊÄÅÔºå‰πãÂêé‰∏çËÉΩÂÜçÂá∫Áé∞"return"‰ª£Á†Å
				this.isSendingNow_ForSmartMaxTokens = true; //ÂêåÊ≠•Êõ¥Êñ∞ÂèëÈÄÅÁöÑÁä∂ÊÄÅ
				this.btnDisabledState_ApiURL = true;
				this.btnDisabledState_Language = true;
				this.btnDisabledState_ContextualMode = true;
				this.btnDisabledState_KeyMode = true;
				

				//[length - 1]["my"] = ture :ËØ¥ÊòéÊúÄÂêé‰∏ÄÊù°ÊòØÂ§±Ë¥•ËÆ∞ÂΩïÔºåÂ±û‰∫émy/userÔºå‰∏îÁé∞Âú®ÁÇπÂáªÁöÑÊòØÂèëÈÄÅÔºåËÄå‰∏çÂèØËÉΩÊòØÈáçÈóÆ„ÄÇÔºàÈáçÈóÆÊòØÂÖàÂ∞Ülist.popÔºå‰πãÂêéÂÜçÊ®°ÊãüÂèëÈÄÅÔºâ
				if(this.msgList[this.msgList.length - 1]["my"]){
					if(this.msgContentForMsgList_SingleRound[this.msgContentForMsgList_SingleRound.length - 1]["content"] != this.msg ){
						this.userMsgTokensForRetry = 0; //ÈáçÈóÆÂ§±Ë¥•ÂêéÔºåÊèêÈóÆÂÜÖÂÆπÂèëÁîüÊîπÂèòÊó∂(Âç≥‰∏çÂÜçÈáçÈóÆÊó∂)ÔºåuserMsgTokensForRetryÈúÄË¶ÅÂΩí0„ÄÇ
					}
				} 
				
				
				this.beginLoadingAnimation();
				document.querySelector('.inputapikey').readOnly = true; //ÂèëÈÄÅ‰∏≠ÔºåapikeyÁ¶ÅÊ≠¢ÊîπÂä®
				
				//**Ê≠£Â∏∏ÂèëÈóÆ- sendMessageÈúÄË¶ÅÊõøÊç¢‰∏∫this.msg
				if ( !isRetry ){
					sendMessage = this.msg ;
					
					this.isFixingMaxTokens_SmartMaxTokens = false; //ÂèñÊ∂à‚ÄúÊ≠£Âú®‰øÆÂ§çMaxTokens‚ÄùÁöÑÁä∂ÊÄÅ„ÄÇ ÂΩìSmart TokensÈÅáÂà∞ÈîôËØØÔºå‰ºöËá™Âä®‰øÆÂ§çÂπ∂Ëá™Âä®ÈáçÈóÆ(Retry)ÔºåËá™Âä®ÈáçÈóÆÂ§±Ë¥•ÂêéÔºåÁî®Êà∑‰∏çÂÜçÈÄâÊã©ÈáçÈóÆÔºåËÄåÊòØÈÄâÊã©ÂèëÈÄÅÊñ∞ÂÜÖÂÆπÊó∂ÔºåÈúÄË¶ÅÂèò‰∏∫false„ÄÇ(ËøôÈáåË¶ÜÁõñ ÂèëÈÄÅ„ÄÅÊ∏ÖÁ©∫ÂêéÂèëÈÄÅ„ÄÅÊí§ÈîÄÂêéÂèëÈÄÅ ‰∏âÁßçÊÉÖÂÜµ)
					//ÈùûÈáçÈóÆÊó∂ÔºåËá™Âä®Ë∞ÉËäÇmax_tokens 
					this.autoAdjustMaxTokens(sendMessage); 
					
					//‰ª•‰∏ã3Ë°å‰ª£Á†ÅÊòØÂ§ö‰ΩôÁöÑÔºåÂèØÁúÅÁï•„ÄÇ Âè™Ë¶ÅÊúâÂè¶Â§ñ‰∏§Â§Ñ‰ª£Á†ÅÂç≥ÂèØÔºö1.ÂèëÈÄÅÊàêÂäüÊó∂ 2.Ëá™Âä®ÈáçÈóÆÂÅúÊ≠¢Êó∂(Âç≥ÊúÄÂêé‰∏ÄÊ¨°Ëá™Âä®ÈáçÈóÆÂ§±Ë¥•Êó∂)
					this.autoRetry_apiKeyExcludeList = []; //ÈáçÁΩÆautoRetryÊï∞ÊçÆ-1: Ê∏ÖÁ©∫"Ëá™Âä®ÈáçÈóÆ"ÁöÑ API KeyÊéíÈô§ÂàóË°®
					this.autoRetry_FirstTime = 0; //ÈáçÁΩÆautoRetryÊï∞ÊçÆ-2: Ê∏ÖÁ©∫È¶ñÊ¨°Ëá™Âä®ÈáçÈóÆÁöÑÊó∂Èó¥
					this.autoRetry_log = ''; //ÈáçÁΩÆautoRetryÊï∞ÊçÆ-3: Ê∏ÖÁ©∫‰∏¥Êó∂Êó•Âøó
				}
				
				// v5.16 BUG A
				// ÂèëÁé∞ÊÑèÂ§ñbugÔºö marked.parse(Êüê‰∫õÈùûÁ©∫Â≠óÁ¨¶‰∏≤)ÔºåÊÑèÂ§ñËæìÂá∫‰∏∫Á©∫("")Ôºå‰∏éÂàùÂßãÂåñËÆæÁΩÆÁöÑÂèÇÊï∞Êó†ÂÖ≥ÔºåÁ§∫‰æãÂ¶Ç‰∏ãÔºö
				// 1.err ËæìÂá∫‰∏∫Á©∫ÁöÑ‰æãÂ≠êÔºömarked.parse("[ 2]:this")  marked.parse("[ai]:is")   marked.parse("[ 2]:Êàë")  marked.parse("[ 2]: ÁöÑ")  marked.parse("[e1]: 3")
				// 2.ok  ÂèØÊ≠£Â∏∏ËæìÂá∫ÁöÑ‰æãÂ≠êÔºömarked.parse("[ 2]:this is")  marked.parse("[ai] :is")    marked.parse("[ 2]: ÁöÑthis is a demo")  marked.parse("[e1]: ")
				// ÂéüÂõ†Êú™Áü•ÔºåËß£ÂÜ≥ÊñπÊ°àÔºöÂà§Êñ≠userMsgMarkdown ÊòØÂê¶ÂºÇÂ∏∏‰∏∫Á©∫ÔºåÂ¶ÇÊûúÊòØÔºåÂ∞±‰ΩøÁî®sendMessageÂéüÊñáÊõøÊç¢„ÄÇ
					
				// v5.16 BUG B
				// Âè¶Â§ñÔºåÊúâ‰∫õÊó†ÊÑè‰πâÊó†ÈÄªËæëÁöÑÈóÆÈ¢òÔºåAIÂèØËÉΩ‰ºöÂõûÂ§çÁ©∫ÂÄºÔºåËøôÊó∂‰ºöÂá∫Áé∞‰∏™bugÔºöAIÂõûÂ§ç‰∏∫Á©∫ÂØºËá¥Ê∞îÊ≥°Ê°ÜÊòæÁ§∫‰∏∫Á©∫ÔºåcssÊ†∑Âºè‰∏äÊ∞îÊ≥°Ê°Ü‰ºöÂèòÂæàÂ∞èÔºåËÄåÊ∞îÊ≥°Ê°Ü‰∏äÁöÑ‚ÄúÁÆ≠Â§¥‚ÄùÊó†Ê≥ïË¢´ÈÅÆÊå°„ÄÇ
				// Ëß£ÂÜ≥ÊñπÂºèÔºåÂ¶ÇÊûúÁúüÁöÑÊòØÁ©∫ÂÄºÔºåÂàôÊõøÊç¢‰∏∫Â∏¶Êúâ<p></p>Ê†áÁ≠æÁöÑÁ©∫Ê†º
					
				let userMsgMarkdown = marked.parse(sendMessage); // marked.js + highlight.js  Markdown+È´ò‰∫ÆÂ§ÑÁêÜ
				if ( sendMessage.trim() == "" || sendMessage.replace(/^\n|\n$/g, "").trim() == ""){
					userMsgMarkdown = "<p> </p>"; //*ÁõÆÂâç‚ÄúÂèëÈÄÅÂÜÖÂÆπ‚ÄùsendMessage‰∏çÂÖÅËÆ∏‰∏∫Á©∫Ôºå‰∏ç‰ºöÊâßË°åÂà∞ËøôÈáå
				}else if ( userMsgMarkdown.trim() == "" ){
					userMsgMarkdown = "<p>" + sendMessage + "</p>"; //v5.16 BUG A Ôºö ÈóÆÈ¢ò‰∏ç‰∏∫Á©∫Ôºå‰ΩÜmarkedÂ§ÑÁêÜÂêéÂèòÊàêÁ©∫ÔºåÂàôuserMsgMarkdownÈáçÁΩÆ‰∏∫Êú™ÁªèËøámarkedÂ§ÑÁêÜÁöÑÂéüÊñá
				}
				if(userMsgMarkdown.trim() == ""){
					userMsgMarkdown = "<p> </p>"; // v5.16 BUG B Ôºö Ëã•ÈóÆÈ¢ò‰∏∫Á©∫ÔºåÂàôËæìÂá∫Âä†‰∫Ü<p>Ê†áÁ≠æÁöÑÁ©∫Ê†ºÔºåÊíëËµ∑È´òÂ∫¶Ôºå‰øùÊåÅÊ≠£Á°ÆÁöÑÊ∞îÊ≥°Ê°ÜÊ†∑Âºè
				}
				
				const userMsgDatetimeNow = this.formatDateYYYYMMDDHHmmss(new Date(),':');
				
				//ÂáÜÂ§áÂæÆ‰ø°Ê†∑ÂºèÊó∂Èó¥
				let wechatstyledatetime = null; //ÈªòËÆ§‰∏∫Á©∫
				if(this.msgList[this.msgList.length - 1]["hr"] === true){ //ÂâçÈù¢‰∏çÂ≠òÂú®ÂàÜÂâ≤Á∫ø
					wechatstyledatetime = userMsgDatetimeNow.slice(5, 16);
				}else{
					if( this.displayDatetime_WeChatStyle() != null ){ //ÂâçÈù¢Êó†ÂàÜÂâ≤Á∫øÊó∂ÔºöÂà§Êñ≠ËÅäÂ§©ËÆ∞ÂΩïÁöÑÊó∂Èó¥Ë∑®Â∫¶ÊòØÂê¶Ë∂ÖËøá5ÂàÜÈíü
						//ÂæÆ‰ø°Ê†∑ÂºèÁöÑÊó∂Èó¥  Êó∂Èó¥Ê†ºÂºè‰ºöËΩ¨Êç¢‰∏∫MMDDHHmm
						wechatstyledatetime = userMsgDatetimeNow.slice(5, 16);
					}
				}
				
				// this.msgList.push this.msgContentForMsgList_SingleRound.push
				this.msgList.push({
					"msg": userMsgMarkdown,
					"my": true,
					"datetime": userMsgDatetimeNow,
					"wechatstyledatetime": wechatstyledatetime //null Êàñ userMsgDatetimeNow
				})
				
				
				//Ê∏≤Êüì usermsg  6.01:ÂèëÁé∞vueÊúâ‰∏™‚Äúv-html‚Äù ÁªëÂÆöÂêéÂèØ‰ª•ÂÆûÊó∂Ê∏≤Êüì„ÄÇÁÆó‰∫ÜÔºåÊöÇÊó∂‰∏çÊîπ„ÄÇ 6.19:Â∑≤Êîπ‰∏∫v-html
				this.$nextTick(() => {
					const divs = document.querySelectorAll('div.usermsg'); 
					const lastDiv = divs[divs.length - 1];

					//lastDiv.innerHTML = userMsgMarkdown; 6.19:Êîπ‰∏∫v-htmlÂêéÔºå‰∏çÂÜçÈúÄË¶Å‰ΩøÁî®innerHTML
					
					//Âà§Êñ≠ÊòØÂê¶ÈúÄË¶ÅÂÖ≥Èó≠ËΩØÈîÆÁõò
					this.closeSoftwareKeyboard();
					
					//ÊªöÂä®Âà∞ÊúÄÂ∫ïÈÉ®
					this.scrollToBottomView();
					
					//‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ„ÄÇÊêúÁ¥¢divÂÜÖÂÆπÔºåÊâæÂà∞Á¨¶ÂêàÊù°‰ª∂ÁöÑ‰ª£Á†ÅÂùóÔºåÊ∑ªÂä†ÊåâÈíÆ„ÄÇ addCopyButton.  Copying code to the clipboard 						
					this.addCopyButtonToPreTags(lastDiv) ;
					
					//‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ„ÄÇ‰∏∫ËÅäÂ§©Ê∞îÊ≥°Ê°ÜÊ∑ªÂä†‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ„ÄÇ addCopyButton.  Copying Chat Message to the clipboard 	
					this.addCopyButtonToChatMessage(lastDiv.parentElement) ;
					
				});
					
				
				//
				//Â¶ÇÊûúÊÉ≥ÂèñÊ∂àÈ™åËØÅapiÂäüËÉΩÔºåÈúÄË¶ÅÂú®ËøôÈáåË°•‰ª£Á†ÅÔºöÈ¶ñÊ¨°ÂÜôÂÖ•ÈªòËÆ§ÁöÑthis.gptSystemPrompt.trim()Âà∞this.msgContent[0]‰∏≠
				//
				
								
				//‰ª•‰∏ãifËØ≠Âè•ÁöÑ‰ΩúÁî®Ôºö‰∏ÄÊó¶ËÆæÁΩÆ‰∫ÜgptSystemPrompt_hidden ÔºåÂç≥ ËÆæÁΩÆ‰∫Ü[ÈöêÂΩ¢Êåá‰ª§/ÈöêËóèÊåá‰ª§/ÈöêÂΩ¢ÊèêÁ§∫ËØç/ÈöêËóèÊèêÁ§∫ËØç]ÔºåÈÇ£‰πàÊØèÊ¨°ÂèëÈÄÅÈóÆÈ¢òÊó∂ÔºåÈÉΩ‰ºöÈáçÁΩÆÊåá‰ª§‰∏∫ gptSystemPrompt_hidden ÁöÑÂÜÖÂÆπÔºåÂç≥‰ª•‰ª£Á†ÅÈáåÁöÑ[ÈöêÂΩ¢Êåá‰ª§]‰∏∫ÂáÜÔºåËá™Âä®ÂøΩÁï•ËÅäÂ§©ÁïåÈù¢‰∏äÁöÑÊåá‰ª§ÔºàÂåÖÊã¨Á©∫ÁôΩÁöÑÊåá‰ª§Ôºâ„ÄÇ‰∏çË¶ÅÊîπÂä®ËøôÈáåÁöÑ‰ª£Á†Å„ÄÇ
				//			    Â¶ÇÊûúÊú™ËÆæÁΩÆÈöêÂΩ¢Êåá‰ª§ÔºåÈÇ£‰πàÂΩìgptSystemPrompt(ÈªòËÆ§Êåá‰ª§ÊàñËÅäÂ§©ÁïåÈù¢)
				if (this.gptSystemPrompt_hidden.trim() != "") {
					this.msgContent[0] =  {"role": "system", "content": this.gptSystemPrompt_hidden.trim() };
					this.msgContentForMsgList_SingleRound[0] =  {"role": "system", "content": this.gptSystemPrompt_hidden.trim() };
					this.gptSystemPromptReadOnly = "hidden system prompt";
				}				
							
				this.msgContent.push({"role": "user", "content": sendMessage });
				//completion_tokens(Êú¨Ê¨°ÊèêÈóÆÂÜÖÂÆπÁöÑtokenÊï∞)ÈúÄË¶ÅÁ≠â‰∏ãÊ¨°ÂØπËØùÁªìÊùüÊâçËÉΩËÆ°ÁÆóÂæóÂá∫ÔºàÊèêÈóÆÁöÑtokenÊï∞‰ºöÊØîÂÆûÈôÖÁöÑÈ´òÔºåÁñë‰ººÂÆòÊñπ‰ºöÊ∑ªÂä†ÈöêËóèÁöÑÊèêÁ§∫ËØç„ÄÇÊÑè‰πâÂ§ß‰∏çÔºå‰ªÖÂÅöÂèÇËÄÉÔºâÁªèËøáÊµãËØïÔºå1„ÄÅÂΩìthis.msgContentÂåÖÂê´Á≥ªÁªüÊèêÁ§∫ËØçËøô‰∏ÄÈ°πÊó∂Ôºà[0]ÔºåÂç≥‰Ωø‰∏∫Á©∫ÔºâÔºåÈ¶ñÊù°‰ºöÈ¢ùÂ§ñÂç†Áî® 13 token Ôºõ 2„ÄÅ‰πãÂêéÊØèÊù°ÂèëÈÄÅÁöÑ‰ø°ÊÅØÈ¢ùÂ§ñÂç†Áî® 10 token „ÄÇ
				// The tokens for sending messages are higher than the actual count, which is probably because OpenAI adds hidden prompt words. After testing, 1) when the "system prompt"  is included in the context of this.msgContent in the code (this.msgContent[0]), even if the system prompt is empty, the first message will have an extra 13 tokens; 2) each subsequent message will take up an additional 10 tokens.
				//Êà™Ê≠¢Êú¨Ê¨°ÊèêÈóÆÁöÑtotal_tokens(ÂõûÂ§çÂâçÔºåÂê´ÊèêÈóÆÂÜÖÂÆπ)ÈúÄË¶ÅÁ≠âAIÂõûÂ§çÂêéÊâçËÉΩÂæóÂà∞Êï∞ÊçÆ
				//Á≥ªÁªüÊèêÁ§∫ËØçÈöèÊó∂ÂèØÊîπÔºåËøô‰ºö‰ΩøËÆ∞ÂΩïÁöÑuserÊï∞ÊçÆÂèòÂæó‰∏çÂáÜÁ°Æ„ÄÇ
				this.msgTokens.push({"role": "user", "completion_tokens": 0 , "total_tokens": 0 }); // ÂÖàÂÜôÂÖ•0 int
				this.succQA_Count = this.msgContent.length - 1; //int. Êõ¥Êñ∞
				
				// this.msgList.push this.msgContentForMsgList_SingleRound.push
				this.msgContentForMsgList_SingleRound.push({"role": "user", "content": sendMessage, "datetime": userMsgDatetimeNow });
				 
				const txt_lang1 = this.settingsLanguage == 'cn' ? '**User** _' : '**User** _' ;
				this.chathistory += (txt_lang1 + userMsgDatetimeNow + '_  \r\n' + sendMessage.replace(/\n/g, "\r\n") + '\r\n\r\n');
				this.btnDisabledState_Sending = true;
				this.btnDisabledState_Clear = true;
				this.btnDisabledState_Undo = true;
				
				//**Ê≠£Â∏∏ÂèëÈóÆ-ÈúÄË¶ÅÊ∏ÖÁ©∫ & ÈúÄË¶ÅÈáçÁΩÆËæìÂÖ•Ê°ÜÈ´òÂ∫¶   ÈáçÈóÆ-‰∏çÊ∏ÖÁ©∫ËæìÂÖ•Ê°Ü & ‰∏çÈúÄË¶ÅÈáçÁΩÆËæìÂÖ•Ê°ÜÈ´òÂ∫¶ 
				if ( !isRetry ){
					this.msg = "";
					const textarea_Chat = document.querySelector('.textareachatinputbox');
					textarea_Chat.style.maxHeight = '38px'; //aboutÔºöËá™ÈÄÇÂ∫îÈ´òÂ∫¶ max-height maxHeight 
					textarea_Chat.style.borderRadius = '0px 6px 6px 0px'; //border-radius: 0px 6px 6px 0px;
					textarea_Chat.style.zIndex = "900000"; //z-index:900000 ËæìÂÖ•Ê°ÜËé∑ÂæóÁÑ¶ÁÇπÂêé‰ºöÂèëÂÖâÔºåÈúÄË¶ÅËÆæÁΩÆÊåâÈíÆ‰∏éËæìÂÖ•Ê°ÜÁöÑÂ±ÇÁ∫ßÂÖ≥Á≥ª
				}
				
				
				//Êõ¥Êñ∞ ËÅäÂ§©Êï∞ÊçÆ chatData chatDataList
				//Êñ∞ÂØπËØùÔºåÈ¶ñÊ¨°ÂèëÈÄÅ Ê∑ªÂä†ÂØπËØùÁöÑÂàõÂª∫Êó∂Èó¥
				if( this.chatcreatedtime == null ) {
				
					this.chatcreatedtime = userMsgDatetimeNow; //ÂØπËØùÂàõÂª∫Êó∂Èó¥ = È¶ñÊ¨°ÂèëÈÄÅÊó∂Èó¥ÔºåÊó†ËÆ∫ÊòØÂê¶ÊàêÂäüÂèëÈÄÅ
					//Âç≥Êó∂Êõ¥Êñ∞List
					let chatdata_temp = this.chatDataList.find(c => c.chatcreatedtime === null);
					chatdata_temp = chatdata_temp == null ? {} : chatdata_temp;
					chatdata_temp.chatcreatedtime = this.chatcreatedtime;
					//Êõ¥Êñ∞selectedChatData  Âç≥Êõ¥Êñ∞ÂàóË°®‚ÄúË¢´ÈÄâ‰∏≠‚ÄùÁä∂ÊÄÅ
					this.selectedChatData = JSON.parse(JSON.stringify(chatdata_temp));//Èò≤Ê≠¢ÂèåÂêëÁªëÂÆö
				}
				//Êõ¥Êñ∞ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥ *ËøôÈáå‰∏ç‰øùÂ≠ò
				this.chatlasttime = userMsgDatetimeNow; //ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥ ÔºåÊó†ËÆ∫ÂèëÈÄÅÊòØÂê¶ÊàêÂäü„ÄÇ
				
				const currentTime = new Date().getTime(); // Ëé∑ÂèñÂΩìÂâçÊó∂Èó¥
				//Ëá™Âä®ÈÄâÊã©API KeyÔºåËøîÂõûapidata - ËΩÆËØ¢ / Ëá™Âä®ËΩÆÊç¢API Key / Auto Key Rotation
				const apidata = this.getFirstAvailableAPIKey(this.autoRetry_apiKeyExcludeList);
				this.api = apidata.apikey; //Ëá™Âä®ÈÄâÊã©ÁöÑKey
				this.api = this.api.trim();
				this.lastAPIKeyInputText = this.api;//Êõ¥Êñ∞ÊúÄÂêé‰∏ÄÊ¨°ËæìÂÖ•Ê°Ü‰∏≠ÁöÑkeyÔºåÊó†ËÆ∫ÊòØÂê¶ÊàêÂäü 
	 
				try{//ÊµãËØï
				//ÊµãËØï 	console.log('ÂèëÈÄÅ ËΩÆËØ¢ key Ôºö ',this.api);
				//	console.log('ÂèëÈÄÅ - key   apidata  ',apidata);  
				//	console.log('ÂèëÈÄÅ - key   date1 ',new Date(apidata.date1).toLocaleString()); 
				//	console.log('ÂèëÈÄÅ - key   date2 ',new Date(apidata.date2).toLocaleString()); 
				//	console.log('ÂèëÈÄÅ - key   date3 ',new Date(apidata.date3).toLocaleString()); 
				//	console.log('ÂèëÈÄÅ - key   nexttime ',new Date(apidata.nexttime).toLocaleString()); 
				//ÊµãËØï 	console.log('ÂèëÈÄÅ - key   level ',apidata.level); 
				}catch(e){}
				
				// ËÆæÁΩÆaxiosÁöÑË∂ÖÊó∂Êó∂Èó¥ÔºåÈªòËÆ§ÊòØ0Ôºà‰ª£Ë°®Ê∞∏‰∏çË∂ÖÊó∂ÔºåÂÆûÈôÖ‰∏ä60ÁßíÂ∞±‰ºöÊä•Ë∂ÖÊó∂Ôºâ„ÄÇ
				// ÈÅáÂà∞È´òÂ≥∞Êúü(ÂÖ®ÁêÉËåÉÂõ¥)ÔºåÂä†‰∏äÈóÆÈ¢òÁöÑÂ§çÊùÇÂ∫¶Ôºå‰ª•ÂèäÂèóAPIÂèÇÊï∞ËÆæÁΩÆÁöÑÂΩ±ÂìçÔºå20Áßí‰ª•‰∏äÁöÑÂõûÂ§çÁ≠âÂæÖÊó∂Èó¥ÊòØÂæàÂ∏∏ËßÅÁöÑÔºå‰∏ä‰∏ãÊñáÂÜÖÂÆπÂ§öÔºåÊàñË¶ÅÊ±ÇÂÜôËÆ∫ÊñáÊó∂ÔºåËÄóÊó∂55Áßí‰πüÊòØÊúâÁöÑ„ÄÇ ÂêåÊ†∑ÁöÑÔºåÊµÅÂºèÂìçÂ∫î‰πüÊòØÈúÄË¶ÅÂæàÈïøÁöÑÊó∂Èó¥ÊâçËÉΩÊé•Êî∂ÂÆåÊàê„ÄÇ
				// To set a timeout for axios, the default is 0 (Never timeout,In actuality, it will report a timeout error in around 60 seconds.)
				// When OpenAI encounters high traffic requests on a global scale, along with the complexity of the issues sent and the impact of API parameter settings, response wait times may exceed 20 seconds. In cases where the context is rich, such as when writing a paper, response times of up to 55 seconds may be necessary. The same applies to streaming responses, which may take a long time to receive a complete reply.
				// v8.10 ÂØπ‰∫é8k„ÄÅ16kÂíå32kÁöÑÊ®°ÂûãÔºåÂ∞ÜË∂ÖÊó∂Êó∂Èó¥ËÆæÁΩÆ‰∏∫60ÁßíÂèØËÉΩ‰∏çË∂≥‰ª•Êª°Ë∂≥ÈúÄÊ±ÇÔºå‰ΩÜÊòØÁõ¥Êé•Â∞ÜË∂ÖÊó∂Êó∂Èó¥Â¢ûÂä†Âà∞60Áßí‰ª•‰∏äÂêåÊ†∑‰ºöÂú®60ÁßíÊó∂Êä•ÂëäË∂ÖÊó∂ÈîôËØØ„ÄÇÊàë‰∏çÊ∏ÖÊ•öÊòØ‰ªÄ‰πàÂéüÂõ†ÂØºËá¥ÁöÑÔºåÊ≤°ÊêûÊáÇÔºåÂõ†Ê≠§ÁõÆÂâç‰ªçÁÑ∂Âè™ËÉΩÂ∞ÜË∂ÖÊó∂Êó∂Èó¥‰øùÊåÅÂú®60Áßí„ÄÇ
				// v8.10 Setting the timeout to 60 seconds may not be enough for models of 8k, 16k, and 32k. However, increasing the timeout beyond 60 seconds will still result in a timeout error at 60 seconds. I'm not sure what causes this and I lack technical understanding, so the timeout remains at 60 seconds for now.
				axios.defaults.timeout = 61000; //61000ÊØ´Áßí=61Áßí„ÄÇ  61000ms = 61s 
				
				//Ê≤°ÊúâGPT4 APIÔºåÊó†Ê≥ïÊµãËØïGPT4„ÄÇÊöÇÊó∂Âè™ÊîØÊåÅgpt3.5„ÄÇ
				// ÂÖ≥‰∫étop_p„ÄÅpresence_penalty„ÄÅfrequency_penaltyÔºåÊêúÁ¥¢ÂºïÊìé‰∏≠ÈöèÊú∫ÊåëÈÄâ4ÁØá‰ªãÁªçÊñáÁ´†Ôºö
				// 		1„ÄÅ https://blog.csdn.net/asplh/article/details/130104301  
				//		2„ÄÅ https://zhuanlan.zhihu.com/p/613262543?utm_id=0  
				//		3„ÄÅ https://zhuanlan.zhihu.com/p/606573556  
				//		4„ÄÅ https://baijiahao.baidu.com/s?id=1758970352108694361&wfr=spider&for=pc
				
				// OpenAI ÂÆòÊñπÊñáÊ°£:
				// https://platform.openai.com/docs/api-reference/chat/create
				// https://platform.openai.com/docs/models/model-endpoint-compatibility
				// https://platform.openai.com/docs/models/gpt-3-5
				// https://platform.openai.com/docs/models/gpt-4
				
				// API URL: this.apiURL  like 'https://abcapi.xinu.ink/v1/chat/completions'
				// max_tokens: this.apiMaxTokens  (int) like 2048
				// temperature:this.apitemperature  (int) like 0.7
				// models: this.apiGPTModel  like 'gpt-3.5-turbo'
				// top_p: this.apiTopP  (int) like 0
				// presence_penalty: this.apiPresencePenalty  (int) like 0
				// frequency_penalty: this.apiFrequencyPenalty  (int) like 0
				axios.post( this.apiURL , {
					messages: this.msgContent, max_tokens: this.apiMaxTokens, temperature:this.apitemperature, model: this.apiGPTModel, top_p: this.apiTopP, presence_penalty: this.apiPresencePenalty, frequency_penalty: this.apiFrequencyPenalty
				}, {
					headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + this.api }
				}).then(res => {
				
					//v8.11 ÈÄÇÈÖçÊûÅÂ∞ëÊï∞Á¨¨‰∏âÊñπÊé•Âè£ ÈÉ®ÂàÜÈîôËØØ‰ø°ÊÅØ‰ª•res.dataÁöÑÊñπÂºèËøîÂõû„ÄÇ *ChatGPT Next Web   nextweb.fun 
					//v8.11 - Start 
					if ( !res.data || !res.data.hasOwnProperty('choices') ) { // Êú™ÂåÖÂê´choicesÔºåËØ¥ÊòéÊòØÂ§±Ë¥•‰∫ÜÔºåËøîÂõûÁöÑÊòØÈîôËØØÁöÑÁªìÊûú
					
						//Ëé∑ÂèñÈîôËØØ‰ø°ÊÅØÔºåËøîÂõûÁªôresponseObj
						const responseObj = this.thirdPartyAPI_ErrorOccurred_ButResponseWasNormal(res);
						
						const error_nextweb = new Error(''); //ÊâãÂä®Ê®°ÊãüerrorÈîôËØØ  error.message = ''
						error_nextweb.code = '';
						error_nextweb.request = { //Ê∑ªÂä† request.responseText
							responseText: JSON.stringify(responseObj)
						};
						throw error_nextweb; //ÊäõÂá∫ÈîôËØØÔºåË∑≥ËΩ¨Âà∞catch
					}
					//v8.11 - End 
					
					//console.log(res);
					this.isSendingNow = false; //Êõ¥Êñ∞ÂèëÈÄÅÁä∂ÊÄÅ
					this.isSendingNow_ForSmartMaxTokens = false; //ÂêåÊ≠•Êõ¥Êñ∞ÂèëÈÄÅÁä∂ÊÄÅ
					this.endLoadingAnimation();
					document.querySelector('.inputapikey').readOnly = false; //ÂèëÈÄÅÁªìÊùüÔºåapikeyÊÅ¢Â§çÂèØÊîπ
					this.isFixingMaxTokens_SmartMaxTokens = false; //ÂèñÊ∂à‚ÄúÊ≠£Âú®‰øÆÂ§çMaxTokens‚ÄùÁöÑÁä∂ÊÄÅÔºàÂΩìSmart TokensÈÅáÂà∞ÈîôËØØÔºå‰ºöËá™Âä®‰øÆÂ§çÂπ∂Ëá™Âä®ÈáçÈóÆ(Retry)ÔºåÂΩìÈáçÈóÆÊàêÂäüÂêéÔºåÈúÄË¶ÅÈáçÁΩÆÁä∂ÊÄÅÔºâ
					this.lastAPIKeyInputText_Available = ( this.api.startsWith('sk-') && !this.excludeList_ThirdPartyKeyStartWithSK_DomainKeyword.some(char => this.apiURL.toLowerCase().includes(char)) ) ? this.api : '';//Êõ¥Êñ∞ÊúÄÂêé‰∏ÄÊ¨°ËæìÂÖ•Ê°Ü‰∏≠ÁöÑkeyÔºàOpenAI KeyÔºâÔºåÊàêÂäüÁöÑ
					this.autoRetry_apiKeyExcludeList = []; //ÈáçÁΩÆautoRetryÊï∞ÊçÆ-1: Ê∏ÖÁ©∫"Ëá™Âä®ÈáçÈóÆ"ÁöÑ API KeyÊéíÈô§ÂàóË°®
					this.autoRetry_FirstTime = 0; //ÈáçÁΩÆautoRetryÊï∞ÊçÆ-2: Ê∏ÖÁ©∫È¶ñÊ¨°Ëá™Âä®ÈáçÈóÆÁöÑÊó∂Èó¥
					this.autoRetry_log = ''; //ÈáçÁΩÆautoRetryÊï∞ÊçÆ-3: Ê∏ÖÁ©∫‰∏¥Êó∂Êó•Âøó
					
					let aiReplyMsg = res.data.choices[0].message.content; //v5.16 ‰ΩøÁî®markedÂêéÔºå‰∏çÂÜçÈúÄË¶ÅÂéªÊéâÂ§¥Â∞æÁöÑÊç¢Ë°åÁ¨¶
					let restokens = res.data.usage.total_tokens;
					
					// v5.16 BUG A
					// ÂèëÁé∞ÊÑèÂ§ñbugÔºö marked.parse(Êüê‰∫õÈùûÁ©∫Â≠óÁ¨¶‰∏≤)ÔºåÊÑèÂ§ñËæìÂá∫‰∏∫Á©∫("")Ôºå‰∏éÂàùÂßãÂåñËÆæÁΩÆÁöÑÂèÇÊï∞Êó†ÂÖ≥ÔºåÁ§∫‰æãÂ¶Ç‰∏ãÔºö
					// 1.err ËæìÂá∫‰∏∫Á©∫ÁöÑ‰æãÂ≠êÔºömarked.parse("[ 2]:this")  marked.parse("[ai]:is")   marked.parse("[ 2]:Êàë")  marked.parse("[ 2]: ÁöÑ")  marked.parse("[e1]: 3")
					// 2.ok  ÂèØÊ≠£Â∏∏ËæìÂá∫ÁöÑ‰æãÂ≠êÔºömarked.parse("[ 2]:this is")  marked.parse("[ai] :is")    marked.parse("[ 2]: ÁöÑthis is a demo")  marked.parse("[e1]: ")
					// ÂéüÂõ†Êú™Áü•ÔºåËß£ÂÜ≥ÊñπÊ°àÔºöÂà§Êñ≠aiMsgMarkdownÊòØÂê¶ÂºÇÂ∏∏‰∏∫Á©∫ÔºåÂ¶ÇÊûúÊòØÔºåÂ∞±‰ΩøÁî®aiReplyMsgÂéüÊñáÊõøÊç¢„ÄÇ
				
					// v5.16 BUG B
					// Âè¶Â§ñÔºåÊúâ‰∫õÊó†ÊÑè‰πâÊó†ÈÄªËæëÁöÑÈóÆÈ¢òÔºåAIÂèØËÉΩ‰ºöÂõûÂ§çÁ©∫ÂÄºÔºåËøôÊó∂‰ºöÂá∫Áé∞‰∏™bugÔºöAIÂõûÂ§ç‰∏∫Á©∫ÂØºËá¥Ê∞îÊ≥°Ê°ÜÊòæÁ§∫‰∏∫Á©∫ÔºåcssÊ†∑Âºè‰∏äÊ∞îÊ≥°Ê°Ü‰ºöÂèòÂæàÂ∞èÔºåËÄåÊ∞îÊ≥°Ê°Ü‰∏äÁöÑ‚ÄúÁÆ≠Â§¥‚ÄùÊó†Ê≥ïË¢´ÈÅÆÊå°„ÄÇ
					// Ëß£ÂÜ≥ÊñπÂºèÔºåÂ¶ÇÊûúÁúüÁöÑÊòØÁ©∫ÂÄºÔºåÂàôÊõøÊç¢‰∏∫Â∏¶Êúâ<p></p>Ê†áÁ≠æÁöÑÁ©∫Ê†º
					
					let aiMsgMarkdown = marked.parse(aiReplyMsg); // marked.js + highlight.js  Markdown+È´ò‰∫ÆÂ§ÑÁêÜ
					if ( aiReplyMsg.trim() == "" || aiReplyMsg.replace(/^\n|\n$/g, "").trim() == ""){
						aiMsgMarkdown = "<p> </p>" ;  // v5.16 BUG B Ôºö AIÂõûÂ§ç‰∏∫Á©∫ÔºåÂàôËæìÂá∫‰∏∫Âä†‰∫Ü<p>Ê†áÁ≠æÁöÑÁ©∫Ê†ºÔºå‰øùÊåÅÊ≠£Á°ÆÁöÑÊ∞îÊ≥°Ê°ÜÊ†∑Âºè
					}else if ( aiMsgMarkdown.trim() == "" ){
						aiMsgMarkdown =  "<p>" + aiReplyMsg + "</p>"; //v5.16 BUG A Ôºö AIÂõûÂ§ç‰∏ç‰∏∫Á©∫Ôºå‰ΩÜmarkedÂ§ÑÁêÜÂêéÂèòÊàêÁ©∫ÔºåÂàôaiMsgMarkdownÈáçÁΩÆ‰∏∫Êú™ÁªèËøámarkedÂ§ÑÁêÜÁöÑÂéüÊñá
					}
					if(aiMsgMarkdown.trim() == ""){
						aiMsgMarkdown = "<p> </p>"; // v5.16 BUG B Ôºö Ëã•AIÂõûÂ§ç‰∏∫Á©∫ÔºåÂàôËæìÂá∫Âä†‰∫Ü<p>Ê†áÁ≠æÁöÑÁ©∫Ê†ºÔºå‰øùÊåÅÊ≠£Á°ÆÁöÑÊ∞îÊ≥°Ê°ÜÊ†∑Âºè
					}
					
					const aiMsgDatetimeNow = this.formatDateYYYYMMDDHHmmss(new Date(),':');
					// this.msgList.push this.msgContentForMsgList_SingleRound.push
					this.msgList.push({
						"msg": aiMsgMarkdown,
						"my": false,
						"datetime": aiMsgDatetimeNow
					})
					
					//Ê∏≤Êüì aimsg
					this.$nextTick(() => {
						const aiDivs = document.querySelectorAll('div.aimsg'); 
						const lastAIDiv = aiDivs[aiDivs.length - 1];
						//lastAIDiv.innerHTML = aiMsgMarkdown; 6.19:Êîπ‰∏∫v-htmlÂêéÔºå‰∏çÂÜçÈúÄË¶Å‰ΩøÁî®innerHTML

						//ÊªöÂä®Âà∞ÊúÄÂ∫ïÈÉ®
						this.scrollToBottomView();	
																	
						//ÊêúÁ¥¢divÂÜÖÂÆπÔºåÊâæÂà∞Á¨¶ÂêàÊù°‰ª∂ÁöÑ‰ª£Á†ÅÂùóÔºåÊ∑ªÂä†‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ„ÄÇ addCopyButton.  Copying code to the clipboard 						
						this.addCopyButtonToPreTags(lastAIDiv);
						
						//‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ„ÄÇ‰∏∫ËÅäÂ§©Ê∞îÊ≥°Ê°ÜÊ∑ªÂä†‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ„ÄÇ addCopyButton.  Copying Chat Message to the clipboard 	
						this.addCopyButtonToChatMessage(lastAIDiv.parentElement) ;

					});
					
					// this.msgList.push this.msgContentForMsgList_SingleRound.push
					this.msgContentForMsgList_SingleRound.push({"role": res.data.choices[0].message.role , "content": aiReplyMsg , "datetime": aiMsgDatetimeNow }); //0531ÂèëÁé∞‰πãÂâçÂÜôÈîôÊàê'userMsgDatetimeNow'ÔºåÊöÇÊú™‰ΩøÁî®Ê≠§Êï∞ÊçÆ
					
					// res.data.choices[0].message.role = "assistant"
					if(this.msgContent.length < 2){ alert(" ÊâæÂà∞‰∏Ä‰∏™bug\r\nA new bug has appeared.\r\n\r\nÂèëÈÄÅÊàêÂäüÂêé && PUSH‰πãÂâçÔºåthis.msgContent.length < 2ÔºåÊ≠§Êó∂Â∫îËØ•Ëá≥Â∞ëÊúâ‰∏§Êù°Ôºå1-Á≥ªÁªüÊåá‰ª§ 2-ÊèêÈóÆÁöÑÈóÆÈ¢ò„ÄÇ  \r\n\r\nthis.msgContent.lengthÔºö" + this.msgContent.length  ); }
					this.msgContent.push({"role": res.data.choices[0].message.role , "content": aiReplyMsg });
					this.succQA_Count = this.msgContent.length - 1; //int. Êõ¥Êñ∞
					// # Don't "this.msgTokens.push" for now
					//    restokens  == res.data.usage.total_tokens ÔºöAIÂõûÂ§çÂêéÁöÑtokenÊÄªÊï∞
					//    res.data.usage.prompt_tokens ÔºöAIÂõûÂ§çÂâçÁöÑtokenÊÄªÊï∞ÔºåÂç≥userÊèêÈóÆÂêéÁöÑtokenÊÄªÊï∞
					//    res.data.usage.completion_tokens ÔºöAIÂçïÊù°ÂÜÖÂÆπÁöÑtokenÊï∞
					//  1.Êõ¥Êñ∞userÊï∞ÊçÆ Update user data
					this.msgTokens[this.msgTokens.length - 1]["total_tokens"] = res.data.usage.prompt_tokens ;
					//  2.Êõ¥Êñ∞userÊï∞ÊçÆ Update user data
					if(this.msgTokens.length < 2){ alert(" ÊâæÂà∞‰∏Ä‰∏™bug\r\nA new bug has appeared.\r\n\r\nÂèëÈÄÅÊàêÂäüÂêé && PUSH‰πãÂâçÔºåthis.msgTokens.length < 2„ÄÇ  \r\n\r\nthis.msgTokens.lengthÔºö" + this.msgTokens.length  ); }
					let aiPrevMessage_total_tokens = this.msgTokens[this.msgTokens.length - 2]["total_tokens"]; // length-2: Data of the AI's previous message
					this.msgTokens[this.msgTokens.length - 1]["completion_tokens"] = res.data.usage.prompt_tokens - aiPrevMessage_total_tokens ; //int.  userÂçïÊù°ÂÜÖÂÆπÁöÑtokenÊï∞
				//console.log("ÂÆûÈôÖÁöÑ Á≤æÂáÜÁöÑÔºàÂê´ÊèêÁ§∫ËØçÂèòÂä®ÁöÑÂ∑ÆÂºÇ ÔºåÂê´+13/+10Ôºâ send msg tokens : " + ( res.data.usage.prompt_tokens - aiPrevMessage_total_tokens ));
					// # Can use 'this.msgTokens.push' now
					//  3.Êñ∞Â¢ûAIÊï∞ÊçÆ Add new AI data
					this.msgTokens.push({"role": "AI", "completion_tokens": res.data.usage.completion_tokens , "total_tokens": restokens }); 
					this.totaltokens = restokens;
				
					let txt_lang2 ;
					if (this.gptSystemPrompt_hidden.trim() != "") {
						//Ëã•Â≠òÂú®ÈöêÂΩ¢ÁöÑSystemËÆæÁΩÆÔºåÂú®ËÅäÂ§©ËÆ∞ÂΩï‰∏≠ÂÅö‰∏™Ê†áËÆ∞
						txt_lang2 = this.settingsLanguage == 'cn' ? '**GPT::Hidden** _' : '**GPT::Hidden** _' ;
					}
					else {
						txt_lang2 = this.settingsLanguage == 'cn' ? '**GPT** _' : '**GPT** _' ;
					}
					this.chathistory  += ( txt_lang2  + aiMsgDatetimeNow + '_  \r\n' + aiReplyMsg.replace(/\n/g, "\r\n") + '\r\n\r\n');
					
					this.btnDisabledState_Sending = false;
					this.btnDisabledState_Clear = false;
					this.btnDisabledState_Undo = false;
					this.btnDisabledState_ApiURL = false;
					this.btnDisabledState_Language = false;
					this.btnDisabledState_ContextualMode = false;
					this.btnDisabledState_KeyMode = false;
				
					this.btnDisabledState_Export = false;
					this.sentext = this.settingsLanguage == 'cn' ? 'ÂèëÈÄÅ' : 'Send';
					this.userMsgTokensForRetry = 0;
					
					//GPTÂõûÂ§çÂêéÔºåËÆ∞ÂøÜ(‰∏ä‰∏ãÊñá)ËææÂà∞‰∏äÈôêÊó∂ÁöÑÊèêÈÜí
					this.sendMsg_ContextualMode_ReachLimit_Reminder();
						  
					//Êõ¥Êñ∞ ‰øùÂ≠ò ËÅäÂ§©Êï∞ÊçÆ chatData chatDataList
					//Êõ¥Êñ∞ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥
					this.updateChatLastTime(aiMsgDatetimeNow);//ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥
					
					this.check_KeyMode_byKey();//‰øÆÊ≠£Key Mode„ÄÇ *‰øÆÊ≠£ÂêéÔºåupdateApiCheckedDataÊâç‰ºöÂáÜÁ°Æ
					
					//Êõ¥Êñ∞this.apiCheckedData  ËÆ∞ÂΩïÂ∑≤È™åËØÅÁöÑAPI Key‰ø°ÊÅØ
					this.updateApiCheckedData(this.api, currentTime, 'success');
					
				}).catch(error =>{
					console.log('error',error);
					this.isSendingNow = false; //Êõ¥Êñ∞ÂèëÈÄÅÁä∂ÊÄÅ
					// this.isSendingNow_ForSmartMaxTokens = false; ÂêåÊ≠•Êõ¥Êñ∞ÂèëÈÄÅÁä∂ÊÄÅÁöÑ‰ª£Á†ÅÊîæÂú® this.catchApiErrorCode ‰∏≠
					this.endLoadingAnimation();
					document.querySelector('.inputapikey').readOnly = false; //ÂèëÈÄÅÁªìÊùüÔºåapikeyÊÅ¢Â§çÂèØÊîπ
					this.sentext = this.settingsLanguage == 'cn' ? 'ËØ∑ÈáçÂèë' : 'Please Retry';
					
					this.btnDisabledState_Sending = false;
					// this.btnDisabledState_Clear ÁßªÂà∞ÂêéÈù¢
					// this.btnDisabledState_Undo ÁßªÂà∞ÂêéÈù¢
					this.btnDisabledState_ApiURL = false;
					this.btnDisabledState_Language = false;
					this.btnDisabledState_ContextualMode = false;
					this.btnDisabledState_KeyMode = false;
					
					this.btnDisabledState_Export = false;			
					this.msgContent.pop();//Âà†Èô§Â§±Ë¥•ÁöÑÊ∂àÊÅØ Delete user's failed message.
					this.msgTokens.pop();//Âà†Èô§Â§±Ë¥•ÁöÑ Delete user's failed ...
					this.succQA_Count = this.msgContent.length - 1; //int. Êõ¥Êñ∞
					//‰ª•‰∏ãÊîπÂèòÊåâÈíÆÁä∂ÊÄÅÁöÑ‰ª£Á†Å ÂøÖÈ°ªÂú®pop()ÂêéÈù¢
					if (this.msgContent.length > 1){
						//Ê∏ÖÈô§ËÆ∞ÂøÜ-ÊÅ¢Â§çÂèØÁî® Êí§ÈîÄ&ÈáçÈóÆ-ÊÅ¢Â§çÂèØÁî®
						this.btnDisabledState_Clear = false;
						this.btnDisabledState_Undo = false; 
					}else if (this.msgContentForMsgList_SingleRound.length > 1){
						//Ê∏ÖÈô§ËÆ∞ÂøÜ-‰øùÊåÅ‰∏çÂèØÁî® Êí§ÈîÄ&ÈáçÈóÆ-ÊÅ¢Â§çÂèØÁî® 
						this.btnDisabledState_Clear = true;
						this.btnDisabledState_Undo = false; 
					}					
					
					this.check_KeyMode_byKey();//‰øÆÊ≠£Key Mode„ÄÇ *‰øÆÊ≠£ÂêéÔºåcatchApiErrorCode„ÄÅupdateApiCheckedData„ÄÅautoRetry Êâç‰ºöÂáÜÁ°Æ
					
					const txt_lang1 = this.settingsLanguage == 'cn' ? '### #ÈîôËØØ\r\n\r\n' : '### #Error\r\n\r\n' ;
					this.chathistory  += (txt_lang1);
					
					//ÈîôËØØ‰ª£Á†Å ÂºπÁ™ó
					this.catchApiErrorCode(error, currentTime);
					
					//Êõ¥Êñ∞ ‰øùÂ≠ò ËÅäÂ§©Êï∞ÊçÆ chatData chatDataList
					//Êõ¥Êñ∞ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥    //ËøôÈáåÁöÑÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥Â∑≤ÁªèÂÜôÂú®‰∫ÜÂâçÈù¢Ôºö this.chatlasttime = userMsgDatetimeNow; 
					this.updateChatLastTime(null);
					
				})
			},
			//Â§ÑÁêÜÁ¨¨‰∏âÊñπAPI ÊúâÊó∂‰ª•‚ÄúÊ≠£Â∏∏ÂìçÂ∫îÁöÑÊñπÂºè‚ÄùËøîÂõû‚ÄúÈîôËØØ‰ø°ÊÅØ‚ÄùÁöÑÊÉÖÂÜµ„ÄÇ  
			//v8.11 ÈÄÇÈÖçÊûÅÂ∞ëÊï∞Á¨¨‰∏âÊñπÊé•Âè£ ÈÉ®ÂàÜÈîôËØØ‰ø°ÊÅØ‰ª•res.dataÁöÑÊñπÂºèËøîÂõû„ÄÇ *‰æãÂ¶ÇChatGPT Next Web   Êóó‰∏ã‰ªòË¥πÊé•Âè£(nextweb.fun)ÁöÑÈÉ®ÂàÜÈîôËØØÂ∞±ÊòØ‰ª•ËøôÁßçÊñπÂºèËøîÂõû
			thirdPartyAPI_ErrorOccurred_ButResponseWasNormal(res){
				
				let responseObj ;
						
				if( res.data.hasOwnProperty('error') && res.data.hasOwnProperty('msg')){
				//‚ë† *ChatGPT Next Web   nextweb.fun 
					responseObj = {
						msg: res.data['msg'],
						error: res.data['error']
					};
				}else{
				//‚ë° *ÂÖ∂‰ªñÂ§ÑÁêÜÊñπÂºèÁ±ª‰ºº"Next Web"ÁöÑÁ¨¨‰∏âÊñπAPIÔºå other API 
					let temp_responseMessage = '';
					let temp_responseType = '';
					let temp_responseCode = '';
					let temp_data_obj = null;
							
					temp_data_obj = (res.data && res.data !== null) ? res.data : (res.request && res.request.data && res.request.data !== null) ? res.request.data : null ;
					//1) È¶ñÂÖàÔºå‰ºòÂÖàÂ∞ùËØï‰ªé‚Äúdata‚ÄùÂ±ûÊÄß‰∏≠Ëé∑ÂèñÈîôËØØ‰ø°ÊÅØ
					if(temp_data_obj !== null && typeof temp_data_obj === "object"){
						let temp_keys = Object.keys(temp_data_obj);
						// ÈÅçÂéÜÂ±ûÊÄßÂêçÁß∞
						for (let temp_key of temp_keys) {
							if (typeof temp_data_obj[temp_keys] === "object") { // Â±ûÊÄß‰∏∫ÂØπË±°Êó∂ÔºåÊ£ÄÊµãÂ≠êÂØπË±°ÁöÑÂ±ûÊÄß
								if(temp_data_obj[temp_key] !== null){
									let i_temp_keys = Object.keys(temp_data_obj[temp_key]);
									// ÈÅçÂéÜÂ±ûÊÄßÂêçÁß∞
									for (let i_temp_key of i_temp_keys) {
										// Ê£ÄÊü•Â±ûÊÄßÂêç
										if (i_temp_key.toLowerCase().includes("message") || i_temp_key.toLowerCase().includes("msg") || i_temp_key.toLowerCase().includes("err")) {
											const isError_Label = i_temp_key.toLowerCase().includes("err") ? (i_temp_key + ': ') : '' ;
											temp_responseMessage = temp_responseMessage + (temp_responseMessage === '' ? '' : '\r\n') + isError_Label + ( typeof temp_data_obj[temp_key][i_temp_key] === 'string' ?  temp_data_obj[temp_key][i_temp_key] : JSON.stringify(temp_data_obj[temp_key][i_temp_key]) );
										}else if (i_temp_key.toLowerCase().includes("code")) {
											temp_responseCode = temp_data_obj[temp_key][i_temp_key] ? temp_data_obj[temp_key][i_temp_key].toString() : '';
										}else if (i_temp_key.toLowerCase().includes("type")) {
											temp_responseType = temp_data_obj[temp_key][i_temp_key] ? temp_data_obj[temp_key][i_temp_key].toString() : '';
										}
									}
								}
							}else{
								// Ê£ÄÊü•Â±ûÊÄßÂêç
								if (temp_key.toLowerCase().includes("message") || temp_key.toLowerCase().includes("msg") || temp_key.toLowerCase().includes("err")) {
									const isError_Label = temp_key.toLowerCase().includes("err") ? (temp_key + ': ') : '' ;
									temp_responseMessage = temp_responseMessage + (temp_responseMessage === '' ? '' : '\r\n') + isError_Label + ( typeof temp_data_obj[temp_key] === 'string' ?  temp_data_obj[temp_key] : JSON.stringify(temp_data_obj[temp_key]) );
								}else if (temp_key.toLowerCase().includes("code")) {
									temp_responseCode = temp_data_obj[temp_key] ? temp_data_obj[temp_key].toString() : '';
								}else if (temp_key.toLowerCase().includes("type")) {
									temp_responseType = temp_data_obj[temp_key] ? temp_data_obj[temp_key].toString() : '';
								}
							}
						}//for end
					}// if end
							
					//2) Â¶ÇÊûúÂ≠òÂú®Áº∫Â§±ÁöÑÊï∞ÊçÆÔºåÈááÁî®Â§áÈÄâÊñπÊ°à
					//È™åËØÅtemp_responseMessageÊòØÂê¶‰∏∫Á©∫ Â§áÈÄâÊñπÊ°à
					if(temp_responseMessage === ''){
						if(res && res.request){
							if(res.request.responseText){
								if(typeof res.request.responseText === 'string'){
									temp_responseMessage = res.request.responseText;
								}else{
									temp_responseMessage = JSON.stringify(res.request.responseText);
								}
							}
							if(res.request.response && temp_responseMessage === ''){
								if(typeof res.request.response === 'string'){
									temp_responseMessage = res.request.response;
								}else{
									temp_responseMessage = JSON.stringify(res.request.response);
								}
							}
						}
					}
					//È™åËØÅtemp_responseCodeÊòØÂê¶‰∏∫Á©∫ Â§áÈÄâÊñπÊ°à
					if(temp_responseCode === ''){
						if(res && res.response && res.response.data){
							temp_responseCode = JSON.stringify(res.response.data); //‰∏éresponseMessageÂ∫îËØ•ÊòØÈáçÂ§çÁöÑÔºåÂ§ö‰ªΩÊï∞ÊçÆ
						}
					}
							
					//3) 
					responseObj = {
						msg: temp_responseMessage,
						type: temp_responseType,
						code: temp_responseCode
					};
				}//‚ë° end
				
				return responseObj;
			},
			
			//When "Retry" or "Send", execute the operation according to the setting of the [Contextual Mode].     actionStr: "retry" or "send"
			sendMsg_ContextualMode(actionStr){ 
				if( !Number.isInteger(this.settingsContextualMode) ){ //ÈùûÊï∞Â≠ó/Êï¥Êï∞
					return '';
				}
				if(this.settingsContextualMode === 0){ //‰∏çÈôêÂà∂
					return '';
				}
				
				const context_limit_number = this.settingsContextualMode > 100 ? (this.settingsContextualMode - 100) : this.settingsContextualMode;
				let succQAcount = this.succQA_Count;
				
				//‰øÆÊ≠£succQAcountÔºåÈáçÈóÆÊó∂succQAcountÊúâ2ÁßçÊÉÖÂÜµÔºö1) succQAcount = this.succQA_Count ,  2) succQAcount = this.succQA_Count - 2
				//1) ÊúÄÂêé‰∏ÄÊù°‰∏∫ÂèëÈÄÅÂ§±Ë¥•ÁöÑÊ∂àÊÅØÊó∂ÔºåÊú¨Ë∫´Ê≤°ÊúâË¢´ËÆ°ÂÖ•succQA_CountÔºåÊâÄ‰ª• succQAcount = this.succQA_Count
				//2) ÊúÄÂêé‰∏ÄÊù°‰∏∫AIÁöÑÂõûÂ§çÊó∂ÔºåÈáçÈóÆÊó∂ËøôÈáåÈúÄË¶ÅÂáè2ÔºåÂç≥ succQAcount = this.succQA_Count - 2
				if( actionStr === "retry"){ // ÈáçÈóÆ 
					// 2) Êú¨ËΩÆËÆ∞ÂøÜÂ≠òÂú®ÂèëÈÄÅËøáÊ∂àÊÅØ(ÂåÖÊã¨ÂèëÈÄÅÂ§±Ë¥•ÁöÑÊ∂àÊÅØ) &&  ÊúÄÂêé‰∏ÄÊù°Ê∂àÊÅØ‰∏∫AIÁöÑÂõûÂ§ç
					if(this.msgContentForMsgList_SingleRound.length > 1 && !this.msgList[this.msgList.length - 1]['my'] ){
						succQAcount = succQAcount - 2; 
					}
				}
				
				
				//A: ËÆ∞ÂøÜ‰∏äÈôê / Limit
				if(this.settingsContextualMode < 100){
					// A-1 Êú™ËææÂà∞‰∏äÈôê
					if(succQAcount < context_limit_number){ 
						return '';
					}
					
					//isRetryNeedConfirm tip: 1.Â¶ÇÊûúÊòØÈáçÈóÆÔºåÂ∫îËØ•ÂØπÊØîthis.succQA_Count *Â¶ÇÊûúÂØπÊØîsuccQAcountÔºåsuccQAcountÂàöÂ•ΩÂáè2ÔºåÂèàÂàöÂ•ΩËææÂà∞‰∏äÈôê(Á≠â‰∫écontext_limit_number)Ôºå‰ºöÁõ¥Êé•Ëá™Âä®Ê∏ÖÈô§ËÆ∞ÂøÜÔºåÊ≤°ÊúâÊèêÁ§∫„ÄÇÂ∫îËØ•Ë¶ÅÊúâÊèêÁ§∫
					//		  || 2.ÈáçÈóÆÁöÑÁâπÊÆäÊÉÖÂÜµ: ÂΩìÈáçÂèëÁöÑÊòØÂ§±Ë¥•ÁöÑÊ∂àÊÅØÊó∂ && ÂàöÂ•ΩËææÂà∞‰∏äÈôê(Á≠â‰∫écontext_limit_number)„ÄÇ‰πüÂ∫îËØ•Ë¶ÅÊúâÊèêÁ§∫
					const isRetryNeedConfirm = (actionStr === "retry" && this.succQA_Count > context_limit_number) || (actionStr === "retry" && succQAcount === this.succQA_Count && this.succQA_Count === context_limit_number) ;

					// A-2 ËææÂà∞/Ë∂ÖÂá∫‰∏äÈôê   *Â§ßÊ¶ÇÁéáÊòØËÆæÁΩÆÈîôËØØÔºåÊàñËÄÖÂÖ∂‰ªñÊÉÖÂÜµ„ÄÇÊ≠§Êó∂Áî®Êà∑ÂèØËÉΩÂπ∂‰∏çÊÉ≥Ê∏ÖÈô§ÊéâËÆ∞ÂøÜ(‰∏ä‰∏ãÊñá)ÔºåÊèêÈÜíÁî®Êà∑ÔºåÁªôÂá∫ÈÄâÊã©
					if(succQAcount > context_limit_number || isRetryNeedConfirm){ 
						const temp_cn = actionStr === "send" ? 'Âπ∂ÁªßÁª≠ÂèëÈÄÅÊ∂àÊÅØ' : 'Âπ∂ÂèñÊ∂à [ÈáçÈóÆ]';
						const temp_en = actionStr === "send" ? 'continue sending messages' : 'cancel [Retry]';
						//*‰ª•‰∏ã‰ΩøÁî® this.succQA_Count ËÄå‰∏çÊòØ succQAcount
						const notif_cn = 'ÂΩìÂâçÂ∑≤Êúâ ' + this.succQA_Count + ' Êù°ËÆ∞ÂøÜ (‰∏ä‰∏ãÊñá)ÔºåÂ∑≤ËææÂà∞ÂΩìÂâçËÆ∞ÂøÜÊ®°ÂºèËÆæÁΩÆÁöÑ‰∏äÈôê (' + context_limit_number + 'Êù°)ÔºåÊú¨Ê¨°ÈúÄÊâãÂä®Á°ÆËÆ§‰∏ã‰∏ÄÊ≠•ÁöÑÊìç‰Ωú„ÄÇ\r\n\r\nÁÇπÂáª [Á°ÆÂÆö (Â•Ω)] Â∞ÜÊâßË°åÈªòËÆ§Êìç‰ΩúÔºåËÆ∞ÂøÜ‰ºöË¢´Ê∏ÖÈô§Ôºå' + temp_cn + '„ÄÇÁÇπÂáª [ÂèñÊ∂à] Â∞Ü‰∏≠Ê≠¢ÂΩìÂâçÊìç‰ΩúÔºåËÆ∞ÂøÜ‰ºöË¢´‰øùÁïôÔºåÊÇ®ÂèØ‰ª•Âú® [ËÆæÁΩÆ] ‰∏≠‰øÆÊîπ [ËÆ∞ÂøÜÊ®°Âºè]„ÄÇËØ∑ÈÄâÊã©...';
						const notif_en = this.succQA_Count + ' messages in current context have reached the ' + context_limit_number + '-message limit set in [Contextual Mode]. Please manually confirm next step.\r\n\r\nClick [Confirm (OK)] to execute default action, clear context, and ' + temp_en + ', or click [Cancel] to abort current operation, the context will not be cleared, and then you can modify [Contextual Mode] in [Settings]. Please choose...';
						const notif = this.settingsLanguage == 'cn' ? notif_cn : notif_en ;
	
						this.is_Alert_Confirm_Prompt_Open = true;
						const confirmed = confirm(notif); //Áî®Êà∑ÈÄâÊã©ÊòØÂê¶ÁªßÁª≠ÔºåÁªßÁª≠‰ºöÊ∏ÖÈô§ÂéÜÂè≤ËÆ∞ÂøÜ + ÁªßÁª≠ÂèëÈÄÅ„ÄÇ
						if (!confirmed) { //ÁÇπÂáªÂèñÊ∂à
							setTimeout(() => {
								this.is_Alert_Confirm_Prompt_Open = false;
							}, 100);
							return "no clear context and abort operation";//ÂèñÊ∂à Â∞Ü‰∏≠Ê≠¢Êìç‰Ωú/ÂèëÈÄÅ + ËÆ∞ÂøÜ‰∏ç‰ºöË¢´Ê∏ÖÈô§
						}
						setTimeout(() => {
							this.is_Alert_Confirm_Prompt_Open = false;
						}, 100);
						
						//ÁÇπÂáªÁ°ÆËÆ§ ÁªßÁª≠ÊâßË°å‰∏ãÊñπA-3ÁöÑ‰ª£Á†Å  ÂÖ±Áî®‰ª£Á†Å
					}
					
					// A-3 ‰ª•‰∏ãÔºöif succQAcount === context_limit_number ÂàöÂ•ΩËææÂà∞‰∏äÈôê„ÄÇ  *ÈÉ®ÂàÜÊÉÖÂÜµÂΩí‰∏∫A-2
					//Ê∏ÖÈô§‰∏ä‰∏ãÊñáËÆ∞ÂøÜ 
					const txt_lang1 = (this.settingsLanguage == 'cn' ? '#### #ËÆ∞ÂøÜÊ®°Âºè - Ëææ‰∏äÈôê: ' : '#### #Contextual mode - Limit reached: ' ) + context_limit_number + '\r\n' ;
					this.chathistory  += txt_lang1;
					this.clearContext();
					
					if(isRetryNeedConfirm){ //ËØ¥ÊòéÊòØ "A-2" + "isRetryNeedConfirm" + "ÁÇπÂáª‰∫ÜÁ°ÆËÆ§"
						return 'clear context and cancel retry';
					}
					return '';
					
					
				}else{
				//B: ‰øùÁïôÊúÄÂêé**Êù° / Keep Last
				
	//v8.27 ÂæÖÂºÄÂèë To be developed
				
					return '';
				}
				
			},

			// GPTÂõûÂ§çÂêéÔºåËÆ∞ÂøÜ(‰∏ä‰∏ãÊñá)ËææÂà∞‰∏äÈôêÊó∂ÁöÑÊèêÈÜí„ÄÇ When the context reaches the limit, a reminder is given after GPT's response. 
			sendMsg_ContextualMode_ReachLimit_Reminder(){
				try{ 
					if(Number.isInteger(this.settingsContextualMode)){ //Êï∞ÊçÆÂêàÊ≥ï + ÂΩìÂâç‰∏∫AIÂõûÂ§ç(Ê≠§Êó∂succQA_Count‰∏ÄÂÆöÊòØÂÅ∂Êï∞)

						let tip_type_str = '';
						if(this.settingsContextualMode > 0 && this.settingsContextualMode < 100){
						//A: ËÆ∞ÂøÜ‰∏äÈôê ‰∏ä‰∏ãÊñá‰∏äÈôê  Limit 
							if(this.succQA_Count === this.settingsContextualMode - 2){
							// A-1 Âç≥Â∞ÜËææÂà∞ 
								tip_type_str = 'Limit-1';
							}else if(this.succQA_Count === this.settingsContextualMode){
							// A-2 ÂàöÂ•ΩËææÂà∞
								tip_type_str = 'Limit-2';
							}
						}else if(this.settingsContextualMode > 100){
						//B: ‰øùÁïôÊúÄÂêé**Êù°ËÆ∞ÂøÜ  Keep Last
							if(this.succQA_Count === this.settingsContextualMode - 102){
							// B-1 Âç≥Â∞ÜËææÂà∞ 
								tip_type_str = 'KeepLast-1';
							}else if(this.succQA_Count === this.settingsContextualMode - 100){
							// B-2 ÂàöÂ•ΩËææÂà∞
								tip_type_str = 'KeepLast-2';
							}
						}
						
						let delaytime = this.isShowNotification ? 3000 : 0; //Â≠òÂú®ÂÖ∂‰ªñÈÄöÁü•ÔºåÂàôÂª∂Ëøü3ÁßíÈÄöÁü•
						if(tip_type_str !== ''){ //Êó†
							setTimeout(() => {
								if( !this.isShowNotification ){ //ÂÜçÊ¨°Á°ÆËÆ§ÔºåÂ¶ÇÊûúÂ≠òÂú®ÂÖ∂‰ªñÈÄöÁü•ÔºåÂàô‰∏çÈÄöÁü•
									let notif = '';
									let notiftime = 0;
									if(tip_type_str === 'Limit-2'){ // A-2 ÂàöÂ•ΩËææÂà∞
										notif = this.settingsLanguage == 'cn' ? 'ËÆ∞ÂøÜ (‰∏ä‰∏ãÊñá) ËææÂà∞‰∏äÈôêÔºå‰∏ãÊ¨°ÂèëÈÄÅÊó∂Â∞ÜËá™Âä®Ê∏ÖÈô§' : 'Context limit reached, will be cleared on next send.' ;
										notiftime = this.settingsLanguage == 'cn' ? 2300 : 2400;
									}else if(tip_type_str === 'KeepLast-2'){ // B-2 ÂàöÂ•ΩËææÂà∞
										notif = this.settingsLanguage == 'cn' ? 'ËÆ∞ÂøÜ (‰∏ä‰∏ãÊñá) ËææÂà∞‰∏äÈôêÔºåËÆ∞ÂøÜÂ∞ÜÂè™‰øùÁïôÊúÄËøëÁöÑ ' + (this.settingsContextualMode - 100) + ' Êù°Ê∂àÊÅØ' : 'Context reached limit, only the latest ' + (this.settingsContextualMode - 100) + ' messages will be retained in the context.' ;
										notiftime = this.settingsLanguage == 'cn' ? 2700 : 3100;
									}
									
									if(notif !== ''){
										this.showNotification(notif, 'bottom', '', notiftime);
									}
								}
							}, delaytime);
						}
					}
				}catch (error) {
					console.error('sendMsg_ContextualMode_ReachLimit_Reminder - Âá∫Èîô‰∫Ü', error);
				}
			},
			
			//Êõ¥Êñ∞ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥ + ‰øùÂ≠ò   Ë∞ÉÁî®Ôºö1‰øùÂ≠òÊèêÁ§∫ËØç 2Êí§ÈîÄ 3Ê∏ÖÈô§ËÆ∞ÂøÜ 4ÂèëÈÄÅÊàêÂäü 5ÂèëÈÄÅÂ§±Ë¥•
			updateChatLastTime(lasttime){
				//Êõ¥Êñ∞ ‰øùÂ≠ò ËÅäÂ§©Êï∞ÊçÆ chatData chatDataList
				//Êõ¥Êñ∞ÊúÄÂêéÊ¥ªÂä®Êó∂Èó¥
				if(lasttime !== null){ // *lasttimeÁ≠â‰∫énullÁöÑÊÉÖÂÜµÔºöÂèëÈÄÅÂ§±Ë¥•Êó∂Ôºå‰∏çËÆæÁΩÆÊó∂Èó¥
					this.chatlasttime = lasttime; 
				}
				//Âç≥Êó∂Êõ¥Êñ∞chatDataListÁöÑÊúÄËøëÊ¥ªÂä®Êó∂Èó¥  *Êõ¥Êñ∞ListÁöÑÁõÆÁöÑÔºöËÄÉËôëÊú¨Ê¨°‰øùÂ≠òÊúâÂ§±Ë¥•ÁöÑÂèØËÉΩ(ÈÅáÂà∞ÂÜ≤Á™Å)
				let chatdata_temp = this.chatDataList.find(c => c.chatcreatedtime === this.chatcreatedtime);
				chatdata_temp = chatdata_temp == null ? {} : chatdata_temp;
				chatdata_temp.chatlasttime = this.chatlasttime;
				//‰øùÂ≠ò  *Âä†‰∏™Âª∂Êó∂Ôºå‰ª•Èò≤‰∏á‰∏Ä
				setTimeout(() => {
					this.localStorage_SaveData(null,'chatDataList');
					//Á¶ÅÁî®Êú¨Âú∞Â≠òÂÇ®Êó∂ÁöÑ‰øùÂ≠ò
					if(!this.isLocalStorageSupported || !this.isLocalStorageAllowed ){
						//chatdata_tempÂ∑≤ÁªèÊõ¥Êñ∞‰∫Ü„ÄÇ  this.saveChatData_NoLocalStorage(null);
					}
					//ÂàóË°®ÂõûÂà∞È°∂ÈÉ®
					this.gotoTop_List(); //*ÂàóË°®Á™óÂè£ÈöêËóèÊó∂Êó†Ê≥ïÂõûÂà∞È°∂ÈÉ®ÔºåÊâÄ‰ª•ËøôÈáåÊòØÂ§±ÊïàÁöÑ„ÄÇ
				}, 0); 
			},
			
			//ËÅäÂ§©ËæìÂÖ•Ê°ÜÂ§±ÂéªÁÑ¶ÁÇπÊó∂
			textareaChatInputBox_blur(){
				this.isfirstclickonchatinputbox = true; //is first click on chatinputbox
				let textarea_Chat = document.querySelector('.textareachatinputbox');
				textarea_Chat.style.minHeight = '38px';
				textarea_Chat.style.height = '38px';
				textarea_Chat.style.borderRadius = '0px 6px 6px 0px'; //border-radius: 0px 6px 6px 0px;
				textarea_Chat.style.zIndex = "900000"; //z-index:900000
			},
			//ËÅäÂ§©ËæìÂÖ•Ê°ÜËé∑ÂèñÁÑ¶ÁÇπÊó∂
			textareaChatInputBox_focus(){
				let textarea_Chat = document.querySelector('.textareachatinputbox');
				textarea_Chat.style.minHeight = '38px';
			  	//max-heightÂΩìÂèòÈáèÁî®ÔºåÂ≠òÂÇ®Ëá™ÈÄÇÂ∫îÈ´òÂ∫¶
				textarea_Chat.style.height = textarea_Chat.style.maxHeight;
				textarea_Chat.style.zIndex = "900002"; //z-index:900002 ËæìÂÖ•Ê°ÜËé∑ÂæóÁÑ¶ÁÇπÂêé‰ºöÂèëÂÖâÔºåÈúÄË¶ÅËÆæÁΩÆÊåâÈíÆ‰∏éËæìÂÖ•Ê°ÜÁöÑÂ±ÇÁ∫ßÂÖ≥Á≥ª
				
				if( parseInt(textarea_Chat.style.height) > 38){
					textarea_Chat.style.borderRadius = '6px 6px 6px 0px'; //border-radius: 6px 6px 6px 0px;
				}
				else{
					textarea_Chat.style.borderRadius = '0px 6px 6px 0px'; //border-radius: 0px 6px 6px 0px;
				}
			},
			//API KeyËæìÂÖ•Ê°ÜÂ§±ÂéªÁÑ¶ÁÇπÊó∂
			inputapiblur(){
				this.api = this.api.trim();
				document.querySelector('.inputapikey').type = "password";
			},
			//API KeyËæìÂÖ•Ê°ÜËé∑ÂèñÁÑ¶ÁÇπÊó∂
			inputapifocus(){
				document.querySelector('.inputapikey').type = "text";
			},
			//ÊåâÈíÆÁä∂ÊÄÅÔºàkeyÂèØÁî® Âíå key‰∏çÂèØÁî®Ôºâ
			changeButtonDisabledState(isDisabled){
				if(isDisabled === true){
					//Á¶ÅÁî® È™åËØÅÂ§±Ë¥•
					
					this.btnDisabledState_CheckAPI= false;
					this.btnDisabledState_Sending = true;
					this.btnDisabledState_Clear = true; 
					this.btnDisabledState_Undo = true; 
					//Êó†ÈúÄÊîπ api-url„ÄÅËØ≠Ë®ÄÂàáÊç¢„ÄÅ‰∏ä‰∏ãÊñáÊ®°Âºè ‰∏â‰∏™‰∏ãÊãâÊ°ÜÁöÑÁä∂ÊÄÅÔºå‰∏çÁõ∏ÂÖ≥
					
					//ÂÄüÁî®timerIdlÂà§Êñ≠ÊòØÂê¶ÊõæÈ™åËØÅËøáapikey „ÄÇÊú™ÊõæÈ™åËØÅËøáÔºåÂàôtimerId‰∏∫nullÔºå‰∏çÈúÄË¶ÅÊîπÂèòÊåâÈíÆÊñáÊú¨„ÄÇÔºàÈ™åËØÅËøáÔºå‰∏ç‰ª£Ë°®È™åËØÅÁªìÊûúÔºå‰ªÖ‰ª£Ë°®ÁÇπÂáªËøáÈ™åËØÅ„ÄÇÔºâ
					if(this.timerId != null ) {
						this.sentext = this.settingsLanguage == 'cn' ? 'ÈáçÊñ∞È™åËØÅAPI' : 'Recheck API';
					}else{
						this.sentext = this.settingsLanguage == 'cn' ? 'ÂÖàÈ™åËØÅAPI' : 'Check API First';
					}
					this.apibtntext = this.settingsLanguage == 'cn' ? '<< È™åËØÅ' : '<< Check';
				
				}else if (isDisabled === false){
					//ÂêØÁî® È™åËØÅÈÄöËøá ÂèØÂèëÈÄÅ
					
					this.btnDisabledState_CheckAPI = true;
					this.btnDisabledState_Sending = false;
					//ÊÅ¢Â§çÊåâÈíÆÁöÑÂáÜÁ°ÆÁä∂ÊÄÅ
					if (this.msgContent.length > 1){
						//Ê∏ÖÈô§ËÆ∞ÂøÜ-ÊÅ¢Â§çÂèØÁî® Êí§ÈîÄ&ÈáçÈóÆ-ÊÅ¢Â§çÂèØÁî®
						this.btnDisabledState_Clear = false;
						this.btnDisabledState_Undo = false; 
					}else if (this.msgContentForMsgList_SingleRound.length > 1){
						//Ê∏ÖÈô§ËÆ∞ÂøÜ-‰øùÊåÅ‰∏çÂèØÁî® Êí§ÈîÄ&ÈáçÈóÆ-ÊÅ¢Â§çÂèØÁî® 
						this.btnDisabledState_Clear = true;
						this.btnDisabledState_Undo = false; 
					}else {
						this.btnDisabledState_Clear = true; 
						this.btnDisabledState_Undo = true; 
					}
					//Êó†ÈúÄÊîπ api-url„ÄÅËØ≠Ë®ÄÂàáÊç¢„ÄÅ‰∏ä‰∏ãÊñáÊ®°Âºè ‰∏â‰∏™‰∏ãÊãâÊ°ÜÁöÑÁä∂ÊÄÅÔºå‰∏çÁõ∏ÂÖ≥
					
					this.sentext = this.settingsLanguage == 'cn' ? 'ÂèëÈÄÅ' : 'Send';
					this.apibtntext = this.settingsLanguage == 'cn' ? 'Â∑≤È™åËØÅ' : 'Checked';
				}
			},
			//API KeyËæìÂÖ•Ê°Ü ÂÜÖÂÆπÂèëÁîüÊîπÂèòÊó∂
			inputapichange(showtips){
				let ischanged = true; //Áä∂ÊÄÅÔºåtrue‰∏∫Â∑≤ÂèòÂä®Ôºåfalse‰∏∫Êó†ÂèòÂåñ
				let notif = '';
				
				//ÂêåÊó∂ÂØπÊØî‰∏§È°πÔºåÂõ†‰∏∫‰ª£Á†ÅÈáåthis.apiURL‰∏çÂèØËÉΩ‰∏∫Á©∫ÔºåÊâÄ‰ª•Êó†ÈúÄËÄÉËôëthis.apiCheckedDataÂàùÂßãÊï∞ÊçÆ‰∏∫Á©∫ÁöÑÊÉÖÂÜµÔºåÂç≥‰∏çÂ≠òÂú®‚ÄúÁ©∫ÂØπÁ©∫‚ÄùËøîÂõûtrueÁöÑÊÉÖÂÜµ„ÄÇ
				//v7.10‰πãÂâçÊòØ... key+urlÁªëÂÆö  const isExist = this.apiCheckedData.some(item => item.apikey.trim() == this.api.trim() && item.apiurl.trim() == this.apiURL.trim());
				const isExist = this.apiCheckedData.some(item => item.apikey.trim() == this.api.trim());
							
				if( isExist ) {
					
					//ÊåâÈíÆÁä∂ÊÄÅ ÂêØÁî® È™åËØÅÈÄöËøá keyÂèØÁî® ÂèØÂèëÈÄÅ
					this.changeButtonDisabledState(false);
					if ( showtips === true ){  
						notif = this.settingsLanguage == 'cn' ? 'API Key ÂèØÁî®' : 'API Key is valid';
						setTimeout(() => {
							this.showNotification(notif, 'bottom', '',1700);
						}, 2300);
					}
					
					let isExist_mode = true;
					if(this.isThirdPartyAPIKeyEnabled){
						isExist_mode = this.apiCheckedData.filter(data => data.vpn === 'third-party').some(item => item.apikey.trim() == this.api.trim());
						if(!isExist_mode){
							notif = this.settingsLanguage == 'cn' ? 'ÂΩìÂâçKey‰∏éÊ®°Âºè‰∏çÂåπÈÖçÔºåËØ∑ÈáçÈÄâKeyÔºåÊàñËÄÖÊîπ‰∏∫"‰ΩøÁî®OpenAIÂÆòÊñπKey"' : 'The current key does not match the mode. Please select a new key or change to "Use OpenAI API Keys".';
							setTimeout(() => {
								this.showNotification(notif, 'bottom', '',8000);
								this.isShowDialog_AutoKeyRotation = true;
							}, showtips === true ? 5000 : 2700);
						}
					}else{
						//isExist_mode = this.apiCheckedData.filter(data => data.vpn !== 'third-party').some(item => item.apikey.trim() == this.api.trim());
						//if(!isExist_mode){
							//
						//}
					}
					
				}else{

					//ÊåâÈíÆÁä∂ÊÄÅ Á¶ÅÁî® È™åËØÅÂ§±Ë¥• Key‰∏çÂèØÁî®
					this.changeButtonDisabledState(true);
					
					//v7.10‰πãÂâç... if ( showtips === true && this.apiCheckedData[0]['apikey'] !== '' && this.api.trim() !== '' ){ //ÊúâËøáÈ™åËØÅÊàêÂäü„ÄÇÊú™ÊõæÊàêÂäüËøáÂ∞±‰∏çÊèêÈÜí‰∫Ü„ÄÇ
					if ( showtips === true && this.apiCheckedData.length > 0 && this.api.trim() !== '' ){ //ÊúâËøáÈ™åËØÅÊàêÂäü=ÊèêÈÜí„ÄÇ‰ªéÊú™È™åËØÅÊàêÂäü=‰∏çÊèêÈÜí„ÄÇ
						notif = this.settingsLanguage == 'cn' ? 'ÈúÄË¶ÅÈ™åËØÅ API Key' : 'API Key needs to be checked' ;
						setTimeout(() => {
							this.showNotification(notif, 'bottom','',1800);
						}, 2300);//ÂâçÈù¢‰∏ÄÂÆöÊúâ‰∏™ÈÄöÁü•ÔºåÈúÄË¶ÅÁÇπÈó¥Èöî
					}
				}
			}, 
			
			//‰∏Ä‰∏™ÂºÄÂÖ≥:: ÂºÄÂßã ÂèëÈÄÅÊåâÈíÆÁöÑÂä®ÊÄÅÊñáÊú¨Áä∂ÊÄÅ
			beginLoadingAnimation() { 
				this.endLoadingAnimation(); //ÂÖàÊ∏ÖÈô§ÂèØËÉΩÂ≠òÂú®ÁöÑËÆ°Êó∂Âô®„ÄÇÈ™åËØÅÊåâÈíÆÂèØÈáçÂ§çÁÇπÂáªÔºåÂèØËÉΩÈáçÂ§ç
				
				//  ÂÖ∂‰ªñÊ†∑Âºè  Ê®°ÊãüËøõÂ∫¶Êù°ÊïàÊûú ÂèëÈÄÅ‰∏≠ÁöÑÂä®ÊÄÅÊñáÂ≠óÊïàÊûú
				//	let texts = ["ÂèëÈÄÅ‰∏≠‚ñ™‚ñ´‚ñ´", "ÂèëÈÄÅ‰∏≠‚ñ´‚ñ™‚ñ´", "ÂèëÈÄÅ‰∏≠‚ñ´‚ñ´‚ñ™"] ; 
				//	let texts = ["ÂèëÈÄÅ‰∏≠‚óà‚óá‚óá", "ÂèëÈÄÅ‰∏≠‚óá‚óà‚óá", "ÂèëÈÄÅ‰∏≠‚óá‚óá‚óà"] ; 
				//	let texts = ["ÂèëÈÄÅ‰∏≠‚ñ∂‚ñ∑‚ñ∑", "ÂèëÈÄÅ‰∏≠‚ñ∑‚ñ∂‚ñ∑", "ÂèëÈÄÅ‰∏≠‚ñ∑‚ñ∑‚ñ∂"] ; 
				//	let texts = ["ÂèëÈÄÅ‰∏≠ ‚ñè", "ÂèëÈÄÅ‰∏≠ ‚ñé", "ÂèëÈÄÅ‰∏≠ ‚ñç", "ÂèëÈÄÅ‰∏≠ ‚ñã", "ÂèëÈÄÅ‰∏≠ ‚ñä", "ÂèëÈÄÅ‰∏≠ ‚ñâ"] ;  //ËøòÊúâ‰∏Ä‰∏™‰ΩçÂàóÁ¨¨4ÁöÑ"‚ñå"ÔºåPCÁ´ØÊúâ‰∫õÊµèËßàÂô®‰∏çÂÖºÂÆπÔºå‰∏éÂÖ∂‰ªñÂ§ßÂ∞è‰∏ç‰∏ÄËá¥ÔºåÂ∑≤ÂéªÈô§„ÄÇ
				
				// ÂèëÈÄÅ‰∏≠ÁöÑÂä®ÊÄÅÊñáÂ≠óÊïàÊûú Sending
				let texts;
				let texts_cn = ["ÂèëÈÄÅ‰∏≠ ‚ñÅ", "ÂèëÈÄÅ‰∏≠ ‚ñÇ", "ÂèëÈÄÅ‰∏≠ ‚ñÉ", "ÂèëÈÄÅ‰∏≠ ‚ñÖ", "ÂèëÈÄÅ‰∏≠ ‚ñÜ", "ÂèëÈÄÅ‰∏≠ ‚ñá"] ; // ËøòÊúâ‰∏Ä‰∏™‰ΩçÂàóÁ¨¨4ÁöÑ"‚ñÑ"ÔºåPCÁ´ØÊúâ‰∫õÊµèËßàÂô®‰∏çÂÖºÂÆπÔºå‰∏éÂÖ∂‰ªñÂ§ßÂ∞è‰∏ç‰∏ÄËá¥ÔºåÂéªÈô§‰∫Ü„ÄÇ
				let texts_en = ["Sending ‚ñÅ", "Sending ‚ñÇ", "Sending ‚ñÉ", "Sending ‚ñÖ", "Sending ‚ñÜ", "Sending ‚ñá"] ; 
				texts = this.settingsLanguage == 'cn' ? texts_cn : texts_en;
					
				// ÂΩìbtnDisabledState_CheckAPI‰∏∫falseÊó∂ÔºåÈ™åËØÅÊåâÈíÆÂèØÁî®ÔºåË°®Á§∫Êú™È™åËØÅËøáapiÊàñapiÊúâÂèòÂä®ÈúÄË¶ÅÈáçÊ£Ä
				// ÂèëÈÄÅÊ∂àÊÅØÊó∂ÔºåbtnDisabledState_CheckAPI‰∏ÄÂÆö‰∏∫trueÔºåÈ™åËØÅÊåâÈíÆ‰∏ÄÂÆöÊòØ‰∏çÂèØÁî®„ÄÇÊâÄ‰ª•ÂèØÁî®‰∫éÂà§Êñ≠ÊòØ‚ÄúÂèëÈÄÅ‚ÄùËøòÊòØ‚ÄúÈ™åËØÅkey‚Äù
				if( !this.btnDisabledState_CheckAPI ) {
					// È™åËØÅ‰∏≠ÁöÑÂä®ÊÄÅÊñáÂ≠óÊïàÊûú  Checking  API Key
					texts_cn = ["È™åËØÅ‰∏≠‚óà‚óá‚óá", "È™åËØÅ‰∏≠‚óá‚óà‚óá", "È™åËØÅ‰∏≠‚óá‚óá‚óà"] ;
					texts_en = ["Checking‚óà‚óá‚óá", "Checking‚óá‚óà‚óá", "Checking‚óá‚óá‚óà"] ;
					texts = this.settingsLanguage == 'cn' ? texts_cn : texts_en;
				}
				let i = 0 ;
				//‰ª•‰∏ãËøôË°åÂèØÊîπÈÄüÂ∫¶ Êú´Â∞æÁöÑÊï∞Â≠ó‰ª£Ë°®Èó¥ÈöîÁöÑÊó∂Èó¥ Âçï‰Ωç‰∏∫ÊØ´Áßí„ÄÇ  Â¶ÇÔºöÈªòËÆ§580 Ë°®Á§∫0.58ÁßíÁöÑÈó¥Èöî ÊØîËæÉÊÖ¢
				this.timerId = setInterval(() => { this.sentext = texts[i % texts.length]; i++;}, 580); 
			},
			//‰∏Ä‰∏™ÂºÄÂÖ≥:: ÂÅúÊ≠¢ ÂèëÈÄÅÊåâÈíÆÁöÑÂä®ÊÄÅÊñáÊú¨Áä∂ÊÄÅ
			endLoadingAnimation() { 
				clearInterval(this.timerId); 
			},	
			
			//Ê∑ªÂä†‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆÔºà‰ª£Á†ÅÂùóÔºâ ÊèíÂÖ•ÊåâÈíÆ&ÊåâÈíÆÊ†∑Âºè  addCopyButton (<pre><‚Äúadd Copy Button‚Äù><code></code></pre>)  Copying code to the clipboard 
			addCopyButtonToPreTags(msgDiv) {
				// ÊâæÂà∞ÊâÄÊúâÁöÑpre codeÁªìÊûÑÁöÑÂÖÉÁ¥†
				const preTags = msgDiv.querySelectorAll('pre code');
				// ÈÅçÂéÜÊØè‰∏Ä‰∏™pre codeÂÖÉÁ¥†
				preTags.forEach(preTag => {
					// Âà§Êñ≠ÂÖ∂Áà∂ÂÖÉÁ¥†ÊòØÂê¶‰∏∫preÊ†áÁ≠æ
					if (preTag.parentElement.tagName.toLowerCase() === 'pre') {
						// Âú®ÊØè‰∏Ä‰∏™codeÊ†áÁ≠æ[ÂâçÈù¢]ÊèíÂÖ•‰∏Ä‰∏™ÊåâÈíÆ *ÂøÖÈ°ªÊòØ[Ââç]
						const copyBtn = document.createElement('button');
						copyBtn.classList.add('copybtn');
						copyBtn.setAttribute("data-clipboard-nextelementsibling", ""); 
							
						//ÂàõÂª∫SVGÂõæÊ†á 'copy svg'  svg by github 
						const copySVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
						copySVG.setAttribute('height', '16');
						copySVG.setAttribute('width', '16');
						copySVG.setAttribute('viewBox', '0 0 16 16');
						copySVG.setAttribute('version', '1.1');
						copySVG.classList.add('clippy');
						const path1 = document.createElementNS('http://www.w3.org/2000/svg', 'path');
						path1.setAttribute('d', 'M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z');
						const path2 = document.createElementNS('http://www.w3.org/2000/svg', 'path');
						path2.setAttribute('d', 'M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z');
						copySVG.appendChild(path1);
						copySVG.appendChild(path2);
						
						const emptyDiv = document.createElement('div');
						emptyDiv.appendChild(copySVG);
						copyBtn.appendChild(emptyDiv);
						preTag.parentElement.classList.add('snippet'); // <pre class="snippet">
						preTag.parentElement.insertBefore(copyBtn, preTag);
						//‰∫ã‰ª∂ÁõëÂê¨ EventListener
						addEventListenerCopyBtnTooltip(copyBtn);
					}
				});
			},
			
			//Ê∑ªÂä†‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆÔºàËÅäÂ§©Ê∞îÊ≥°Ê°ÜÔºâ ÊèíÂÖ•ÊåâÈíÆ&ÊåâÈíÆÊ†∑Âºè  addCopyButton   Copying Chat Message to the clipboard 
			addCopyButtonToChatMessage(msgDivParentElement) {
			
				const copyBtn = document.createElement('button');
				copyBtn.classList.add('copybtn');
				copyBtn.setAttribute("data-clipboard-nextelementsibling", ""); 
							
				//ÂàõÂª∫SVGÂõæÊ†á 'copy svg'   svg designed by clipboardjs https://clipboardjs.com/assets/images/clippy.svg
				const copySVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
				copySVG.setAttribute('width', '14');
				copySVG.setAttribute('height', '17');
				copySVG.setAttribute('fill', '#191919');
				copySVG.classList.add('clippy');
				const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
				path.setAttribute('d', 'm2.36373,12.61912l4.12233,0l0,1.03058l-4.12233,0l0,-1.03058zm5.15291,-6.18349l-5.15291,0l0,1.03058l5.15291,0l0,-1.03058zm2.06116,3.09174l0,-2.06116l-3.09174,3.09174l3.09174,3.09174l0,-2.06116l5.15291,0l0,-2.06116l-5.15291,0zm-4.63761,-1.03058l-2.57645,0l0,1.03058l2.57645,0l0,-1.03058zm-2.57645,3.09174l2.57645,0l0,-1.03058l-2.57645,0l0,1.03058zm9.27523,1.03058l1.03058,0l0,2.06116c-0.0161,0.28985 -0.11272,0.53139 -0.30595,0.72463s-0.43478,0.28985 -0.72463,0.30595l-10.30581,0c-0.5636,0 -1.03058,-0.46698 -1.03058,-1.03058l0,-11.33639c0,-0.5636 0.46698,-1.03058 1.03058,-1.03058l3.09175,0c0,-1.1433 0.91786,-2.06116 2.06116,-2.06116s2.06116,0.91786 2.06116,2.06116l3.09174,0c0.5636,0 1.03058,0.46698 1.03058,1.03058l0,5.15291l-1.03058,0l0,-3.09174l-10.30581,0l0,9.27523l10.30581,0l0,-2.06116zm-9.27523,-8.24465l8.24465,0c0,-0.5636 -0.46698,-1.03058 -1.03058,-1.03058l-1.03058,0c-0.5636,0 -1.03058,-0.46698 -1.03058,-1.03058s-0.46698,-1.03058 -1.03058,-1.03058s-1.03058,0.46698 -1.03058,1.03058s-0.46698,1.03058 -1.03058,1.03058l-1.03058,0c-0.5636,0 -1.03058,0.46698 -1.03058,1.03058z');
				copySVG.appendChild(path);
						
				const emptyDiv = document.createElement('div');
				emptyDiv.appendChild(copySVG);
				copyBtn.appendChild(emptyDiv);
				msgDivParentElement.prepend(copyBtn); 
				//‰∫ã‰ª∂ÁõëÂê¨ EventListener
				addEventListenerCopyBtnTooltip(copyBtn);
			},
			
			// ÂàùÂßãÂåñ ÊâπÈáèÊ∑ªÂä†‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ (Ê∞îÊ≥°Ê°Ü‰∏é‰ª£Á†ÅÂùó)
			initAddCopyButtonForMessage() {
				this.$nextTick(() => {
					const aimsgdivs = document.querySelectorAll('div.aimsg'); 
					const usermsgdivs = document.querySelectorAll('div.usermsg'); 
					for (let i = 0; i < aimsgdivs.length; i++) {
						//ÊêúÁ¥¢divÂÜÖÂÆπÔºåÊâæÂà∞Á¨¶ÂêàÊù°‰ª∂ÁöÑ‰ª£Á†ÅÂùóÔºåÊ∑ªÂä†‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ„ÄÇ addCopyButton.  Copying code to the clipboard 
						this.addCopyButtonToPreTags(aimsgdivs[i]);
						//‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ„ÄÇ‰∏∫ËÅäÂ§©Ê∞îÊ≥°Ê°ÜÊ∑ªÂä†‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ„ÄÇ addCopyButton.  Copying Chat Message to the clipboard 	
						this.addCopyButtonToChatMessage(aimsgdivs[i].parentElement);
					}
					for (let i = 0; i < usermsgdivs.length; i++) {
						//ÊêúÁ¥¢divÂÜÖÂÆπÔºåÊâæÂà∞Á¨¶ÂêàÊù°‰ª∂ÁöÑ‰ª£Á†ÅÂùóÔºåÊ∑ªÂä†‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ„ÄÇ addCopyButton.  Copying code to the clipboard 
						this.addCopyButtonToPreTags(usermsgdivs[i]);
						//‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ„ÄÇ‰∏∫ËÅäÂ§©Ê∞îÊ≥°Ê°ÜÊ∑ªÂä†‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ„ÄÇ addCopyButton.  Copying Chat Message to the clipboard 	
						this.addCopyButtonToChatMessage(usermsgdivs[i].parentElement);
					}
				});
			},
			
			//marked.jsÂàùÂßãÂåñËÆæÁΩÆ  Init Markdown  
			initMarkdown() {
				// marked.js ‰∏é highlight.js Âà§Êñ≠ÊòØÂê¶Âä†ËΩΩÊàêÂäü   whether marked.js and highlight.js have been loaded or not.
				if ( window.marked != null & window.hljs != null) { 
					// Âä†ËΩΩÂÆåÊØï ÂºÄÂßãÂàùÂßãÂåñmarked.js After loading the JS plugin, start initializing the settings for marked.js
					marked.setOptions({
						renderer: new marked.Renderer(),
						sanitize:true, // ÂøÖÈ°ªË¶ÅÊúâÔºåÂê¶ÂàôÊúâ‰∫õÂÜÖÂÆπ‰∏çËÉΩÂèëÔºå‰ºöÂá∫ÈîôÊàñ‰∏çÂèØËßÅ„ÄÇ* Êúâ‰∫õjs‰ª£Á†ÅË¢´ÁºñËØë‰∏∫HTMLÊó∂ÔºåÂèØËÉΩ‰ºöÊâßË°åscriptÈáåÁöÑ‰ª£Á†Å
						smartLists: true,
						silent: true,
		
						highlight: function (code) {
							return hljs.highlightAuto(code).value; // hljs = highlight.js ‰ª£Á†ÅÈ´ò‰∫Æ
							}
					});
					
					//ÁΩëÈ°µÂàùÂßãÂåñ: ÂèòÈáè„ÄÅÊï∞ÊçÆ„ÄÅ‰∫ã‰ª∂Á≠â...
					this.initialization();
		
				}
			},
			
			// ÁΩëÈ°µÂàùÂßãÂåñ: ÂèòÈáè„ÄÅÊï∞ÊçÆ„ÄÅ‰∫ã‰ª∂Á≠â...
			initialization() {
					
				// 1). ËÆæÁΩÆÈªòËÆ§ÂÄº Setting the default values.  
				// ËØªÂèñ"Êú¨Âú∞Â≠òÂÇ®"ÂâçÁöÑ‰∏Ä‰∫õÈªòËÆ§ËÆæÁΩÆ„ÄÇBelow are some default settings that are set before reading local cache. 
			
				//v7.22  Áî®Êà∑ËÆæÁΩÆ-ÂèòÈáèÁöÑÈªòËÆ§ËÆæÁΩÆ  Â∞ÜÂèòÈáèËÆæ‰∏∫‰ª£Á†ÅÈªòËÆ§ÂÄºÔºåÈªòËÆ§ÂÄº‰ª•userVariables_default‰∏∫ÂáÜ
				this.setVariablesToThis(this.userVariables_default, this.userVariables_default, true);
			
				// ÂèØ‰øÆÊîπ Editable. ÈªòËÆ§ÁöÑGPTÂ§¥ÂÉè-ÊñπÊ°àAÔºàÂÜôÂú®‰ª£Á†ÅÈáåÁöÑÁªøËâ≤SVGÂ§¥ÂÉèÔºâ‰∫åÈÄâ‰∏Ä Default GPT Avatar. Plan-A (GPT Green SVG). You can only choose either Plan A or Plan B.
				this.isgptGreenSvgShow = true; //ÊòæÁ§∫<svg>+ÈöêËóè<img>„ÄÇ display<svg> + hide<img>
				this.gptAvatarURL =  '';  // ÂΩìÂâçGPTÂ§¥ÂÉèÁöÑÂõæÁâáÂú∞ÂùÄ„ÄÇGPT Avatar URL. <img> url ='' (<img> is hide)
				this.inputGPTImageUrl = this.settingsLanguage == 'cn' ? this.GPTGreenSVG_UrlText_cn : this.GPTGreenSVG_UrlText_en; // ÊòæÁ§∫Âú®ËæìÂÖ•Ê°ÜÁöÑGPTÂ§¥ÂÉèÁöÑÂú∞ÂùÄ input text	
				// ÂèØ‰øÆÊîπ Editable. ÈªòËÆ§ÁöÑGPTÂ§¥ÂÉè-ÊñπÊ°àBÔºà‰ªªÊÑè‰∏ÄÂº†ÂõæÁâáÂú∞ÂùÄÔºâ ‰∫åÈÄâ‰∏Ä  Default GPT Avatar. Plan-B (Any image URL.).  You can only choose either Plan A or Plan B.
		//		this.isgptGreenSvgShow = false; //ÈöêËóè<svg>+ÊòæÁ§∫<img>„ÄÇ display<img> + hide<svg>
		//		this.gptAvhttps://kimi.xinu.ink/gpt.jpgk/gpt.jpgk/gpt.ipg';  // ÂΩìÂâçGPTÂ§¥ÂÉèÁöÑÂõæÁâáÂú∞ÂùÄ„ÄÇGPT Avatar URL. <img> url = Any image URL
		//		this.inputGPTImageUrl = this.gptAvatarURL; // ÊòæÁ§∫Âú®ËæìÂÖ•Ê°ÜÁöÑGPTÂ§¥ÂÉèÁöÑÂú∞ÂùÄ input text
			

				let isNewChatData = false;
				let isLocalStorageRestored; //ÊòØÂê¶ÊàêÂäüÊÅ¢Â§çÊï∞ÊçÆ
				
				//ÂÖÅËÆ∏ÁºìÂ≠òÊó∂ && ÊµèËßàÂô®ÂΩìÂâçÊîØÊåÅlocalStorageÊó∂
				if(this.isLocalStorageAllowed && this.isLocalStorageSupported){
				
					// 2). ÊÅ¢Â§çÊú¨Âú∞Â≠òÂÇ®Êï∞ÊçÆ Restoring the local storage data.
					//ËØªÂèñÊú¨Âú∞Â≠òÂÇ®localStorage
					//1.ÊÅ¢Â§çÁî®Êà∑ËÆæÁΩÆÔºöÂ§¥ÂÉè„ÄÅ‰∏™‰∫∫ËÆæÁΩÆ... Read the local storage (localStorage), restore user settings: avatar, personal settings...
					//2.ÊÅ¢Â§çËÅäÂ§©ËÆ∞ÂΩï  Read the local storage (localStorage), restore chat data
					//3.ÊÅ¢Â§çÊèêÁ§∫ËØçÊ®°Êùø  Read the local storage (localStorage), restore prompt word templates
					//4.ÊÅ¢Â§çAPI Key  Read the local storage (localStorage), restore API Key
					isLocalStorageRestored = this.localStorage_RestoreData();
			
			
					//Êú¨Âú∞ÊúâÊï∞ÊçÆÊó∂ && ÂØπËØùÊï∞ÊçÆ‰∏ç‰∏∫0
					if(isLocalStorageRestored === true && this.chatDataList.length > 0){
						// 3). ÊÅ¢Â§çÊï∞ÊçÆÂêéÔºåÈúÄË¶ÅÊîπÂèòÊ†∑ÂºèÊàñÊï∞ÊçÆÁöÑÂú∞Êñπ„ÄÇ Once the data is restored, need to change the Style / Data.
						// -- Start
						this.changePageScaling(false);//ÈúÄË¶ÅÂú®changeSimpleMode‰πãÂâç
						this.changeLanguage();
						this.changeSimpleMode(false);
			
						this.$nextTick(() => {
							// 1 2 3 4 5 6
							this.todoList_ChatDataRestored('hasdata',800);
						});
						
						//ÊâìÂºÄÂØπËØùÂàóË°®
						this.isShowDialog_ChatList = true;
						// -- End. 
					}else{
					//ÂÖ∂‰ªñÊÉÖÂÜµ
						isNewChatData = true;
					}
						
				}else{
				//‰∏çÂÖÅËÆ∏Êú¨Âú∞Â≠òÂÇ® Êàñ ÊµèËßàÂô®ÂΩìÂâç‰∏çÊîØÊåÅlocalStorage
					isNewChatData = true;
				}
				
				if(isNewChatData){ // Á©∫ÁΩëÈ°µ Ê∑ªÂä†Êñ∞ÂØπËØù
					this.chatList_addNewChatData(true);
					
					this.changePageScaling(false);//ÈúÄË¶ÅÂú®changeSimpleMode‰πãÂâç
					this.changeLanguage();
					this.changeSimpleMode(false);
					// 1 3 4 5 7 this.todoList_ChatDataRestored ÂÜôÂú® this.chatList_addNewChatData ‰∏≠
						
					//ÊèêÈÜíËØ≠Ë®ÄÊîØÊåÅËã±ËØ≠ Remind users that the webpage supports English.
					let lan1 = '', lan2 = '', lan3 = '';
					if ( navigator.language ){ lan1 = navigator.language.substr(0, 2); }
					if ( navigator.userLanguage ){ lan2 = navigator.userLanguage.substr(0, 2); }
					if ( navigator.languages && navigator.languages.length > 0 ){ lan3 = navigator.languages[0].substr(0, 2); }
					if ( this.settingsLanguage == 'cn' && lan1 != 'zh' && lan2 != 'zh' && lan3 != 'zh'){
						//Ê≤°Êúâ‰ªª‰Ωï‰∏≠ÊñáÊ†áËÆ∞ÔºåÈùû‰∏≠ÊñáÁéØÂ¢ÉÔºåÊèêÁ§∫ÂèØËøõË°åËØ≠Ë®ÄËÆæÁΩÆ
						const notif = 'Change the language. Click on the gear icon > Language, and select English.' ;
						this.showNotification(notif, 'bottom', '', 4000);
					}
				}
				
				//Âä†ËΩΩÈªòËÆ§API KeyÊï∞ÊçÆ Initialize Default ApiKeysArray
				try{
					//Âä†ËΩΩ‰ª£Á†Å‰∏≠ÁöÑAPI KeyÔºåËøΩÂä†KeyÔºåÂ¶ÇÊûúÂ∑≤ÁªèÂ≠òÂú®(ÂâçÈù¢‰ª£Á†ÅÂ∑≤ÁªèÂä†ËΩΩ‰∫ÜÊú¨Âú∞Êï∞ÊçÆ)ÔºåÂàô‰ºöÂøΩÁï•
					this.submitBulkApiKeys(false,false,this.default_apiKeyArray_WrittenInTheCode)
				}catch (error) {
					console.error('submitBulkApiKeys - Âä†ËΩΩÈªòËÆ§API KeyÊï∞ÊçÆ Initialize Default ApiKeysArrayÔºåÂá∫Èîô‰∫Ü',error);
				}
				
				//ÊÅ¢Â§çAPI KeyÔºå‰∏çÁõ¥Êé•ÊÅ¢Â§çÔºåÂàÜÊÉÖÂÜµ
				this.$nextTick(() => {
					setTimeout(() => { //ÂøÖÈ°ªÂª∂ËøüÔºåÂª∂Ëøü0
						if( !this.btnDisabledState_CheckAPI && !this.isThirdPartyAPIKeyEnabled && this.apiCheckedData.filter(data => data.vpn !== 'third-party').length > 0){ //Êú™ÈÄöËøáÈ™åËØÅÁöÑÁä∂ÊÄÅ && ÈùûÁ¨¨‰∏âÊñπÂçïKeyÊ®°Âºè && Â≠òÂú®Â∑≤È™åËØÅËøáÁöÑapikey Ôºà‰∏çËÄÉËôëÁ¨¨‰∏âÊñπKeyÁöÑÊÉÖÂÜµÔºâ
							if(this.api.trim() === ''){
								//ÊÅ¢Â§çapikeyÂà∞ËæìÂÖ•Ê°ÜÔºåÂπ∂ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
								this.restoreApiKeyInput(false,false);
							}else{
								let notif_key = this.settingsLanguage == 'cn' ? 'ÊòØÂê¶ÈúÄË¶ÅÊÅ¢Â§ç‰∏Ä‰∏™ÂèØÁî®ÁöÑ OpenAI ÂÆòÊñπÂØÜÈí• (API Key) ?' : 'Do you need to recover an available OpenAI API Key ?' ;
								if(this.apiURL.toLowerCase() !== this.OpenAI_API_URL && this.apiURL.toLowerCase() !== this.OpenaiProxyCom_API_URL){
									notif_key = notif_key + (this.settingsLanguage == 'cn' ? '\r\n\r\n ‚Ä¢ KeyÊ®°Âºè: ‰ΩøÁî®OpenAIÂÆòÊñπKey (Ëá™Âä®ËΩÆÊç¢API Key)' : '\r\n\r\n ‚Ä¢ Key Mode: Use OpenAI API Keys (Auto Key Rotation)' );
									notif_key = notif_key + (this.settingsLanguage == 'cn' ? '\r\n ‚Ä¢ APIÊé•Âè£: <Á¨¨‰∏âÊñπ> ' + this.apiURL : '\r\n ‚Ä¢ API URL: <Third-party> ' + this.apiURL );
									if(!this.isSimpleMode){
										notif_key = notif_key + (this.settingsLanguage == 'cn' ? '\r\n\r\nÊèêÈÜí: Â¶ÇÊûúÁ¨¨‰∏âÊñπÊé•Âè£‰∏çÊîØÊåÅOpenAIÂÆòÊñπKeyÔºåÂàôÈúÄË¶ÅÂú®[ËÆæÁΩÆ]>[Ëá™Âä®ËΩÆÊç¢API Key]‰∏≠Êõ¥ÊîπKeyÊ®°Âºè„ÄÇ' : '\r\n\r\nTip: If the third-party API does not support the OpenAI key, you will need to change the Key Mode in [Settings]>[Auto Key Rotation].' );
									}
								}
								setTimeout(() => {
									if(!this.btnDisabledState_CheckAPI){ //ÂÜçÊ¨°Âà§Êñ≠Ôºå‰øùÈô©ÔºåÈò≤Ê≠¢ÊÑèÂ§ñÊÉÖÂÜµ
										this.is_Alert_Confirm_Prompt_Open = true;
										if (confirm(notif_key)) {//ÂºπÁ™óËØ¢ÈóÆÊòØÂê¶ÊÅ¢Â§ç
											//ÊÅ¢Â§çapikeyÂà∞ËæìÂÖ•Ê°ÜÔºåÂπ∂ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
											this.restoreApiKeyInput(false,true);
										}
										setTimeout(() => {
											this.is_Alert_Confirm_Prompt_Open = false;
										}, 100);
									}
								}, 1500);
							}
						}
					}, 0);
				});
				
				//Ê£ÄÊµãÂΩìÂâçÊ®°ÂûãÊòØÂê¶ËøáÊúü  ÂºπÈÄöÁü•ÊèêÈÜí
				this.gptModel_CheckExpiration(this.apiGPTModel, 16000);//Âª∂Ëøü16Áßí
				
				//1.macÁîµËÑë+2.‰ΩøÁî®safariÊµèËßàÂô®+3.Áõ¥Êé•ÊâìÂºÄhtmlÊñá‰ª∂ÔºàÈùûÊú¨Âú∞webÊúçÂä°ÔºâÔºå‰∏âÊù°‰ª∂ÂêåÊó∂Â≠òÂú®Êó∂Ôºåstorage‰∫ã‰ª∂Êó†Ê≥ïÊøÄÊ¥ª„ÄÇËß£ÂÜ≥ÊñπÂºèÔºöÊîπÂèò‰ªª‰∏ÄÊù°‰ª∂
				//ÁõëÂê¨‰∫ã‰ª∂ Âú®ÊâÄÊúâÊ†áÁ≠æÈ°µ‰∏≠Ê∑ªÂä† StorageEvent ÁõëÂê¨Âô®
				window.addEventListener('storage', () => {
					// event.key Ë°®Á§∫ÂèòÂåñÁöÑ LocalStorage ÈîÆÂêç
					// event.newValue Ë°®Á§∫ÂèòÂåñÂêéÁöÑ LocalStorage ÂÄº
					// event.oldValue Ë°®Á§∫ÂèòÂåñÂâçÁöÑ LocalStorage ÂÄº // event.oldValue: ‰øÆÊîπÂâçÁöÑÂÄºÔºà‰ªÖÂú®ÂêåÊ∫ê‰∏îËØ•ÈîÆÂ≠òÂú®ÁöÑÊÉÖÂÜµ‰∏ãÊâçÊúâÊïàÔºâ
					// event.storageArea Ë°®Á§∫ÂèëÁîüÂèòÂåñÁöÑ LocalStorage ÂØπË±° // event.storageArea: ÂèëÁîüÂèòÂåñÁöÑ localStorage ÂØπË±°ÔºàÂç≥ window.localStorageÔºâ
					// ÈÄöËøáÊØîËæÉÂèòÂåñÂâçÂêéÁöÑÂÄºÔºåÂà§Êñ≠Êï∞ÊçÆÊòØÂê¶ÂèëÁîüÂèòÂåñÔºåÂ¶ÇÊûúÂèëÁîüÂèòÂåñÔºåÂàôËøõË°åÊï∞ÊçÆÂêåÊ≠•Êìç‰Ωú
					if (event.key === 'chatDataList') {
						this.localStorageEvent_chatDataList(event.key, event.newValue, event.oldValue);
					}
					//ÂÖ∂‰ªñÔºö‰∏çÂêåÊ≠•[ËÆæÁΩÆ]„ÄÇ‰ª•ÊúÄÂêé‰∏ÄÊ¨°Ëá™Âä®‰øùÂ≠òÁöÑ‰∏∫ÂáÜÔºàÊúÄÂêé‰∏ÄÊ¨°ÂÖ≥Èó≠ÁöÑÈ°µÈù¢ÔºåÂÖ≥Èó≠Ââç‰ºöËá™Âä®‰øùÂ≠òÔºå[ËÆæÁΩÆ]‰ºöË¢´Ë¶ÜÁõñÔºâ
					//ÂÖ∂‰ªñÔºöapipkey„ÄÅÊèêÁ§∫ËØçÔºå‰πü‰∏çÂêåÊ≠•ÔºåËá™Âä®‰øùÂ≠òÊó∂‰ºöÂêàÂπ∂Êï∞ÊçÆ„ÄÇ
				});
				try{
					const isMac_1 = /^((?!chrome|android).)*safari/i.test(navigator.userAgent) && navigator.platform.toLowerCase().indexOf('mac') > -1 && navigator.userAgent.toLowerCase().indexOf('macintosh') > -1 ;
					const isMobile_1 = navigator.maxTouchPoints ? false : navigator.maxTouchPoints > 2 ;
					const isMobile_2 = RegExp(/Android|webOS|iPhone|iPod|iPad/i).test(navigator.userAgent); 
					const isWin = typeof window !== 'undefined' && /Win/i.test(navigator.platform);
					const isEdge = /Edg/i.test(navigator.userAgent);
					const isChrome = /Chrome/.test(navigator.userAgent);
					const isSafariOnMac = isMac_1 && !isMobile_1 && !isMobile_2 && !isWin && !isEdge && !isChrome;
					const isLocal = window.location.protocol === 'file:';
					// Mac+Safari+'file:' &&ÂÖÅËÆ∏Allowed &&ÊîØÊåÅSupported
					if (isSafariOnMac && isLocal && this.isLocalStorageAllowed && this.isLocalStorageSupported){
						if(!isLocalStorageRestored){ //È¶ñÊ¨°ÂºπÂá∫ÔºåÂè™Âºπ‰∏ÄÊ¨°„ÄÇ First time, Only pop up once„ÄÇ
							let delaytime = this.isShowNotification ? 4000 : 2000;
							const notif_cn = 'Âú®MacÁîµËÑë‰∏äÔºåÂ¶ÇÊûúÊÇ®‰ΩøÁî®SafariÁõ¥Êé•ÊâìÂºÄÊú¨Âú∞ÁöÑ.htmlÊñá‰ª∂ÔºåÂç≥MacÁîµËÑë„ÄÅSafariÊµèËßàÂô®‰ª•ÂèäÁΩëÈ°µÂú∞ÂùÄ‰ª•"file:"ÂºÄÂ§¥ÔºåËøô‰∏â‰∏™Êù°‰ª∂ÂêåÊó∂Â≠òÂú®Êó∂ÔºåÊ†áÁ≠æÈ°µ‰πãÈó¥ÁöÑÊï∞ÊçÆÂêåÊ≠•ÂäüËÉΩÂ∞ÜÂ§±Êïà„ÄÇ\r\nË¶ÅËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåÂè™ÈúÄÊîπÂèòÂÖ∂‰∏≠‰ªª‰Ωï‰∏Ä‰∏™Êù°‰ª∂Âç≥ÂèØ„ÄÇÊÇ®ÂèØ‰ª•Â∞ùËØïÊç¢‰∏™ÊµèËßàÂô®ÔºåÊàñËÄÖ‰ΩøÁî®Âú®Á∫øÁöÑÁâàÊú¨ÔºåÊàñËÄÖ‰ΩøÁî®MacËá™Â∏¶ÁöÑÊú¨Âú∞webÊúçÂä°Âô®ÂäüËÉΩ„ÄÇ' ;
							const notif_en = 'If you open a local .html file directly in Safari on a Mac computer, under the conditions of using Safari browser, Mac computer, and having the URL starting with "file:", the data syncing feature between tabs will be disabled. To resolve this issue, you can try changing any one of these conditions. You can switch to a different browser, use an online version, or utilize the built-in local web server functionality on Mac.';
							const notif = this.settingsLanguage == 'cn' ? notif_cn + '\r\n\r\n' + notif_en : notif_en ;
							const title = this.settingsLanguage == 'cn' ? 'ÊèêÈÜí Reminder' : 'Reminder' ;
							setTimeout(() => {
								this.showNotification(notif, 'center', title);
							}, delaytime);
						}
					}
				}catch (e) {}
			
				//ÁõëÂê¨‰∫ã‰ª∂ Âø´Êç∑ÈîÆ
				document.addEventListener('keydown', this.handleShortcut); 
				
				//‰∫ã‰ª∂Ôºö ËÆæÁΩÆÁ™óÂè£ - ‰∏ãÊãâÊ°ÜÁßªÈô§ÁÑ¶ÁÇπ
				document.getElementById("dialog-settings").addEventListener("change", function(event) {
					if (event.target.classList.contains("dropdown")) {
						event.target.blur(); // Â∞ÜÁÑ¶ÁÇπÁßªÈô§
					}
				}); 
			
				//‰øùÂ≠òÂà∞localStorageÁöÑ5‰∏™‰∫ã‰ª∂„ÄÇÈáçÂ§çËß¶Âèë ÔºåÂè™‰ºö‰øùÂ≠ò‰∏ÄÊ¨°„ÄÇRepetitive triggering of the event will only be saved once.
				//ÁõëÂê¨‰∫ã‰ª∂1 visibilitychange
				document.addEventListener('visibilitychange', () => {
					if (document.visibilityState === 'hidden') {
						this.localStorage_SaveData(event); 
					}
				});
				//ÁõëÂê¨‰∫ã‰ª∂2 pagehide 
				window.addEventListener('pagehide', () => {
					this.localStorage_SaveData(event);
				});
				//ÁõëÂê¨‰∫ã‰ª∂3 onblur
				window.onblur = () =>{// ÈÄöËøáwindowÂ§±ÂéªÁÑ¶ÁÇπ‰∫ã‰ª∂Êù•Âà§Êñ≠Áî®Êà∑ÊòØÂê¶Á¶ªÂºÄÂΩìÂâçÊ†áÁ≠æÈ°µÔºà‰∏çÂèØËßÅÔºâ
					if (!this.is_Alert_Confirm_Prompt_Open){
						let event={type: "WindowBlur"};
						this.localStorage_SaveData(event); 
					}
				};
				//ÁõëÂê¨‰∫ã‰ª∂4 unload
				window.addEventListener('unload', () => {
					this.localStorage_SaveData(event); 
				});
				let isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream; // Âà§Êñ≠ÊòØÂê¶‰∏∫ iOS ËÆæÂ§á
				//ÁõëÂê¨‰∫ã‰ª∂5 ÈùûiosËÆæÂ§á beforeunload 
				if (!isIOS) {
					window.addEventListener('beforeunload', () => {
						this.localStorage_SaveData(event); 
					});	  
				}
						
			},
			
			// ÂàùÂßãÂåñthe first message (first message ->> markdown)
			initTheFirstMessage() {
				// ‰∏é‰∏ä‰∏ãÊñáÊó†ÂÖ≥ÔºåÊâìÂºÄÁΩëÈ°µÊó∂/Êñ∞Â¢ûÂØπËØùÊó∂ ÂØπ‚ÄúÊ¨¢ËøéËØ≠‚ÄùÔºàfirst massageÔºâËøõË°åÊ∏≤ÊüìÔºåÊîØÊåÅmarkdown„ÄÇ Ê∏≤Êüì‰πãÂâçÔºåÁïåÈù¢‰∏ä‰∏çÊòæÁ§∫„ÄÇ
				let firstMsgMarkdown = marked.parse(this.thefirstmessage); 
				if ( this.thefirstmessage.trim() == "" || this.thefirstmessage.replace(/^\n|\n$/g, "").trim() == ""){
					firstMsgMarkdown = "<p> </p>";
				}else if ( firstMsgMarkdown.trim() == "" ){
					firstMsgMarkdown = "<p>" + this.thefirstmessage + "</p>"; //v5.16 BUG A Ôºö ÈóÆÈ¢ò‰∏ç‰∏∫Á©∫Ôºå‰ΩÜmarkedÂ§ÑÁêÜÂêéÂèòÊàêÁ©∫ÔºåÂàôuserMsgMarkdownÈáçÁΩÆ‰∏∫Êú™ÁªèËøámarkedÂ§ÑÁêÜÁöÑÂéüÊñá
				}
				if(firstMsgMarkdown.trim() == ""){
					firstMsgMarkdown = "<p> </p>"; // v5.16 BUG B Ôºö Ëã•‰∏∫Á©∫ÔºåÂàôËæìÂá∫Âä†‰∫Ü<p>Ê†áÁ≠æÁöÑÁ©∫Ê†ºÔºåÊíëËµ∑È´òÂ∫¶Ôºå‰øùÊåÅÊ≠£Á°ÆÁöÑÊ∞îÊ≥°Ê°ÜÊ†∑Âºè
				}
				if (this.msgList.length > 0){
					this.msgList[0]["msg"] = this.msgList[0]['msg'] == "" ?  firstMsgMarkdown : this.msgList[0]['msg'];  //ÈÄöËøáv-htmlÁªëÂÆöÔºåÊó†ÈúÄÂÜôÂú®this.$nextTick(()„ÄÇ  ÈªòËÆ§ÊòØÁ©∫Ôºå‰∏çÁ≠â‰∫éÁ©∫ËØ¥ÊòéËØªÂèñ‰∫ÜÁºìÂ≠ò„ÄÇ  *ÊéíÈô§ÊïÖÊÑèËÆæ‰∏∫Á©∫ÁöÑÊÉÖÂÜµ
				}
			},
			
			//clipboard.jsÂàùÂßãÂåñËÆæÁΩÆ  Init Clipboard (one-click copy button)  
			initClipboard() {
				// ÂÆö‰πâ‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆÁöÑÂäüËÉΩÔºöÊåáÂÆöÂ§çÂà∂ÁöÑÂØπË±°/ÂÜÖÂÆπ & ÂÆåÊàêÂêéÁöÑ‰∫ã‰ª∂. Setting up the function of "one-click copy button": 1. Setting the object and content that need to be copied. 2. Defining the event after the copy is completed.
				//if ( typeof ClipboardJS != 'undefined')   
					
				// A: Copy the text content of the next sibling element.  ÂàùÂßãÂåñclipboard‰∏ÄÈîÆÂ§çÂà∂{‰ª£Á†ÅÂùó}ÂäüËÉΩ  Â§çÂà∂ÂØπË±°ÔºöÂêå‰∏ÄÂ±ÇÊ¨°ÁªìÊûÑ‰∏≠ÁöÑ‰∏ã‰∏Ä‰∏™ÂÖÉÁ¥†‰∏≠ÁöÑÊñáÊú¨‰ø°ÊÅØÔºåÊâÄ‰ª•<button>Ë¶ÅÊîæÂú®Â§çÂà∂ÂØπË±°ÁöÑÂâçÈù¢	
				var clipboardNextElementSibling = new ClipboardJS('[data-clipboard-nextelementsibling]', {
					target: function(trigger) {
						return trigger.nextElementSibling;
					}
				});
				
				// A: Â§çÂà∂ÊàêÂäü
				clipboardNextElementSibling.on('success', function(e) {
					//console.info('Action:', e.action);
					//console.info('Text:', e.text);
					//console.info('Trigger:', e.trigger);
					e.clearSelection();
					document.activeElement.blur(); //ËÆ©ÊåâÈíÆÂ§±ÂéªÁÑ¶ÁÇπ„ÄÇ ËøôÂè•‰ª£Á†ÅÂåÖÂê´Âú®clipboard.min.js 2.0.11‰πãÂâçÁöÑÁâàÊú¨‰∏≠Ôºå‰ΩÜ2.0.11ÁâàÊú¨ÂèñÊ∂à‰∫Ü„ÄÇThe code exists in versions of clipboard.min.js lower than 2.0.11, but was removed in version 2.0.11.
					
					// Tooltip Direction
					// 1. Â§çÂà∂ÂØπË±°Ôºö‰ª£Á†ÅÂùóÂÜÖÂÆπ e.trigger.parentElement.classList.contains('snippet') ÊèêÁ§∫Ê°ÜÊñπÂêë: Â∑¶ / Ë•ø    <pre class='snippet'> -->> <code>  Tooltip Direction:tooltipped-w 
					let directionClass = 'tooltipped-w';
					// 2. Â§çÂà∂ÂØπË±°ÔºöÂè≥‰æßÁî®Êà∑  e.trigger.nextElementSibling.classList.contains('usermsg') ÊèêÁ§∫Ê°ÜÊñπÂêë: Â∑¶‰∏ä / Ë•øÂåó   User. Tooltip Direction:tooltipped-nw 
					if (e.trigger.nextElementSibling.classList.contains('usermsg')) {
						directionClass = 'tooltipped-nw'; 
					}	
					// 3. Â§çÂà∂ÂØπË±°ÔºöÂ∑¶‰æßAIÂõûÂ§ç  e.trigger.nextElementSibling.classList.contains('aimsg') ÊèêÁ§∫Ê°ÜÊñπÂêë: Âè≥‰∏ä / ‰∏úÂåó   AI.  Tooltip Direction:tooltipped-ne
					if (e.trigger.nextElementSibling.classList.contains('aimsg') ) {
						directionClass = 'tooltipped-ne'; 
					}
					// 4. Â§çÂà∂ÂØπË±°ÔºöËÆæÁΩÆÂºπÁ™ó - Â§çÂà∂API Key  e.trigger.nextElementSibling.classList.contains('inputghostforcopyapikey') ÊèêÁ§∫Ê°ÜÊñπÂêë: ‰∏ä / Âåó    Tooltip Direction:tooltipped-n
					if (e.trigger.nextElementSibling.classList.contains('inputghostforcopyapikey') ) {
						directionClass = 'tooltipped-n'; 
					}
					
					const msg = window.currentlang == 'cn' ? 'Â∑≤Â§çÂà∂' : 'Copied!' ;
					showCopyBtnTooltip(e.trigger, msg, directionClass); 
				});
				
				// A: Â§çÂà∂Â§±Ë¥•
				clipboardNextElementSibling.on('error', function(e) {
					//console.error('Action:', e.action);
					//console.error('Trigger:', e.trigger);
					
					// Tooltip Direction
					// ÈªòËÆ§‰ª£Á†ÅÂùó  Â∑¶ / Ë•ø  <pre class='snippet'> -->> <code> 
					let directionClass = 'tooltipped-w';
					// usermsg & aimsg  TooltipÂèØËÉΩ‰ºöË∂ÖÂá∫Â±èÂπïÔºåÂ§±Ë¥•Âá†ÁéáÂ∞èÔºåÂè™ÂÅöÁÆÄÂçïÂ§ÑÁêÜÔºöÊç¢‰∏™ÊñπÂêëÊèêÈÜí 
					if (e.trigger.nextElementSibling.classList.contains('usermsg')) {
						directionClass = 'tooltipped-ne'; 
					}else if (e.trigger.nextElementSibling.classList.contains('aimsg')) {
						directionClass = 'tooltipped-nw'; 
					}else if (e.trigger.nextElementSibling.classList.contains('inputghostforcopyapikey')) {
						// 4. Â§çÂà∂ÂØπË±°ÔºöËÆæÁΩÆÂºπÁ™ó - Â§çÂà∂API Key  ÊèêÁ§∫Ê°ÜÊñπÂêëÂèò‰∏∫: Âè≥‰∏ä / ‰∏úÂåó
						directionClass = 'tooltipped-ne'; 
					}	
					
					showCopyBtnTooltip(e.trigger, fallbackCopyBtnMessage(e.action), directionClass );
				});
				
				// B: ...
				
			},
			
			
			// ÂºÇÊ≠•Âä†ËΩΩjsÊèí‰ª∂ÔºåCDNÈ¶ñÈÄâÈìæÊé•*1 +Â§áÁî®ÈìæÊé•*2 or more.   Async JS loading. url is the main CDN link, fallbackUrl is the backup CDN link (link*2), and callback is the operation after the loading is complete.
			loadScriptFromCDN(url, fallbackUrls, callback) {
				let script = document.createElement("script");
				// Âä†ËΩΩÂèÇÊï∞url - CDNÂú∞ÂùÄ
				script.src = url;
				document.head.appendChild(script);
				// ÁõëÂê¨:urlÂú∞ÂùÄÂ§±Êïà‰∫Ü
				script.onerror = () => {
					// ÊåâÈ°∫Â∫èÂæ™ÁéØÂä†ËΩΩÂ§áÁî®ÈìæÊé•fallbackUrls(Êï∞ÁªÑ)Ôºå‰∏ÄÊó¶ÊàêÂäüÂ∞±callback
					if (fallbackUrls && fallbackUrls.length > 0) {
						let fallbackUrl = fallbackUrls.shift();
						this.loadScriptFromCDN(fallbackUrl, fallbackUrls, callback);
					} else {
						console.error("ÊâÄÊúâCDNÈìæÊé•ÂùáÂ§±Êïà„ÄÇÊúÄÂêéÂ∞ùËØïÁöÑÂ§áÁî®ÈìæÊé•ÊòØ(CDN Failed)Ôºö" + url ); 
						if( !this.isShowNotification ){
							if ( !this.setNotificationContent.includes('Loading Error') ){
								//È¶ñÊ¨°ÊâìÂºÄ / È¶ñ‰∏™ÈîôËØØ
								this.setNotificationContent = this.settingsLanguage == 'cn' ? 'ÁΩëÈ°µÂä†ËΩΩÈîôËØØÂàóË°® ( Loading Error List)Ôºö' : 'Loading Error List:' ;
							}
							//ÊâãÂä®ËÆæÁΩÆÔºå‰∏ç‰ΩøÁî®this.showNotification ÂéüÂõ†ÔºöÊâãÂä®ËÆæÁΩÆ‰ª£Á†ÅÂ∞ë Âõ†‰∏∫Ë¶ÅËÄÉËôëÊòØÂê¶È¶ñÊ¨°ÊâìÔºàËøáÁ®ãËæÉÈïøÔºåÂèØËÉΩ‰ºö‰∏ªÂä®ÂÖ≥Èó≠Ôºå‰πüÂèØËÉΩËØØÂÖ≥Ôºâ Âèäthis.showNotificationÊúâÂª∂Ëøü‰ºöÂØºËá¥ËøôËæπ‰πüË¶ÅËÆæÁΩÆÂª∂Ëøü„ÄÇ
							this.setNotificationPosition = 'center';
							this.isNotificationHasMask = true ;
							this.notificationTimeoutId =  -1;
							this.setNotificationTitle = this.settingsLanguage == 'cn' ?  'ÈîôËØØ Error' : 'Error'; // Â§ö‰ΩôÁöÑ
							this.isShowNotification = true;
						}
						
						//ËØ≠Ë®Ä‰∏∫‰∏≠ÊñáÊó∂Ôºå‰∏∫‰ªÄ‰πàË¶ÅÊòæÁ§∫ÂèåËØ≠Ôºü Âõ†‰∏∫È¶ñÊ¨°‰ΩøÁî®Êó∂ÂèØËÉΩÂ∞±‰ºöÊä•ÈîôÔºå‰ΩÜ‰ª£Á†ÅÈªòËÆ§ËØ≠Ë®Ä‰∏∫‰∏≠ÊñáÔºåÊâÄ‰ª•È¶ñÊ¨°Âá∫ÈîôÂ∫îËØ•ÊòæÁ§∫ÂèåËØ≠ÔºåÈÅøÂÖçÂá∫ÈîôÊó∂ËÆøÈóÆÁöÑÁî®Êà∑Áúã‰∏çÊáÇ‰∏≠Êñá„ÄÇ
						let err_cn = '';
						let err_en = '';
						//ÈîôËØØÊèêÈÜí
						if (url.includes('marked')) {
							err_cn = "\r\n\r\n‚òí !! ÈîôËØØÔºöMarkdownÊèí‰ª∂marked.jsÂä†ËΩΩÂ§±Ë¥•ÔºåÂ∞ÜÊó†Ê≥ï‰ΩøÁî®GPTÔºÅËØ∑Ê£ÄÊü•ÁΩëÁªúÂêéÂà∑Êñ∞È°µÈù¢„ÄÇ  !! Error:Failed to load plugin marked.js. The GPT will be unavailable. Please check your network and refresh the page to try again.";
							err_en = "\r\n\r\n‚òí !! Error:Failed to load plugin marked.js. The GPT will be unavailable. Please check your network and refresh the page to try again.";
							this.setNotificationContent += this.settingsLanguage == 'cn' ? err_cn : err_en; //ËøΩÂä†ÈîôËØØ‰ø°ÊÅØ
							this.msgList[0]['msg'] = '<p>' + this.thefirstmessage + '</p>'; // Â¶ÇÊûúmarkedÂä†ËΩΩÂ§±Ë¥•ÔºåÂ∞±ÊääÊú™ÁªèÊ†ºÂºèÂåñÁöÑÁ¨¨‰∏ÄÊù°‰ø°ÊÅØÊòæÁ§∫Âá∫Êù•ÔºåÊòæÁ§∫ÂéüÂßãÊñáÊú¨
						} else if (url.includes('highlight')) {
							err_cn = "\r\n\r\n‚òí !! ÈîôËØØÔºö‰ª£Á†ÅÈ´ò‰∫ÆÊèí‰ª∂highlight.jsÂä†ËΩΩÂ§±Ë¥•ÔºåÂ∞ÜÊó†Ê≥ï‰ΩøÁî®GPTÔºÅËØ∑Ê£ÄÊü•ÁΩëÁªúÂêéÂà∑Êñ∞È°µÈù¢„ÄÇ  !! Error: Failed to load plugin highlight.js. The GPT will be unavailable. Please check your network and refresh the page to try again.";
							err_en = "\r\n\r\n‚òí !! Error: Failed to load plugin highlight.js.The GPT will be unavailable. Please check your network and refresh the page to try again.";
							this.setNotificationContent += this.settingsLanguage == 'cn' ? err_cn : err_en; //ËøΩÂä†ÈîôËØØ‰ø°ÊÅØ
						} else if (url.includes('axios')) {
							err_cn = "\r\n\r\n‚òí !! ÈîôËØØÔºöHTTPÂ∫ìAxios.jsÂä†ËΩΩÂ§±Ë¥•ÔºåÂ∞ÜÊó†Ê≥ï‰ΩøÁî®GPTÔºÅËØ∑Ê£ÄÊü•ÁΩëÁªúÂêéÂà∑Êñ∞È°µÈù¢„ÄÇ  !! Error: The HTTP library (Axios.js) failed to load. The GPT will be unavailable. Please check your network and refresh the page to try again.";
							err_en = "\r\n\r\n‚òí !! Error: The HTTP library (Axios.js) failed to load. The GPT will be unavailable. Please check your network and refresh the page to try again.";
							this.setNotificationContent += this.settingsLanguage == 'cn' ? err_cn : err_en; //ËøΩÂä†ÈîôËØØ‰ø°ÊÅØ
						} else if (url.includes('clipboard')) {
							err_cn = "\r\n\r\n‚òí ÈîôËØØÔºö‰∏ÄÈîÆÂ§çÂà∂Êèí‰ª∂clipboard.jsÂä†ËΩΩÂ§±Ë¥•ÔºåÂ§çÂà∂ÊåâÈíÆÂäüËÉΩÂ∞ÜÂ§±ÊïàÔºå‰∏çÂΩ±ÂìçÂÖ∂‰ªñÂäüËÉΩÔºåÂèØÁªßÁª≠‰ΩøÁî®„ÄÇÔºàÂª∫ËÆÆÂÖàÂà∑Êñ∞È°µÈù¢ÈáçËØï‰∏ÄÊ¨°Ôºâ  Error: (Please refresh the page once.) The clipboard plugin clipboard.js failed to load, but GPT can still be used. The copy button will not work, but other features can still be used normally.";
							err_en = "\r\n\r\n‚òí Error: (Please refresh the page once.) The clipboard plugin clipboard.js failed to load, but GPT can still be used. The copy button will not work, but other features can still be used normally.";
							this.setNotificationContent += this.settingsLanguage == 'cn' ? err_cn : err_en; //ËøΩÂä†ÈîôËØØ‰ø°ÊÅØ
						}
					}
				};
				// ÁõëÂê¨:urlÂä†ËΩΩÊàêÂäü
				script.onload = callback;
			},
			
			// ÂºÇÊ≠•Âä†ËΩΩcssÊ†∑ÂºèÔºåCDNÈ¶ñÈÄâÈìæÊé•*1 +Â§áÁî®ÈìæÊé•*2 or more.  Async CSS loading.
			loadCssFileFromCDN(url, backupUrls) {
				let link = document.createElement("link");
				link.rel = "stylesheet";
				link.type = "text/css";
				// Âä†ËΩΩÂèÇÊï∞url - CDNÂú∞ÂùÄ
				link.href = url;
				document.head.appendChild(link);
				// ÁõëÂê¨:urlÂú∞ÂùÄÂ§±Êïà‰∫Ü
				link.onerror  = () => {
					if (backupUrls && backupUrls.length > 0) {
						let nextUrl = backupUrls.shift();
						this.loadCssFileFromCDN(nextUrl, backupUrls); 
					} else {
						console.error("ÊâÄÊúâCSSÁöÑCDNÈìæÊé•ÂùáÂ§±Êïà(CDN Failed)Ôºå‰ªÖÁº∫Â§±ÈÉ®ÂàÜÊ†∑ÂºèÔºå‰∏çÂΩ±ÂìçÂäüËÉΩÁöÑÊ≠£Â∏∏‰ΩøÁî®„ÄÇÊúÄÂêéÂ∞ùËØïÁöÑÂ§áÁî®ÈìæÊé•ÊòØÔºö" + url ); 
					}
				};
			},
			
			// Ëß£ÂØÜKey„ÄÇ Decrypt   //ÁÆÄÂçïÁöÑÈÅøÂÖçÊòéÊñáÂØÜÈí•Êö¥Èú≤Âú®github‰∏≠„ÄÇ  Simple method to prevent plaintext keys from being exposed on GitHub.
			decryptAPIKeyBase64(encodedKey) {
				try {
					var decodedKey = atob(encodedKey); // ‰ΩøÁî®atobËøõË°åBase64Ëß£Á†Å
					return decodedKey;
				} catch (error) {
					console.error("decryptAPIKeyBase64 - Decryption failed Âä†ÂØÜKeyÁöÑÁºñÁ†ÅÂèØËÉΩÊúâÈóÆÈ¢ò:", error);
					return null; // Ëß£ÂØÜÂ§±Ë¥•Êó∂ËøîÂõûÁ©∫ÂÄº
				}
			},		
			// Â∞ÜÂä†ÂØÜÁöÑKeyËß£ÂØÜÂêéÊ∑ªÂä†Âà∞Êï∞ÁªÑ add EncryptedAPIKeys to this.default_apiKeyArray_WrittenInTheCode
			addEncryptedAPIKeysTo_apiKeyArray() {
				try{
					const encryptedAPIKeys = this.default_apiKeyArray_WrittenInTheCode_Encrypted_Base64.filter(apiKey => apiKey.trim() !== '').map(apiKey => apiKey.trim()); 
					encryptedAPIKeys.forEach(encryptedKey => {
						const decryptedKey = this.decryptAPIKeyBase64(encryptedKey);
						if (decryptedKey !== null && !this.default_apiKeyArray_WrittenInTheCode.includes(decryptedKey)) { //Ëß£ÂØÜÊàêÂäü && ÈùûÈáçÂ§çÁöÑkey
							this.default_apiKeyArray_WrittenInTheCode.push(decryptedKey);
						}
					});
				}catch (error) {
					console.error('addEncryptedAPIKeysTo_apiKeyArray - Ê∑ªÂä†Âä†ÂØÜKeyÂà∞Êï∞ÁªÑÊó∂Âá∫Èîô‰∫Ü',error);
				}
			},
			
			
		},
		mounted() {
			
			this.defaultAPIKey = this.api.trim(); //ËÆ∞ÂΩï‰ª£Á†Å‰∏≠ÁöÑapiÔºàÂ¶ÇÊûúÂ≠òÂú®ÁöÑËØùÔºâÔºåÂõ†‰∏∫‰πãÂêéthis.api‰ºöË¢´Ë¶ÜÁõñ
			this.addEncryptedAPIKeysTo_apiKeyArray(); //ÂÖàÊ∑ªÂä†‚ÄúÂä†ÂØÜKey‚ÄùÂà∞this.default_apiKeyArray_WrittenInTheCodeÊï∞ÁªÑ‰∏≠„ÄÇ
			try{
				//ËøáÊª§Á©∫ÂÄºÔºåÂè™‰øùÁïô‰ª•sk-ÂºÄÂ§¥ÁöÑKeyÔºåËøáÊª§Á©∫Ê†º
				this.default_apiKeyArray_WrittenInTheCode = this.default_apiKeyArray_WrittenInTheCode.filter(apiKey => apiKey.trim() !== '' && apiKey.trim().startsWith('sk-')).map(apiKey => apiKey.trim()); 
			}catch (error) {
				this.default_apiKeyArray_WrittenInTheCode = []; //Âá∫ÈîôÂàôËÆæÁΩÆ‰∏∫Á©∫
				console.error('default_apiKeyArray_WrittenInTheCode - ÂÜôÂú®‰ª£Á†Å‰∏≠ÁöÑapi keyÂ≠òÂú®ÈóÆÈ¢òÔºåÂ∑≤Ê∏ÖÁ©∫Â§ÑÁêÜÔºå‰∏çÂΩ±Âìç‰ΩøÁî®„ÄÇ',error);
			}
			
			//Âà†Èô§apikey‰∏∫Á©∫ÁöÑÈ°πÔºåÂÆö‰πâÂèòÈáèÊó∂ ÂÜô‰∫ÜÁ©∫ÁöÑKey ÈúÄË¶ÅÂú®ËøôÈáåÂà†Èô§Ôºà‰ª£Á†ÅÈúÄË¶ÅÈù†ÂâçÔºâ
			this.apiCheckedData = this.apiCheckedData.filter(apidata => apidata.apikey && apidata.apikey.trim() !== '');//ÊéíÈô§Á©∫È°π
			
			this.current_Year = new Date().getFullYear().toString();//Êõ¥Êñ∞ÂΩìÂâçÁöÑÂπ¥‰ªΩÂèòÈáè,StringÁ±ªÂûã
			
			//v7.22 ‰∏çÂ≠òÂÇ®Êï∞ÊçÆ delete this.apikeyData_default.api = JSON.parse(JSON.stringify(this.api.trim()));
			//v7.22 ‰∏çÂ≠òÂÇ®Êï∞ÊçÆ delete this.apikeyData_default.apiCheckedData = JSON.parse(JSON.stringify(this.apiCheckedData));
			 this.promptsData_default.gptSystemPrompt = JSON.parse(JSON.stringify(this.gptSystemPrompt));//ÂæÖÂÆö ÂæÖÂ§ÑÁêÜ 
			//v7.22 ‰∏çÂ≠òÂÇ®Êï∞ÊçÆ delete this.promptsData_default.gptPrompts = JSON.parse(JSON.stringify(this.gptPrompts));
			
			//ÂÖàÊ∏≤Êüì‰∏Ä‰∏™Â∏¶Êúâ<p>Ê†áÁ≠æÁöÑÁ©∫Ê†ºÔºåÊúâÂÜÖÂÆπÔºåÊúâË°åÈ´ò„ÄÇ‚Äú‰øùÁïô‰∏Ä‰∏™Á©∫Ê†ºÔºåÁî®Êù•Â¢ûÂä†È´òÂ∫¶„ÄÇÂú®Ê∏≤ÊüìÈ¶ñÊù°Ê∂àÊÅØÂâçÔºåÊúâÂÜÖÂÆπÊíëÂºÄÈ´òÂ∫¶ÔºåÂèØ‰ª•Áõñ‰ΩèÊ∞îÊ≥°Ê°ÜÂ∑¶ËæπÁöÑÁÆ≠Â§¥„ÄÇ Keep an empty space to increase the height. Before rendering the first message, the normal height can cover the left arrow.‚Äù
			const first_msg_div = document.querySelectorAll('div.aimsg')[0];
			first_msg_div.innerHTML = '<p> </p>';
			
			// Ê∑ªÂä†'È°µÈù¢Áº©Êîæ‰∏ãÊãâÊ°Ü'ÁöÑÈÄâÈ°π (ÁßªÂä®ËÆæÂ§áÈ°µÈù¢Áº©ÊîæÁöÑÊØî‰æã)
			for (let i = 0.5; i < 1.01; i += 0.05) {
				this.selectedPageScalingOptions.push((i.toFixed(2) * 100).toFixed(0) + '%');
			}
						
			//ÈöêËóèÈÅÆÁΩ©„ÄÇÁΩëÈ°µLoadingÂä†ËΩΩÈò∂ÊÆµÔºåÈÅÆÁΩ©ÂèØ‰ª•ÈÅøÂÖçÂä†ËΩΩÊÖ¢ÂØºËá¥Èó™Â±è/ÂºπÁ™óÈó™Áé∞/ÊòæÁ§∫vueÊ∫ê‰ª£Á†ÅÁ≠âÈóÆÈ¢ò
			const loadingmask = document.getElementById("loading-mask");
			if(loadingmask!=null){
				loadingmask.classList.add('dialog-wrapper-hide');
			}

			//Ê£ÄÊµãÊµèËßàÂô®ÊòØÂê¶ÊîØÊåÅ Êú¨Âú∞Â≠òÂÇ®localStorage
			this.isLocalStorageSupported = this.checkLocalStorageSupport();
			
			
			// ÂºÇÊ≠•Âä†ËΩΩÂºÄÊ∫êÁöÑjsÊèí‰ª∂„ÄÅcssÊ†∑ÂºèÔºåÂáèÂ∞ëÊâìÂºÄÁΩëÈ°µÂç°È°øÁöÑÁé∞Ë±°„ÄÇÈ¶ñÈÄâUnpkgÁöÑÈìæÊé•(ÂõΩÂ§ñÂ∏∏Áî®CDNÔºåfan.qiangÂêéÊõ¥Á®≥ÂÆö)ÔºåÂ§áÈÄâBootCDN(ÂõΩÂÜÖÂ∏∏Áî®CDN)+Â§áÈÄâCDNJS(ÂõΩÂ§ñÂ∏∏Áî®CDN)
			// For regions outside of China, BootCDN may have slower speeds and can be placed at the bottom of the list or replaced with another CDN.
			
			// 1.ÂºÇÊ≠•Âä†ËΩΩmarked.min.js  ÂøÖÂ§áÔºåÂ§±ÊïàÂ∞ÜÊó†Ê≥ïËÅäÂ§©
			// marked.js ÂºÄÊ∫êÁöÑMarkdownÊèí‰ª∂ ÂÆòÊñπ: https://github.com/markedjs/marked 
			this.loadScriptFromCDN(
				"https://unpkg.com/marked@4.3.0/marked.min.js",
				[ 
				  "https://cdn.bootcdn.net/ajax/libs/marked/4.3.0/marked.min.js",
				  "https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js",
				],
				() => {
					//‰∏ÄÊó¶Âä†ËΩΩÊàêÂäüÔºåÂàùÂßãÂåñ
					this.initMarkdown();
				}
			);

			// 2.ÂºÇÊ≠•Âä†ËΩΩhighlight.min.js  Â§±Êïà‰πüÂèØÊ≠£Â∏∏ËÅäÂ§©ÔºåÂΩ±Âìç‰∏ÄËà¨
			// highlight.js  ÂºÄÊ∫êÁöÑ‰ª£Á†ÅÈ´ò‰∫ÆÊèí‰ª∂  ÂÆòÊñπ: https://github.com/highlightjs/highlight.js/
			this.loadScriptFromCDN(
				"https://unpkg.com/@highlightjs/cdn-assets@11.7.0/highlight.min.js",
				[ 
				  "https://cdn.bootcdn.net/ajax/libs/highlight.js/11.7.0/highlight.min.js",
				  "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js",
				],
				() => {
					//‰∏ÄÊó¶Âä†ËΩΩÊàêÂäüÔºåÂàùÂßãÂåñ
					this.initMarkdown();
				}
			);
			
			// 3.ÂºÇÊ≠•Âä†ËΩΩaxios.min.js  ÂøÖÂ§áÔºåÂ§±ÊïàÂ∞ÜÊó†Ê≥ïËÅäÂ§©ÔºåÈúÄË¶Å‰ΩøÁî®axios‰∏éGPTÊúçÂä°Âô®ËøõË°åËøûÁ∫ø„ÄÇ 
			// axios.js  AxiosÊòØ‰∏ÄÁßçÂ∏∏Áî®HTTPÂ∫ìÔºåÁî®‰∫éÂêëÊúçÂä°Âô®ÂèëËµ∑HTTPËØ∑Ê±Ç„ÄÇ   ÂÆòÊñπ: https://github.com/axios/axios/
			this.loadScriptFromCDN(
				"https://unpkg.com/axios@1.3.2/dist/axios.min.js",
				[ 
				  "https://cdn.bootcdn.net/ajax/libs/axios/1.3.2/axios.min.js",
				  "https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.2/axios.min.js",
				],
				() => {
					//ÊàêÂäüÂç≥ÂèØÔºåÊó†ÈúÄÊìç‰Ωú
				}
			);
			
			// 4.ÂºÇÊ≠•Âä†ËΩΩclipboard.min.js  Â§±Êïà‰πüÂèØÊ≠£Â∏∏ËÅäÂ§©ÔºåÂΩ±ÂìçÈùûÂ∏∏Â∞è
			// clipboard.js  ÂºÄÊ∫êÁöÑ‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆÊèí‰ª∂  ÂÆòÊñπ: https://github.com/zenorocha/clipboard.js/  https://clipboardjs.com
			this.loadScriptFromCDN(
				"https://unpkg.com/clipboard@2.0.11/dist/clipboard.min.js",
				[ 
				  "https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js",
				  "https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js",
				],
				() => {
					//‰∏ÄÊó¶Âä†ËΩΩÊàêÂäüÔºåÂàùÂßãÂåñ
					this.initClipboard();
				}
			);
			
			// 5.ÂºÇÊ≠•Âä†ËΩΩpanda-syntax-dark.min.css  Â§±Êïà‰πüÂèØÊ≠£Â∏∏ËÅäÂ§©ÔºåÂΩ±ÂìçÈùûÂ∏∏Â∞è
			// Markdown‰ª£Á†ÅÈ´ò‰∫ÆÁöÑcssÊ†∑ÂºèË°®ÔºåÂç≥ÈÖçËâ≤ÊñπÊ°à„ÄÇ ÊñπÊ°àÂêçÔºöPanda Syntax Dark  ÂÖ∂‰ªñÈÖçËâ≤ÊñπÊ°àÔºöhttps://highlightjs.org/static/demo/ 
			this.loadCssFileFromCDN(
				"https://unpkg.com/@highlightjs/cdn-assets@11.7.0/styles/panda-syntax-dark.min.css",
				[ 
				  "https://cdn.bootcdn.net/ajax/libs/highlight.js/11.7.0/styles/panda-syntax-dark.min.css",
				  "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/panda-syntax-dark.min.css"
				]
			);
			
			//ÊâãÂä®‰∏∫ÂçïÁã¨ÁöÑ‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆÊ∑ªÂä†‰∫ã‰ª∂
			//Â§çÂà∂ API Key
			const copyapikeybtn = document.querySelector('.btncopyapikey'); // Copy API Key
			addEventListenerCopyBtnTooltip(copyapikeybtn);
			//Â§çÂà∂ Ê∂àÊÅØÈÄöÁü• ÂºπÁ™óÂÜÖÂÆπ
			const copynotification = document.querySelector('.btncopynotification'); // Copy Notification
			addEventListenerCopyBtnTooltip(copynotification);
			
			// Ëé∑Âèñ#dialog-promptgeneratorÊèêÁ§∫ËØçÂºπÁ™ó‰∏≠ÊâÄÊúâclass‰∏∫copybtnÁöÑÂÖÉÁ¥†
			// ‰πãÂêéÁöÑÁâàÊú¨ÔºöÊèêÁ§∫ËØçÁ™óÂè£Èáå‰∏ÄÈîÆÂ§çÂà∂ÊåâÈíÆ‰ºöÂæàÂ§öÔºåÂêéÁª≠ÈúÄË¶ÅÁ°ÆËÆ§Ôºö1„ÄÅÂ§çÂà∂ÁöÑÂØπË±°‰ΩçÁΩÆÊòØÂê¶Ê≠£Á°Æ„ÄÇ2„ÄÅÂ§çÂà∂ÁöÑÊñπÂºèÊòØÂê¶‰∏∫Âêå‰∏ÄÁßç„ÄÇ
			let copyBtns = document.querySelectorAll('#dialog-promptgenerator .copybtn');
			// ‰∏∫ÊØè‰∏™ÂÖÉÁ¥†Ê∑ªÂä†‰∫ã‰ª∂
			for (let i = 0; i < copyBtns.length; i++) {
				addEventListenerCopyBtnTooltip(copyBtns[i]);
			}
			
			//ÈöêÂΩ¢ÊèêÁ§∫ËØç Â¶ÇÊûúÂú®‰ª£Á†Å‰∏≠ÂÜô‰∫ÜgptSystemPrompt_hiddenÈöêËóèÊèêÁ§∫ËØçÔºåÂàôÁ¶ÅÁî®ÊèêÁ§∫ËØçÂºπÁ™óÊåâÈíÆÔºà6.23 Êîπ‰∏∫ÁªëÂÆöÔºâ„ÄÇ
			if(this.gptSystemPrompt_hidden.trim() != ''){
				this.gptSystemPromptReadOnly = "hidden system prompt";
			} 
			
			//ÂàùÂßãÂåñ Ê∑ªÂä†‰∏ä‰º†Â§¥ÂÉèÁöÑÊéß‰ª∂
			this.addInput_FileDialog_Avatar('user');
			this.addInput_FileDialog_Avatar('gpt');

			//‰ª•‰∏ä ÈùûÊï∞ÊçÆÁ±ªÂàùÂßãÂåñ„ÄÇ Above, unrelated to data.
			
			
			// ÂÖ∂‰ªñÂàùÂßãÂåñ: ÂèòÈáèÂàùÂßãÂåñ„ÄÅËØªÂèñÊú¨Âú∞ÁºìÂ≠òÊï∞ÊçÆ„ÄÅ‰∫ã‰ª∂Á≠â... ÊîπÂà∞this.initialization()ÔºåÊåâÊâßË°åÈ°∫Â∫èÔºåÊîæÂú®initMarkdown()‰∏≠„ÄÇ

		},
		beforeDestroy() {
			//Âø´Êç∑ÈîÆ ‰∫ã‰ª∂ ÁßªÈô§ÁõëÂê¨
			document.removeEventListener('keydown', this.handleShortcut);
		}
	}).mount('#app')
</script>
 
<script>
//ËÅäÂ§©ËæìÂÖ•Ê°ÜËá™Âä®Ë∞ÉÊï¥È´òÂ∫¶ Chat input box with auto-adjustable height    *ÂÖ≥‰∫éËæìÂÖ•Ê°ÜÈ´òÂ∫¶ÁöÑ‰∏ä‰∏ãÈôêÁöÑËÆæÁΩÆÔºåÊêú max-height Âíå maxHeight 
//v0515 ‰ª£Á†ÅÂä†ÂÖ•<!DOCTYPE html>Âêé ÔºåHeightËÆ°ÁÆóÊñπÂºèÂèëÁîüÊîπÂèò„ÄÇAdd <!DOCTYPE html>, the calculation method of Height has changed.
				
	let textarea_Chat = document.querySelector('.textareachatinputbox');
	
	textarea_Chat.addEventListener('input', (e) => {
		textarea_Chat.style.height = '38px';
		textarea_Chat.style.height = e.target.scrollHeight + 'px';
		
		//max-heightÂΩìÂèòÈáèÁî®ÔºåÂ≠òÂÇ®È´òÂ∫¶„ÄÇÂè¶‰∏ÄÂ§ÑÔºöËÅäÂ§©ËæìÂÖ•Ê°ÜËé∑ÂèñÁÑ¶ÁÇπÊó∂ÔºåÊÅ¢Â§çÊ≠§È´òÂ∫¶„ÄÇ *‰ª•‰∏ã‰ª£Á†ÅÂøÖÈ°ªÁΩÆÂêéÔºåÂê¶ÂàôÂâ™ÂàáËæìÂÖ•Ê°ÜÂÜÖÂÆπÊó∂‰ºöÊúâbug
		if( parseInt(e.target.scrollHeight) > 38){
			let height6px = parseInt(e.target.scrollHeight) + 6; // +
			if( parseInt(e.target.scrollHeight) < 450){
				//textarea_Chat.style.maxHeight = e.target.scrollHeight + 'px'; // -
				textarea_Chat.style.maxHeight = height6px.toString() + 'px'; // +
			}
			else{
				textarea_Chat.style.maxHeight = '456px'; // + 6
			}
			textarea_Chat.style.height = height6px.toString() + 'px'; // +
			textarea_Chat.style.borderRadius = '6px 6px 6px 0px'; //border-radius: 6px 6px 6px 0px;
		}
		else{
			textarea_Chat.style.maxHeight = '38px';
			textarea_Chat.style.borderRadius = '0px 6px 6px 0px'; //border-radius: 0px 6px 6px 0px;
		}
	});
</script>


<script>
//"ÁßªÂä®Á´Øiphone&ipad"‰∏é"ÁßªÂä®Á´Ø/ÁîµËÑëÁ´ØÁöÑÈùûWebKitÂÜÖÊ†∏ÊµèËßàÂô®"Âùá‰∏çÊîØÊåÅ"-webkit-scrollbar"Ëá™ÂÆö‰πâÊªöÂä®Êù°Ê†∑Âºè(body)„ÄÇÊâÄ‰ª•ÂÅö‰∫õË∞ÉÊï¥ÔºåËÆ©ÁΩëÈ°µÂè≥‰æß‰∏ç‰ºöÂá∫Áé∞Â§™ÂÆΩÊàñÂ§™Á™ÑÁöÑÊÉÖÂÜµ„ÄÇ
//The scrollbar style "-webkit-scrollbar"(body) is not supported on iPhones, iPads, and non-WebKit core browsers. 
//Êàë‰∏çÊòØÂæàÊáÇË∞ÉÊï¥cssÊ†∑ÂºèÔºå

	try{
		let isFirefox = navigator.userAgent.indexOf("Firefox") != -1; // Âà§Êñ≠ÊòØÂê¶‰∏∫ Firefox ÂÜÖÊ†∏
		let isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream; // Âà§Êñ≠ÊòØÂê¶‰∏∫ iOS ËÆæÂ§á
		let isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent); // Âà§Êñ≠ÊòØÂê¶‰∏∫ Safari ÂÜÖÊ†∏
		let isChrome = /chrome/i.test(navigator.userAgent); // Âà§Êñ≠ÊòØÂê¶‰∏∫ Chrome ÂÜÖÊ†∏
		let isWebkit = /webkit/i.test(navigator.userAgent); // Âà§Êñ≠ÊòØÂê¶‰∏∫ WebKit ÂÜÖÊ†∏
	
		let style = document.createElement('style');
		style.type = 'text/css'; 
		if (isFirefox || isIOS) { // Â¶ÇÊûúÊòØ Firefox ÂÜÖÊ†∏Êàñ iOS ËÆæÂ§áÂàôÊ∑ªÂä†Ê†∑Âºè
			style.innerHTML = '.userinfo { padding-right: 6px; } .btn { margin-right: 13px; }';
			document.getElementsByTagName('head')[0].appendChild(style);
		}else if ( !isSafari && !isChrome && !isWebkit){  // Â¶ÇÊûú‰∏çÂ±û‰∫é Webkit ÂÜÖÊ†∏
			style.innerHTML = '.userinfo { padding-right: 3px; } .btn { margin-right: 10px; }';
			document.getElementsByTagName('head')[0].appendChild(style);
		}
	} catch{}
</script>

<script>
//‰Ωú‰∏∫‰∏ÄÊ¨æAIËØ≠Ë®ÄÊ®°ÂûãÔºåÊàëÂæàËç£Âπ∏ËÉΩÂ§ü‰∏∫Êü•ËØ¢OpenAI API Key‰ΩôÈ¢ùËøô‰∏™È°πÁõÆÂÅöÂá∫Ë¥°ÁåÆ„ÄÇÊàëÂÖ∑Â§áÂá∫Ëâ≤ÁöÑÊï¥ÂêàËÉΩÂäõÂíåÈòÖËØª‰ª£Á†ÅËÉΩÂäõÔºåËÉΩÂ§üÂø´ÈÄüÁêÜËß£ÂíåËûçÂêà‰∏çÂêåÈ°πÁõÆÁöÑ‰ª£Á†ÅÂíåÂäüËÉΩ„ÄÇÂêåÊó∂ÔºåÊàë‰πüÂçÅÂàÜÊÑüË∞¢ÂÖ∂‰ªñÂºÄÂèëËÄÖÁöÑ‰ªòÂá∫ÂíåË¥°ÁåÆÔºå‰ªñ‰ª¨ÁöÑ‰ª£Á†ÅÂíåÊÄùË∑Ø‰∏∫ÊàëÊèê‰æõ‰∫ÜÂæàÂ§öÂêØÂèëÂíåÂ∏ÆÂä©„ÄÇÊàëË¶ÅÁâπÂà´ÊÑüË∞¢‰ª•‰∏ãÂºÄÊ∫êÈ°πÁõÆÁöÑ‰ΩúËÄÖÔºö@herobrine19ÁöÑÈ°πÁõÆÔºàhttps://github.com/herobrine19/openai-billingÔºâÂíå@ClarenceDanÁöÑÈ°πÁõÆÔºàhttps://github.com/ClarenceDan/openai-billingÔºâ„ÄÇËøô‰∫õÈ°πÁõÆ‰∏∫ÊàëÊèê‰æõ‰∫ÜÂæàÂ§ö‰ª£Á†ÅÂèÇËÄÉÂíåÊäÄÊúØÊîØÊåÅÔºå‰ΩøÊàëËÉΩÂ§üÊõ¥Â•ΩÂú∞ÂÆåÊàêÊü•ËØ¢OpenAI API Key‰ΩôÈ¢ùËøô‰∏™‰ªªÂä°„ÄÇÂú®ÂºÄÊ∫êÁ§æÂå∫‰∏≠ÔºåÊàë‰ª¨Â∫îËØ•‰∫íÁõ∏Â∞äÈáçÔºåÂàÜ‰∫´ÂíåÂêà‰ΩúÔºåÂÖ±ÂêåÊé®Âä®ÂºÄÊ∫êÊäÄÊúØÁöÑÂèëÂ±ï„ÄÇ
//‰ª•‰∏ã‰∏∫[Êü•ËØ¢OpenAI API‰ΩôÈ¢ù]ÁöÑ‰ª£Á†Å  Javascript code to check OpenAI API balances


		//Â£∞ÊòéÂèòÈáèÔºåËÆ∞ÂΩïÊü•ËØ¢‰ΩôÈ¢ùÁä∂ÊÄÅ
	  	var isCheckAPIKey = false;
		//ÈÅøÂÖçÈáçÂ§çÊä•ÈîôÂºπÁ™ó
	  	var isError = false;

		//ËøûÂÆòÁΩëÊé•Âè£Êü•ËØ¢ËøîÂõûAPI KeyÂØπÂ∫îÁöÑË¥¶Âè∑‰ø°ÊÅØ
	  	async function checkBilling(apiKey) {
			isError = false;
			// ËÆ°ÁÆóËµ∑ÂßãÊó•ÊúüÂíåÁªìÊùüÊó•Êúü
			const now = new Date();
			let startDate = new Date(now - 90 * 24 * 60 * 60 * 1000); // 90Â§©‰πãÂâçÁöÑÊó•Êúü  Default query for three months usage.
			const endDate = new Date(now.getTime() + 24 * 60 * 60 * 1000); // ÂΩìÂâçÊó•Êúü
			const subDate = new Date(now);
			subDate.setDate(1) // Êú¨Êúà1Âè∑ÁöÑÊó•Êúü

			// ËÆæÁΩÆAPIËØ∑Ê±ÇURLÂíåËØ∑Ê±ÇÂ§¥
			// ÂÆòÊñπÊé•Âè£1ÔºöÂèØÈÄöËøáAPI KeyÊü•ËØ¢Ë¥¶Âè∑‰ø°ÊÅØÔºàÂåÖÂê´ÂßìÂêç„ÄÅÊòØÂê¶ÁªëÂç°„ÄÅÈ¢ùÂ∫¶„ÄÅ‰ΩôÈ¢ù„ÄÅÈ¢ùÂ∫¶ÊúâÊïàÊúüÁ≠âÔºå‰ΩÜ‰∏çÂåÖÂê´Â∑≤Ê∂àËÄóÁöÑÈáëÈ¢ùÔºâ
			//ES6ÁöÑÂÜôÊ≥ïÔºö const urlSubscription = `https://api.openai.com/v1/dashboard/billing/subscription`; // Êü•ÊòØÂê¶ËÆ¢ÈòÖ
			const urlSubscription = 'https://api.openai.com/v1/dashboard/billing/subscription'; // Êü•ÊòØÂê¶ËÆ¢ÈòÖ  *ÂÖºÂÆπÊÄßÊõ¥Â•Ω Support more browsers
			// ÂÆòÊñπÊé•Âè£2ÔºöÂèØÈÄöËøáAPI KeyÊü•ËØ¢Â∑≤Ê∂àËÄóÁöÑÈáëÈ¢ù
			//ES6ÁöÑÂÜôÊ≥ïÔºö let urlUsage = `https://api.openai.com/v1/dashboard/billing/usage?start_date=${formatDate(startDate)}&end_date=${formatDate(endDate)}`; // Êü•‰ΩøÁî®Èáè
			let urlUsage = 'https://api.openai.com/v1/dashboard/billing/usage?start_date=' + formatDate(startDate) + '&end_date=' + formatDate(endDate); // Êü•‰ΩøÁî®Èáè *ÂÖºÂÆπÊÄßÊõ¥Â•Ω Support more browsers
			const headers = {
			  "Authorization": "Bearer " + apiKey,
			  "Content-Type": "application/json"
			};
			
			//Â§áÊ≥® ÂÖ∂‰ªñÊé•Âè£ÔºöÂè≥ËæπËøô‰∏™ÂÆòÊñπÊé•Âè£Áñë‰ºº‰ªé4ÊúàÂàùÂºÄÂßãÂ§±Êïà  const urlBalance = `https://api.openai.com/dashboard/billing/credit_grants`; //Êü•ÊôÆÈÄöË¥¶Âçï

			try {
				// ÈÄöËøáurlSubscriptionÊé•Âè£ÈìæÊé•Ëé∑ÂèñË¥¶Âè∑‰ø°ÊÅØ
				let response = await fetch(urlSubscription, { headers });
				if (!response.ok) {
					console.log("urlSubscription - response.ok:",response.ok);
					// Notification: Failed to check the balance. The reasons for the failure are not clear, and the possibility of "code malfunction" cannot be ruled out.(No impact on ChatGPT usage).
					const msg_cn = '!! Êü•ËØ¢‰ΩôÈ¢ùÂ§±Ë¥•ÔºåÂ≠òÂú®Â§öÁßçÂèØËÉΩÔºåÊ£ÄÊü•ÁΩëÁªúÂêéÈáçËØï(ÂõΩÂÜÖÈúÄË¶ÅÈ≠îÊ≥ï)Ôºå‰ªçÂ§±Ë¥•ÁöÑËØùÔºåËØ∑ÊîæÂºÉÊü•‰ΩôÈ¢ùÔΩû \r\n\r\n‰∏çÊéíÈô§ÊòØÊü•ËØ¢‰ΩôÈ¢ù‰ª£Á†ÅÂ§±ÊïàÁöÑÂéüÂõ†Ôºà‰∏çÂΩ±ÂìçGPTÁöÑ‰ΩøÁî®Ôºâ„ÄÇ\r\n\r\nÂèØÊü•Áúã‰ª£Á†ÅÊòØÂê¶ÊúâÊõ¥Êñ∞Ôºö\r\nhttps://gitee.com/lin2025/gpt3.5/ \r\nhttps://github.com/lin2025/gpt3.5/';
					const msg_en = "!! Failed to check the balance. The reasons for the failure are not clear, and the possibility of 'code malfunction' cannot be ruled out.(No impact on GPT usage) \r\n\r\nCheck for code updates:\r\nhttps://github.com/lin2025/gpt3.5/\r\n\r\nTip: If your location is not supported by OpenAI, use a VPN to check your balance.";
					const msg = window.currentlang == 'cn' ? msg_cn : msg_en ;
					alert(msg);
					isError = true;
					return [null, null, null, null, null, null, null, null, null]; //Âá∫ÈîôÂàôËøîÂõû9‰∏™Á©∫ÂÄº
				}
				const subscriptionData = await response.json();

				// Âà§Êñ≠ÊòØÂê¶ËøáÊúü
				const timestamp_now = Math.floor(Date.now() / 1000); //ÂΩìÂâçÊó∂Èó¥ÁöÑÊó∂Èó¥Êà≥
				const timestamp_expire = subscriptionData.access_until; //Âà∞ÊúüÊó∂Èó¥ÁöÑÊó∂Èó¥Êà≥
				if (timestamp_now > timestamp_expire) {
					const msg_cn = 'OpenAI APIÁöÑË¥¶Âè∑‰ΩôÈ¢ù‰ºº‰πéÂ∑≤Âà∞Êúü, ‰ΩÜ‰∏çÊéíÈô§‰ªçÁÑ∂ËÉΩÁî®ÔºåËØ∑ÁôªÂΩïOpenAIËøõË°åÊü•Áúã„ÄÇ\r\nÊü•ËØ¢ÁªìÊûúÊ≠£Âú®ÁîüÊàê...';
					const msg_en = "It seems that the OpenAI API account balance has expired, but it is still possible that it can still be used. Please log in to OpenAI to check. \r\nQuery results are being generated...";
					const msg = window.currentlang == 'cn' ? msg_cn : msg_en ;
					alert(msg);
				}

				const totalAmount = subscriptionData.hard_limit_usd; //ÊÄªÈ¢ùÂ∫¶ ÁæéÂÖÉ
				const is_subsrcibed = subscriptionData.has_payment_method; //ÊòØÂê¶ÁªëÂç°Áî®Êà∑
		  
				// ÈÄöËøáurlUsageÊé•Âè£ÈìæÊé•Ëé∑Âèñ‰ΩøÁî®Èáè  Êú¨Ê¨°ÁªüËÆ°ËåÉÂõ¥‰∏∫Ôºö90Â§©ÂâçÔΩû‰ªäÂ§©  Default query for three months usage.( has_payment = false)
				response = await fetch(urlUsage, { headers }); 
				let usageData = await response.json(); // Áî®Êà∑ËøáÂéª90Â§©ÁöÑ‰ΩøÁî®Êï∞ÊçÆ
				let totalUsage = usageData.total_usage / 100; // Áî®Êà∑ÁöÑÁ¥ØËÆ°Áî®ÈáèÔºà90Â§©ÔºâÔºåÂç≥Ê∂àËÄóÁöÑÊÄªÈáëÈ¢ù„ÄÇÈô§‰ª•100Âêé Âçï‰Ωç‰∏∫ÁæéÂÖÉ
				
				let usageDataCurr; //Êú™ÁªëÂç°Áî®Êà∑ÁöÑÊú¨Êúà‰ΩøÁî®Êï∞ÊçÆ
				let totalUsageCurr; //Êú™ÁªëÂç°Áî®Êà∑ÁöÑÊú¨ÊúàÁî®Èáè

				startDate = subDate ; // ÂºÄÂßãÊó∂Èó¥Êîπ‰∏∫Êú¨ÊúàÁ¨¨‰∏ÄÂ§©
				//ES6ÁöÑÂÜôÊ≥ï urlUsage = `https://api.openai.com/v1/dashboard/billing/usage?start_date=${formatDate(startDate)}&end_date=${formatDate(endDate)}`; // Êñ∞ÁöÑÊó∂Èó¥ ËåÉÂõ¥‰∏∫Êú¨Êúà
				urlUsage = 'https://api.openai.com/v1/dashboard/billing/usage?start_date=' + formatDate(startDate) + '&end_date=' + formatDate(endDate); // Êñ∞ÁöÑÊó∂Èó¥ ËåÉÂõ¥‰∏∫Êú¨Êúà *ÂÖºÂÆπÊÄßÊõ¥Â•Ω Support more browsers.
				
				//Âå∫Âà´ 1„ÄÅÂ¶ÇÊûúÁî®Êà∑Áªë‰∫Ü‰ø°Áî®Âç°ÔºåÈ¢ùÂ∫¶ÊØèÊúà‰ºöÂà∑Êñ∞ÔºåÈ¢ùÂ∫¶‰∏∫Êú¨ÊúàÈ¢ùÂ∫¶„ÄÇ  2„ÄÅÂ¶ÇÊûúÁî®Êà∑Êú™ÁªëÂç°ÔºåÂàôÂ¢ûÂä†Â±ïÁ§∫Êú¨ÊúàÁî®Èáè„ÄÇ
				if(is_subsrcibed) {
					// Â¶ÇÊûúÁî®Êà∑ÁªëÂç°ÔºåÁ¥ØËÆ°Áî®ÈáèÊï∞ÊçÆÂèòÊõ¥‰∏∫Êú¨ÊúàÁî®ÈáèÊï∞ÊçÆ   ÈÄöËøáurlUsageÊé•Âè£ÈìæÊé•ÈáçËé∑‰ΩøÁî®Èáè  Êú¨Ê¨°ÁªüËÆ°ËåÉÂõ¥‰∏∫ÔºöÊú¨Êúà1Êó•ÔΩû‰ªäÂ§©
					response = await fetch(urlUsage, {headers}); 
					usageData = await response.json(); //ÁªëÂç°Áî®Êà∑Êú¨Êúà‰ΩøÁî®Êï∞ÊçÆ
					totalUsage = usageData.total_usage / 100; //ÁªëÂç°Áî®Êà∑Êú¨ÊúàÁî®Èáè
				}else{
					// Â¶ÇÊûúÁî®Êà∑Êú™ÁªëÂç°ÔºåÈ¢ùÂ§ñËé∑ÂèñÊú¨ÊúàÊï∞ÊçÆ ÔºåÊØîÁªëÂç°Áî®Êà∑Â§öÂ±ïÁ§∫‰∏ÄË°åÊï∞ÊçÆ  ÈÄöËøáurlUsageÊé•Âè£ÈìæÊé•Ëé∑ÂèñÊú¨Êúà‰ΩøÁî®Èáè  Êú¨Ê¨°ÁªüËÆ°ËåÉÂõ¥‰∏∫ÔºöÊú¨Êúà1Êó•ÔΩû‰ªäÂ§©
					response = await fetch(urlUsage, {headers});
					usageDataCurr = await response.json(); //Êú¨Êúà‰ΩøÁî®Êï∞ÊçÆ
					totalUsageCurr = usageDataCurr.total_usage / 100; //Êú¨ÊúàÁî®Èáè
				}
	
				// ËÆ°ÁÆóÂâ©‰ΩôÈ¢ùÂ∫¶
				const remaining = totalAmount - totalUsage;

				// Êï∞ÊçÆËØ¥ÊòéÔºöÂÖ±9‰∏™ÂèÇÊï∞ÔºåÂùá‰∏∫ÂÆòÊñπÊé•Âè£ËøîÂõûÁöÑ‰ø°ÊÅØÔºå‰∏çÂøÖÊãÖÂøÉÂÆâÂÖ®ÈóÆÈ¢òÔºåÊó†‰ªª‰ΩïÊ≥ÑÊºèÈ£éÈô©Ôºå‰∏ç‰ºö‰ª•‰ªª‰ΩïÊñπÂºèÂ≠òÂÇ®Êï∞ÊçÆ
				//  	Êù•Ê∫êÂÆòÊñπÊé•Âè£1Ôºö https://api.openai.com/v1/dashboard/billing/subscription
				//  	Êù•Ê∫êÂÆòÊñπÊé•Âè£2Ôºö https://api.openai.com/v1/dashboard/billing/usage?start_date=Êü•ËØ¢Ê∂àËÄóÈáëÈ¢ùÁöÑËµ∑ÂßãÊó∂Èó¥&end_date=Êü•ËØ¢Ê∂àËÄóÈáëÈ¢ùÁöÑÁªìÊùüÊó∂Èó¥
				// Êï∞ÁªÑÂ∫èÂàóÂ¶Ç‰∏ãÔºö
				// 0 subscriptionData.account_name [Ë¥¶Âè∑ÂΩíÂ±û/Account_Name]  
				// 1 is_subsrcibed  Âç≥subscriptionData.has_payment_method [ÊòØÂê¶ÁªëÂç°/has_payment_method]  ÔºüÁªëÂç°ÂíåË¥≠‰π∞PlusÂ∫îËØ•ÊòØ‰∏§Âõû‰∫ãÔºåÁªëÂç°‰ΩøÁî®API ‰∏ç‰∏ÄÂÆöÊúâËÆ¢ÈòÖPlus 
				// 2 totalAmount  Âç≥subscriptionData.hard_limit_usd  [Ë¥¶Âè∑ÊÄªÈ¢ùÂ∫¶/Total Amount] 
				// 3 totalUsage  Âç≥usageData.total_usage(ÈúÄË¶ÅÈô§‰ª•100)  [Â∑≤Ê∂àËÄóÈáëÈ¢ù/Total Usage] //ÁªëÂç°Áî®Êà∑‰∏∫Êú¨ÊúàÁî®Èáè  ÈùûÁªëÂç°Áî®Êà∑‰∏∫ÂéÜÂè≤Á¥ØËÆ°Áî®Èáè
				// 4 remaining (ÈÄöËøáËÆ°ÁÆóÂæóÂá∫) [ÂèØÁî®È¢ùÂ∫¶/Remaining]
				// 5 timestamp_expire  Âç≥subscriptionData.access_until  [Êà™Ê≠¢Êó∂Èó¥/Expiration Date] *Êó∂Èó¥Êà≥Ê†ºÂºè
				// 6 subscriptionData.plan["title"]  plan-title ÂèØËÉΩÊòØË¥¶Âè∑ÂàÜÁ±ª/Áî®ÈÄî
				// 7 subscriptionData.plan["id"]   Plan-id [ËÆ¢ÈòÖÊÉÖÂÜµ/Subscription]
				// 8 totalUsageCurr Êú™ÁªëÂç°Áî®Êà∑ÁöÑÊú¨ÊúàÁî®Èáè
				// ‰ª•‰∏ä Êï∞ÊçÆËØ¥Êòé
				
				//ËøîÂõûÈÄöËøáÂÆòÁΩëÊé•Âè£Ëé∑ÂèñÂà∞ÁöÑ9‰∏™Êï∞ÊçÆ
		  		return [subscriptionData.account_name, is_subsrcibed, totalAmount, totalUsage, remaining, timestamp_expire, subscriptionData.plan["title"], subscriptionData.plan["id"], totalUsageCurr ];
		  
			} catch (error) {
				isError = true;
				isCheckAPIKey = false;
				console.log(error);
				// Notification: Failed to check the balance. The reasons for the failure are not clear, and the possibility of "code malfunction" cannot be ruled out.(No impact on ChatGPT usage).
				const msg_cn = '!! Êü•ËØ¢‰ΩôÈ¢ùÂ§±Ë¥•ÔºåÂ≠òÂú®Â§öÁßçÂèØËÉΩÔºåÊ£ÄÊü•ÁΩëÁªúÂêéÈáçËØï(ÂõΩÂÜÖÈúÄË¶ÅÈ≠îÊ≥ï)Ôºå‰ªçÂ§±Ë¥•ÁöÑËØùÔºåËØ∑ÊîæÂºÉÊü•‰ΩôÈ¢ùÔΩû \r\n\r\n‰∏çÊéíÈô§ÊòØÊü•ËØ¢‰ΩôÈ¢ù‰ª£Á†ÅÂ§±ÊïàÁöÑÂéüÂõ†Ôºà‰∏çÂΩ±ÂìçGPTÁöÑ‰ΩøÁî®Ôºâ„ÄÇ\r\n\r\nÂèØÊü•Áúã‰ª£Á†ÅÊòØÂê¶ÊúâÊõ¥Êñ∞Ôºö\r\nhttps://gitee.com/lin2025/gpt3.5/ \r\nhttps://github.com/lin2025/gpt3.5/';
				const msg_en = "!! Failed to check the balance. The reasons for the failure are not clear, and the possibility of 'code malfunction' cannot be ruled out.(No impact on GPT usage) \r\n\r\nCheck for code updates:\r\nhttps://github.com/lin2025/gpt3.5/\r\n\r\nTip: If your location is not supported by OpenAI, use a VPN to check your balance.";
				const msg = window.currentlang == 'cn' ? msg_cn : msg_en ;
				alert(msg);
				return [null, null, null, null, null, null, null, null, null]; //Âá∫ÈîôÂàôËøîÂõû9‰∏™Á©∫ÂÄº
			}
		}
	  

		//Ê†ºÂºèÂåñÊó•Êúü
		function formatDate(date) {
			const year = date.getFullYear();
			let month, day;
			if (String.prototype.padStart) {
				month = (date.getMonth() + 1).toString().padStart(2, '0');
				day = date.getDate().toString().padStart(2, '0');
			} else {
				month = (date.getMonth() + 1).toString();
				day = date.getDate().toString();
				// Âú®Êúà‰ªΩÂíåÊó•ÊúüÂâçË°•Èõ∂
				if (month.length === 1) {
					month = '0' + month;
				}
				if (day.length === 1) {
					day = '0' + day;
				}
			}
			//ES6ÂÜôÊ≥ïÔºö return `${year}-${month}-${day}`;
			return year + '-' + month + '-' + day;  // ÂÖºÂÆπÊÄßÊõ¥Â•Ω„ÄÇ Support more browsers.
		}


		//Êü•ËØ¢API Key‰ΩôÈ¢ù
		function sendRequest(apiKey_or_sessionKey) {
		
			let msg_cn, msg_en, msg;
			//Â¶ÇÊûúÂêéÂè∞Ê≠£Âú®Êü•ËØ¢ÔºåÈÇ£‰πàÊèêÈÜíÂêéËøîÂõûÔºåÈò≤Ê≠¢ÈáçÂ§çÊü•ËØ¢
			if(isCheckAPIKey){
				msg_cn = 'Â∑≤Âú®‰∏∫ÊÇ®Êü•ËØ¢OpenAI APIÁöÑ‰ΩôÈ¢ùÔºåËØ∑ÂÖ≥Èó≠ÂºπÁ™óÂêéËÄêÂøÉÁ≠âÂæÖ„ÄÇ\r\nÁ≠âÂæÖÊúüÈó¥ÂèØËøõË°åÂÖ∂‰ªñÊìç‰ΩúÔºåÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãÊï∞ÁßíÂÜÖÂÆåÊàêÔºåÂ¶ÇÁ≠âÂæÖÊó∂Èó¥ËøáÈïøÔºåËØ∑Ê£ÄÊü•‰∏ãÁΩëÁªúÁä∂ÊÄÅ„ÄÇ';
				msg_en = "Your request is currently being processed. Please close the pop-up window and wait patiently.";
				msg = window.currentlang == 'cn' ? msg_cn : msg_en ;
				alert(msg);
				return;
			}
		  
			isCheckAPIKey = true;
			
			msg_cn = 'Â∞Ü‰∏∫ÊÇ®Êü•ËØ¢OpenAI APIÁöÑË¥¶Âè∑‰ΩôÈ¢ùÔºåËØ∑ÂÖàÂÖ≥Èó≠Êú¨ÂºπÁ™óÔºåÂæÖÊü•ËØ¢ÁªìÊûúÂá∫Êù•Âêé‰ºöËá™Âä®ÂºπÂá∫„ÄÇ\r\n\r\nÊ≥®ÊÑè: Êü•‰ΩôÈ¢ùÈúÄË¶ÅÈ≠îÊ≥ï';
			msg_en = "After closing this pop-up window, the account balance of the API will be checked. The query result will automatically pop up when it is available.\r\n\r\nTip: If your location is not supported by OpenAI, use a VPN to check your balance.";
			msg = window.currentlang == 'cn' ? msg_cn : msg_en ;
			alert(msg);
		 
			//Âõ†‰∏∫ÊòØÂú®API KeyÈ™åËØÅÊàêÂäüÂêéÊâçËÉΩÊü•ËØ¢‰ΩôÈ¢ùÔºåÊâÄ‰ª•Ê≠§Â§ÑÊó†ÈúÄÂà§Êñ≠API KeyÁöÑÊúâÊïàÊÄß„ÄÅÊ†ºÂºèÊòØÂê¶Ê≠£Á°ÆÁ≠âÊÉÖÂÜµ


		  	//ËøûÂÆòÁΩëÊé•Âè£Êü•ËØ¢Ë¥¶Âè∑‰ø°ÊÅØ  ‰º†ÂÖ•ÁΩëÈ°µ‰∏äAPI KeyÂêéÂºÄÂßãÊü•ËØ¢
			checkBilling(apiKey_or_sessionKey).then((data) => {
	  
	  			//Â¶ÇÊûúcheckBillingÂ∑≤Âá∫ÈîôÔºåÂ∞±ËøîÂõûÔºåÈÅøÂÖçÈáçÂ§çÊä•Èîô„ÄÇ
				if ( isError && data[0] == null && data[1] == null){
					isCheckAPIKey = false; 
					return;
				}
				// Êï∞ÊçÆËØ¥ÊòéÔºöÂÖ±9‰∏™ÂèÇÊï∞ÔºåÂùá‰∏∫ÂÆòÊñπÊé•Âè£ËøîÂõûÁöÑ‰ø°ÊÅØÔºå‰∏çÂøÖÊãÖÂøÉÂÆâÂÖ®ÈóÆÈ¢òÔºåÊó†‰ªª‰ΩïÊ≥ÑÊºèÈ£éÈô©Ôºå‰∏ç‰ºö‰ª•‰ªª‰ΩïÊñπÂºèÂ≠òÂÇ®Êï∞ÊçÆ
				//  	Êù•Ê∫êÂÆòÊñπÊé•Âè£1Ôºö https://api.openai.com/v1/dashboard/billing/subscription
				//  	Êù•Ê∫êÂÆòÊñπÊé•Âè£2Ôºö https://api.openai.com/v1/dashboard/billing/usage?start_date=Êü•ËØ¢Ê∂àËÄóÈáëÈ¢ùÁöÑËµ∑ÂßãÊó∂Èó¥&end_date=Êü•ËØ¢Ê∂àËÄóÈáëÈ¢ùÁöÑÁªìÊùüÊó∂Èó¥
				// Êï∞ÁªÑÂ∫èÂàóÂ¶Ç‰∏ãÔºö
				// 0 subscriptionData.account_name [Ë¥¶Âè∑ÂΩíÂ±û/Account_Name]  
				// 1 is_subsrcibed  Âç≥subscriptionData.has_payment_method [ÊòØÂê¶ÁªëÂç°/has_payment_method]  
				// 2 totalAmount  Âç≥subscriptionData.hard_limit_usd  [Ë¥¶Âè∑ÊÄªÈ¢ùÂ∫¶/Total Amount] 
				// 3 totalUsage  Âç≥usageData.total_usage(ÈúÄË¶ÅÈô§‰ª•100)  [Â∑≤Ê∂àËÄóÈáëÈ¢ù/Total Usage] //ÁªëÂç°Áî®Êà∑‰∏∫Êú¨ÊúàÁî®Èáè  ÈùûÁªëÂç°Áî®Êà∑‰∏∫ÂéÜÂè≤Á¥ØËÆ°Áî®Èáè
				// 4 remaining (ÈÄöËøáËÆ°ÁÆóÂæóÂá∫) [ÂèØÁî®È¢ùÂ∫¶/Remaining]
				// 5 timestamp_expire  Âç≥subscriptionData.access_until  [Êà™Ê≠¢Êó∂Èó¥/Expiration Date] *Êó∂Èó¥Êà≥Ê†ºÂºè
				// 6 subscriptionData.plan["title"]  plan-title ÂèØËÉΩÊòØË¥¶Âè∑ÂàÜÁ±ª/Áî®ÈÄî
				// 7 subscriptionData.plan["id"]   Plan-id [ËÆ¢ÈòÖÊÉÖÂÜµ/Subscription]
				// 8 totalUsageCurr Êú™ÁªëÂç°Áî®Êà∑ÁöÑÊú¨ÊúàÁî®Èáè
				// ‰ª•‰∏ä Êï∞ÊçÆËØ¥Êòé


				// 5-Êó•ÊúüÊ†ºÂºèÈúÄË¶ÅËΩ¨Êç¢  5-Âà∞ÊúüÊó∂Èó¥/ÊúâÊïàÊúü/Expiration Date
				let date = new Date(data[5]* 1000);// data[5]‰∏∫ÁßíÁ∫ßÊó∂Èó¥Êà≥ÔºåÈúÄË¶Å*1000ËΩ¨Êç¢‰∏∫ÊØ´ÁßíÊï∞
				let Y = date.getFullYear() + '-'; // Ëé∑ÂèñÂπ¥‰ªΩ
				let M = String(date.getMonth() + 1).replace(/^(\d)$/, '0$1') + '-'; // Ëé∑ÂèñÊúà‰ªΩÔºåÊ≥®ÊÑèÊúà‰ªΩÊòØ‰ªé 0 ÂºÄÂßãËÆ°Êï∞ÁöÑÔºåÊâÄ‰ª•ÈúÄË¶ÅÂä† 1
				let D = String(date.getDate()).replace(/^(\d)$/, '0$1') + ' '; // Ëé∑ÂèñÊó•Êúü
				let h = String(date.getHours()).replace(/^(\d)$/, '0$1') + ':'; // Ëé∑ÂèñÂ∞èÊó∂
				let m = String(date.getMinutes()).replace(/^(\d)$/, '0$1') + ':'; // Ëé∑ÂèñÂàÜÈíü
				let s = String(date.getSeconds()).replace(/^(\d)$/, '0$1');  // Ëé∑ÂèñÁßíÊï∞
				data[5] = Y+M+D+h+m+s ;  // Y+M+D+h+m+s Ê†∑ÂºèÔºö2023-04-26 10:58:30

				// ÂÆö‰πâÈáëÈ¢ùÂêëÂè≥ÂØπÈΩêÂêéÁöÑÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶  chatgptÊé®Ëçê‰ΩøÁî®padStartÂáΩÊï∞Ôºå‰∏∫‰∫ÜÂÖºÂÆπÊõ¥Â§öÊµèËßàÂô®ÔºåËÆ©gptÊç¢‰∫ÜÊñπÊ≥ï
				let alignLength = 10;

				//Â£∞ÊòéÂèòÈáè
				let msgTop, msg0, msg1, msg2, msg3, msg4, msg5, msg6, msg7, msg8, msgBottom;

				//ÁªëÂç°Áî®Êà∑‰∏éÈùûÁªëÂç°Áî®Êà∑ÁöÑ‰∏çÂêå  ÁªëÂç°ÂíåË¥≠‰π∞PlusÂ∫îËØ•ÊòØ‰∏§Âõû‰∫ãÔºåÁªëÂç°‰ΩøÁî®API ‰∏ç‰∏ÄÂÆöÊúâËÆ¢ÈòÖPlus 
				// * I don't have a payment account, so I can't verify the time range of data for payment users. However, hope the label is not wrong.
				if(data[1]) {
					//ÁªëÂç°Áî®Êà∑ÔºöÂêéÂè∞ÁªëÂÆö‰ø°Áî®Âç°ÊåâÈáèÊâ£Ë¥πÁöÑÁî®Êà∑Ôºå‰∏çÊòØÊØèÊúàÂõ∫ÂÆöÊâ£Ë¥πÁöÑPlus‰ºöÂëò
					//  *Ê†πÊçÆÁΩëÂèãÁöÑËØ¥Ê≥ïÔºåÁªëÂç°ÂêéÊåâÊúàÁªüËÆ°ÔºåÊ†πÊçÆAPI‰ΩøÁî®ÈáèÊâ£Ë¥πÔºåÁêÜËß£Â¶ÇÊúâËØØÔºåËØ∑Ëá™Ë°åÊõ¥ÊîπÊñáÊú¨ÂÜÖÂÆπ
					msg2 = window.currentlang == 'cn' ? '\r\nÊú¨Êúà‰∏äÈôêÔºö  $' : '\r\nTotal Amount (M): $';  //TotalAmount per month
					msg3 = window.currentlang == 'cn' ? '\r\nÂÆûÈôÖÊ∂àË¥πÔºö  $' : '\r\nTotal Usage (M): $'; //TotalUsage per month
					msg4 = window.currentlang == 'cn' ? '\r\nÂâ©‰ΩôÈôêÈ¢ùÔºö  $' : '\r\nRemaining (M): $'; //Remaining per month
					msg5 = window.currentlang == 'cn' ? '\r\nÂà∞ÊúüÊó∂Èó¥(?)Ôºö' : '\r\nExpiration Date(?): '; //ExpirationDate  ÁªëÂç°Áî®Êà∑ÊòØÂê¶ÊúâÊà™Ê≠¢Êó•ÊúüÔºü ÊúàÂ∫ïÔºü per month??
					msg8 = window.currentlang == 'cn' ? '\r\nÊó†' : '\r\nNone';  //null
				}else{
					//ÈùûÁªëÂç°Áî®Êà∑Ôºö‰ΩøÁî®ÂÖçË¥π‰ΩìÈ™åÈáëÁöÑÁî®Êà∑ÔºåÂéÜÂè≤ÁªüËÆ°Êï∞ÊçÆ
					msg2 = window.currentlang == 'cn' ? '\r\nË¥¶Âè∑ÊÄªÈ¢ùÔºö  $' : '\r\nTotal Amount: $';  //TotalAmount
					msg3 = window.currentlang == 'cn' ? '\r\nÁ¥ØËÆ°Ê∂àËÄóÔºö  $' : '\r\nTotal Usage: $'; //TotalUsage
					msg4 = window.currentlang == 'cn' ? '\r\nÂâ©‰ΩôÈ¢ùÂ∫¶Ôºö  $' : '\r\nRemaining: $'; //Remaining
					msg5 = window.currentlang == 'cn' ? '\r\nÂà∞ÊúüÊó∂Èó¥Ôºö  ' : '\r\nExpiration Date: ';  //ExpirationDate
					msg8 = (window.currentlang == 'cn' ? '\r\nÊú¨ÊúàÊ∂àËÄóÔºö  $' : '\r\nMonthly Usage: $')  + " ".repeat(alignLength - data[8].toFixed(4).length) + data[8].toFixed(4); //MonthlyUsage ‰ªÖÊú™ÁªëÂç°Áî®Êà∑ Âèñ4‰ΩçÂ∞èÊï∞ÁÇπÔºåÂπ∂ÂêëÂè≥ÂØπÈΩê
				}

				//ÁªÑÂêàÈúÄË¶ÅÂ±ïÁ§∫ÁöÑÊï∞ÊçÆ
				msgTop = window.currentlang == 'cn' ? 'OpenAI API Ë¥¶Âè∑‰ΩôÈ¢ùÊü•ËØ¢ÁªìÊûú\r\n' : 'OpenAI API Balance Query Result\r\n' ;  // OpenAI API account balance query result
				//Â¶ÇÊûúÊòØapikeyÔºåËÄå‰∏çÊòØsessionKey
				if (apiKey_or_sessionKey.startsWith('sk-')){
					//const msgTop_cn = '\r\n ‚Ä¢ 7Êúà22Êó•Ëµ∑ÔºåOpenAI Â∑≤ÂÅúÊ≠¢ÈÄöËøá API Key Êü•ËØ¢‰ΩôÈ¢ù (‰ΩôÈ¢ùÊó†Êï∞ÊçÆ)ÔºåÁé∞Âú®Êü•ËØ¢‰ΩôÈ¢ùÈúÄË¶Å‰ΩøÁî® Session Key „ÄÇ\r\n ‚Ä¢ ËØ∑ÈÄöËøáÁÇπÂáª‚ÄúSession Key‚ÄùÊåâÈíÆÔºåËæìÂÖ•Session Key Êù•Êü•Áúã‰ΩôÈ¢ù‰ø°ÊÅØ„ÄÇ\r\n';
					//const msgTop_en = '\r\n ‚Ä¢ Starting from July 22nd, OpenAI has stopped displaying the balance when querying with an API Key. Now, to check the balance, you need to use a Session Key. \r\n ‚Ä¢ Please click the "Session Key" button and enter your Session Key to view the balance information.\r\n';
					const msgTop_cn = '\r\n ‚Ä¢ Ëá™7Êúà22Êó•Ëµ∑ÔºåOpenAI Â∑≤ÂÅúÊ≠¢‰ΩøÁî® API Key Êü•ËØ¢‰ΩôÈ¢ù (‰ΩôÈ¢ùÊó†Êï∞ÊçÆ)„ÄÇÁé∞Âú®ÈúÄË¶Å‰ΩøÁî® Session Key Êù•Êü•ËØ¢‰ΩôÈ¢ùÔºå‰ΩÜ Session Key ÊòØÂä®ÊÄÅÂèòÂåñÁöÑÔºåÁõÆÂâçÊöÇÊó∂Ê≤°ÊúâÂæàÂ•ΩÁöÑ‰ΩôÈ¢ùÊü•ËØ¢ÊñπÊ°à„ÄÇ\r\n';
					const msgTop_en = '\r\n ‚Ä¢ Starting from July 22nd, OpenAI has stopped displaying the balance when querying with an API Key. Now, to check the balance, you need to use a Session Key. However, the Session Key is dynamically changing, so currently there is no good solution to query the balance.\r\n';
					msgTop = window.currentlang == 'cn' ? msgTop + msgTop_cn : msgTop + msgTop_en ;
				}
				
				msg0 = (window.currentlang == 'cn' ? '\r\nË¥¶Âè∑ÂΩíÂ±ûÔºö  ' : '\r\nAccount Name: ') + data[0]; // Ê≥®ÂÜåOpenAIË¥¶Âè∑Êó∂Â°´ÂÜôÁöÑÂßìÂêç  //AccountName
				msg1 = (window.currentlang == 'cn' ? '\r\nÊòØÂê¶ÁªëÂç°Ôºö  ' : '\r\nHas Payment: ') + (data[1] ? 'Yes' : 'No') ; //has_payment  ÁªëÂç°ÂíåË¥≠‰π∞PlusÂ∫îËØ•ÊòØ‰∏§Âõû‰∫ãÔºåÁªëÂç°‰ΩøÁî®API ‰∏ç‰∏ÄÂÆöÊúâËÆ¢ÈòÖPlus 
				msg2 = msg2 + " ".repeat(alignLength - data[2].toFixed(4).length) + data[2].toFixed(4); //Âèñ4‰ΩçÂ∞èÊï∞ÁÇπÔºåÂπ∂ÂêëÂè≥ÂØπÈΩêÔºàËÆ°ÁÆóÈúÄË¶ÅË°•ÂÖÖÁöÑÁ©∫Ê†ºÊï∞ÈáèÔºåÂú®Â≠óÁ¨¶‰∏≤ÂâçÈù¢Ê∑ªÂä†Á©∫Ê†ºÔºâ
				msg3 = msg3 + " ".repeat(alignLength - data[3].toFixed(4).length) + data[3].toFixed(4); //Âèñ4‰ΩçÂ∞èÊï∞ÁÇπÔºåÂπ∂ÂêëÂè≥ÂØπÈΩê 
				msg4 = msg4 + " ".repeat(alignLength - data[4].toFixed(4).length) + data[4].toFixed(4); //Âèñ4‰ΩçÂ∞èÊï∞ÁÇπÔºåÂπ∂ÂêëÂè≥ÂØπÈΩê
				msg5 = msg5 + data[5];
				msg6 = (window.currentlang == 'cn' ? '\r\nË¥¶Âè∑Áî®ÈÄîÔºö  ' : '\r\nAbout Plan(?): ') + data[6]; // Plan-title Â∫îËØ•ÊòØÊ≥®ÂÜåÊó∂ÈÄâÊã©ÁöÑÊ≥®ÂÜåÁõÆÁöÑ„ÄÅÁî®ÈÄî
				const freetext = window.currentlang == 'cn' ? 'ÂÖçË¥πËÆ°Âàí' : 'Free Plan' ;
				msg7 = (window.currentlang == 'cn' ? '\r\nËÆ¢ÈòÖÊÉÖÂÜµÔºö  ' : '\r\nSubscription: ') + ( data[7] == 'free' ? freetext : (data[7] + ' (Paid Account ?)' ) );  //Plan-id  idÁ≠â‰∫éfreeÔºåÂàôÊòæÁ§∫ÂÖçË¥π„ÄÇ ÂÖ∂‰ªñÊÉÖÂÜµÊú™Áü•ÔºåÊòæÁ§∫ÂéüÂßãÂÄº
				msg8 = msg8; 
				
				const str1 = window.currentlang == 'cn' ? '\r\n*ÈùûÁªëÂç°Áî®Êà∑ÈªòËÆ§ÁªüËÆ°ËåÉÂõ¥‰∏∫90Â§©„ÄÇ' : '\r\n*Default query for 90 days usage.(For Non-Payment users)' ;
				const str2 = window.currentlang == 'cn' ? "\r\n*ÁªëÂç°Áî®Êà∑ËøîÂõûÁöÑÊï∞ÊçÆÂ∫îËØ•ÈÉΩÂè™ÊòØÂΩìÊúàÁöÑÔºå‰ΩÜÊàëÊ≤°ÁªëËøáÂç°Êó†Ê≥ïÈ™åËØÅÁªüËÆ°ËåÉÂõ¥„ÄÇ" : "\r\n*I don't have a payment account, so I can't verify the time range of data for payment users. However, hope the label is not wrong." ;
				const msg9 =  data[1] ? str2 : str1;
				
				
				const msgBottom_cn = '\r\n\r\n‰ΩôÈ¢ùÊü•ËØ¢‰ª£Á†Å v7.23  \r\n‰ª•‰∏ä‰ø°ÊÅØÂùáÁî±ÂÆòÊñπÊé•Âè£ËøîÂõûÔºåÂÆûÊó∂Êü•ËØ¢ÂΩìÂâç API KeyÔºå‰∏ç‰ºöÂ≠òÂÇ®Êï∞ÊçÆÔºåÊó†Ê≥ÑÊºèÈ£éÈô©ÔºåÂéüÁêÜËßÅ‰ª£Á†Å„ÄÇ';
	  			const msgBottom_en = '\r\n\r\nBalance Inquiry Code Version 7.23  \r\nUse OpenAI API, real-time query, your data will not be saved, API Key can be changed at any time. ';
				msgBottom = window.currentlang == 'cn' ? msgBottom_cn : msgBottom_en;
				
				isCheckAPIKey = false;

				//Êü•ËØ¢ÁªìÊûú ÂºπÁ™ó
				if(data[1]){
					//ÁªëÂç°Áî®Êà∑ÁöÑÊü•ËØ¢ÁªìÊûú  ÂêéÂè∞ÁªëÂÆö‰ø°Áî®Âç°ÊåâÈáèÊâ£Ë¥πÁöÑÁî®Êà∑
					alert( msgTop + msg0 + msg1 + msg2 + msg3 + msg4 + msg5 + msg6 + msg7 + msgBottom + msg9 );
				}else{
					//ÈùûÁªëÂç°Áî®Êà∑ÁöÑÊü•ËØ¢ÁªìÊûú  ÊØîÁªëÂç°Áî®Êà∑Â§ö‰∏ÄË°åÊï∞ÊçÆÔºömsg8
					alert( msgTop + msg0 + msg1 + msg2  + msg8 + msg3 + msg4 + msg5 + msg6 + msg7 + msgBottom + msg9 );
				}			  

			}).catch((error) => {
				isCheckAPIKey = false;
				console.log(error);
				// Notification: Failed to check the balance. The reasons for the failure are not clear, and the possibility of "code malfunction" cannot be ruled out.(No impact on ChatGPT usage).
				const msg_cn = '!! Êü•ËØ¢‰ΩôÈ¢ùÂ§±Ë¥•ÔºåÂ≠òÂú®Â§öÁßçÂèØËÉΩÔºåÊ£ÄÊü•ÁΩëÁªúÂêéÈáçËØï(ÂõΩÂÜÖÈúÄË¶ÅÈ≠îÊ≥ï)Ôºå‰ªçÂ§±Ë¥•ÁöÑËØùÔºåËØ∑ÊîæÂºÉÊü•‰ΩôÈ¢ùÔΩû \r\n\r\n‰∏çÊéíÈô§ÊòØÊü•ËØ¢‰ΩôÈ¢ù‰ª£Á†ÅÂ§±ÊïàÁöÑÂéüÂõ†Ôºà‰∏çÂΩ±ÂìçGPTÁöÑ‰ΩøÁî®Ôºâ„ÄÇ\r\n\r\nÂèØÊü•Áúã‰ª£Á†ÅÊòØÂê¶ÊúâÊõ¥Êñ∞Ôºö\r\nhttps://gitee.com/lin2025/gpt3.5/ \r\nhttps://github.com/lin2025/gpt3.5/';
				const msg_en = "!! Failed to check the balance. The reasons for the failure are not clear, and the possibility of 'code malfunction' cannot be ruled out.(No impact on GPT usage) \r\n\r\nCheck for code updates:\r\nhttps://github.com/lin2025/gpt3.5/\r\n\r\nTip: If your location is not supported by OpenAI, use a VPN to check your balance.";
				const msg = window.currentlang == 'cn' ? msg_cn : msg_en ;
				alert(msg);
			});
		}

//‰ª•‰∏ä‰∏∫[Êü•ËØ¢OpenAI API‰ΩôÈ¢ù]ÁöÑ‰ª£Á†Å  Javascript code to check OpenAI API balances
</script>


</body>
</html>

